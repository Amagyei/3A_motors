/*!
*  filename: ej2-treemap.umd.min.js
*  version : 28.1.33
*  Copyright Syncfusion Inc. 2001 - 2024. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-svg-base"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-pdf-export")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-svg-base","@syncfusion/ej2-data","@syncfusion/ej2-pdf-export"],t):t((e=e||self).ej={},e.ej2Base,e.ej2SvgBase,e.ej2Data,e.ej2PdfExport)}(this,function(e,A,F,C,w){"use strict";var O,N,E="load",_="loaded",U="beforePrint",H="itemRendering",k="drillStart",q="drillEnd",X="itemSelected",J="itemHighlight",Y="tooltipRendering",Z="itemClick",Q="itemMove",$="click",K="doubleClick",ee="rightClick",te="mouseMove",ie="legendItemRendering",le="legendRendering",oe="resize",re="Roboto, Segoe UI, Noto, Sans-serif",t=(O=function(e,t){return(O=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)},function(e,t){function i(){this.constructor=e}O(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(n=(r<3?o(n):3<r?o(t,i,n):o(t,i))||n);return 3<r&&n&&Object.defineProperty(t,i,n),n},l=(N=A.ChildProperty,t(ne,N),i([A.Property("#808080")],ne.prototype,"color",void 0),i([A.Property(0)],ne.prototype,"width",void 0),ne);function ne(){return null!==N&&N.apply(this,arguments)||this}ae=A.ChildProperty,t(o,ae),i([A.Property(10)],o.prototype,"left",void 0),i([A.Property(10)],o.prototype,"right",void 0),i([A.Property(10)],o.prototype,"top",void 0),i([A.Property(10)],o.prototype,"bottom",void 0);var ae,se=o;function o(){return null!==ae&&ae.apply(this,arguments)||this}de=A.ChildProperty,t(n,de),i([A.Property(null)],n.prototype,"size",void 0),i([A.Property(null)],n.prototype,"color",void 0),i([A.Property(re)],n.prototype,"fontFamily",void 0),i([A.Property("")],n.prototype,"fontWeight",void 0),i([A.Property("Normal")],n.prototype,"fontStyle",void 0),i([A.Property(1)],n.prototype,"opacity",void 0);var de,r=n;function n(){return null!==de&&de.apply(this,arguments)||this}he=A.ChildProperty,t(ge,he),i([A.Property("")],ge.prototype,"text",void 0),i([A.Property("")],ge.prototype,"description",void 0);var he,pe=ge;function ge(){return null!==he&&he.apply(this,arguments)||this}t(ue,ce=pe),i([A.Complex({fontFamily:null,fontWeight:null},r)],ue.prototype,"textStyle",void 0),i([A.Property("Center")],ue.prototype,"alignment",void 0);var ce,me=ue;function ue(){return null!==ce&&ce.apply(this,arguments)||this}t(ve,ye=pe),i([A.Complex({fontFamily:null,fontWeight:null},r)],ve.prototype,"textStyle",void 0),i([A.Property("Center")],ve.prototype,"alignment",void 0),i([A.Complex({},me)],ve.prototype,"subtitleSettings",void 0);var ye,fe=ve;function ve(){return null!==ye&&ye.apply(this,arguments)||this}Se=A.ChildProperty,t(a,Se),i([A.Property(null)],a.prototype,"from",void 0),i([A.Property(null)],a.prototype,"to",void 0),i([A.Property(null)],a.prototype,"color",void 0),i([A.Property(null)],a.prototype,"label",void 0),i([A.Property(null)],a.prototype,"value",void 0),i([A.Property(null)],a.prototype,"minOpacity",void 0),i([A.Property(null)],a.prototype,"maxOpacity",void 0),i([A.Property(!0)],a.prototype,"showLegend",void 0);var Se,xe=a;function a(){return null!==Se&&Se.apply(this,arguments)||this}be=A.ChildProperty,t(s,be),i([A.Property(!1)],s.prototype,"visible",void 0),i([A.Property("Default")],s.prototype,"mode",void 0),i([A.Property("transparent")],s.prototype,"background",void 0),i([A.Property("Circle")],s.prototype,"shape",void 0),i([A.Property("")],s.prototype,"width",void 0),i([A.Property("")],s.prototype,"height",void 0),i([A.Complex({size:null,fontFamily:null,fontWeight:null},r)],s.prototype,"textStyle",void 0),i([A.Property(null)],s.prototype,"fill",void 0),i([A.Property(1)],s.prototype,"opacity",void 0),i([A.Property(15)],s.prototype,"shapeWidth",void 0),i([A.Property(15)],s.prototype,"shapeHeight",void 0),i([A.Property(10)],s.prototype,"shapePadding",void 0),i([A.Property(null)],s.prototype,"imageUrl",void 0),i([A.Complex({color:null,width:null},l)],s.prototype,"border",void 0),i([A.Complex({color:"#000000",width:0},l)],s.prototype,"shapeBorder",void 0),i([A.Complex({},pe)],s.prototype,"title",void 0),i([A.Complex({size:null,fontFamily:null,fontWeight:null},r)],s.prototype,"titleStyle",void 0),i([A.Property("Bottom")],s.prototype,"position",void 0),i([A.Property("None")],s.prototype,"orientation",void 0),i([A.Property(!1)],s.prototype,"invertedPointer",void 0),i([A.Property("After")],s.prototype,"labelPosition",void 0),i([A.Property("None")],s.prototype,"labelDisplayMode",void 0),i([A.Property("Center")],s.prototype,"alignment",void 0),i([A.Property({x:0,y:0})],s.prototype,"location",void 0),i([A.Property(null)],s.prototype,"showLegendPath",void 0),i([A.Property(null)],s.prototype,"valuePath",void 0),i([A.Property(!1)],s.prototype,"removeDuplicateLegend",void 0);var be,Ie=s;function s(){return null!==be&&be.apply(this,arguments)||this}Fe=A.ChildProperty,t(we,Fe),i([A.Property(null)],we.prototype,"groupIndex",void 0),i([A.Property(null)],we.prototype,"groupName",void 0);var Fe,Ce=we;function we(){return null!==Fe&&Fe.apply(this,arguments)||this}Oe=A.ChildProperty,t(d,Oe),i([A.Property(null)],d.prototype,"fill",void 0),i([A.Property(!1)],d.prototype,"autoFill",void 0),i([A.Complex({},l)],d.prototype,"border",void 0),i([A.Property(0)],d.prototype,"gap",void 0),i([A.Property(10)],d.prototype,"padding",void 0),i([A.Property(1)],d.prototype,"opacity",void 0),i([A.Property(!0)],d.prototype,"showLabels",void 0),i([A.Property(null)],d.prototype,"labelPath",void 0),i([A.Property(null)],d.prototype,"labelFormat",void 0),i([A.Property("TopLeft")],d.prototype,"labelPosition",void 0),i([A.Complex({color:null,size:null,fontFamily:null},r)],d.prototype,"labelStyle",void 0),i([A.Property(null)],d.prototype,"labelTemplate",void 0),i([A.Property("Center")],d.prototype,"templatePosition",void 0),i([A.Property("Trim")],d.prototype,"interSectAction",void 0),i([A.Collection([],xe)],d.prototype,"colorMapping",void 0);var Oe,Le=d;function d(){return null!==Oe&&Oe.apply(this,arguments)||this}Te=A.ChildProperty,t(h,Te),i([A.Property(!1)],h.prototype,"visible",void 0),i([A.Property("")],h.prototype,"template",void 0),i([A.Property(null)],h.prototype,"format",void 0),i([A.Property(null)],h.prototype,"fill",void 0),i([A.Property(.75)],h.prototype,"opacity",void 0),i([A.Property(["Circle"])],h.prototype,"markerShapes",void 0),i([A.Complex({width:null,color:null},l)],h.prototype,"border",void 0),i([A.Complex({fontFamily:null,size:null,fontWeight:null,opacity:null},r)],h.prototype,"textStyle",void 0);var Te,Ne=h;function h(){return null!==Te&&Te.apply(this,arguments)||this}Ee=A.ChildProperty,t(p,Ee),i([A.Property(!1)],p.prototype,"enable",void 0),i([A.Property(null)],p.prototype,"fill",void 0),i([A.Property("0.5")],p.prototype,"opacity",void 0),i([A.Complex({},l)],p.prototype,"border",void 0),i([A.Property("Item")],p.prototype,"mode",void 0);var Ee,_e=p;function p(){return null!==Ee&&Ee.apply(this,arguments)||this}Me=A.ChildProperty,t(g,Me),i([A.Property(!1)],g.prototype,"enable",void 0),i([A.Property("#808080")],g.prototype,"fill",void 0),i([A.Property("0.5")],g.prototype,"opacity",void 0),i([A.Complex({},l)],g.prototype,"border",void 0),i([A.Property("Item")],g.prototype,"mode",void 0);var Me,De=g;function g(){return null!==Me&&Me.apply(this,arguments)||this}Pe=A.ChildProperty,t(c,Pe),i([A.Property(null)],c.prototype,"groupPath",void 0),i([A.Property(0)],c.prototype,"groupGap",void 0),i([A.Property(10)],c.prototype,"groupPadding",void 0),i([A.Complex({},l)],c.prototype,"border",void 0),i([A.Property(null)],c.prototype,"fill",void 0),i([A.Property(!1)],c.prototype,"autoFill",void 0),i([A.Property(1)],c.prototype,"opacity",void 0),i([A.Property(!0)],c.prototype,"showHeader",void 0),i([A.Property(20)],c.prototype,"headerHeight",void 0),i([A.Property(null)],c.prototype,"headerTemplate",void 0),i([A.Property(null)],c.prototype,"headerFormat",void 0),i([A.Property("Near")],c.prototype,"headerAlignment",void 0),i([A.Complex({color:null,size:"13px",fontFamily:null},r)],c.prototype,"headerStyle",void 0),i([A.Property("TopLeft")],c.prototype,"templatePosition",void 0),i([A.Collection([],xe)],c.prototype,"colorMapping",void 0);var Pe,t=c;function c(){return null!==Pe&&Pe.apply(this,arguments)||this}var W=function(e,t){this.width=e,this.height=t};function Be(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}var j=function(e,t,i,l){this.x=e,this.y=t,this.width=i,this.height=l},L=function(e,t,i,l,o,r){this.y=o.y,this.x=o.x,this.height=o.height,this.width=o.width,this.id=e,this.fill=t,this.opacity=l,this.stroke=i.color,this["stroke-width"]=i.width,this["stroke-dasharray"]=r},z=function(e,t,i,l,o,r,n){this.id=e,this.opacity=o,this.fill=t,this.stroke=l,this["stroke-width"]=i,this["stroke-dasharray"]=r,this.d=n};function G(e,t){var i=document.getElementById("treeMapMeasureText");return null===i&&(i=A.createElement("text",{id:"treeMapMeasureText"}),document.body.appendChild(i)),i.innerHTML=A.SanitizeHtmlHelper.sanitize(e),i.style.position="absolute",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new W(i.clientWidth,i.clientHeight)}var T=function(e,t,i,l,o,r,n,a){void 0===r&&(r=""),this.transform="",this.baseLine="auto",this.id=e,this.text=o,this.transform=r,this.anchor=l,this.x=t,this.y=i,this.baseLine=n,this.connectorText=a};function V(e,t,i){var l=t;if(e<G(t,i).width)for(var o=t.length-1;0<=o;--o)if(G(l=t.substring(0,o)+"...",i).width<=e||l.length<4)return l=l.length<4?" ":l;return l}var m=function(e,t){this.x=e,this.y=t};function ze(e,t,i,l){var o;switch(t){case"Near":o=e.x;break;case"Center":o="title"===l?e.width/2-i.width/2:e.x+e.width/2-i.width/2;break;case"Far":o="title"===l?e.width-e.y-i.width:e.x+e.width-i.width}t="title"===l?e.y+i.height/2:e.y+e.height/2+i.height/2;return new m(o,t)}function Re(e,t,i){e=e.createText(t,i);return e.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),e.style["user-select"]="none",e.style["-moz-user-select"]="none",e.style["-webkit-touch-callout"]="none",e.style["-webkit-user-select"]="none",e.style["-khtml-user-select"]="none",e.style["-ms-user-select"]="none",e.style["-o-user-select"]="none",e}function Ue(e,t,i,l,o){void 0===o&&(o=!1);var r,n,a={"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine,id:e.id,x:e.x,y:e.y,fill:i},i="string"==typeof e.text?e.text:o?e.text[e.text.length-1]:e.text[0],s=new F.SvgRenderer("");if(!A.isNullOrUndefined(i)&&!A.isNullOrUndefined(e.connectorText)&&0<=i.search(e.connectorText[1]))for(var d=i.split("#"),h=0;h<d.length;h++){var p=-1===d[h].search(e.connectorText)||A.isNullOrUndefined(e.connectorText)?d[h]:e.connectorText,p=(a.id=e.id+"_"+h,n=Re(s,a,p),h%2==0&&0!==h&&(p=p.replace(/\s+/g,"&nbsp")),G(p,t));a.x=0!==h?a.x+p.width:a.x+p.width+5,l.appendChild(n)}else n=Re(s,a,i),l.appendChild(n);if("string"!=typeof e.text&&1<e.text.length){for(var g=1,c=e.text.length;g<c;g++)r=G(e.text[g],t).height,r=s.createTSpan({x:e.x,id:e.id,y:e.y+g*r},e.text[g]),n.appendChild(r);l.appendChild(n)}return n}function He(e,t,i){var l=e.split("_RectPath")[0],e=-1<e.indexOf("_LabelTemplate")?t:document.querySelector("#"+l+"_LabelTemplate");A.isNullOrUndefined(e)||(e.innerHTML=i)}function ke(e){return document.getElementById(e)}function Ae(e,t){return e.weight===t.weight?0:e.weight<t.weight?1:-1}function We(e,t,i,l){for(var o=!1,r="",n=l.leafItemSettings,a=0;a<e.length;a++){var s=i[l.levels[a]?l.levels[a].groupPath:n.labelPath||l.weightValuePath]||"undefined";if(e[a]===s&&(r+=s+(a===e.length-1?"":"#"))===t){o=!0;break}}return o}function R(e){if(e)for(var t=Object.keys(e),i={},l=0;l<t.length;l++)if(e[t[l]]instanceof Array){i.values=e[t[l]],i.key=t[l];break}return i}function je(e,t,i,l){if("Child"===i){t.push(e.levelOrderName);var o=R(e).values;if(o&&0<o.length){for(var r=0;r<o.length;r++)-1===t.indexOf(o[r].levelOrderName)&&t.push(o[r].levelOrderName);for(var n=0;n<o.length;n++)je(o[n],t,i,l)}}else if("Parent"===i)"string"==typeof e.levelOrderName&&-1===t.indexOf(e.levelOrderName)&&(t.push(e.levelOrderName),je(e.parent,t,i,l));else if("All"===i)for(var a=e.levelOrderName.split("#")[0],s=void 0,r=0;r<l.layout.renderItems.length;r++)-1<(s=l.layout.renderItems[r]).levelOrderName.indexOf(a)&&-1===t.indexOf(s.levelOrderName)&&t.push(s.levelOrderName);else t.push(e.levelOrderName);return t}function Ge(t){var i=null;try{i="function"!=typeof t&&document.querySelectorAll(t).length?A.compile(document.querySelector(t).innerHTML.trim()):A.compile(t)}catch(e){i=A.compile(t)}return i}function Ve(e,t,i){for(var l=A.createElement("div",{id:t}),o=(l.style.cssText="position: absolute;pointer-events: auto;",e.length);0<o;)l.appendChild(e[0]),o--;for(var r=l.innerHTML,n=Object.keys(i),a=0;a<n.length;a++)var s=RegExp,r=r.replace(new s("{{:"+n[a]+"}}","g"),i[n[a].toString()]);return l.innerHTML=r,l}function qe(e,t,i,l,o){var r=new m(0,0),n="Template"===l?o.areaRect.x:0,a="Template"===l?o.areaRect.y:0;return r.x=Math.abs(n-(-1<t.indexOf("Left")?e.x+5:-1<t.indexOf("Right")?e.x+e.width-i.width:e.x+(e.width/2-i.width/2)))-2,!o.enableDrillDown||"BottomLeftTopRight"!==o.renderDirection&&"BottomRightTopLeft"!==o.renderDirection?r.y=Math.abs(a-(-1<t.indexOf("Top")?"Template"===l?e.y:e.y+i.height:-1<t.indexOf("Bottom")?e.y+e.height-i.height:"Template"===l?e.y+(e.height/2-i.height/2):e.y+e.height/2+i.height/4)):r.y=Math.abs(e.y+e.height-i.height+5),r}function Xe(e,t){var i=new W(0,0),t=(t.appendChild(e),i.height=e.offsetHeight,i.width=e.offsetWidth,document.getElementById(e.id));return t.parentNode.removeChild(t),i}function Je(e){return(e.width-e.x)*(e.height-e.y)}function Ye(e){var e=Ze(e),t=e.width,e=e.height;return Math.min(t,e)}function Ze(e){var t=e.x,i=e.y;return{x:t,y:i,width:e.width-t,height:e.height-i}}function Qe(e){var t=e.x,i=e.y;return{x:t,y:i,width:t+e.width,height:i+e.height}}function $e(e,t,i){var l=i.getBoundingClientRect(),o=i.ownerDocument.defaultView.pageXOffset,r=i.ownerDocument.defaultView.pageYOffset,n=i.ownerDocument.documentElement.clientTop,i=i.ownerDocument.documentElement.clientLeft,o=l.left+o-i,i=l.top+r-n;return new m(e-o,t-i)}function Ke(e,t,i){var l,o,r=[];if(A.isNullOrUndefined(t)&&A.isNullOrUndefined(i)&&isNaN(i))return null;for(var n=0;n<e.length;n++){var a=!1,s=i;A.isNullOrUndefined(e[n].from)||A.isNullOrUndefined(e[n].to)||A.isNullOrUndefined(e[n].value)?(A.isNullOrUndefined(e[n].from)||A.isNullOrUndefined(e[n].to))&&A.isNullOrUndefined(e[n].value)||(i>=e[n].from&&e[n].to>=i||e[n].value===t)&&(e[n].value===t&&(a=!0),l="[object Array]"===Object.prototype.toString.call(e[n].color)?a?e[n].color[0]:tt(e[n],s):e[n].color):i>=e[n].from&&e[n].to>=i&&e[n].value===t&&(a=!0,l="[object Array]"===Object.prototype.toString.call(e[n].color)?a?e[n].color[0]:tt(e[n],s):e[n].color),(i>=e[n].from&&i<=e[n].to||e[n].value===t)&&!A.isNullOrUndefined(e[n].minOpacity)&&!A.isNullOrUndefined(e[n].maxOpacity)&&l&&(o=et(e[n],i)),(""===l||A.isNullOrUndefined(l))&&A.isNullOrUndefined(e[n].from)&&A.isNullOrUndefined(e[n].to)&&A.isNullOrUndefined(e[n].minOpacity)&&A.isNullOrUndefined(e[n].maxOpacity)&&A.isNullOrUndefined(e[n].value)&&(l="[object Array]"===Object.prototype.toString.call(e[n].color)?e[n].color[0]:e[n].color),o=A.isNullOrUndefined(o)?"1":o,r.push(l)}for(var d=r.length-1;0<=d;d--)d=(l=r[d])?-1:d;return{fill:l,opacity:o}}function et(e,t){var i=1;return(i=t>=e.from&&t<=e.to?(t-e.from)/(e.to-e.from)*(e.maxOpacity-e.minOpacity)+e.minOpacity:i).toString()}function tt(e,t){return lt(e,t)}function it(e,t,i){return"#"+u(e)+u(t)+u(i)}function lt(e,t){return Number(t)===e.from?e.color[0]:Number(t)===e.to?e.color[e.color.length-1]:it((t=ot(Number(t),e)).r,t.g,t.b)}function ot(e,t){var i=t.from,l=t.to,o=0,r=l-i,o=(e-i)/r;if(t.color.length<=2)a="#"===t.color[0].charAt(0)?t.color[0]:y(t.color[0]),s="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:y(t.color[t.color.length-1]);else{for(var n,a="#"===t.color[0].charAt(0)?t.color[0]:y(t.color[0]),s="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:y(t.color[t.color.length-1]),d=r/(t.color.length-1),h=t.color.length-1,p=[],g=1;g<h;g++)n={b:i+g*d,color:t.color[g]},p.push(n);for(var c=0;c<p.length;c++)i<=e&&e<=p[c].b&&0===c?(s="#"===p[c].color.charAt(0)?p[c].color:y(p[c].color),o=e<p[c].b?1-Math.abs((e-p[c].b)/d):(e-p[c].b)/d):p[c].b<=e&&e<=l&&c===p.length-1&&(a="#"===p[c].color.charAt(0)?p[c].color:y(p[c].color),o=e<p[c].b?1-Math.abs((e-p[c].b)/d):(e-p[c].b)/d),c!==p.length-1&&c<p.length&&p[c].b<=e&&e<=p[c+1].b&&(a="#"===p[c].color.charAt(0)?p[c].color:y(p[c].color),s="#"===p[c+1].color.charAt(0)?p[c+1].color:y(p[c+1].color),o=Math.abs(e-p[c+1].b)/d)}return rt(o,a,s)}function rt(e,t,i){var i=i.split("#")[1],t=t.split("#")[1],l=nt(e,parseInt(t.substr(0,2),16),parseInt(i.substr(0,2),16)),o=nt(e,parseInt(t.substr(2,2),16),parseInt(i.substr(2,2),16)),e=nt(e,parseInt(t.substr(4,2),16),parseInt(i.substr(4,2),16));return new ut(l,o,e)}function nt(e,t,i){return Math.round(t+(i-t)*e)}function at(e,t,i){for(var l,o=t.split(" "),r="",n=[],a=0,s=o.length;a<s;a++)l=o[a],G(r.concat(l),i).width<e?r=r.concat((""===r?"":" ")+l):""!==r?(n.push(V(e,r,i)),r=l):n.push(V(e,l,i)),r&&a===s-1&&n.push(V(e,r,i));return n}function st(e,t,i){var l=[],o=0,r=G(t,i).width,n=t.length;if(r<=e)l.push(t);else for(var a=t.length;o<a;a--){var s=t.slice(o,a);if(G(s,i).width<=e){if(l.push(s),n===(o+=s.length))return l;a=n+1}}return l}function dt(e,t,i,l){l=G(i,l);return l.width>e||l.height>t?" ":i}function ht(e,t){return e.itemArea===t.itemArea?0:e.itemArea<t.itemArea?1:-1}function pt(e,t,i){var l=e.levelSelection;if(l)for(var o=0;o<l.length;o++)t.getAttribute("id")===l[o]||t.children[0].id===l[o]?0<t.childElementCount&&(t.children[0].setAttribute("class",i),D(t.childNodes[0],{border:e.selectionSettings.border,fill:e.selectionSettings.fill,opacity:e.selectionSettings.opacity})):t.setAttribute("class","")}function gt(e,t){var i=e.legendId;if(i)for(var l=0;l<i.length;l++)if("Interactive"===e.legendSettings.mode)for(var o,r=0;r<t.childElementCount;r++)t.childNodes[r].id!==i[l]&&parseFloat(t.childNodes[r].id.split("Index_")[1])!==parseFloat(i[l].split("Index_")[1])||((o=t.childNodes[r]).setAttribute("fill",e.selectionSettings.fill),o.setAttribute("stroke",e.selectionSettings.border.color),o.setAttribute("stroke-width",e.selectionSettings.border.width.toString()),o.setAttribute("opacity",e.selectionSettings.opacity));else{var n=document.getElementById(i[l]);A.isNullOrUndefined(n)||(n.setAttribute("fill",e.selectionSettings.fill),n.setAttribute("stroke",e.selectionSettings.border.color),n.setAttribute("stroke-width",e.selectionSettings.border.width.toString()),n.setAttribute("opacity",e.selectionSettings.opacity))}}function M(e,t,i){for(var l,o,r=0;r<e.length;r++)l=A.isNullOrUndefined(e[r].childNodes[0])?e[r]:e[r].childNodes[0],o=i.layout.renderItems[parseFloat(l.id.split("_Item_Index_")[1])].options,D(l,o),e[r].classList.remove(t),--r}function D(e,t){e.setAttribute("opacity",t.opacity),A.isNullOrUndefined(t.fill)?e.setAttribute("fill","black"):e.setAttribute("fill",t.fill),e.setAttribute("stroke",t.border.color),e.setAttribute("stroke-width",t.border.width)}function ct(e,t,i){if(A.isNullOrUndefined(e))return null;for(var l=0,o=Object.keys(t);l<o.length;l++){var r=o[l];e=e.split("${"+r+"}").join(mt(t[r],i).toString())}return e}function mt(e,t){t=t.format&&!isNaN(Number(e))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(e)):e;return t||""}var ut=function(e,t,i){this.r=e,this.g=t,this.b=i};function yt(e){return"#"+u(e.r)+u(e.g)+u(e.b)}function u(e){e=e.toString(16);return 1===e.length?"0"+e:e}function ft(e){e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return e?new ut(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)):new ut(255,255,255)}function y(e){e="transparent"===e?"white":e;var t=document.getElementById("treeMapMeasureText"),t=(t.style.color=e,(e=window.getComputedStyle(t).color).replace(/[()RGBrgba ]/g,"").split(","));return yt(new ut(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)))}function vt(e,t,i,l,o){var r=new F.SvgRenderer(""),e=St(e,i,t,o,l);return r["draw"+e.functionName](e.renderOption)}function St(e,t,i,l,o){var r,n="Path",a=t.width,s=t.height,d=e.x,h=e.y,p=e.x+-a/2,g=e.y+-s/2;switch(i){case"Circle":case"Bubble":n="Ellipse",A.merge(l,{rx:a/2,ry:s/2,cx:d,cy:h});break;case"VerticalLine":A.merge(l,{d:r="M "+d+" "+(h+s/2)+" L "+d+" "+(h+-s/2)});break;case"Diamond":A.merge(l,{d:r="M "+p+" "+h+" L "+d+" "+(h+-s/2)+" L "+(d+a/2)+" "+h+" L "+d+" "+(h+s/2)+" L "+p+" "+h+" z"});break;case"Rectangle":A.merge(l,{d:r="M "+p+" "+(h+-s/2)+" L "+(d+a/2)+" "+(h+-s/2)+" L "+(d+a/2)+" "+(h+s/2)+" L "+p+" "+(h+s/2)+" L "+p+" "+(h+-s/2)+" z"});break;case"Triangle":A.merge(l,{d:r="M "+p+" "+(h+s/2)+" L "+d+" "+(h+-s/2)+" L "+(d+a/2)+" "+(h+s/2)+" L "+p+" "+(h+s/2)+" z"});break;case"InvertedTriangle":A.merge(l,{d:r="M "+(d+a/2)+" "+(h-s/2)+" L "+d+" "+(h+s/2)+" L "+(d-a/2)+" "+(h-s/2)+" L "+(d+a/2)+" "+(h-s/2)+" z"});break;case"Pentagon":for(var c,m,u=0;u<=5;u++)c=a/2*Math.cos(Math.PI/180*(72*u)),m=a/2*Math.sin(Math.PI/180*(72*u)),r=0===u?"M "+(d+c)+" "+(h+m)+" ":r.concat("L "+(d+c)+" "+(h+m)+" ");r=r.concat("Z"),A.merge(l,{d:r});break;case"Star":r="M "+(e.x+t.width/3)+" "+(e.y-t.height/2)+" L "+(e.x-t.width/2)+" "+(e.y+t.height/6)+" L "+(e.x+t.width/2)+" "+(e.y+t.height/6)+" L "+(e.x-t.width/3)+" "+(e.y-t.height/2)+" L "+e.x+" "+(e.y+t.height/2)+" L "+(e.x+t.width/3)+" "+(e.y-t.height/2)+" Z",A.merge(l,{d:r});break;case"Cross":A.merge(l,{d:r="M "+p+" "+h+" L "+(d+a/2)+" "+h+" M "+d+" "+(h+s/2)+" L "+d+" "+(h+-s/2)});break;case"Image":n="Image",A.merge(l,{href:o,height:s,width:a,x:p,y:g})}return{renderOption:l,functionName:n}}function xt(e,t){for(var i=!1,l=0;l<e.length;l++)if(t.levelOrderName===e[l].levelOrderName){i=!0;break}return i}function bt(e,t,i,l,o){this.dataOptions=e,this.type=t||"GET",this.async=i||!0,this.contentType=l,this.sendData=o}function It(e){if(0<e.length)for(var t=0;t<e.length;t++){var i=e[t];B(i.legendEle,i.oldFill,i.oldOpacity,i.oldBorderColor,i.oldBorderWidth)}}function P(e,t){if(0<e.length)for(var i=0;i<e.length;i++)for(var l=e[i],o=parseFloat(l.legendEle.id.split("_Index_")[1]),r=-1<l.legendEle.id.indexOf("Text")?l.legendEle.id.replace("_Text",""):l.legendEle.id,n="Interactive"===t.legendSettings.mode?document.getElementById(r):document.getElementById(t.element.id+"_Legend_Shape_Index_"+o),r="Interactive"===t.legendSettings.mode?document.getElementById(r+"_Text"):document.getElementById(t.element.id+"_Legend_Text_Index_"+o),a=(A.isNullOrUndefined(n)||B(n,l.oldFill,l.oldOpacity,l.oldBorderColor,l.oldBorderWidth),A.isNullOrUndefined(r)||B(r,t.legendSettings.textStyle.color,l.oldOpacity,l.oldBorderColor,l.oldBorderWidth),A.isNullOrUndefined(l.ShapeCollection)?0:l.ShapeCollection.Elements.length),s=0;s<a;s++){var d=document.getElementById(l.ShapeCollection.Elements[s].id);A.isNullOrUndefined(d)||B(d,l.shapeOldFill,l.shapeOldOpacity,l.shapeOldBorderColor,l.shapeOldBorderWidth)}}function B(e,t,i,l,o){e.setAttribute("fill",t),e.setAttribute("opacity",i),e.setAttribute("stroke",l),e.setAttribute("stroke-width",o)}function Ft(e,t,i){P(e,i),M(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",i)}function Ct(e,t,i){for(var l,o=i.rangeColorValuePath,r=0;r<e;r++){var n=i.treeMapLegendModule.legendCollections[r].legendData.length;if(0<n){for(var a=0;a<n;a++)if(!A.isNullOrUndefined(o)&&""!==o&&0<i.leafItemSettings.colorMapping.length?i.treeMapLegendModule.legendCollections[r].legendData[a].data[o]===t.data[o]:i.treeMapLegendModule.legendCollections[r].legendData[a].levelOrderName===t.levelOrderName||-1<t.levelOrderName.indexOf(i.treeMapLegendModule.legendCollections[r].legendName)){l=r;break}}else if(i.palette&&0<i.palette.length&&(i.treeMapLegendModule.legendCollections[r].levelOrderName===t.levelOrderName||-1<t.levelOrderName.indexOf(i.treeMapLegendModule.legendCollections[r].levelOrderName))&&i.treeMapLegendModule.legendCollections[r].legendName===t.name){l=r;break}}return l}function wt(e,t,i,l,o,r,n){e.push({legendEle:l,oldFill:n[t].legendFill,oldOpacity:n[t].opacity,oldBorderColor:n[t].borderColor,oldBorderWidth:n[t].borderWidth,shapeElement:o,shapeOldFill:r[i].options.fill,shapeOldOpacity:r[i].options.opacity,shapeOldBorderColor:r[i].options.border.color,shapeOldBorderWidth:r[i].options.border.width})}function Ot(e,t,i,l){A.createElement("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(l?"click":"move",{view:window,bubbles:!1,cancelable:!0}))}function Lt(e){e=document.getElementById(e);return e?A.remove(e):null}f.prototype.processLayoutPanel=function(){var e,t,i,l;this.treemap.treemapLevelData.levelsData&&0<this.treemap.treemapLevelData.levelsData.length&&(i=(A.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)||A.isNullOrUndefined(this.treemap.initialDrillDown.groupName)||(A.isNullOrUndefined(this.treemap.drilledItems)?!A.isNullOrUndefined(this.treemap.drilledItems):0!==this.treemap.drilledItems.length)?this.treemap.treemapLevelData.levelsData:this.getDrilldownData(this.treemap.treemapLevelData.levelsData[0],[]))[0],l=A.extend({},this.treemap.areaRect,l,!1),A.isNullOrUndefined(this.treemap.treeMapLegendModule)||A.isNullOrUndefined(this.treemap.totalRect)||"Float"!==this.treemap.legendSettings.position&&(l=this.treemap.totalRect),A.isNullOrUndefined(this.treemap.currentLevel)||(A.isNullOrUndefined(this.treemap.drilledItems)?A.isNullOrUndefined(this.treemap.drilledItems):0===this.treemap.drilledItems.length)?(!A.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)&&(A.isNullOrUndefined(this.treemap.drilledItems)?A.isNullOrUndefined(this.treemap.drilledItems):0===this.treemap.drilledItems.length)&&(this.treemap.currentLevel=this.treemap.initialDrillDown.groupIndex),this.calculateLayoutItems(i||this.treemap.treemapLevelData.levelsData[0],l)):(i=this.treemap.drilledItems.length-1,e=this.treemap.drilledItems[i].data,(t={})[this.treemap.drilledItems[i].data.groupName]=[e],A.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)||this.treemap.enableBreadcrumb||(this.treemap.currentLevel=this.treemap.drilledItems[i].data.groupIndex),this.calculateLayoutItems(t||this.treemap.treemapLevelData.levelsData[0],l)),this.renderLayoutItems())},f.prototype.getDrilldownData=function(e,t){var i=this.treemap,l={},o=R(e).values;if(o&&0<o.length&&0===t.length){for(var r=0;r<o.length;r++)o[r].groupIndex===i.initialDrillDown.groupIndex&&o[r].name===i.initialDrillDown.groupName&&(o[r].isDrilled=!0,l[o[r].groupName]=[o[r]],t.push(l));for(var n=0;n<o.length;n++)this.getDrilldownData(o[n],t)}return t},f.prototype.calculateLayoutItems=function(e,t){this.renderItems=[],this.parentData=[],A.isNullOrUndefined(this.treemap.weightValuePath)||(-1<this.treemap.layoutType.indexOf("SliceAndDice")?this.computeSliceAndDiceDimensional(e,t):(t.height=t.height+t.y,t.width=t.width+t.x,this.computeSquarifyDimensional(e,t)))},f.prototype.computeSliceAndDiceDimensional=function(e,t){var i,l,o,r=this.treemap.leafItemSettings,n=this.treemap.levels,a=R(e).values;if(a&&0<a.length&&(this.sliceAndDiceProcess(a,t),0<this.treemap.levels.length))for(var s=0;s<a.length;s++)o=a[s].groupIndex,l=0===n.length||o===n.length?r.gap:n[o].groupGap,o=0===n.length?0:n[o]?n[o].showHeader?n[o].headerHeight:0:n[o-1].showHeader?n[o-1].headerHeight:0,i=a[s].rect,i=new j(i.x+l/2,i.y+(o+l/2),i.width-l,Math.abs(i.height-(l+o))),this.computeSliceAndDiceDimensional(a[s],i);return e},f.prototype.sliceAndDiceProcess=function(e,t){var i,l=t.height*t.width,o=this.treemap.levels,r=0,n=0,a=(e.forEach(function(e){n+=e.weight}),e.forEach(function(e){e.weightArea=l*e.weight/n}),"SliceAndDiceAuto"===this.treemap.layoutType?t.width>t.height:"SliceAndDiceHorizontal"===this.treemap.layoutType);e.sort(Ae);for(var s=0;s<e.length;s++){var d=e[s];d.isLeafItem=0===o.length||(this.treemap.isHierarchicalData||A.isNullOrUndefined(this.treemap.leafItemSettings.labelPath)?d.groupIndex===o.length-1:d.groupIndex===this.treemap.levels.length),a?(i=l/n*e[s].weight/t.height,r<=t.width&&(e[s].rect=new j(r+t.x,t.y,i,t.height))):(i=l/n*e[s].weight/t.width,r<=t.height&&(e[s].rect=new j(t.x,r+t.y,t.width,i))),r+=i,this.renderItems.push(e[s])}},f.prototype.computeSquarifyDimensional=function(e,t){var i,l,o,r,n=this.treemap.leafItemSettings,a=this.treemap.levels,s=R(e).values;if(s&&0<s.length&&(0===this.parentData.length&&(this.parentData=[],this.parentData.push(s)),this.calculateChildrenLayout(e,s,t),0<this.treemap.levels.length))for(var d=0;d<s.length;d++)r=(l=s[d]).groupIndex,i=l.rect,o=(l.isLeafItem?n.padding:a[r].groupPadding)/2,r=this.treemap.isHierarchicalData?(0!==r||!l.isLeafItem)&&a[r]&&a[r].showHeader?a[r].headerHeight:0:0!==a.length&&a[r]&&a[r].showHeader?a[r].headerHeight:0,i=new j(i.x+o,i.y+(r+o),i.width-o,i.height-o),!l.isLeafItem&&0<l.weight&&this.computeSquarifyDimensional(s[d],i)},f.prototype.calculateChildrenLayout=function(e,t,i){this.computeTotalArea(t,Je(i)),t.sort(ht),this.performRowsLayout(t,[],i,[])},f.prototype.performRowsLayout=function(e,t,i,l){var o=e.length;if(0===o)return h=this.getCoordinates(t,i),l.concat(h);var r=Ye(i),n=e[0],o=e.slice(1,o);if(this.aspectRatio(t,n,r))return r=t.concat(n),this.performRowsLayout(o,r,i,l);for(var a=t.length,s=0,d=0;d<a;d+=1)s+=t[d].itemArea;var n=this.cutArea(i,s),h=this.getCoordinates(t,i),o=l.concat(h);return this.performRowsLayout(e,[],n,o)},f.prototype.aspectRatio=function(e,t,i){return 0===e.length||(t=e.concat(t),e=this.findMaxAspectRatio(e,i),this.findMaxAspectRatio(t,i)<=e)},f.prototype.findMaxAspectRatio=function(e,t){for(var i=e.length,l=1/0,o=-1/0,r=0,n=0;n<i;n+=1){var a=e[n].itemArea;a<l&&(l=a),o<a&&(o=a),r+=a}return Math.max(Math.pow(t,2)*o/Math.pow(r,2),Math.pow(r,2)/(Math.pow(t,2)*l))},f.prototype.cutArea=function(e,t){var i,e=Ze(e),l=e.width,o=e.height,r=e.x,e=e.y;return Qe(o<=l?{x:r+(i=t/o),y:e,width:l-i,height:o}:{x:r,y:e+(i=t/l),width:l,height:o-i})},f.prototype.getCoordinates=function(e,t){for(var i=Ze(t),l=i.width,o=i.height,r=i.x,i=i.y,n=e.length,a=this.treemap.levels,s=this.treemap.leafItemSettings,d=0,h=0;h<n;h+=1)d+=e[h].itemArea;for(var p,g,c=d/o,m=d/l,u=r,y=i,f=[],h=0;h<n;h+=1){var v,S=e[h],x=S.groupIndex;S.isLeafItem=0===a.length||(this.treemap.isHierarchicalData||!A.isNullOrUndefined(s.labelPath))&&x===a.length,g=(p=xt(this.parentData[0],S))?this.treemap.areaRect:S.parent.rect,x=S.isLeafItem?s.padding:a[x].groupPadding,o<=l?(v=y+S.itemArea/c,S.rect={x:u,y:y,width:u+c,height:v},y=v):(v=u+S.itemArea/m,S.rect={x:u,y:y,width:v,height:y+m},u=v),0<S.weight&&(p||Math.round(t.y+x/2)<=Math.round(g.y+(g.height-g.y))&&Math.round(t.x+x/2)<=Math.round(g.x+(g.width-g.x)))&&(this.renderItems.push(S),f.push(S))}return f},f.prototype.computeTotalArea=function(e,t){for(var i=e.length,l=[],o=0;o<i;o+=1){for(var r=e.length,n=0,a=0;a<r;a+=1)n+=e[a].weight;for(var s=t/n,d=void 0,h=0;h<r;h++)(d=e[h]).itemArea=d.weight*s,l.push(d)}return l},f.prototype.onDemandProcess=function(e){var t,i=e[0].parent;this.treemap.currentLevel=i.isDrilled?i.groupIndex:null;for(var l={},o=(A.isNullOrUndefined(i.groupName)?l=i:l[i.groupName]=[i],t=A.extend({},this.treemap.areaRect,t,!1),A.isNullOrUndefined(this.treemap.treeMapLegendModule)||A.isNullOrUndefined(this.treemap.totalRect)||(t=this.treemap.totalRect),this.treemap.levels.length),r=0;r<o;r++)o===e[0].groupIndex?this.treemap.levels[o]=this.treemap.levels[r]:this.treemap.levels.splice(o-1,1);this.calculateLayoutItems(l,t),this.renderLayoutItems()},f.prototype.renderLayoutItems=function(){for(var a,s,d,h,p,g,c,m,u,y,f,v,S,x,b,I,F,C,w=this,O=this.treemap,L=(this.renderer=O.renderer,O.element.id),e=O.layoutType,T=this.treemap.leafItemSettings.interSectAction,N="",E=document.getElementById(O.element.id+"_Secondary_Element"),_=O.levels,M=(this.layoutGroup=this.renderer.createGroup({id:L+"_TreeMap_"+e+"_Layout"}),A.createElement("div",{id:O.element.id+"_Label_Template_Group",className:"template"})),D=(M.style.cssText="overflow: hidden; position: absolute;pointer-events: none;top:"+O.areaRect.y+"px;left:"+O.areaRect.x+"px;height:"+O.areaRect.height+"px;width:"+O.areaRect.width+"px;",!1),P=O.leafItemSettings,B=this,t=0;t<this.renderItems.length;t++)!function(e){if(m=B.renderItems[e],h=m.groupIndex,B.treemap.drillDownView&&A.isNullOrUndefined(B.treemap.currentLevel)&&0<h||B.treemap.drillDownView&&h>B.treemap.currentLevel+1)return;g=m.rect,D=m.isLeafItem,f=L+"_Level_Index_"+h+"_Item_Index_"+e,x=B.renderer.createGroup({id:f+"_Group"}),F=(D?P.gap:_[h].groupGap)/2;var t,e=B.treemap.totalRect?O.legendSettings.visible?B.treemap.totalRect:Ze(B.treemap.totalRect):B.treemap.areaRect;"Squarified"===O.layoutType&&(g.width=Math.abs(g.x-g.width)-F,g.height=Math.abs(g.y-g.height)-F),"TopRightBottomLeft"===O.renderDirection?g.x=e.x+e.width-g.width-Math.abs(e.x-g.x):"BottomLeftTopRight"===O.renderDirection?g.y=e.y+e.height-g.height-Math.abs(e.y-g.y):"BottomRightTopLeft"===O.renderDirection&&(g.x=e.x+e.width-g.width-Math.abs(e.x-g.x),g.y=e.y+e.height-g.height-Math.abs(e.y-g.y)),F=B.getItemColor(D,m),c=F.fill,y=F.opacity,F=D?P.labelFormat:_[h].headerFormat,s=D?P.showLabels:_[h].showHeader,t=h===B.treemap.currentLevel?B.treemap.enableBreadcrumb?(C="#"+B.treemap.breadcrumbConnector+"#",t=m.levelOrderName.replace(/#/gi,C),0!==h?"#"+t:t):m.name:(B.treemap.enableBreadcrumb&&(m.isDrilled=!1),m.name),u=ct(F,m.data,B.treemap)||t||"undefined",F=R(m).values,u=!D&&F&&0<F.length&&B.treemap.enableDrillDown?m.isDrilled?O.enableRtl?u+" [-]":"[-] "+u:O.enableRtl?u+" [+]":"[+] "+u:u,O.enableHtmlSanitizer&&(u=A.SanitizeHtmlHelper.sanitize(u));var e=(D?P.labelStyle:_[h].headerStyle).fontFamily||B.treemap.themeStyle.labelFontFamily,i=(D?P.labelStyle:_[h].headerStyle).size||B.treemap.themeStyle.labelFontSize,l=(D?P.labelStyle:_[h].headerStyle).fontWeight||B.treemap.themeStyle.fontWeight,o=(D?P.labelStyle:_[h].headerStyle).color,r=(D?P.labelStyle:_[h].headerStyle).fontStyle,n=(D?P.labelStyle:_[h].headerStyle).opacity;S={fontFamily:e,size:i,fontWeight:l,color:o,fontStyle:r,opacity:n},I=(D?P:_[h]).border,a=D?P.labelPosition:"Near"===_[h].headerAlignment?"TopLeft":"Center"===_[h].headerAlignment?"TopCenter":"TopRight",p=(D?P:_[h]).templatePosition,b=D?P.labelTemplate:_[h].headerTemplate,m.options={border:I,opacity:y,fill:c},d={cancel:!1,name:H,treemap:B.treemap,text:u,currentItem:m,RenderItems:B.renderItems,options:m.options,textColor:S.color},B.treemap.trigger(H,d,function(e){e.cancel||(N=" M "+g.x+" "+g.y+" L "+(g.x+g.width)+" "+g.y+" L "+(g.x+g.width)+" "+(g.y+g.height)+" L "+g.x+" "+(g.y+g.height)+"z",v=new z(f+"_RectPath",c,I.width,I.color,y,null,N),e=w.renderer.drawPath(v),x.appendChild(e),s&&(d.text!==u&&(d.text=ct(d.text,m.data,w.treemap)||t),S.color=d.textColor||S.color,w.renderItemText(d.text.toString(),x,S,g,T,f,c,a,C)),b&&(v=w.renderTemplate(E,f,g,p,b,m,D),A.isNullOrUndefined(v)||(M.appendChild(v),w.treemap.renderReactTemplates())),x.setAttribute("aria-label",m.name),w.treemap.enableDrillDown&&D||w.treemap.selectionSettings.enable||w.treemap.highlightSettings.enable?(x.setAttribute("role","button"),x.setAttribute("tabindex",w.treemap.tabIndex.toString()),x.style.cursor=(!w.treemap.highlightSettings.enable||w.treemap.selectionSettings.enable||!w.treemap.enableDrillDown||m.groupIndex!==w.treemap.levels.length-1)&&(!w.treemap.highlightSettings.enable||w.treemap.selectionSettings.enable||w.treemap.enableDrillDown)?"pointer":"default"):x.setAttribute("role","region"),pt(w.treemap,x,"treeMapSelection"),w.layoutGroup.appendChild(x))})}(t);0<M.childNodes.length&&E.appendChild(M),this.treemap.svgObject.appendChild(this.layoutGroup),pt(this.treemap,this.layoutGroup,"treeMapSelection")},f.prototype.renderItemText=function(e,t,i,l,o,r,n,a,s){var d=[],h=0,p=-1!==e.indexOf("<br>")?e.split("<br>"):null,g=this.labelInterSectAction(l,e,i,o),c=G(p&&p[0]||g[0],i),e=(this.treemap.enableRtl&&(S=G(e,i),v=e.search("[+]")||e.search("[-]"),l.width<S.width)&&0<v&&(S=e.substring(v-1,e.length),v=G("[+]",i),g[0]=V(l.width-v.width-5,g[0],i)+S),qe(l,a,c,"Text",this.treemap));if(!A.isNullOrUndefined(p)){for(var m,u=[],y=[],f=0;f<p.length;f++)h+=(c=G(m=V(l.width-5,p[f],i),i)).height,y.push(c.width),u.push(m);g=u,c.width=Math.max.apply(null,y),c.height=h}if("WrapByWord"===o||"Wrap"===o||"Trim"===o){for(var v,S,x=0;x<g.length;x++)h+=(c=G(g[x],i)).height,l.height-5>h&&d.push(g[x]);"Wrap"===o&&g.length!==d.length&&d.length&&(S=(S=d[v=d.length-1]).substring(0,S.length-1)+"...",d.splice(v),"..."!==S)&&d.push(S)}else a=g,d.push(a);Ue(new T(r+"_Text",e.x,e.y,"start",d,"","",s),i,i.color||this.getSaturatedColor(n),t)},f.prototype.getItemColor=function(e,t){var i=this.treemap,l=(e?i.leafItemSettings:i.levels[t.groupIndex]).fill,o=(e?i.leafItemSettings:i.levels[t.groupIndex]).opacity,r=(A.isNullOrUndefined(i.treemapLevelData.defaultLevelsData)||0<i.treemapLevelData.defaultLevelsData.length&&(i.treemapLevelData.levelsData=i.treemapLevelData.defaultLevelsData),R(i.treemapLevelData.levelsData[0]).values),e=(e?i.leafItemSettings:i.levels[t.groupIndex]).colorMapping;if(0<e.length){e=Ke(e,t.data[i.equalColorValuePath],t.data[i.rangeColorValuePath]);A.isNullOrUndefined(e)||(l=(A.isNullOrUndefined(e.fill)?i.leafItemSettings:e).fill,o=e.opacity)}else for(var n=0;n<r.length;n++)r[n].levelOrderName===t.levelOrderName.split("#")[0]&&(l=A.isNullOrUndefined(l)?A.isNullOrUndefined(i.colorValuePath)?A.isNullOrUndefined(t.options)?!A.isNullOrUndefined(i.palette)&&0<i.palette.length?i.palette[n%i.palette.length]:"#808080":t.options.fill:r[n].data[i.colorValuePath]:l);return{fill:l,opacity:o}},f.prototype.getSaturatedColor=function(e){var t=e,e=ft(y("transparent"===e?window.getComputedStyle(document.body,null).backgroundColor:t));return 128<=Math.round((299*e.r+587*e.g+114*e.b)/1e3)?"black":"white"},f.prototype.renderTemplate=function(e,t,i,l,o,r,n){var a,t=n?t+"_LabelTemplate":t+"_HeaderTemplate",n=n?"_LabelTemplate":"_HeaderTemplate";if(A.isNullOrUndefined(o.prototype)&&"string"==typeof o)for(var s=Object.keys(r.data),d=0;d<s.length;d++){var h=RegExp;o=o.replace(new h("{{:"+s[d]+"}}","g"),r.data[s[d].toString()])}return this.treemap.enableHtmlSanitizer&&"string"==typeof o&&(o=A.SanitizeHtmlHelper.sanitize(o)),A.isNullOrUndefined(document.getElementById(this.treemap.element.id+"_Secondary_Element"))||(i=qe(i,l,Xe(a=Ve(Ge(o)(r.data,this.treemap,o,this.treemap.element.id+n,!1),t,r.data),e),"Template",this.treemap),a.style.left=i.x+"px",a.style.top=i.y+"px"),a},f.prototype.labelInterSectAction=function(e,t,i,l){var o,r=e.width-10;switch(l){case"Hide":o=[dt(r,e.height,t,i)];break;case"Trim":o=[V(3+r,t,i)];break;case"WrapByWord":o=at(r,t,i);break;case"Wrap":o=st(r,t,i)}return o},f.prototype.destroy=function(){this.treemap=null,this.currentRect=null,this.layoutGroup=null,this.renderer=null,this.renderItems=[],this.parentData=[]};var Tt=f;function f(e){this.treemap=e}function Nt(e){var t,i;switch(e.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(e.toLowerCase()){case"bootstrapdark":case"fabricdark":case"materialdark":t={backgroundColor:i,titleFontColor:"#FFFFFF",titleFontWeight:"Normal",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",tooltipFontSize:"13px",legendTitleColor:"#DADADA",legendTextColor:"#DADADA",fontSize:"15px",fontWeight:"Normal",subtitleFontSize:"14px",legendFontSize:"13px",fontFamily:"Roboto, Noto, Sans-serif",labelFontSize:"12px",labelFontFamily:re,legendBorderColor:"#000000",legendBorderWidth:0};break;case"highcontrast":t={backgroundColor:"#000000",titleFontColor:"#FFFFFF",titleFontWeight:"Normal",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",tooltipFontSize:"13px",legendTitleColor:"#FFFFFF",legendTextColor:"#FFFFFF",fontSize:"15px",fontWeight:"Normal",subtitleFontSize:"14px",legendFontSize:"13px",labelFontFamily:re,fontFamily:"Roboto, Noto, Sans-serif",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",titleFontColor:"#212529",titleFontWeight:"Normal",subTitleFontColor:"#212529",tooltipFillColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFontSize:"13px",tooltipFillOpacity:1,tooltipTextOpacity:.9,legendTitleColor:"#212529",legendTextColor:"#212529",fontFamily:"HelveticaNeue-Medium",fontSize:"16px",fontWeight:"Normal",subtitleFontSize:"14px",legendFontSize:"14px",labelFontFamily:"HelveticaNeue",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"tailwind":t={backgroundColor:"transparent",titleFontColor:"#374151",titleFontWeight:"Normal",subTitleFontColor:"#374151",tooltipFillColor:"#111827",tooltipFontColor:"#F9FAFB",tooltipFontSize:"13px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#374151",legendTextColor:"#374151",fontFamily:"Inter",fontSize:"14px",fontWeight:"Normal",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Inter",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"tailwinddark":t={backgroundColor:"transparent",titleFontColor:"#D1D5DB",titleFontWeight:"Normal",subTitleFontColor:"#D1D5DB",tooltipFillColor:"#F9FAFB",tooltipFontColor:"#1F2937",tooltipFontSize:"13px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#D1D5DB",legendTextColor:"#D1D5DB",fontFamily:"Inter",fontWeight:"Normal",fontSize:"14px",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Inter",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"tailwind3":t={backgroundColor:"transparent",titleFontColor:"#111827",titleFontWeight:"600",subTitleFontColor:"#111827",tooltipFillColor:"#111827",tooltipFontColor:"#F9FAFB",tooltipFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#111827",legendTextColor:"#111827",fontFamily:"Inter",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Inter",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"tailwind3dark":t={backgroundColor:"transparent",titleFontColor:"#FFFFFF",titleFontWeight:"600",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#F9FAFB",tooltipFontColor:"#1F2937",tooltipFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#FFFFFF",legendTextColor:"#FFFFFF",fontFamily:"Inter",fontWeight:"400",fontSize:"14px",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Inter",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"bootstrap5":t={backgroundColor:"transparent",titleFontColor:"#212529",titleFontWeight:"400",subTitleFontColor:"#212529",tooltipFillColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFontSize:"12px",tooltipFillOpacity:.9,legendTitleColor:"#212529",legendTextColor:"#212529",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"10px",labelFontFamily:"Segoe UI",labelFontSize:"10px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"bootstrap5dark":t={backgroundColor:"transparent",titleFontColor:"#DEE2E6",titleFontWeight:"400",subTitleFontColor:"#DEE2E6",tooltipFillColor:"#FFFFFF",tooltipFontColor:"#212529",tooltipFontSize:"12px",tooltipFillOpacity:.9,legendTitleColor:"#DEE2E6",legendTextColor:"#DEE2E6",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"10px",labelFontFamily:"Segoe UI",labelFontSize:"10px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"fluent":t={backgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#201F1E",titleFontWeight:"Normal",subTitleFontColor:"#201F1E",tooltipFillColor:"#FFFFFF",tooltipFontColor:"#323130",tooltipFontSize:"13px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#201F1E",legendTextColor:"#201F1E",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"Normal",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Segoe UI",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"fluentdark":t={backgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#F3F2F1",titleFontWeight:"Normal",subTitleFontColor:"#F3F2F1",tooltipFillColor:"#252423",tooltipFontColor:"#F3F2F1",tooltipFontSize:"13px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#F3F2F1",legendTextColor:"#F3F2F1",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"Normal",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Segoe UI",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"material3":t={backgroundColor:"transparent",titleFontColor:"#1C1B1F",titleFontWeight:"500",subTitleFontColor:"#1C1B1F",tooltipFillColor:"#313033",tooltipFontColor:"#F4EFF4",tooltipFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#1C1B1F",legendTextColor:"#49454E",fontFamily:"Roboto",fontSize:"16px",fontWeight:"400",subtitleFontSize:"14px",legendFontSize:"14px",labelFontFamily:"Roboto",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"material3dark":t={backgroundColor:"transparent",titleFontColor:"#E6E1E5",titleFontWeight:"500",subTitleFontColor:"#E6E1E5",tooltipFillColor:"#E6E1E5",tooltipFontColor:"#313033",tooltipFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#E6E1E5",legendTextColor:"#CAC4D0",fontFamily:"Roboto",fontSize:"16px",fontWeight:"400",subtitleFontSize:"14px",legendFontSize:"14px",labelFontFamily:"Roboto",labelFontSize:"12px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"fluent2":t={backgroundColor:"transparent",titleFontColor:"#242424",titleFontWeight:"600",subTitleFontColor:"#242424",tooltipFillColor:"#FFFFFF",tooltipFontColor:"#242424",tooltipFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#242424",legendTextColor:"#242424",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Segoe UI",labelFontSize:"10px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"fluent2dark":t={backgroundColor:"transparent",titleFontColor:"#FFFFFF",titleFontWeight:"600",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#292929",tooltipFontColor:"#FFFFFF",tooltipFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#FFFFFF",legendTextColor:"#FFFFFF",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Segoe UI",labelFontSize:"10px",legendBorderColor:"#000000",legendBorderWidth:0};break;case"fluent2highcontrast":t={backgroundColor:"transparent",titleFontColor:"#FFFFFF",titleFontWeight:"600",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,legendTitleColor:"#FFFFFF",legendTextColor:"#FFFFFF",fontFamily:"Segoe UI",fontSize:"14px",fontWeight:"400",subtitleFontSize:"12px",legendFontSize:"12px",labelFontFamily:"Segoe UI",labelFontSize:"10px",legendBorderColor:"#FFF",legendBorderWidth:1,tooltipBorderColor:"#FFF",tooltipBorderWidth:1};break;default:t={backgroundColor:"#FFFFFF",titleFontColor:"#424242",titleFontWeight:"Normal",subTitleFontColor:"#424242",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",tooltipFontSize:"13px",legendTitleColor:"#353535",legendTextColor:"#353535",fontSize:"15px",fontWeight:"Normal",subtitleFontSize:"14px",legendFontSize:"13px",fontFamily:"Roboto, Noto, Sans-serif",labelFontSize:"12px",labelFontFamily:re,legendBorderColor:"#000000",legendBorderWidth:0}}return t}(e.Theme||(e.Theme={})).mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};_t.prototype.print=function(e,t){var i=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),l=(i.moveTo(0,0),i.resizeTo(screen.availWidth,screen.availHeight),{cancel:!1,htmlContent:this.getHTMLContent(e,t),name:U});e.trigger(U,l,function(){l.cancel||A.print(l.htmlContent,i)})},_t.prototype.getHTMLContent=function(e,t){var i,l,o=A.createElement("div");return t?t instanceof Array?t.forEach(function(e){o.appendChild(ke(e).cloneNode(!0))}):t instanceof Element?o.appendChild(t.cloneNode(!0)):o.appendChild(ke(t).cloneNode(!0)):(l=(t=e.element.cloneNode(!0)).getElementsByTagName("svg")[0],A.isNullOrUndefined(l)||(l=l.childNodes[0],A.isNullOrUndefined(l))||(i=l.getAttribute("fill"),"Tailwind"!==e.theme&&"Tailwind3"!==e.theme&&"Bootstrap5"!==e.theme&&"Fluent"!==e.theme&&"Material3"!==e.theme&&"Fluent2"!==e.theme||"rgba(255,255,255, 0.0)"!==i&&"transparent"!==i?"TailwindDark"!==e.theme&&"Tailwind3Dark"!==e.theme&&"Bootstrap5Dark"!==e.theme&&"FluentDark"!==e.theme&&"Material3Dark"!==e.theme&&"Fluent2Dark"!==e.theme&&"Fluent2HighContrast"!==e.theme||"rgba(255,255,255, 0.0)"!==i&&"transparent"!==i||l.setAttribute("fill","rgba(0, 0, 0, 1)"):l.setAttribute("fill","rgba(255,255,255, 1)")),o.appendChild(t)),o},_t.prototype.getModuleName=function(){return"Print"},_t.prototype.destroy=function(){};var Et=_t;function _t(e){}Dt.prototype.export=function(d,h,p,g){return new Promise(function(e,t){var i,l,o=A.createElement("canvas",{id:"ej2-canvas",attrs:{height:d.availableSize.height.toString(),width:d.availableSize.width.toString()}}),r=d.svgObject.cloneNode(!0),n=r.childNodes[0],a=(A.isNullOrUndefined(n)||(n=n.getAttribute("fill"),"Tailwind"!==d.theme&&"Tailwind3"!==d.theme&&"Bootstrap5"!==d.theme&&"Fluent"!==d.theme&&"Material3"!==d.theme&&"Fluent2"!==d.theme||"rgba(255,255,255, 0.0)"!==n&&"transparent"!==n?"TailwindDark"!==d.theme&&"Tailwind3Dark"!==d.theme&&"Bootstrap5Dark"!==d.theme&&"FluentDark"!==d.theme&&"Material3Dark"!==d.theme&&"Fluent2Dark"!==d.theme&&"Fluent2HighContrast"!==d.theme||"rgba(255,255,255, 0.0)"!==n&&"transparent"!==n||r.childNodes[0].setAttribute("fill","rgba(0, 0, 0, 1)"):r.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)")),!(-1<A.Browser.userAgent.toString().indexOf("HeadlessChrome"))),n='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+r.outerHTML+"</svg>",s=window.URL.createObjectURL(new Blob("SVG"===h?[n]:[(new XMLSerializer).serializeToString(r)],{type:"image/svg+xml"}));"SVG"===h?g?Ot(p,h,s,a):e(null):(i=new Image,l=o.getContext("2d"),i.onload=function(){l.drawImage(i,0,0),window.URL.revokeObjectURL(s),g?Ot(p,h,o.toDataURL("image/png").replace("image/png","image/octet-stream"),a):"JPEG"===h?e(o.toDataURL("image/jpeg")):"PNG"===h&&e(o.toDataURL("image/png"))},i.src=s)})},Dt.prototype.getModuleName=function(){return"ImageExport"},Dt.prototype.destroy=function(){};var Mt=Dt;function Dt(e){}Bt.prototype.export=function(s,e,d,h,p){return new Promise(function(i,e){var l=A.createElement("canvas",{id:"ej2-canvas",attrs:{width:s.availableSize.width.toString(),height:s.availableSize.height.toString()}}),t=(h=A.isNullOrUndefined(h)?w.PdfPageOrientation.Landscape:h,s.svgObject.cloneNode(!0)),o=t.childNodes[0],r=(A.isNullOrUndefined(o)||(o=o.getAttribute("fill"),"Tailwind"!==s.theme&&"Tailwind3"!==s.theme&&"Bootstrap5"!==s.theme&&"Fluent"!==s.theme&&"Material3"!==s.theme&&"Fluent2"!==s.theme||"rgba(255,255,255, 0.0)"!==o&&"transparent"!==o?"TailwindDark"!==s.theme&&"Tailwind3Dark"!==s.theme&&"Bootstrap5Dark"!==s.theme&&"FluentDark"!==s.theme&&"Material3Dark"!==s.theme&&"Fluent2Dark"!==s.theme&&"Fluent2HighContrast"!==s.theme||"rgba(255,255,255, 0.0)"!==o&&"transparent"!==o||t.childNodes[0].setAttribute("fill","rgba(0, 0, 0, 1)"):t.childNodes[0].setAttribute("fill","rgba(255,255,255, 1)")),window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(t)],{type:"image/svg+xml"}))),n=new Image,a=l.getContext("2d");n.onload=function(){a.drawImage(n,0,0),window.URL.revokeObjectURL(r);var e=new w.PdfDocument,t=l.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");e.pageSettings.orientation=h,t=t.slice(t.indexOf(",")+1),e.pages.add().graphics.drawImage(new w.PdfBitmap(t),0,0,s.availableSize.width-60,s.availableSize.height),p?(e.save(d+".pdf"),e.destroy()):i(null)},n.src=r})},Bt.prototype.getModuleName=function(){return"PdfExport"},Bt.prototype.destroy=function(){};var Pt=Bt;function Bt(e){}zt=function(e,t){return(zt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}))(e,t)};var zt,Rt,i=function(e,t){function i(){this.constructor=e}zt(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},v=function(e,t,i,l){var o,r=arguments.length,n=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;0<=a;a--)(o=e[a])&&(n=(r<3?o(n):3<r?o(t,i,n):o(t,i))||n);return 3<r&&n&&Object.defineProperty(t,i,n),n},i=(Rt=A.Component,i(S,Rt),S.prototype.preRender=function(){var e=this;this.trigger(E,{treemap:this},function(){e.initPrivateVariable(),e.unWireEVents(),e.createSvg(),e.wireEVents(),e.setCulture()})},S.prototype.render=function(){this.renderElements()},S.prototype.renderElements=function(){this.treemapLevelData=new Ut,this.treemapLevelData.levelsData=null,this.treemapLevelData.defaultLevelsData=null,this.treemapLevelData.hierarchyData=null,this.createSecondaryElement(),this.addTabIndex(),this.themeStyle=Nt(this.theme),this.renderBorder(),this.renderTitle(this.titleSettings,"title",null,null),A.isNullOrUndefined(this.treemapLevelData.levelsData)||(this.treemapLevelData.defaultLevelsData=this.treemapLevelData.levelsData),this.processDataManager()},S.prototype.processDataManager=function(){var e,t,l=this;this.dataSource instanceof C.DataManager?(e=this.dataSource,t=this.query instanceof C.Query?this.query:new C.Query,e.executeQuery(t).then(function(e){l.dataSource=e.result,l.renderTreeMapElements()})):this.dataSource instanceof bt?(e=this.dataSource,(t=new A.Fetch(e.dataOptions,e.type,e.contentType)).onSuccess=function(e){var t,i;A.isNullOrUndefined(e.type)||"application/octet-stream"!==e.type?(l.dataSource=e,l.renderTreeMapElements()):(t=new FileReader,i=l,t.onload=function(){e=JSON.parse(t.result.toString()),i.dataSource=e,i.renderTreeMapElements()},t.readAsText(e))},t.send(e.sendData)):this.renderTreeMapElements()},S.prototype.renderTreeMapElements=function(){this.processingData(),this.treeMapLegendModule&&this.legendSettings.visible&&this.treeMapLegendModule.renderLegend(),this.layout.processLayoutPanel(),this.element.appendChild(this.svgObject),!A.isNullOrUndefined(this.treeMapLegendModule)&&this.legendSettings.visible&&gt(this,this.treeMapLegendModule.legendGroup),this.elementChange(),this.trigger(_,{treemap:this,isResized:this.isResize}),this.isResize=!1,this.renderComplete()},S.prototype.createSvg=function(){if(this.svgObject){for(;0<this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&A.remove(this.svgObject)}A.isNullOrUndefined(this.renderer)&&(this.renderer=new F.SvgRenderer(this.element.id)),A.isNullOrUndefined(this.layout)&&(this.layout=new Tt(this)),this.clearTemplate();var e=this.element.clientWidth,t=this.element.clientHeight;this.availableSize=new W(Be(this.width,e)||e||600,Be(this.height,t)||t||450),this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height})},S.prototype.initPrivateVariable=function(){var e;""===this.element.id&&(e=document.getElementsByClassName("e-treemap").length,this.element.id="treemap_control_"+e),this.renderer=new F.SvgRenderer(this.element.id),this.layout=new Tt(this)},S.prototype.createSecondaryElement=function(){var e=document.getElementById(this.element.id+"_Secondary_Element");e&&0<e.childElementCount&&e.parentNode.removeChild(e),A.isNullOrUndefined(document.getElementById(this.element.id+"_Secondary_Element"))&&((e=A.createElement("div",{id:this.element.id+"_Secondary_Element"})).style.cssText="position: absolute;z-index:1;",this.element.appendChild(e))},S.prototype.elementChange=function(){this.treeMapLegendModule&&this.legendSettings.visible&&this.treeMapLegendModule.legendGroup&&this.layout.layoutGroup&&!A.isNullOrUndefined(this.svgObject)&&!A.isNullOrUndefined(document.getElementById(this.layout.layoutGroup.id))&&!A.isNullOrUndefined(document.getElementById(this.treeMapLegendModule.legendGroup.id))&&this.svgObject.insertBefore(this.layout.layoutGroup,this.treeMapLegendModule.legendGroup)},S.prototype.renderBorder=function(){var e=this.border.width,t=this.svgObject.querySelector("#"+this.element.id+"_TreeMap_Border");(0<this.border.width||this.background||this.themeStyle.backgroundColor)&&A.isNullOrUndefined(t)?(e=new L(this.element.id+"_TreeMap_Border",this.background||this.themeStyle.backgroundColor,this.border,1,new j(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e)),this.svgObject.appendChild(this.renderer.drawRectangle(e))):t&&t.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},S.prototype.renderTitle=function(e,t,i,l){var o,r,n,a,s={color:e.textStyle.color,size:e.textStyle.size,fontFamily:e.textStyle.fontFamily,fontStyle:e.textStyle.fontStyle,fontWeight:e.textStyle.fontWeight,opacity:e.textStyle.opacity},d=this.availableSize.width-this.margin.right-this.margin.left;s.fontFamily=s.fontFamily||this.themeStyle.fontFamily,s.fontWeight=s.fontWeight||this.themeStyle.titleFontWeight,s.size=s.size||("title"===t?this.themeStyle.fontSize:this.themeStyle.subtitleFontSize),e.text?(A.isNullOrUndefined(l)&&(l=this.renderer.createGroup({id:this.element.id+"_Title_Group"})),a=G(n=V(d,r=this.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(e.text):e.text,s),s),i=ze(A.isNullOrUndefined(i)?new j(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height):i,e.alignment,a,t),n=new T(this.element.id+"_TreeMap_"+t,i.x,i.y,"start",n),i=new j(i.x,i.y,a.width,a.height),(a=Ue(n,s,s.color||("title"===t?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),l)).setAttribute("aria-label",e.description||r),a.setAttribute("role","region"),a.setAttribute("tabindex",this.tabIndex.toString()),("title"!==t||e.subtitleSettings.text)&&"subtitle"!==t||(o=this.availableSize.height-i.y-10-this.margin.bottom,this.areaRect=new j(this.margin.left,i.y+10,d,o)),"subtitle"!==t&&e.subtitleSettings.text?this.renderTitle(e.subtitleSettings,"subtitle",i,l):this.svgObject.appendChild(l)):(o=this.availableSize.height-this.margin.top-this.margin.bottom,this.areaRect=new j(this.margin.left,this.margin.top,d,o))},S.prototype.processingData=function(){var t=this;if(this.dataSource=this.dataSource,!A.isNullOrUndefined(this.dataSource)&&0<this.dataSource.length&&this.weightValuePath){if(this.treemapLevelData.levelsData=[],this.dataSource.map(function(e){e[t.weightValuePath]=e[t.weightValuePath]&&e[t.weightValuePath].toString()}),this.leafItemSettings.labelPath=this.leafItemSettings.labelPath||this.weightValuePath,this.checkIsHierarchicalData(),0===this.levels.length){var i={level:0},l=this.leafItemSettings.labelPath;i[l]=[];for(var e=0;e<this.dataSource.length;e++){var o=R(this.dataSource[e]).values;this.isHierarchicalData&&o&&0<o.length?o.forEach(function(e){e[l]&&i[l].push({groupIndex:0,name:e[l],levelOrderName:e[l].toString(),data:e,weight:e[t.weightValuePath]})}):this.dataSource[e][l]&&i[l].push({groupIndex:0,name:this.dataSource[e][l],levelOrderName:this.dataSource[e][l].toString(),data:this.dataSource[e],weight:this.dataSource[e][this.weightValuePath]})}this.treemapLevelData.levelsData.push(i)}else{if(this.isHierarchicalData){this.treemapLevelData.hierarchyData=[],this.treemapLevelData.hierarchyData=A.extend([],this.dataSource,this.treemapLevelData.hierarchyData,!0);for(e=0;e<this.treemapLevelData.hierarchyData.length;e++)this.processHierarchicalData(this.treemapLevelData.hierarchyData[e],e);this.treemapLevelData.levelsData=this.treemapLevelData.hierarchyData}else this.processFlatJsonData(),1<this.treemapLevelData.levelsData.length&&this.reOrderLevelData(this.treemapLevelData.levelsData.length-1);l=this.levels[0].groupPath}this.isHierarchicalData||this.findTotalWeight(this.treemapLevelData.levelsData[0][l],"Parent")}},S.prototype.checkIsHierarchicalData=function(){var e;this.dataSource=this.dataSource;for(var t=0;t<this.dataSource.length;t++){if((e=R(this.dataSource[t]).values)&&e.length){this.isHierarchicalData=!0;break}t===this.dataSource.length-1&&(this.isHierarchicalData=!1)}},S.prototype.processHierarchicalData=function(e,t){var i,l=this,o={},r=this.leafItemSettings.labelPath||this.weightValuePath,n=(o=R(e))?o.values:null;if(n&&0<n.length){for(var a=o.key,s=0;s<this.levels.length;s++)a===this.levels[s].groupPath&&(i=s);for(var d=0;d<n.length;d++){n[d].name=n[d][r],n[d].levelOrderName=(0===i?n[d].name:e.levelOrderName+"#"+n[d].name)+"";var h=n[d].levelOrderName,p=void 0;0<h.search("#")&&(p=h.split("#").length-1),n[d].groupIndex=A.isNullOrUndefined(i)?p===this.levels.length?this.levels.length:p:i,0!==i&&(n[d].parent=e),n[d].groupName=a,n[d].data=n[d],n[d].isDrilled=!1,n[d].weight=n[d][this.weightValuePath]}n.forEach(function(e){l.processHierarchicalData(e,t)})}if(t===this.treemapLevelData.hierarchyData.length-1){var g=this.treemapLevelData.hierarchyData[0][this.levels[0].groupPath];if(!A.isNullOrUndefined(g)){for(var c=0;c<this.treemapLevelData.hierarchyData.length;c++)n=R(this.treemapLevelData.hierarchyData[c]).values,0!==c&&n&&(n.forEach(function(e){g.push(e)}),this.treemapLevelData.hierarchyData.splice(c,1),--c);for(var g=this.treemapLevelData.hierarchyData[0][this.levels[0].groupPath],m=0;m<g.length;m++)(o[this.levels[0].groupPath]=g)[m].parent=o}}},S.prototype.print=function(e){this.allowPrint&&this.printModule&&this.printModule.print(this,e)},S.prototype.export=function(i,l,o,r){var n=this;return A.isNullOrUndefined(r)&&(r=!0),"PDF"===i&&this.allowPdfExport&&this.pdfExportModule?new Promise(function(e,t){e(n.pdfExportModule.export(n,i,l,o,r))}):this.allowImageExport&&"PDF"!==i&&this.imageExportModule?new Promise(function(e,t){e(n.imageExportModule.export(n,i,l,r))}):null},S.prototype.processFlatJsonData=function(){this.dataSource=this.dataSource;for(var e=[],t=0;t<this.levels.length+1;t++){var i=this.levels[t]?this.levels[t].groupPath:this.leafItemSettings.labelPath,l={};l.level=t,l[i]=[],this.treemapLevelData.levelsData.push(l);for(var o=0;o<this.dataSource.length;o++){var r={},n="";if(!A.isNullOrUndefined(i)){var a=this.dataSource[o][i];if(0!==t)for(var s=0;s<=t;s++){var d=this.levels[s]?this.levels[s].groupPath:i;n+=this.dataSource[o][d]+(s===t?"":"#")}0<e.length&&-1!==e.indexOf(n||a)||(r.name=a,r.levelOrderName=(n||a)+"",r.groupIndex=t,r.isDrilled=!1,r.groupName=i,r.data=this.dataSource[o],this.treemapLevelData.levelsData[this.treemapLevelData.levelsData.length-1][i].push(r),e.push(n||a))}}}},S.prototype.reOrderLevelData=function(e){for(var t=this.levels[e]?this.levels[e].groupPath:this.leafItemSettings.labelPath,i=this.levels[e-1].groupPath,l=this.treemapLevelData.levelsData[e][t],o=this.treemapLevelData.levelsData[e-1][i],r=0;r<l.length;r++)for(var n=l[r].levelOrderName,a=0;a<o.length;a++)if(o[a][t]=A.isNullOrUndefined(o[a][t])?[]:o[a][t],this.IsChildHierarchy(n.split("#"),o[a].levelOrderName.split("#"))){A.isNullOrUndefined(l[r].parent)&&(l[r].parent=o[a]),o[a][t].push(l[r]);break}this.findTotalWeight(this.treemapLevelData.levelsData[this.treemapLevelData.levelsData.length-1][t],"Child"),this.treemapLevelData.levelsData.splice(e,1),0<e-1&&this.reOrderLevelData(e-1)},S.prototype.IsChildHierarchy=function(e,t){for(var i=!1,l=0;l<t.length;l++){if(e.length<l||t[l]!==e[l])return!1;i=!0}return i},S.prototype.findTotalWeight=function(i,e){for(var l,o,r,n=this,a={},s=this,t=0;t<i.length;t++)!function(t){l=0,r=i[t].groupName,o=i[t].levelOrderName.split("#"),s.dataSource.forEach(function(e){We(o,i[t].levelOrderName,e,n)&&(l+=parseFloat(e[n.weightValuePath]))}),"Parent"===e&&((a[r]=i)[t].parent=a),i[t].weight=l}(t)},S.prototype.unWireEVents=function(){A.EventHandler.remove(this.element,"click",this.clickOnTreeMap),A.EventHandler.remove(this.element,"dblclick",this.doubleClickOnTreeMap),A.EventHandler.remove(this.element,"contextmenu",this.rightClickOnTreeMap),A.EventHandler.remove(this.element,A.Browser.touchStartEvent,this.mouseDownOnTreeMap),A.EventHandler.remove(this.element,A.Browser.touchMoveEvent,this.mouseMoveOnTreeMap),A.EventHandler.remove(this.element,A.Browser.touchEndEvent,this.mouseEndOnTreeMap),A.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnTreeMap),window.removeEventListener("resize",this.resizeEvent)},S.prototype.wireEVents=function(){A.EventHandler.add(this.element,"click",this.clickOnTreeMap,this),A.EventHandler.add(this.element,"dblclick",this.doubleClickOnTreeMap,this),A.EventHandler.add(this.element,"contextmenu",this.rightClickOnTreeMap,this),A.EventHandler.add(this.element,A.Browser.touchStartEvent,this.mouseDownOnTreeMap,this),A.EventHandler.add(this.element,A.Browser.touchMoveEvent,this.mouseMoveOnTreeMap,this),A.EventHandler.add(this.element,A.Browser.touchEndEvent,this.mouseEndOnTreeMap,this),A.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnTreeMap,this),this.resizeEvent=this.resizeOnTreeMap.bind(this),window.addEventListener("resize",this.resizeEvent)},S.prototype.setCulture=function(){this.intl=new A.Internationalization},S.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"TreeMap Element"),this.element.setAttribute("role","region"),this.element.setAttribute("tabindex",this.tabIndex.toString())},S.prototype.resizeOnTreeMap=function(e){var t,i=this;this.isDestroyed||(this.isResize=!0,t={name:oe,cancel:!1,previousSize:this.availableSize,currentSize:new W(0,0),treemap:this},this.resizeTo&&clearTimeout(this.resizeTo),!A.isNullOrUndefined(this.element)&&this.element.classList.contains("e-treemap")&&(this.resizeTo=setTimeout(function(){i.unWireEVents(),i.createSvg(),i.refreshing=!0,i.wireEVents(),t.currentSize=i.availableSize,i.trigger(oe,t,function(e){i.render(),i.refreshing=!1})},500)))},S.prototype.clickOnTreeMap=function(e){var t,i=this,l=e.target,o=l.id,r=l.innerHTML,n=(this.trigger($,{cancel:!1,name:$,treemap:this,mouseEvent:e}),-1<o.indexOf("_Item_Index")&&(e.preventDefault(),n=parseFloat(o.split("_Item_Index_")[1]),n={cancel:!1,name:Z,treemap:this,item:this.layout.renderItems[n],mouseEvent:e,groupIndex:this.layout.renderItems[n].groupIndex,groupName:this.layout.renderItems[n].name,text:r,contentItemTemplate:r},this.trigger(Z,n,function(e){e.text===r&&e.contentItemTemplate===r||(A.isNullOrUndefined(i.leafItemSettings.labelTemplate)?(e.text=ct(e.text,e.item.data,e.treemap),l.textContent=e.text):He(o,l,e.contentItemTemplate))})),(new Date).getMilliseconds());A.isNullOrUndefined(this.doubleClick)||!A.isNullOrUndefined(t)&&n-t<500&&this.doubleClickOnTreeMap(e)},S.prototype.doubleClickOnTreeMap=function(e){this.trigger(K,{cancel:!1,name:K,treemap:this,mouseEvent:e})},S.prototype.rightClickOnTreeMap=function(e){this.trigger(ee,{cancel:!1,name:ee,treemap:this,mouseEvent:e})},S.prototype.mouseDownOnTreeMap=function(e){-1<e.target.id.indexOf("_Item_Index")&&(this.mouseDown=!0),this.notify(A.Browser.touchStartEvent,e)},S.prototype.mouseMoveOnTreeMap=function(e){var t,i=e.target.id;this.trigger(te,{cancel:!1,name:te,treemap:this,mouseEvent:e}),-1<i.indexOf("_Item_Index")?(t=R(i=this.layout.renderItems[parseFloat(i.split("_Item_Index_")[1])]).values,this.element.style.cursor=!i.isLeafItem&&t&&0<t.length&&this.enableDrillDown?"pointer":"auto",this.trigger(Q,{cancel:!1,name:Q,treemap:this,item:i,mouseEvent:e})):this.element.style.cursor="default",this.notify(A.Browser.touchMoveEvent,e)},S.prototype.calculateSelectedTextLevels=function(e,t){for(var i,l,o,r=t.levelOrderName.split("#"),n=0,a=Object.keys(r);n<a.length;n++)r[l=a[n]]===e&&(i=parseInt(l,10),o=e);return{drillLevel:i,currentLevelLabel:o,levelText:r}},S.prototype.calculatePreviousLevelChildItems=function(e,t,i){for(var l,o,r=0,n=this.layout.renderItems[0].levelOrderName.split("#").length,a=0;a<n;a++)o=0===a?e.levelText[a]:o+"#"+e.levelText[a];for(var s,r=1<n?n:r,d=0,h=Object.values(this.layout.renderItems);d<h.length;d++)(s=h[d]).levelOrderName.split("#")[0]===e.levelText[0]&&(l=0===r?A.isNullOrUndefined(o)?o:e.levelText[r]:i?o:o+"#"+e.levelText[r])===s.levelOrderName&&(this.drilledItems.push({name:s.levelOrderName,data:s}),i=!0,++r<=t.groupIndex)&&(o=l+"#"+e.levelText[r]);return i},S.prototype.compareSelectedLabelWithDrillDownItems=function(e,t,i){var l,o={};return e.drillLevel+1===this.drilledItems[i].data.groupIndex?((l=this.drilledItems[i].data.parent).isDrilled=!0,o[l[this.drilledItems[i].data.groupName]]=[l],this.drilledItems.splice(i,this.drilledItems.length)):e.drillLevel!==this.drilledItems.length-1&&e.drillLevel!==t.groupIndex||(o[t.groupName]=[t]),o},S.prototype.mouseEndOnTreeMap=function(e){var i,l,t,o=this,r=e.target,n=r.id,a=!1,s={},d=this.element.id+"_TreeMap_"+this.layoutType+"_Layout",h=this.element.id+"_Label_Template_Group";if(-1<n.indexOf("_Item_Index")&&this.enableDrillDown&&!this.drillMouseMove){e.cancelable&&e.preventDefault(),n=parseFloat(n.split("_Item_Index_")[1]),p=this.layout.renderItems[n];var n=r.textContent;if(this.enableBreadcrumb&&(t=this.calculateSelectedTextLevels(n,p),l=t.drillLevel,this.drillDownView||-1===n.search("[+]")||(a=this.calculatePreviousLevelChildItems(t,p,a))),0!==this.levels.length&&!p.isLeafItem&&R(p).values&&0<R(p).values.length){if(0<this.drilledItems.length)for(var p=a?this.drilledItems[this.drilledItems.length-1].data:p,g=0;g<this.drilledItems.length;g++){if(!A.isNullOrUndefined(l)){var c=this.drilledItems.length,s=this.compareSelectedLabelWithDrillDownItems(t,p,g);if(c!==this.drilledItems.length){--g;break}}if(p.levelOrderName===this.drilledItems[g].name&&!a&&A.isNullOrUndefined(l)){0===p.groupIndex&&p.parent[p.groupName]instanceof Array?(p.isDrilled=!p.isDrilled,p.isDrilled?s[p.groupName]=[p]:s=p.parent):(p.isDrilled=!1,p.parent.isDrilled=!0,p=p.parent,s[p.groupName]=[p]),this.drilledItems.splice(g,1),--g;break}g===this.drilledItems.length-1&&A.isNullOrUndefined(l)&&(p.isDrilled=!0,s[p.groupName]=[p])}else p.isDrilled=!0,s[p.groupName]=[p];n={cancel:!1,name:k,treemap:this,element:r,groupIndex:(this.enableBreadcrumb&&0!==this.drilledItems.length&&!A.isNullOrUndefined(l)?this.drilledItems[this.drilledItems.length-1].data:p).groupIndex,groupName:(this.enableBreadcrumb&&0!==this.drilledItems.length&&!A.isNullOrUndefined(l)?this.drilledItems[this.drilledItems.length-1].data:p).name,rightClick:3===e.which,childItems:null,item:s},this.trigger(k,n,function(e){var t;o.currentLevel=p.isDrilled&&A.isNullOrUndefined(l)?p.groupIndex:!A.isNullOrUndefined(l)&&o.enableBreadcrumb&&p.isDrilled?l:null,e.cancel||(document.getElementById(d)&&(t=document.getElementById(d)).parentNode.removeChild(t),i=A.extend({},o.areaRect,i,!0),o.legendSettings.visible&&!A.isNullOrUndefined(o.treeMapLegendModule)&&(A.isNullOrUndefined(s)||(o.treeMapLegendModule.legendGroup.textContent="",o.treeMapLegendModule.legendGroup=null,o.treeMapLegendModule.widthIncrement=0,o.treeMapLegendModule.heightIncrement=0,o.enableBreadcrumb&&!A.isNullOrUndefined(l)?o.drilledLegendItems={name:o.drilledItems[o.drilledItems.length-1].data.levelOrderName,data:o.drilledItems[o.drilledItems.length-1].data}:o.drilledLegendItems={name:p.levelOrderName,data:p},o.treeMapLegendModule.renderLegend()),i=A.isNullOrUndefined(o.totalRect)?i:o.totalRect),document.getElementById(h)&&(t=document.getElementById(h)).parentNode.removeChild(t),A.isNullOrUndefined(e.childItems)||e.cancel?(o.layout.calculateLayoutItems(s,i),o.layout.renderLayoutItems()):o.layout.onDemandProcess(e.childItems))}),r={cancel:!1,name:q,treemap:this,renderItems:this.layout.renderItems},this.trigger(q,r),!a&&A.isNullOrUndefined(l)&&this.drilledItems.push({name:p.levelOrderName,data:p})}}this.mouseDown=!1,this.notify(A.Browser.touchEndEvent,e)},S.prototype.mouseLeaveOnTreeMap=function(e){this.treeMapTooltipModule&&this.treeMapTooltipModule.removeTooltip(),this.treeMapLegendModule&&this.treeMapLegendModule.removeInteractivePointer(),M(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",this),this.treeMapHighlightModule&&(P(this.treeMapHighlightModule.shapeHighlightCollection,this),this.treeMapHighlightModule.highLightId="")},S.prototype.selectItem=function(e,t){A.isNullOrUndefined(t)&&(t=!0);for(var i="",l=0;l<e.length;l++)l!==e.length-1?i+=e[l]+"#":i+=e[l];this.treeMapSelectionModule&&this.selectionSettings.enable&&this.treeMapSelectionModule.selectTreemapItem(i,t)},S.prototype.requiredModules=function(){var e=[];return this.tooltipSettings.visible&&e.push({member:"treeMapTooltip",args:[this],name:"TreeMapTooltip"}),this.highlightSettings.enable&&e.push({member:"treeMapHighlight",args:[this],name:"TreeMapHighlight"}),this.selectionSettings.enable&&e.push({member:"treeMapSelection",args:[this],name:"TreeMapSelection"}),this.legendSettings.visible&&e.push({member:"treeMapLegend",args:[this],name:"TreeMapLegend"}),this.allowPrint&&e.push({member:"Print",args:[this,Et],name:"Print"}),this.allowImageExport&&e.push({member:"ImageExport",args:[this,Mt],name:"ImageExport"}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this,Pt],name:"PdfExport"}),e},S.prototype.onPropertyChanged=function(e,t){if(!this.isDestroyed){for(var i=!1,l=0,o=Object.keys(e);l<o.length;l++)switch(o[l]){case"background":this.renderBorder();break;case"height":case"width":case"layoutType":case"levels":case"drillDownView":case"renderDirection":case"leafItemSettings":case"legendSettings":case"dataSource":i=!0}i&&(this.createSvg(),this.renderElements())}},S.prototype.getModuleName=function(){return"treemap"},S.prototype.destroy=function(){this.unWireEVents(),Lt("treeMapMeasureText"),this.drilledItems=[],this.levelSelection=[],this.legendId=[],this.removeSvg(),Rt.prototype.destroy.call(this),this.areaRect=null,this.themeStyle=null,this.totalRect=null,this.drilledLegendItems=null,this.doubleTapTimer=null,this.treemapLevelData=null,this.resizeEvent=null,this.availableSize=null,this.intl=null,A.isNullOrUndefined(this.layout)||this.layout.destroy(),this.layout=null,this.renderer=null},S.prototype.removeSvg=function(){if(Lt(this.element.id+"_Secondary_Element"),this.svgObject){for(;0<this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&A.remove(this.svgObject)}},v([A.Property(!(S.prototype.getPersistData=function(){return""}))],S.prototype,"allowPrint",void 0),v([A.Property(!1)],S.prototype,"allowImageExport",void 0),v([A.Property(!1)],S.prototype,"allowPdfExport",void 0),v([A.Property(null)],S.prototype,"width",void 0),v([A.Property(null)],S.prototype,"height",void 0),v([A.Complex({},l)],S.prototype,"border",void 0),v([A.Complex({},se)],S.prototype,"margin",void 0),v([A.Property(null)],S.prototype,"background",void 0),v([A.Property("Material")],S.prototype,"theme",void 0),v([A.Complex({},fe)],S.prototype,"titleSettings",void 0),v([A.Property("Squarified")],S.prototype,"layoutType",void 0),v([A.Property(null)],S.prototype,"dataSource",void 0),v([A.Property(null)],S.prototype,"query",void 0),v([A.Property(null)],S.prototype,"weightValuePath",void 0),v([A.Property("")],S.prototype,"rangeColorValuePath",void 0),v([A.Property("")],S.prototype,"equalColorValuePath",void 0),v([A.Property(null)],S.prototype,"colorValuePath",void 0),v([A.Property([])],S.prototype,"palette",void 0),v([A.Property("TopLeftBottomRight")],S.prototype,"renderDirection",void 0),v([A.Property(!1)],S.prototype,"enableDrillDown",void 0),v([A.Property(!1)],S.prototype,"enableBreadcrumb",void 0),v([A.Property(" - ")],S.prototype,"breadcrumbConnector",void 0),v([A.Property(!1)],S.prototype,"drillDownView",void 0),v([A.Property(!1)],S.prototype,"enableHtmlSanitizer",void 0),v([A.Complex({},Ce)],S.prototype,"initialDrillDown",void 0),v([A.Complex({},Le)],S.prototype,"leafItemSettings",void 0),v([A.Collection([],t)],S.prototype,"levels",void 0),v([A.Complex({},De)],S.prototype,"highlightSettings",void 0),v([A.Complex({},_e)],S.prototype,"selectionSettings",void 0),v([A.Complex({},Ne)],S.prototype,"tooltipSettings",void 0),v([A.Complex({},Ie)],S.prototype,"legendSettings",void 0),v([A.Property(!1)],S.prototype,"useGroupingSeparator",void 0),v([A.Property(null)],S.prototype,"description",void 0),v([A.Property(0)],S.prototype,"tabIndex",void 0),v([A.Property(null)],S.prototype,"format",void 0),v([A.Event()],S.prototype,"load",void 0),v([A.Event()],S.prototype,"beforePrint",void 0),v([A.Event()],S.prototype,"loaded",void 0),v([A.Event()],S.prototype,"itemRendering",void 0),v([A.Event()],S.prototype,"drillStart",void 0),v([A.Event()],S.prototype,"drillEnd",void 0),v([A.Event()],S.prototype,"itemSelected",void 0),v([A.Event()],S.prototype,"itemHighlight",void 0),v([A.Event()],S.prototype,"tooltipRendering",void 0),v([A.Event()],S.prototype,"itemClick",void 0),v([A.Event()],S.prototype,"itemMove",void 0),v([A.Event()],S.prototype,"click",void 0),v([A.Event()],S.prototype,"doubleClick",void 0),v([A.Event()],S.prototype,"rightClick",void 0),v([A.Event()],S.prototype,"mouseMove",void 0),v([A.Event()],S.prototype,"resize",void 0),v([A.Event()],S.prototype,"legendItemRendering",void 0),v([A.Event()],S.prototype,"legendRendering",void 0),v([A.NotifyPropertyChanges],S));function S(e,t){e=Rt.call(this,e,t)||this;return e.isResize=!1,e.orientation="Horizontal",e.drilledItems=[],e.isHierarchicalData=!1,e.levelSelection=[],e.legendId=[],e}var Ut=function(){},v=(x.prototype.renderLegend=function(){var t=this,e=(this.page=0,this.legendRenderingCollections=[],this.legendCollections=[],this.legendNames=[],this.totalPages=[],this.gradientCount=1,this.widthIncrement=0,this.heightIncrement=0,this.defsElement=this.treemap.renderer.createDefs(),this.treemap.svgObject.appendChild(this.defsElement),{cancel:!1,name:le,treemap:this.treemap,_changePosition:this.treemap.legendSettings.position,position:this.treemap.legendSettings.position});this.treemap.trigger(le,e,function(e){e.cancel||e._changePosition===t.treemap.legendSettings.position||(t.treemap.legendSettings.position=e._changePosition),t.calculateLegendBounds(),0<t.legendCollections.length&&t.drawLegend()})},x.prototype.calculateLegendBounds=function(){var i=this,e=this.treemap,t=e.legendSettings;if(this.findColorMappingLegendItems(e.treemapLevelData.levelsData[0]),(!A.isNullOrUndefined(this.treemap.palette)&&0<this.treemap.palette.length||!A.isNullOrUndefined(e.colorValuePath))&&0===this.legendCollections.length&&this.findPaletteLegendItems(e.treemapLevelData.levelsData[0]),0<this.legendCollections.length){this.legendCollections.sort(function(e,t){return e.levelIndex>t.levelIndex?1:e.levelIndex<t.levelIndex?-1:0}),this.legendCollections.sort(function(e,t){return e.groupIndex>t.groupIndex?1:e.groupIndex<t.groupIndex?-1:0}),this.legendCollections.sort(function(e,t){return e.leafIndex>t.leafIndex?1:e.leafIndex<t.leafIndex?-1:0});var l=t.position,z=e.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(t.title.text):t.title.text,o=t.titleStyle,R=t.mode,r=0,n=0,a=0,s=0,d=t.shapeHeight,h=t.shapeWidth,p=[],g=[],c="None"===t.orientation?"Top"===l||"Bottom"===l||"Auto"===l&&e.availableSize.width<=e.availableSize.height?"Horizontal":"Vertical":t.orientation,m=1<t.width.length?-1<t.width.indexOf("%")?e.availableSize.width/100*parseFloat(t.width):parseFloat(t.width):null,u=1<t.height.length?-1<t.height.indexOf("%")?e.availableSize.height/100*parseFloat(t.height):parseFloat(t.height):null,U=(o.fontFamily=o.fontFamily||e.themeStyle.fontFamily,o.fontWeight=o.fontWeight||e.themeStyle.titleFontWeight,o.size=o.size||e.themeStyle.subtitleFontSize,G(z,o)),y=0,f=0,v=t.shapePadding,S=t.textStyle;if(S.size=S.size||e.themeStyle.legendFontSize,S.fontFamily=S.fontFamily||e.themeStyle.fontFamily,S.fontWeight=S.fontWeight||e.themeStyle.fontWeight,"Default"===R){for(var m=A.isNullOrUndefined(m)?e.areaRect.width:m,u=A.isNullOrUndefined(u)?e.areaRect.height:u,x=0,b=0;b<this.legendCollections.length;b++){var I,F,C,w=this.legendCollections[b],O=(A.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]}),G(e.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(w.legendName):w.legendName,S));this.textMaxWidth=Math.max(this.textMaxWidth,O.width),0===b?(y=r=10+h/2,f=n=10+U.height+(d>O.height?d/2:O.height/4)):(I=O.height>d?O.height:d,"Horizontal"===c?n=(C=g[x-1].x+g[x-1].width+10+h)+v+O.width>m?u<(F=(g[x-1].y>p[x-1].y+d/2?g[x-1].y:p[x-1].y+d/2)+10)+I?(this.getPageChanged(),x=0,p=[],g=[],r=y,f):(r=p[0].x,F+I/2):(r=C-h/2,p[x-1].y):u<(F=g[x-1].y>p[x-1].y+d/2?g[x-1].y:p[x-1].y+d/2)+10+I?(C=g[x-1].x+this.textMaxWidth+10)+v+O.width>m?(r=y,n=f,g=[],p=[],this.getPageChanged(),x=0):(r=C+h/2,n=p[0].y):(r=p[x-1].x,n=F+10+d/2)),a=r+h/2+v,s=n+O.height/4,p.push({x:r,y:n}),g.push({x:a,y:s,width:O.width,height:O.height/2}),this.totalPages[this.page].Collection.push({DisplayText:w.legendName,element:w.gradientElement,Shape:{x:r,y:n},Text:{x:a,y:s},Fill:w.legendFill,Data:w.legendData,Rect:{x:p[x].x-h/2,y:p[x].y-d/2<s-O.height?p[x].y-d/2:s-O.height,width:Math.abs(p[x].x-h/2-(a+O.width)),height:d>O.height?d:O.height}}),x++}l=this.totalPages[0].Collection;l.forEach(function(e,t){e=new j(e.Rect.x,e.Rect.y,e.Rect.width,e.Rect.height);0===t&&(y=e.x,f=e.y),i.widthIncrement=Math.max(i.widthIncrement,Math.abs(y-(e.x+e.width))),i.heightIncrement=Math.max(i.heightIncrement,Math.abs(f-(e.y+e.height)))}),m=this.widthIncrement<m?this.widthIncrement:m,u=this.heightIncrement<u?this.heightIncrement:u,this.legendItemRect={x:l[0].Rect.x,y:l[0].Rect.y,width:m,height:u}}else{for(var L=this.legendCollections.length,T="Horizontal"===c?A.isNullOrUndefined(m)?e.areaRect.width/L:m/L:A.isNullOrUndefined(m)?25:m,N="Horizontal"===c?A.isNullOrUndefined(u)?25:u:A.isNullOrUndefined(u)?e.areaRect.height/L:u/L,E=(y=0,f=U.height+10,t.labelPosition),_=0,M=0,H=t.labelDisplayMode,D=0,k=0,b=0;b<this.legendCollections.length;b++){var y="Horizontal"===c?y+T:y,f="Horizontal"===c?f:f+N,P=this.legendCollections[b].legendName,B=new W(0,0);"None"===H?B=G(P,S):"Trim"===H?B=G(P=V("Horizontal"===c?T:N,P,S),S):P="",D=Math.max(D,B.height),k=Math.max(k,B.width),0<B.width&&0<B.height&&(s="Horizontal"===c?(a=y+T/2,"After"===E?f+N+B.height/2+10:f-10):(a="After"===E?y-B.width/2-10:y+T+B.width/2+10,f+N/2+B.height/4)),0===b&&(_="Horizontal"!==c&&"After"===E?a-B.width/2:y,M="Horizontal"!==c||"After"===E?f:s-B.height/2),b===L-1&&(m="Horizontal"===c?Math.abs(y+T-_):T+k+10,u="Horizontal"===c?N+D/2+10:Math.abs(f+N-M)),this.legendRenderingCollections.push({fill:this.legendCollections[b].legendFill,x:y,y:f,width:T,height:N,element:this.legendCollections[b].gradientElement,text:P,textX:a,textY:s,textWidth:B.width,textHeight:B.height,data:this.legendCollections[b].legendData})}this.legendItemRect={x:_,y:M,width:m,height:u}}}},x.prototype.getPageChanged=function(){this.page++,A.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},x.prototype.findColorMappingLegendItems=function(e){var t=R(e).values;if(t&&0<t.length&&(this.calculateLegendItems(t),0<this.treemap.levels.length))for(var i=0;i<t.length;i++)this.findColorMappingLegendItems(t[i])},x.prototype.findPaletteLegendItems=function(e){var t,i;if(!A.isNullOrUndefined(this.treemap.drilledItems)&&0===this.treemap.drilledItems.length&&!A.isNullOrUndefined(this.treemap.initialDrillDown.groupName)&&A.isNullOrUndefined(this.treemap.drilledLegendItems))for(var l=R(e).values,o=0;o<l.length;o++)if(l[o].Name===this.treemap.initialDrillDown.groupName){l[o].isDrilled=!l[o].isDrilled,e=l[o],this.treemap.currentLevel=this.treemap.initialDrillDown.groupIndex,t=0<this.treemap.palette.length?this.treemap.palette[o%this.treemap.palette.length]:l[o].data[this.treemap.colorValuePath];break}if(this.treemap.enableDrillDown&&!A.isNullOrUndefined(this.treemap.drilledLegendItems)){var r,n=this.treemap.drilledLegendItems;if(A.isNullOrUndefined(n.data.options))for(o=0;o<n.length;o++){t=0<this.treemap.palette.length?this.treemap.palette[o%this.treemap.palette.length]:n[o].data[this.treemap.colorValuePath];break}else t=n.data.options.fill;r=(n.data.isDrilled?R(n.data):R(n.data.parent)).values}else r=R(e).values;if(r&&0<r.length){for(var a=0;a<r.length;a++)!A.isNullOrUndefined(r[a].data[this.treemap.legendSettings.showLegendPath])&&!r[a].data[this.treemap.legendSettings.showLegendPath]||(i=r[a].data[this.treemap.legendSettings.valuePath]||r[a].name,!!this.treemap.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollections,i))||this.legendCollections.push({legendName:i,legendFill:0<this.treemap.palette.length?A.isNullOrUndefined(this.treemap.currentLevel)?this.treemap.palette[a%this.treemap.palette.length]:t:r[a].data[this.treemap.colorValuePath],legendData:[],itemArea:r[a].weight,levelOrderName:r[a].levelOrderName});if(this.legendCollections.sort(ht),0<this.treemap.palette.length)for(var s=0;s<this.legendCollections.length;s++)this.legendCollections[s].legendFill=A.isNullOrUndefined(this.treemap.currentLevel)?this.treemap.palette[s%this.treemap.palette.length]:t}},x.prototype.calculateLegendItems=function(e){var t,i,l,o,r,n,a=!1,s=this.treemap.leafItemSettings,d=this.treemap.levels,h=this.treemap.legendSettings.position,p=!1,g=0;this.outOfRangeLegend=null;for(var c=0;c<e.length;c++){i="",p=n=r=!1;for(var m,u=e[c].data,y=e[c].groupIndex,f=((m=0===this.treemap.levels.length||y===this.treemap.levels.length)?s:d[y]).colorMapping,v=0;v<f.length;v++){var S=f[v];if(w=null,F=Number(u[this.treemap.rangeColorValuePath]),C=u[this.treemap.equalColorValuePath],S.value=A.isNullOrUndefined(S.value)?S.value:S.value.toString(),!A.isNullOrUndefined(S.from)&&!A.isNullOrUndefined(S.to)&&F>=S.from&&F<=S.to&&S.showLegend?(n=a=!0,o=S.from+" - "+S.to,l=A.isNullOrUndefined(S.label)?S.from+" - "+S.to:S.label,i=A.isNullOrUndefined(S.color)?i:S.color,t=this.isAddNewLegendData(o)):!A.isNullOrUndefined(S.value)&&C===S.value&&S.showLegend&&(r=a=!0,o=S.value.toString(),l=A.isNullOrUndefined(S.label)?S.value.toString():S.label,i=A.isNullOrUndefined(S.color)?i:"[object Array]"===Object.prototype.toString.call(S.color)?S.color[0]:S.color,t=this.isAddNewLegendData(o)),a&&A.isNullOrUndefined(S.value)&&S.maxOpacity&&S.minOpacity&&"Interactive"===this.treemap.legendSettings.mode){var x=[],p=!0;if("[object Array]"===Object.prototype.toString.call(S.color))for(var b=0;b<S.color.length;b++){var I={colorStop:(b*(100/(S.color.length-1))+"%").toString(),color:S.color[b]};x.push(I)}else{var I={colorStop:"0%",color:i},F={colorStop:"100%",color:i};x.push(I),x.push(F)}var C={id:"groupIndex_"+y+"_colorIndex_"+this.gradientCount,x1:"0%",y1:"0%",x2:"Top"===h||"Bottom"===h?"100%":"0%",y2:"Top"===h||"Bottom"===h?"0%":"100%"},w=this.treemap.renderer.drawGradient("linearGradient",C,x).childNodes[0];"[object Array]"!==Object.prototype.toString.call(S.color)&&(w.childNodes[0].setAttribute("stop-opacity",S.minOpacity.toString()),w.childNodes[1].setAttribute("stop-opacity",S.maxOpacity.toString())),this.defsElement.appendChild(w),this.gradientCount++}if(F=!!this.treemap.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollections,l),t&&t.process&&a&&!F?(a=!1,i="[object Array]"===Object.prototype.toString.call(S.color)&&A.isNullOrUndefined(w)&&A.isNullOrUndefined(S.value)?this.legendGradientColor(S,g):i,this.legendCollections.push({actualValue:o,levelIndex:m?-1:v,leafIndex:m?v:-1,legendName:l,legendFill:i,legendData:[],groupIndex:m?-1:y,gradientElement:A.isNullOrUndefined(w)?A.isNullOrUndefined(S.value)?this.legendLinearGradient:null:w,name:e[c].name,opacity:this.treemap.legendSettings.opacity,borderColor:this.treemap.legendSettings.border.color,borderWidth:this.treemap.legendSettings.border.width}),this.legendCollections[this.legendCollections.length-1].legendData.push(e[c]),g++):a&&(a=!1,this.legendCollections[t.value].legendData.push(e[c])),!n&&!p&&!r&&A.isNullOrUndefined(S.from)&&A.isNullOrUndefined(S.to)&&A.isNullOrUndefined(S.minOpacity)&&A.isNullOrUndefined(S.maxOpacity)&&A.isNullOrUndefined(S.value)&&!A.isNullOrUndefined(S.color)){C="[object Array]"===Object.prototype.toString.call(S.color)?S.color[0]:S.color,w=A.isNullOrUndefined(S.label)?"Others":S.label,F=!!this.treemap.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollections,w),A.isNullOrUndefined(this.outOfRangeLegend)&&!F&&(this.legendCollections.push({actualValue:w,legendData:[],legendName:w,legendFill:C,groupIndex:!m||-1<y?y:-1}),F=this.legendCollections.length,this.outOfRangeLegend=this.legendCollections[F-1],g++);for(var O=this.legendCollections.length-1;0<=O;O--)if(this.legendCollections[O].groupIndex===e[c].groupIndex){this.legendCollections[O].legendData.push(e[c]);break}}}}},x.prototype.removeDuplicates=function(e,t){for(var i=!1,l=0;l<e.length;l++)if(e[l].legendName===t){i=!0;break}return i},x.prototype.isAddNewLegendData=function(e){var t,i;if(0===this.legendCollections.length)t=!0;else for(var l=0;l<this.legendCollections.length;l++){if(e===this.legendCollections[l].actualValue){t=!1,i=l;break}l===this.legendCollections.length-1&&(t=!0)}return{process:t,value:i}},x.prototype.drawLegend=function(){var e=this.treemap.legendSettings,t=this.treemap.renderer,i=e.textStyle;if(this.legendGroup=t.createGroup({id:this.treemap.element.id+"_Legend_Group"}),this.renderLegendBorder(),this.renderLegendTitle(),"Default"===e.mode)this.drawLegendItem(this.currentPage);else for(var l=0;l<this.legendRenderingCollections.length;l++){var o=this.treemap.element.id+"_Legend_Index_"+l,r=this.treemap.element.id+"_Legend_Index_"+l+"_Text",n=this.legendRenderingCollections[l],a=(a=n.element)?"url(#"+a.id+")":n.fill,s=new j(n.x,n.y,n.width,n.height),d=new m(n.textX,n.textY),o=new L(o,a,e.shapeBorder,e.opacity,s),a=(this.treemap.enableRtl&&("Left"===this.treemap.legendSettings.position||"Right"===this.treemap.legendSettings.position||"Auto"===this.treemap.legendSettings.position&&this.treemap.availableSize.width>=this.treemap.availableSize.height?(o.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-(this.translate.y+o.height)-Math.abs(this.legendBorderRect.y-o.y),d.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y+n.textHeight/2-Math.abs(this.legendBorderRect.y-d.y)):(o.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+o.width)-Math.abs(this.legendBorderRect.x-o.x),d.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-this.translate.x-Math.abs(this.legendBorderRect.x-d.x))),this.treemap.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(n.text):n.text);Ue(new T(r,d.x,d.y,"middle",a,"",""),i,i.color||this.treemap.themeStyle.legendTextColor,this.legendGroup),this.legendGroup.appendChild(t.drawRectangle(o))}gt(this.treemap,this.legendGroup)},x.prototype.defaultLegendRtlLocation=function(e,t,i,l){var o=e.Shape,r=e.Text,e=G(e.DisplayText,l.textStyle);return o.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+t)-Math.abs(this.legendBorderRect.x-o.x),r.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+e.width+t)-Math.abs(this.legendBorderRect.x-r.x),("Left"===i.legendSettings.position||"Right"===i.legendSettings.position||"Auto"===i.legendSettings.position&&this.treemap.availableSize.width>=this.treemap.availableSize.height)&&(o.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y-Math.abs(Math.abs(this.legendBorderRect.y)-o.y)-l.shapeHeight/2,r.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y-Math.abs(Math.abs(this.legendBorderRect.y)-r.y)),{shapeLocation:o,textLocation:r}},x.prototype.drawLegendItem=function(t){var d,h=this,p=this.treemap,g=10,c=p.legendSettings,m=new W(c.shapeWidth,c.shapeHeight),u=p.renderer,e=c.shapeBorder;if(0<=t&&t<this.totalPages.length){document.getElementById(this.legendGroup.id)&&document.getElementById(this.legendGroup.id).remove();for(var y="HorizontalLine"===c.shape||"VerticalLine"===c.shape||"Cross"===c.shape,f=y?A.isNullOrUndefined(c.fill)?"#000000":c.fill:e.color,v=y&&0===e.width?1:e.width,S=this,i=0;i<this.totalPages[t].Collection.length;i++)!function(e){var i=S.totalPages[t].Collection[e],l=S.treemap.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(i.DisplayText):i.DisplayText,o=u.createGroup({id:p.element.id+"_Legend_Index_"+e}),r=(o.setAttribute("aria-label",l+" Legend"),o.setAttribute("role","region"),p.element.id+"_Legend_Shape_Index_"+e),n=p.element.id+"_Legend_Text_Index_"+e,a=i.Shape,s=i.Text;p.enableRtl&&(d=S.defaultLegendRtlLocation(i,g,p,c),a=d.shapeLocation,s=d.textLocation),d={cancel:!1,name:ie,treemap:p,fill:i.Fill,shape:c.shape,imageUrl:c.imageUrl},p.trigger(ie,d,function(e){var t=new z(r,e.fill,v,y?i.Fill:f,c.opacity,"");o.appendChild(vt(a,e.shape,m,e.imageUrl,t)),Ue(new T(n,s.x,s.y,"start",l,"",""),c.textStyle,c.textStyle.color||p.themeStyle.legendTextColor,o),h.legendGroup.appendChild(o)})}(i);var l,o,r,n,a,s,x,b,I,F,C,e=void 0,w=g,O=g/2;0!==this.page&&(r=G(l=t+1+"/"+this.totalPages.length,o=c.textStyle),I=this.legendItemRect.x+this.legendItemRect.width-r.width-2*w-g,n=this.legendItemRect.x+this.legendItemRect.width,a=this.legendItemRect.y+this.legendItemRect.height+O/2+g,s=n-w-r.width/2-g/2,e=u.createGroup({id:p.element.id+"_Legend_Paging_Group"}),x=u.createGroup({id:p.element.id+"_Legend_Left_Paging_Group"}),b=u.createGroup({id:p.element.id+"_Legend_Right_Paging_Group"}),C=" M "+n+" "+a+" L "+(n-w)+" "+(a-O)+" L "+(n-w)+" "+(a+O)+" z ",F=new z(p.element.id+"_Left_Page","#a6a6a6",0,"#a6a6a6",1,""," M "+I+" "+a+" L "+(I+w)+" "+(a-O)+" L "+(I+w)+" "+(a+O)+" z "),x.appendChild(u.drawPath(F)),F=new L(p.element.id+"_Left_Page_Rect","transparent",{},1,new j(I-w/2,a-2*O,2*w,2*g),""),x.appendChild(u.drawRectangle(F)),this.wireEvents(x),I=new z(p.element.id+"_Right_Page","#a6a6a6",0,"#a6a6a6",1,"",C),b.appendChild(u.drawPath(I)),F=new L(p.element.id+"_Right_Page_Rect","transparent",{},1,new j(n-w,a-O,w,g),""),b.appendChild(u.drawRectangle(F)),this.wireEvents(b),e.appendChild(x),e.appendChild(b),C={id:p.element.id+"_Paging_Text",x:s,y:a+r.height/4,fill:"#a6a6a6","font-size":"14px","font-style":o.fontStyle,"font-family":o.fontFamily,"font-weight":o.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":"",role:"region","aria-label":l},e.appendChild(u.createText(C,l)),this.legendGroup.appendChild(e))}},x.prototype.renderLegendBorder=function(){var e=this.treemap,t=e.legendSettings,i=t.title.text,l=t.titleStyle,i=G(V(this.legendItemRect.width+20,i,l),l),l=(this.legendBorderRect=new j(this.legendItemRect.x-10,this.legendItemRect.y-10-i.height,this.legendItemRect.width+20,this.legendItemRect.height+20+i.height+("Interactive"!==t.mode&&0!==this.page?10:0)),{color:t.border.color||this.treemap.themeStyle.legendBorderColor,width:t.border.width||this.treemap.themeStyle.legendBorderWidth}),i=new L(e.element.id+"_Legend_Border",t.background,l,1,this.legendBorderRect,""),l=e.renderer.drawRectangle(i);l.style.pointerEvents="none",this.legendGroup.appendChild(l),this.getLegendAlignment(e,this.legendBorderRect.width,this.legendBorderRect.height,t),this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )"),e.svgObject.appendChild(this.legendGroup)},x.prototype.renderLegendTitle=function(){var e=this.treemap.legendSettings,t=e.titleStyle,e=this.treemap.enableHtmlSanitizer?A.SanitizeHtmlHelper.sanitize(e.title.text):e.title.text,i=V(this.legendItemRect.width+20,e,t),l=G(i,t);e&&((l=Ue(new T(this.treemap.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-l.height/2-5,"middle",i,""),t,t.color||this.treemap.themeStyle.legendTitleColor,this.legendGroup)).setAttribute("role","region"),l.setAttribute("aria-label",e))},x.prototype.renderInteractivePointer=function(e){var t=this.treemap,i=e.target,l=t.element.id+"_Interactive_Legend",o=!1,i=-1<e.type.indexOf("touch")?document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY):i,r=t.legendSettings;if(-1<i.id.indexOf("_Item_Index")&&r.visible&&0<this.legendRenderingCollections.length)for(var n=void 0,a=void 0,s=t.layout.renderItems[parseFloat(i.id.split("_Item_Index_")[1])],d=t.svgObject.getBoundingClientRect(),h=0;h<this.legendCollections.length&&!o;h++){var p=this.legendCollections[h],g=(a=document.getElementById(t.element.id+"_Legend_Index_"+h)).getBoundingClientRect(),c=new j(Math.abs(g.left-d.left),Math.abs(g.top-d.top),g.width,g.height),m=a.getAttribute("fill"),u=r.shapeBorder.color,y=r.shapeBorder.width;if(!A.isNullOrUndefined(p.legendData)&&0<p.legendData.length){var n=p.legendData,f=t.rangeColorValuePath;if(-1<s.levelOrderName.indexOf(this.legendCollections[h].legendName))this.drawInteractivePointer(r,m,u,l,y,c),o=!0;else for(var v=0;v<n.length;v++)if(t.rangeColorValuePath&&0<t.leafItemSettings.colorMapping.length?n[v].data[f]===s.data[f]:n[v].levelOrderName===s.levelOrderName||-1<n[v].levelOrderName.indexOf(s.levelOrderName)){this.drawInteractivePointer(r,m,u,l,y,c),o=!0;break}}else 0===this.treemap.leafItemSettings.colorMapping.length&&this.treemap.palette&&-1<s.levelOrderName.indexOf(p.levelOrderName)&&(this.drawInteractivePointer(r,m,u,l,y,c),o=!0)}else this.removeInteractivePointer()},x.prototype.drawInteractivePointer=function(e,t,i,l,o,r){var n,a,e="Horizontal"===("None"===e.orientation?"Top"===e.position||"Bottom"===e.position?"Horizontal":"Vertical":e.orientation)?e.invertedPointer?" M "+(n=r.x+r.width/2)+" "+(a=r.y+r.height)+" L "+(n-10)+" "+(a+10)+" L "+(n+10)+" "+(a+10)+" Z ":" M "+(n=r.x+r.width/2)+" "+(a=r.y)+" L "+(n-10)+" "+(a-10)+" L "+(n+10)+" "+(a-10)+" Z ":e.invertedPointer?" M "+(n=r.x)+" "+(a=r.y+r.height/2)+" L "+(n-10)+" "+(a-10)+" L "+(n-10)+" "+(a+10)+" z ":" M "+(n=r.x+r.width)+" "+(a=r.y+r.height/2)+" L "+(n+10)+" "+(a-10)+" L "+(n+10)+" "+(a+10)+" z ",r=new z(l,t,o,i,1,"",e);this.treemap.svgObject.appendChild(this.treemap.renderer.drawPath(r))},x.prototype.getLegendAlignment=function(e,t,i,l){var o,r,n=A.extend({},e.areaRect,void 0,!0),a=n.x,s=n.y,d=n.height,h=n.width,p=e.availableSize.width,g=e.availableSize.height,c="Auto"===l.position?g<p?"Right":"Bottom":l.position;if("Float"===l.position)this.translate=l.location;else{switch(c){case"Top":case"Bottom":n.height=d-i,o=p/2-t/2,r="Top"===c?s:s+n.height+10,n.y="Top"===c?s+i+10:s;break;case"Left":case"Right":n.width=h-t,o="Left"===c?a:a+n.width,r=g/2-i/2,n.x="Left"===c?a+t:a}switch(l.alignment){case"Near":"Top"===c||"Bottom"===c?o=n.x:r=n.y;break;case"Far":"Top"===c||"Bottom"===c?o=p-t:r=g-i}this.treemap.totalRect=n,this.translate=new m(o,r)}},x.prototype.mouseUpHandler=function(e){this.renderInteractivePointer(e),clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeInteractivePointer.bind(this),3e3)},x.prototype.removeInteractivePointer=function(){var e;document.getElementById(this.treemap.element.id+"_Interactive_Legend")&&(e=document.getElementById(this.treemap.element.id+"_Interactive_Legend")).parentNode.removeChild(e)},x.prototype.changeNextPage=function(e){this.currentPage=-1<e.target.id.indexOf("_Left_Page_")?this.currentPage-1:this.currentPage+1,0<=this.currentPage&&this.currentPage<this.totalPages.length?this.drawLegend():this.currentPage=-1<e.target.id.indexOf("_Left_Page_")?0:this.totalPages.length-1},x.prototype.wireEvents=function(e){A.EventHandler.add(e,A.Browser.touchStartEvent,this.changeNextPage,this)},x.prototype.addEventListener=function(){this.treemap.isDestroyed||(this.treemap.on(A.Browser.touchMoveEvent,this.renderInteractivePointer,this),this.treemap.on(A.Browser.touchEndEvent,this.mouseUpHandler,this))},x.prototype.removeEventListener=function(){this.treemap.isDestroyed||(this.treemap.off(A.Browser.touchMoveEvent,this.renderInteractivePointer),this.treemap.off(A.Browser.touchEndEvent,this.mouseUpHandler))},x.prototype.getModuleName=function(){return"treeMapLegend"},x.prototype.destroy=function(){clearTimeout(this.clearTimeout),this.clearTimeout=null,this.legendRenderingCollections=[],this.legendCollections=[],this.outOfRangeLegend=null,this.totalPages=[],this.translate=null,this.legendBorderRect=null,this.legendGroup=null,this.legendNames=[],this.defsElement=null,this.legendLinearGradient=null,this.legendInteractiveGradient=[],this.legendItemRect=null,this.removeEventListener(),this.treemap=null},x.prototype.legendGradientColor=function(e,t){var i="http://www.w3.org/2000/svg";if(!A.isNullOrUndefined(e.color)&&"[object Array]"===Object.prototype.toString.call(e.color)){var l=this.treemap.renderer.createDefs(),o=document.createElementNS(i,"linearGradient"),r=this.treemap.legendSettings.position,n="Top"===r||"Bottom"===r?"100":"0",r="Top"===r||"Bottom"===r?"0":"100";o.setAttribute("id","linear_"+t),o.setAttribute("x1","0%"),o.setAttribute("y1","0%"),o.setAttribute("x2",n+"%"),o.setAttribute("y2",r+"%");for(var a=0;a<e.color.length;a++){var s=100/(e.color.length-1),d=document.createElementNS(i,"stop");d.setAttribute("offset",a*s+"%"),d.setAttribute("stop-color",e.color[a]),d.setAttribute("stop-opacity",1..toString()),o.appendChild(d)}l.appendChild(o),this.legendLinearGradient=o;n="url(#linear_"+t+")";this.defsElement.appendChild(o),r=n}return r},x);function x(e){this.page=0,this.legendBorderRect=new j(0,0,0,0),this.currentPage=0,this.heightIncrement=0,this.widthIncrement=0,this.textMaxWidth=0,this.legendInteractiveGradient=[],this.legendItemRect=new j(0,0,0,0),this.treemap=e,this.addEventListener()}kt.prototype.mouseMove=function(e){var t,i,l=this.treemap,o=e.target.id,r=[],n=this.treemap.highlightSettings,a=[],s=this.treemap.treeMapSelectionModule,d=!1;if(s&&0<s.legendSelectionCollection.length)for(var h=0;h<s.legendSelectionCollection.length;h++)for(var p=0;p<s.legendSelectionCollection[h].ShapeCollection.Elements.length;p++){var g=parseFloat(s.legendSelectionCollection[h].ShapeCollection.Elements[p].id.split("Item_Index_")[1].split("_")[0]),c=-1<o.indexOf("_Item_Index_")?parseFloat(o.split("Item_Index_")[1].split("_")[0]):null;if(s.legendSelectionCollection[h].ShapeCollection.Elements[p].id===o||g===c){d=!0;break}}if(-1<o.indexOf("_Item_Index")&&!d){if(this.highLightId!==o){var m=document.getElementById(l.element.id+"_TreeMap_"+l.layoutType+"_Layout"),u=document.getElementsByClassName("treeMapSelection"),e=(x=this.treemap.layout.renderItems[parseFloat(o.split("_Item_Index_")[1])],void 0);if(this.treemap.legendSettings.visible&&(N=this.treemap.treeMapLegendModule.legendCollections,I=this.treemap.treeMapLegendModule.legendCollections.length,e=!l.legendSettings.removeDuplicateLegend&&l.palette&&0<l.palette.length&&0===l.leafItemSettings.colorMapping.length&&0===l.levels.length?parseFloat(o.split("_Item_Index_")[1]):Ct(I,x,l),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+e):document.getElementById(this.treemap.element.id+"_Legend_Index_"+e),null===this.shapeElement||s&&this.shapeElement.getAttribute("id")===s.legendSelectId?0<this.currentElement.length&&this.currentElement[this.currentElement.length-1].currentElement!==this.shapeElement&&(Ft(this.shapeHighlightCollection,this.currentElement,l),this.highLightId="","Interactive"===this.treemap.legendSettings.mode)&&this.treemap.treeMapLegendModule.removeInteractivePointer():(I=s?s.shapeElement:null,s&&this.shapeElement===I?0<this.currentElement.length&&this.currentElement[this.currentElement.length-1].currentElement!==this.shapeElement&&(Ft(this.shapeHighlightCollection,this.currentElement,l),this.highLightId=""):(this.currentElement.push({currentElement:this.shapeElement}),P(this.shapeHighlightCollection,l),this.shapeHighlightCollection.push({legendEle:this.shapeElement,oldFill:N[e].legendFill,oldOpacity:N[e].opacity,oldBorderColor:N[e].borderColor,oldBorderWidth:N[e].borderWidth}),B("Default"===this.treemap.legendSettings.mode?document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+e):document.getElementById(this.treemap.element.id+"_Legend_Index_"+e+"_Text"),n.fill,n.opacity,n.border.color,n.border.width.toString()),B(this.shapeElement,n.fill,n.opacity,n.border.color,n.border.width.toString()),this.target="highlight"))),i=je(x,[],n.mode,l),!this.treemap.legendSettings.visible||!s||!this.shapeElement||this.shapeElement.getAttribute("id")!==s.legendSelectId)if(this.treemap.legendSettings.visible&&s&&this.shapeElement===s.shapeElement)t=!1;else{for(h=0;h<m.childElementCount;h++){for(var y=m.childNodes[h],f=!0,v=l.rangeColorValuePath,S=l.layout.renderItems[parseFloat(o.split("_Item_Index_")[1])],x=l.layout.renderItems[parseFloat(y.id.split("_Item_Index_")[1])],p=0;p<u.length;p++)if(y.id===u[p].id){f=!1;break}-1<i.indexOf(x.levelOrderName)&&f&&(A.isNullOrUndefined(v)||""===v||x.data[v]===S.data[v])&&(a.push(y),r.push(x))}M(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",l);for(var b=0;b<a.length;b++)D((y=a[b]).childNodes[0],{border:n.border,fill:n.fill,opacity:n.opacity}),y.classList.add("treeMapHighLight"),this.highLightId=o;l.trigger(J,{cancel:!1,name:J,treemap:l,items:r,elements:a})}}}else if(-1<o.indexOf("_Legend_Shape")||-1<o.indexOf("_Legend_Index")||-1<o.indexOf("_Legend_Text_Index")){A.isNullOrUndefined(s)||(s.legendSelectId=A.isNullOrUndefined(l.legendId[0])?null:l.legendId[0]);var I=s&&s.legendSelectId?parseFloat(s.legendSelectId.split("Index_")[1]):s&&s.shapeSelectId?parseFloat(s.shapeSelectId.split("Index_")[1]):null,F="Default"===this.treemap.legendSettings.mode?-1===o.indexOf("Text")?parseFloat(o.split("_Legend_Shape_Index_")[1]):parseFloat(o.split("_Legend_Text_Index_")[1]):parseFloat(o.split("_Legend_Index_")[1]);if(this.treemap.legendSettings.visible&&F!==I){for(var C,w=void 0,O=void 0,v=l.rangeColorValuePath,L=document.getElementById(o),T=("highlight"===this.shapeTarget&&(P(this.legendHighlightCollection,this.treemap),this.legendHighlightCollection=[]),this.shapeTarget="highlight",this.treemap.treeMapLegendModule.legendCollections[F].legendData.length),N=this.treemap.treeMapLegendModule.legendCollections,h=0;h<T;h++)for(p=0;p<this.treemap.layout.renderItems.length;p++)(!A.isNullOrUndefined(v)&&""!==v&&0<l.leafItemSettings.colorMapping.length?l.treeMapLegendModule.legendCollections[F].legendData[h].data[v]===l.layout.renderItems[p].data[v]:l.treeMapLegendModule.legendCollections[F].legendData[h].levelOrderName===l.layout.renderItems[p].levelOrderName)&&(w=p,O=this.treemap.layout.renderItems[p].groupIndex,E=document.getElementById(this.treemap.element.id+"_Level_Index_"+O+"_Item_Index_"+w+"_RectPath"),0!==h&&0!==this.legendHighlightCollection.length||(this.legendHighlightCollection=[],wt(this.legendHighlightCollection,F,p,L,E,this.treemap.layout.renderItems,N),C=this.legendHighlightCollection.length,this.legendHighlightCollection[C-1].ShapeCollection={Elements:[]}),B(L,n.fill,n.opacity,n.border.color,n.border.width.toString()),B(-1<L.id.indexOf("Text")?"Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id.replace("_Text","")):document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+F):"Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id+"_Text"):document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+F),n.fill,n.opacity,n.border.color,n.border.width.toString()),B(E,n.fill,n.opacity,n.border.color,n.border.width.toString()),C=this.legendHighlightCollection.length,this.legendHighlightCollection[C-1].ShapeCollection.Elements.push(E));if(0===T&&this.treemap.palette&&0<this.treemap.palette.length)for(var E,p=0;p<this.treemap.layout.renderItems.length;p++)!(this.treemap.treeMapLegendModule.legendCollections[F].levelOrderName===this.treemap.layout.renderItems[p].levelOrderName||-1<this.treemap.layout.renderItems[p].levelOrderName.indexOf(this.treemap.treeMapLegendModule.legendCollections[F].levelOrderName))||!this.treemap.legendSettings.removeDuplicateLegend&&l.palette&&0<l.palette.length&&F!==p||(w=p,O=this.treemap.layout.renderItems[p].groupIndex,E=document.getElementById(this.treemap.element.id+"_Level_Index_"+O+"_Item_Index_"+w+"_RectPath"),wt(this.legendHighlightCollection,F,p,L,E,this.treemap.layout.renderItems,N),C=this.legendHighlightCollection.length,this.legendHighlightCollection[C-1].ShapeCollection={Elements:[]},B(-1<L.id.indexOf("Text")?"Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id.replace("_Text","")):document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+F):"Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id+"_Text"):document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+F),n.fill,n.opacity,n.border.color,n.border.width.toString()),B(L,n.fill,n.opacity,n.border.color,n.border.width.toString()),B(E,n.fill,n.opacity,n.border.color,n.border.width.toString()),C=this.legendHighlightCollection.length,this.legendHighlightCollection[C-1].ShapeCollection.Elements.push(E))}}else s&&this.shapeElement&&this.shapeElement.getAttribute("id")===s.legendSelectId||(s?this.shapeElement!==s.shapeElement:this.treemap.legendSettings.visible)&&M(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",l),"highlight"!==this.shapeTarget&&"highlight"!==this.target||!this.treemap.legendSettings.visible||s&&this.shapeElement&&this.shapeElement.getAttribute("id")===s.legendSelectId||s&&this.shapeElement===s.shapeElement||(P(this.shapeHighlightCollection,l),this.shapeHighlightCollection=[]),"highlight"===this.shapeTarget&&this.treemap.legendSettings.visible&&P(this.legendHighlightCollection,this.treemap),this.highLightId="",t=!1;return t},kt.prototype.addEventListener=function(){this.treemap.isDestroyed||this.treemap.on(A.Browser.touchMoveEvent,this.mouseMove,this)},kt.prototype.removeEventListener=function(){this.treemap.isDestroyed||this.treemap.off(A.Browser.touchMoveEvent,this.mouseMove)},kt.prototype.getModuleName=function(){return"treeMapHighlight"},kt.prototype.destroy=function(){this.shapeElement=null,this.shapeHighlightCollection=[],this.legendHighlightCollection=[],this.currentElement=[],this.removeEventListener(),this.treemap=null};var Ht=kt;function kt(e){this.target="highlight",this.shapeTarget="highlight",this.shapeHighlightCollection=[],this.legendHighlightCollection=[],this.currentElement=[],this.treemap=e,this.addEventListener()}b.prototype.mouseDown=function(e){var t=e.target,i=this.treemap,l=[],o=t.id,r=t.innerHTML,n=[],a=i.selectionSettings,s=this.treemap.treeMapHighlightModule,d=i.element.id+"_TreeMap_"+i.layoutType+"_Layout",h=(f=i.layout.renderItems[parseFloat(o.split("_Item_Index_")[1])])&&!f.isLeafItem&&i.enableDrillDown&&(-1<t.nextSibling.textContent.indexOf("[+]")||-1<t.nextSibling.textContent.indexOf("[-]"));if(-1<o.indexOf("_Item_Index")&&!h)if(e.preventDefault(),this.treemap.selectionId!==o){i.levelSelection=[],i.legendId=[],this.shapeSelectId="",P(this.legendSelectionCollection,i),this.legendSelectionCollection=[];var p=document.getElementById(d),g=void 0;this.treemap.legendSettings.visible&&(this.shapeSelect=!1,e=this.treemap.treeMapLegendModule.legendCollections.length,I=this.treemap.treeMapLegendModule.legendCollections,this.shapeElement=void 0,P(this.shapeSelectionCollection,i),s&&(s.shapeTarget="selection",s.shapeHighlightCollection=[]),g=!i.legendSettings.removeDuplicateLegend&&i.palette&&0<i.palette.length&&0===i.leafItemSettings.colorMapping.length&&0===i.levels.length?parseFloat(o.split("_Item_Index_")[1]):Ct(e,f,i),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+g):document.getElementById(this.treemap.element.id+"_Legend_Index_"+g),null!==this.shapeElement)&&(this.shapeSelectId=this.shapeElement.getAttribute("id"),this.shapeSelectionCollection.push({legendEle:this.shapeElement,oldFill:I[g].legendFill,oldOpacity:I[g].opacity,oldBorderColor:I[g].borderColor,oldBorderWidth:I[g].borderWidth}),B(d="Default"===this.treemap.legendSettings.mode?document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+g):document.getElementById(this.treemap.element.id+"_Legend_Index_"+g+"_Text"),a.fill,a.opacity,a.border.color,a.border.width.toString()),B(this.shapeElement,a.fill,a.opacity,a.border.color,a.border.width.toString()),i.legendId.push(this.shapeElement.id),i.legendId.push(d.id));for(var c=je(f,[],a.mode,i),m=0;m<p.childElementCount;m++){var u=p.childNodes[m],y=i.layout.renderItems[parseFloat(o.split("_Item_Index_")[1])],f=i.layout.renderItems[parseFloat(u.id.split("_Item_Index_")[1])],v=i.rangeColorValuePath;-1<c.indexOf(f.levelOrderName)&&(A.isNullOrUndefined(v)||""===v||f.data[v]===y.data[v])&&(n.push(u),-1<o.indexOf("_RectPath")&&i.levelSelection.push(o),l.push(f))}M(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",i),this.treemap.selectionId=o;for(var S=document.getElementsByClassName("treeMapHighLight"),x=0;x<n.length;x++){if(u=n[x],0<S.length)for(var b=0;b<S.length;b++)S[b].id===u.id&&S[b].classList.remove("treeMapHighLight"),D(u.childNodes[0],{border:a.border,fill:a.fill,opacity:a.opacity}),u.classList.add("treeMapSelection");else D(u.childNodes[0],{border:a.border,fill:a.fill,opacity:a.opacity}),u.classList.add("treeMapSelection");i.trigger(X,{cancel:!1,name:X,treemap:i,items:l,elements:n,text:r,contentItemTemplate:r},function(e){e.contentItemTemplate!==r&&He(o,t,e.contentItemTemplate)})}}else P(this.shapeSelectionCollection,i),this.treemap.legendId=[],this.shapeSelectionCollection=[],this.shapeElement=void 0,this.shapeSelect=!0,this.shapeSelectId="",this.treemap.levelSelection=[],this.legendSelect&&(M(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",i),this.treemap.selectionId="");else if(-1<o.indexOf("_Legend_Shape")||-1<o.indexOf("_Legend_Index")||-1<o.indexOf("_Legend_Text_")){var I=this.treemap.treeMapLegendModule.legendCollections,e=A.isNullOrUndefined(this.legendSelectId)?null:parseFloat(this.legendSelectId.split("_Index_")[1]);if(this.treemap.legendSettings.visible&&e!==parseFloat(o.split("_Index_")[1])){for(var F,C=void 0,w=void 0,O=(i.legendId=[],i.levelSelection=[],this.legendSelectId=o,this.legendSelect=!1,isNaN(parseInt(o[o.length-1],10))?parseInt(o[o.length-6],10):parseInt(o[o.length-1],10)),L=document.getElementById(o),v=(P(this.legendSelectionCollection,i),M(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",i),P(this.shapeSelectionCollection,i),this.legendSelectionCollection=[],s&&(s.shapeTarget="selection",s.legendHighlightCollection=[]),i.rangeColorValuePath),g="Default"===this.treemap.legendSettings.mode?-1===o.indexOf("Text")?parseFloat(o.split("_Legend_Shape_Index_")[1]):parseFloat(o.split("_Legend_Text_Index_")[1]):parseFloat(o.split("_Legend_Index_")[1]),T=this.treemap.treeMapLegendModule.legendCollections[g].legendData.length,x=0;x<T;x++)for(var N=0;N<this.treemap.layout.renderItems.length;N++)(!A.isNullOrUndefined(v)&&""!==v&&0<i.leafItemSettings.colorMapping.length?i.treeMapLegendModule.legendCollections[g].legendData[x].data[v]===i.layout.renderItems[N].data[v]:this.treemap.treeMapLegendModule.legendCollections[g].legendData[x].levelOrderName===this.treemap.layout.renderItems[N].levelOrderName)&&(C=N,w=this.treemap.layout.renderItems[N].groupIndex,E=document.getElementById(this.treemap.element.id+"_Level_Index_"+w+"_Item_Index_"+C+"_RectPath"),this.treemap.selectionId=E.id,0!==x&&0!==this.legendSelectionCollection.length||(wt(this.legendSelectionCollection,O,N,L,E,this.treemap.layout.renderItems,I),F=this.legendSelectionCollection.length,this.legendSelectionCollection[F-1].ShapeCollection={Elements:[]}),_=void(this.treemap.selectionId=E.id),-1<L.id.indexOf("Text")?(_="Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id.replace("_Text","")):document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+g),this.legendSelectId=_.id,this.shapeElement=_):(_="Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id+"_Text"):document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+g),this.shapeElement=L),B(_,a.fill,a.opacity,a.border.color,a.border.width.toString()),B(L,a.fill,a.opacity,a.border.color,a.border.width.toString()),B(E,a.fill,a.opacity,a.border.color,a.border.width.toString()),F=this.legendSelectionCollection.length,i.levelSelection.push(E.id),-1===i.legendId.indexOf(L.id)&&i.legendId.push(L.id),-1===i.legendId.indexOf(_.id)&&i.legendId.push(_.id),this.legendSelectionCollection[F-1].ShapeCollection.Elements.push(E));if(0===T&&this.treemap.palette&&0<this.treemap.palette.length)for(var E,_,b=0;b<this.treemap.layout.renderItems.length;b++)!(this.treemap.treeMapLegendModule.legendCollections[g].levelOrderName===this.treemap.layout.renderItems[b].levelOrderName||-1<this.treemap.layout.renderItems[b].levelOrderName.indexOf(this.treemap.treeMapLegendModule.legendCollections[g].levelOrderName))||!this.treemap.legendSettings.removeDuplicateLegend&&i.palette&&0<i.palette.length&&g!==b||(C=b,w=this.treemap.layout.renderItems[b].groupIndex,E=document.getElementById(this.treemap.element.id+"_Level_Index_"+w+"_Item_Index_"+C+"_RectPath"),wt(this.legendSelectionCollection,g,b,L,E,this.treemap.layout.renderItems,I),this.treemap.selectionId=E.id,F=this.legendSelectionCollection.length,_=void(this.legendSelectionCollection[F-1].ShapeCollection={Elements:[]}),-1<L.id.indexOf("Text")?(_="Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id.replace("_Text","")):document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+g),this.legendSelectId=_.id,this.shapeElement=_):(_="Interactive"===this.treemap.legendSettings.mode?document.getElementById(L.id+"_Text"):document.getElementById(this.treemap.element.id+"_Legend_Text_Index_"+g),this.legendSelectId=o,this.shapeElement=L),B(_,a.fill,a.opacity,a.border.color,a.border.width.toString()),B(L,a.fill,a.opacity,a.border.color,a.border.width.toString()),B(E,a.fill,a.opacity,a.border.color,a.border.width.toString()),i.levelSelection.push(E.id),-1===i.legendId.indexOf(_.id)&&i.legendId.push(_.id),-1===i.legendId.indexOf(L.id)&&i.legendId.push(L.id),F=this.legendSelectionCollection.length,this.legendSelectionCollection[F-1].ShapeCollection.Elements.push(E))}else P(this.legendSelectionCollection,this.treemap),this.legendSelectionCollection=[],s&&(s.shapeTarget="highlight"),this.legendSelect=!0,this.legendSelectId="",this.treemap.legendId=[],this.treemap.levelSelection=[]}else h&&(P(this.legendSelectionCollection,this.treemap),this.legendSelectionCollection=[],this.legendSelect=!0,this.legendSelectId="",this.treemap.legendId=[],this.treemap.levelSelection=[])},b.prototype.selectTreemapItem=function(e,t){if(t){for(var i=void 0,l=0;l<this.treemap.layout.renderItems.length;l++)if(e===this.treemap.layout.renderItems[l].levelOrderName){i=this.treemap.layout.renderItems[l];break}for(var o=this.treemap.selectionSettings,r=[],n=void 0,a=[],t=(this.treemap.levelSelection=[],this.treemap.element.id+"_TreeMap_"+this.treemap.layoutType+"_Layout"),s=document.getElementById(t),d=je(i,[],o.mode,this.treemap),h=0;h<s.childElementCount;h++)n=s.childNodes[h],i=this.treemap.layout.renderItems[parseFloat(n.id.split("_Item_Index_")[1])],-1<d.indexOf(i.levelOrderName)&&(r.push(n),this.treemap.levelSelection.push(n.id),a.push(i));if(this.treemap.legendSettings.visible)for(var p=0;p<a.length;p++){this.shapeSelect=!1;var g=this.treemap.treeMapLegendModule.legendCollections.length,c=this.treemap.treeMapLegendModule.legendCollections;this.shapeElement=void 0,It(this.shapeSelectionCollection),g=Ct(g,a[p],this.treemap),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById(this.treemap.element.id+"_Legend_Shape_Index_"+g):document.getElementById(this.treemap.element.id+"_Legend_Index_"+g),null!==this.shapeElement&&(this.shapeSelectId=this.shapeElement.getAttribute("id"),this.treemap.legendId.push(this.shapeSelectId),this.shapeSelectionCollection.push({legendEle:this.shapeElement,oldFill:c[g].legendFill,oldOpacity:c[g].opacity,oldBorderColor:c[g].borderColor,oldBorderWidth:c[g].borderWidth}),B(this.shapeElement,o.fill,o.opacity,o.border.color,o.border.width.toString()))}M(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",this.treemap);for(var t=document.getElementById(this.treemap.levelSelection[0]),m=(this.treemap.selectionId=t.childNodes[0].id,document.getElementsByClassName("treeMapHighLight")),u=0;u<r.length;u++)if(n=r[u],0<m.length)for(var y=0;y<m.length;y++)m[y].id===n.id&&m[y].classList.remove("treeMapHighLight"),D(n.childNodes[0],{border:o.border,fill:o.fill,opacity:o.opacity}),n.classList.add("treeMapSelection");else o.fill=("null"===o.fill?this.treemap.layout.renderItems[parseInt(n.id.split("Item_Index_")[1],10)].options:o).fill,D(n.childNodes[0],{border:o.border,fill:o.fill,opacity:o.opacity}),n.classList.add("treeMapSelection")}else It(this.shapeSelectionCollection),this.shapeElement=void 0,this.treemap.levelSelection=[],this.shapeSelect=!0,this.shapeSelectId="",this.treemap.legendId=[],M(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",this.treemap),this.treemap.selectionId=""},b.prototype.addEventListener=function(){this.treemap.isDestroyed||this.treemap.on(A.Browser.touchStartEvent,this.mouseDown,this)},b.prototype.removeEventListener=function(){this.treemap.isDestroyed||this.treemap.off(A.Browser.touchStartEvent,this.mouseDown)},b.prototype.getModuleName=function(){return"treeMapSelection"},b.prototype.destroy=function(){this.shapeElement=null,this.shapeSelectionCollection=[],this.legendSelectionCollection=[],this.removeEventListener(),this.treemap=null};var At=b;function b(e){this.shapeSelectionCollection=[],this.legendSelectionCollection=[],this.shapeSelect=!0,this.legendSelect=!0,this.treemap=e,this.addEventListener()}var Wt=function(e,t){var i={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var l=0,o=Object.getOwnPropertySymbols(e);l<o.length;l++)t.indexOf(o[l])<0&&(i[o[l]]=e[o[l]]);return i},jt=(I.prototype.renderTooltip=function(e){var t,i,l,o,r,n,a=this,s=(t=(-1!==e.type.indexOf("touch")?(this.isTouch=!0,p=e.changedTouches[0].pageX,e.changedTouches[0]):(this.isTouch="touch"===e.pointerType,p=e.pageX,e)).pageY,e.target),d=s.id,h=[];if(-1<d.indexOf("_Item_Index")){if(d=this.treemap.layout.renderItems[parseFloat(d.split("_Item_Index_")[1])],!A.isNullOrUndefined(d)){o=d.weight,r=d.data,A.isNullOrUndefined(d.options)||(n=d.options.fill),h=this.treemap.enableRtl?[(A.isNullOrUndefined(this.tooltipSettings.format)?null:ct(this.tooltipSettings.format,r,this.treemap))||mt(o,this.treemap)+" : "+this.treemap.weightValuePath.toString()]:[(A.isNullOrUndefined(this.tooltipSettings.format)?null:ct(this.tooltipSettings.format,r,this.treemap))||this.treemap.weightValuePath.toString()+" : "+mt(o,this.treemap)],document.getElementById(this.tooltipId)?l=document.getElementById(this.tooltipId):((l=A.createElement("div",{id:this.treemap.element.id+"_TreeMapTooltip",className:"EJ2-TreeMap-Tooltip"})).style.cssText="position: absolute;pointer-events:none;",document.getElementById(this.treemap.element.id+"_Secondary_Element").appendChild(l)),(o=$e(p,t,this.treemap.svgObject)).y=this.tooltipSettings.template?o.y+10:o.y,this.tooltipSettings.textStyle.size=this.tooltipSettings.textStyle.size||this.treemap.themeStyle.tooltipFontSize,this.tooltipSettings.textStyle.fontFamily=this.tooltipSettings.textStyle.fontFamily||this.treemap.themeStyle.fontFamily,this.tooltipSettings.textStyle.fontStyle=A.isNullOrUndefined(this.tooltipSettings.textStyle.fontStyle)?"Normal":this.tooltipSettings.textStyle.fontStyle,this.tooltipSettings.textStyle.fontWeight=this.tooltipSettings.textStyle.fontWeight||this.treemap.themeStyle.fontWeight,this.tooltipSettings.textStyle.color=this.tooltipSettings.textStyle.color||this.treemap.themeStyle.tooltipFontColor,this.tooltipSettings.textStyle.opacity=this.tooltipSettings.textStyle.opacity||this.treemap.themeStyle.tooltipTextOpacity;var p={width:this.tooltipSettings.border.width||this.treemap.themeStyle.tooltipBorderWidth||0,color:this.tooltipSettings.border.color||this.treemap.themeStyle.tooltipBorderColor||"transparent"};if(this.treemap.enableHtmlSanitizer)for(var g=0;g<h.length;g++)h[g]=A.SanitizeHtmlHelper.sanitize(h[g]);i={cancel:!1,name:Y,item:d,options:{location:o,text:h,data:r,border:p,textStyle:this.tooltipSettings.textStyle,template:this.tooltipSettings.template},treemap:this.treemap,element:s,eventArgs:e},this.treemap.trigger(Y,i,function(e){a.addTooltip(i,n,l)})}}else this.removeTooltip(),this.treemap.clearTemplate()},I.prototype.addTooltip=function(e,t,i,l){var o;l=A.isNullOrUndefined(e)?(o=l.cancel,l):(o=e.cancel,Wt(e,["cancel"]).options),o?(this.removeTooltip(),this.treemap.clearTemplate()):(this.svgTooltip=new F.Tooltip({theme:this.treemap.theme,enable:!0,header:"",data:l.data,template:l.template,content:l.text,shapes:[],location:l.location,palette:[t],areaBounds:this.treemap.areaRect,textStyle:l.textStyle,fill:this.treemap.tooltipSettings.fill||this.treemap.themeStyle.tooltipFillColor,border:l.border,enableShadow:!0}),(this.treemap.isVue||this.treemap.isVue3)&&(this.svgTooltip.controlInstance=this.treemap),this.svgTooltip.opacity=this.treemap.themeStyle.tooltipFillOpacity||this.svgTooltip.opacity,this.svgTooltip.appendTo(i),this.treemap.renderReactTemplates())},I.prototype.mouseUpHandler=function(e){this.renderTooltip(e),clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3)},I.prototype.removeTooltip=function(){var e;0<document.getElementsByClassName("EJ2-TreeMap-Tooltip").length&&(e=document.getElementsByClassName("EJ2-TreeMap-Tooltip")[0]).parentNode.removeChild(e)},I.prototype.addEventListener=function(){this.treemap.isDestroyed||(this.treemap.on(A.Browser.touchMoveEvent,this.renderTooltip,this),this.treemap.on(A.Browser.touchEndEvent,this.mouseUpHandler,this))},I.prototype.removeEventListener=function(){this.treemap.isDestroyed||(this.treemap.off(A.Browser.touchMoveEvent,this.renderTooltip),this.treemap.off(A.Browser.touchEndEvent,this.mouseUpHandler))},I.prototype.getModuleName=function(){return"treeMapTooltip"},I.prototype.destroy=function(){A.isNullOrUndefined(this.svgTooltip)||this.svgTooltip.destroy(),this.svgTooltip=null,this.tooltipSettings=null,this.removeEventListener(),this.treemap=null},I);function I(e){this.treemap=e,this.tooltipSettings=this.treemap.tooltipSettings,this.tooltipId=this.treemap.element.id+"_TreeMapTooltip",this.addEventListener()}e.Border=l,e.ColorMapping=xe,e.ColorValue=ut,e.CommonTitleSettings=pe,e.Font=r,e.HighlightSettings=De,e.ImageExport=Mt,e.InitialDrillSettings=Ce,e.LayoutPanel=Tt,e.LeafItemSettings=Le,e.LegendSettings=Ie,e.LevelSettings=t,e.LevelsData=Ut,e.Location=m,e.Margin=se,e.PathOption=z,e.PdfExport=Pt,e.Print=Et,e.Rect=j,e.RectOption=L,e.SelectionSettings=_e,e.Size=W,e.SubTitleSettings=me,e.TextOption=T,e.TitleSettings=fe,e.TooltipSettings=Ne,e.TreeMap=i,e.TreeMapAjax=bt,e.TreeMapHighlight=Ht,e.TreeMapLegend=v,e.TreeMapSelection=At,e.TreeMapTooltip=jt,e.applyOptions=D,e.beforePrint=U,e.click=$,e.colorCollections=tt,e.colorMap=Ke,e.colorNameToHex=y,e.componentToHex=u,e.convertElement=Ve,e.convertHexToColor=ft,e.convertToContainer=Ze,e.convertToHexCode=yt,e.convertToRect=Qe,e.createTextStyle=Re,e.deSaturationColor=et,e.defaultFont=re,e.doubleClick=K,e.drawSymbol=vt,e.drillEnd=q,e.drillStart=k,e.findChildren=R,e.findHightLightItems=je,e.findLabelLocation=qe,e.findPosition=ze,e.formatValue=mt,e.getArea=Je,e.getColorByValue=lt,e.getElement=ke,e.getGradientColor=ot,e.getLegendIndex=Ct,e.getMousePosition=$e,e.getPercentage=nt,e.getPercentageColor=rt,e.getShortestEdge=Ye,e.getTemplateFunction=Ge,e.getThemeStyle=Nt,e.hide=dt,e.isContainsData=We,e.isParentItem=xt,e.itemClick=Z,e.itemHighlight=J,e.itemMove=Q,e.itemRendering=H,e.itemSelected=X,e.itemsToOrder=Ae,e.legendItemRendering=ie,e.legendMaintain=gt,e.legendRendering=le,e.load=E,e.loaded=_,e.maintainSelection=pt,e.measureElement=Xe,e.measureText=G,e.mouseMove=te,e.orderByArea=ht,e.pushCollection=wt,e.removeClassNames=M,e.removeElement=Lt,e.removeLegend=P,e.removeSelectionWithHighlight=Ft,e.removeShape=It,e.renderLegendShape=St,e.renderTextElement=Ue,e.resize=oe,e.rgbToHex=it,e.rightClick=ee,e.setColor=B,e.setItemTemplateContent=He,e.stringToNumber=Be,e.textFormatter=ct,e.textTrim=V,e.textWrap=st,e.tooltipRendering=Y,e.triggerDownload=Ot,e.wordWrap=at,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-treemap.umd.min.js.map
