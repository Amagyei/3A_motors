{"version":3,"file":"ej2-interactive-chat.min.js","sources":["../../src/interactive-chat-base/interactive-chat-base.js","../../src/ai-assistview/ai-assistview.js","../../src/chat-ui/chat-ui.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, select, compile, NotifyPropertyChanges, isNullOrUndefined as isNOU, formatUnit, Event, append, addClass, removeClass, Property, ChildProperty, Collection } from '@syncfusion/ej2-base';\nimport { attributes, EventHandler, remove } from '@syncfusion/ej2-base';\nimport { TextArea } from '@syncfusion/ej2-inputs';\n/**\n * Represents a toolbar item model in the component.\n */\nvar ToolbarItem = /** @class */ (function (_super) {\n    __extends(ToolbarItem, _super);\n    function ToolbarItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], ToolbarItem.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property()\n    ], ToolbarItem.prototype, \"text\", void 0);\n    __decorate([\n        Property('Button')\n    ], ToolbarItem.prototype, \"type\", void 0);\n    __decorate([\n        Property('Left')\n    ], ToolbarItem.prototype, \"align\", void 0);\n    __decorate([\n        Property(true)\n    ], ToolbarItem.prototype, \"visible\", void 0);\n    __decorate([\n        Property(false)\n    ], ToolbarItem.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('')\n    ], ToolbarItem.prototype, \"tooltip\", void 0);\n    __decorate([\n        Property('')\n    ], ToolbarItem.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(null)\n    ], ToolbarItem.prototype, \"template\", void 0);\n    __decorate([\n        Property(-1)\n    ], ToolbarItem.prototype, \"tabIndex\", void 0);\n    return ToolbarItem;\n}(ChildProperty));\nexport { ToolbarItem };\n/**\n * Represents the settings for the toolbar in the component.\n */\nvar ToolbarSettings = /** @class */ (function (_super) {\n    __extends(ToolbarSettings, _super);\n    function ToolbarSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Collection([], ToolbarItem)\n    ], ToolbarSettings.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], ToolbarSettings.prototype, \"itemClicked\", void 0);\n    return ToolbarSettings;\n}(ChildProperty));\nexport { ToolbarSettings };\n/**\n * ChatBase component act as base class.\n */\nvar InterActiveChatBase = /** @class */ (function (_super) {\n    __extends(InterActiveChatBase, _super);\n    /**\n     * * Constructor for Base class\n     *\n     * @param {InterActiveChatBaseModel} options - Specifies the Base model.\n     * @param {string | HTMLElement} element - Specifies the element to render as component.\n     * @private\n     */\n    function InterActiveChatBase(options, element) {\n        return _super.call(this, options, element) || this;\n    }\n    /**\n     * This method is abstract member of the Component<HTMLElement>.\n     *\n     * @private\n     * @returns {void}\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    InterActiveChatBase.prototype.preRender = function () {\n    };\n    /**\n     * This method is abstract member of the Component<HTMLElement>.\n     *\n     * @private\n     * @returns {string} - It returns the current module name.\n     */\n    InterActiveChatBase.prototype.getModuleName = function () {\n        return 'interactivechatBase';\n    };\n    /**\n     * This method is abstract member of the Component<HTMLElement>.\n     *\n     * @private\n     * @returns {string} - It returns the persisted data.\n     */\n    InterActiveChatBase.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     * This method is abstract member of the Component<HTMLElement>.\n     *\n     * @private\n     * @returns {void}\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function\n    InterActiveChatBase.prototype.render = function () {\n    };\n    /* To calculate the width when change via set model */\n    InterActiveChatBase.prototype.setDimension = function (element, width, height) {\n        element.style.width = !isNOU(width) ? formatUnit(width) : element.style.width;\n        element.style.height = !isNOU(height) ? formatUnit(height) : element.style.height;\n    };\n    InterActiveChatBase.prototype.addCssClass = function (element, cssClass) {\n        if (cssClass) {\n            element.classList.add(cssClass);\n        }\n    };\n    InterActiveChatBase.prototype.addRtlClass = function (element, isRtl) {\n        if (isRtl) {\n            element.classList.add('e-rtl');\n        }\n    };\n    InterActiveChatBase.prototype.updateCssClass = function (element, newClass, oldClass) {\n        if (oldClass) {\n            removeClass([element], oldClass.trim().split(' '));\n        }\n        if (newClass) {\n            addClass([element], newClass.trim().split(' '));\n        }\n    };\n    InterActiveChatBase.prototype.updateHeader = function (showHeader, headerElement, viewWrapper) {\n        if (!showHeader) {\n            headerElement.hidden = true;\n            viewWrapper.style.height = '100%';\n        }\n        else {\n            headerElement.hidden = false;\n            viewWrapper.style.height = '';\n        }\n    };\n    InterActiveChatBase.prototype.renderViewSections = function (element, headerClassName, viewClassName) {\n        var headerWrapper = this.createElement('div', { attrs: { class: headerClassName } });\n        element.appendChild(headerWrapper);\n        var viewWrapper = this.createElement('div', { attrs: { class: viewClassName } });\n        element.appendChild(viewWrapper);\n    };\n    InterActiveChatBase.prototype.createViewComponents = function (viewWrapper) {\n        var contentWrapper = this.createElement('div', { attrs: { class: 'e-views' } });\n        var viewContainer = this.createElement('div', { attrs: { class: 'e-view-container' } });\n        contentWrapper.appendChild(viewContainer);\n        viewWrapper.appendChild(contentWrapper);\n    };\n    InterActiveChatBase.prototype.updateScroll = function (scrollElement) {\n        scrollElement.scrollTo(0, scrollElement.scrollHeight);\n    };\n    InterActiveChatBase.prototype.getElement = function (element) {\n        var className;\n        switch (element) {\n            case 'footer':\n                className = 'e-footer';\n                break;\n            case 'contentContainer':\n                className = 'e-content-container';\n                break;\n            case 'outputElement':\n                className = 'e-content';\n                break;\n            default:\n                className = '';\n                break;\n        }\n        return this.createElement('div', { attrs: { class: className } });\n    };\n    InterActiveChatBase.prototype.createSuggestionElement = function (suggestionHeader) {\n        var suggestionContainer = this.createElement('div', { attrs: { class: 'e-suggestions' } });\n        var suggestionHeaderElement = this.createElement('div', { attrs: { class: 'e-suggestion-header' } });\n        var suggestionListElement = this.createElement('div', { attrs: { class: 'e-suggestion-list' } });\n        if (suggestionHeader) {\n            suggestionContainer.appendChild(suggestionHeaderElement);\n        }\n        suggestionContainer.appendChild(suggestionListElement);\n        return { suggestionContainer: suggestionContainer, suggestionHeaderElement: suggestionHeaderElement, suggestionListElement: suggestionListElement };\n    };\n    InterActiveChatBase.prototype.renderSuggestions = function (suggestionsArray, suggestionHeader, suggestionTemplate, contextName, templateName, onSuggestionClick) {\n        var isSuggestionTemplate = suggestionTemplate ? true : false;\n        if (suggestionsArray && suggestionsArray.length > 0) {\n            var _a = this.createSuggestionElement(suggestionHeader), suggestionContainer = _a.suggestionContainer, suggestionHeaderElement = _a.suggestionHeaderElement, suggestionListElement = _a.suggestionListElement;\n            this.suggestionsElement = suggestionContainer;\n            var suggestionContainerClass = \"e-suggestions \" + (isSuggestionTemplate ? 'e-suggestion-item-template' : '');\n            this.suggestionsElement.className = suggestionContainerClass;\n            this.suggestionHeader = suggestionHeaderElement;\n            var suggestionList = suggestionListElement;\n            this.renderSuggestionList(suggestionsArray, suggestionList, isSuggestionTemplate, contextName, suggestionTemplate, templateName, onSuggestionClick);\n            if (suggestionHeader) {\n                this.suggestionHeader.innerHTML = suggestionHeader;\n            }\n            this.suggestionsElement.append(suggestionList);\n            this.content.append(this.suggestionsElement);\n        }\n    };\n    InterActiveChatBase.prototype.renderSuggestionList = function (suggestionsArray, suggestionWrapper, isSuggestionTemplate, contextName, suggestionTemplate, templateName, onSuggestionClick) {\n        var _this = this;\n        var suggestionsListElement = this.createElement('ul', { attrs: { 'tabindex': '-1' } });\n        suggestionsArray.forEach(function (suggestion, i) {\n            var _a;\n            var suggestionList = _this.createElement('li');\n            attributes(suggestionList, { 'tabindex': '0' });\n            EventHandler.add(suggestionList, 'click', onSuggestionClick, _this);\n            EventHandler.add(suggestionList, 'keydown', _this.suggestionItemHandler, _this);\n            if (isSuggestionTemplate) {\n                var suggestionContext = (_a = { index: i }, _a[contextName] = suggestionsArray[parseInt(i.toString(), 10)], _a);\n                _this.updateContent(suggestionTemplate, suggestionList, suggestionContext, templateName);\n            }\n            else {\n                suggestionList.innerHTML = suggestion;\n            }\n            suggestionsListElement.append(suggestionList);\n        });\n        suggestionWrapper.appendChild(suggestionsListElement);\n    };\n    InterActiveChatBase.prototype.suggestionItemHandler = function (event) {\n        if (event.key === 'Enter' && !event.shiftKey) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.onSuggestionClick(event);\n        }\n    };\n    InterActiveChatBase.prototype.renderBannerView = function (bannerTemplate, parentElement, templateName) {\n        if (bannerTemplate) {\n            var introContainer = this.createElement('div', { attrs: { class: 'e-banner-view' } });\n            this.updateContent(bannerTemplate, introContainer, {}, templateName);\n            parentElement.prepend(introContainer);\n        }\n    };\n    InterActiveChatBase.prototype.updateContent = function (template, contentElement, context, templateName) {\n        if (this.isReact) {\n            this.clearTemplate([templateName]);\n        }\n        var notCompile = !(this.isReact || this.isVue);\n        var ctn = this.getTemplateFunction(template, notCompile);\n        if (typeof ctn === 'string') {\n            contentElement.innerHTML = ctn;\n        }\n        else {\n            append(ctn(context, this), contentElement);\n        }\n        this.renderReactTemplates();\n    };\n    InterActiveChatBase.prototype.renderFooterContent = function (footerTemplate, footer, prompt, promptPlaceholder, showClearButton, rowCount, className) {\n        if (footerTemplate) {\n            this.updateContent(footerTemplate, footer, {}, 'footerTemplate');\n            return null;\n        }\n        else {\n            var textareaEle = this.createElement('textarea', { attrs: { class: className } });\n            footer.appendChild(textareaEle);\n            return this.renderFooter(textareaEle, prompt, promptPlaceholder, showClearButton, rowCount);\n        }\n    };\n    InterActiveChatBase.prototype.renderFooter = function (textareaElement, prompt, promptPlaceholder, showClearButton, rowCount) {\n        if (showClearButton === void 0) { showClearButton = false; }\n        var textareaObj = new TextArea({\n            rows: rowCount,\n            cols: 300,\n            cssClass: rowCount >= 10 ? 'show-scrollbar' : 'hide-scrollbar',\n            placeholder: promptPlaceholder,\n            resizeMode: 'None',\n            value: prompt,\n            showClearButton: showClearButton\n        });\n        textareaObj.appendTo(textareaElement);\n        return textareaObj;\n    };\n    InterActiveChatBase.prototype.renderSendIcon = function (sendIconClass, footer) {\n        var sendIcon = this.createElement('span', { attrs: { class: sendIconClass, role: 'button', 'aria-label': 'Submit', tabindex: '0' } });\n        footer.appendChild(sendIcon);\n        return sendIcon;\n    };\n    InterActiveChatBase.prototype.appendChildren = function (target) {\n        var children = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            children[_i - 1] = arguments[_i];\n        }\n        target.append.apply(target, children);\n    };\n    InterActiveChatBase.prototype.insertBeforeChildren = function (target) {\n        var children = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            children[_i - 1] = arguments[_i];\n        }\n        target.prepend.apply(target, children);\n    };\n    InterActiveChatBase.prototype.wireFooterEvents = function (sendIcon, footer, footerTemplate) {\n        if (sendIcon) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            EventHandler.add(sendIcon, 'click', this.onSendIconClick, this);\n        }\n        if (footer && !footerTemplate) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            EventHandler.add(footer, 'keydown', this.footerKeyHandler, this);\n        }\n    };\n    InterActiveChatBase.prototype.unWireFooterEvents = function (sendIcon, footer, footerTemplate) {\n        if (sendIcon) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            EventHandler.remove(sendIcon, 'click', this.onSendIconClick);\n        }\n        if (footer && !footerTemplate) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            EventHandler.remove(footer, 'keydown', this.footerKeyHandler);\n        }\n    };\n    InterActiveChatBase.prototype.removeAndNullify = function (element) {\n        if (element) {\n            if (!isNOU(element.parentNode)) {\n                remove(element);\n            }\n            else {\n                element.innerHTML = '';\n            }\n        }\n    };\n    // eslint-disable-next-line  @typescript-eslint/no-explicit-any\n    InterActiveChatBase.prototype.destroyAndNullify = function (obj) {\n        if (obj) {\n            obj.destroy();\n            obj = null;\n        }\n    };\n    /**\n     * Gets template content based on the template property value.\n     *\n     * @param {string | Function} template - Template property value.\n     * @param {boolean} notCompile - Compile property value.\n     * @returns {Function} - Return template function.\n     * @hidden\n     */\n    InterActiveChatBase.prototype.getTemplateFunction = function (template, notCompile) {\n        if (typeof template === 'string') {\n            var content = '';\n            try {\n                var tempEle = select(template);\n                if (tempEle) {\n                    //Return innerHTML incase of jsrenderer script else outerHTML\n                    content = tempEle.tagName === 'SCRIPT' ? tempEle.innerHTML : tempEle.outerHTML;\n                    notCompile = false;\n                }\n                else {\n                    content = template;\n                }\n            }\n            catch (e) {\n                content = template;\n            }\n            return notCompile ? content : compile(content);\n        }\n        else {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            return compile(template);\n        }\n    };\n    /**\n     * This method is abstract member of the Component<HTMLElement>.\n     *\n     * @param  {InterActiveChatBaseModel} newProp - Specifies new properties\n     * @param  {InterActiveChatBaseModel} oldProp - Specifies old properties\n     * @private\n     * @returns {void}\n     */\n    // eslint-disable-next-line @typescript-eslint/no-empty-function, @typescript-eslint/no-unused-vars\n    InterActiveChatBase.prototype.onPropertyChanged = function (newProp, oldProp) {\n    };\n    __decorate([\n        Event()\n    ], InterActiveChatBase.prototype, \"created\", void 0);\n    InterActiveChatBase = __decorate([\n        NotifyPropertyChanges\n    ], InterActiveChatBase);\n    return InterActiveChatBase;\n}(Component));\nexport { InterActiveChatBase };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n///<reference path='../interactive-chat-base/interactive-chat-base-model.d.ts'/>\nimport { EventHandler, Property, NotifyPropertyChanges, Collection, Event, remove, L10n } from '@syncfusion/ej2-base';\nimport { ChildProperty, getUniqueID, isNullOrUndefined as isNOU, Complex, removeClass, addClass } from '@syncfusion/ej2-base';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { InterActiveChatBase, ToolbarSettings, ToolbarItem } from '../interactive-chat-base/interactive-chat-base';\nvar ASSISTHEADER = 'e-aiassist-header-text e-assist-view-header';\n/* eslint-enable @typescript-eslint/no-misused-new, no-redeclare */\n/**\n * The prompts property maps the list of the prompts and binds the data to the suggestions.\n */\nvar Prompt = /** @class */ (function (_super) {\n    __extends(Prompt, _super);\n    function Prompt() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], Prompt.prototype, \"prompt\", void 0);\n    __decorate([\n        Property('')\n    ], Prompt.prototype, \"response\", void 0);\n    __decorate([\n        Property(null)\n    ], Prompt.prototype, \"isResponseHelpful\", void 0);\n    return Prompt;\n}(ChildProperty));\nexport { Prompt };\n/**\n * Specifies the type of assist view.\n */\nexport var AssistViewType;\n(function (AssistViewType) {\n    /**\n     * Represents the default assist view type.\n     */\n    AssistViewType[\"Assist\"] = \"Assist\";\n    /**\n     * Represents a custom assist view type.\n     */\n    AssistViewType[\"Custom\"] = \"Custom\";\n})(AssistViewType || (AssistViewType = {}));\n/**\n * The assistView property maps the customized AiAssistView.\n */\nvar AssistView = /** @class */ (function (_super) {\n    __extends(AssistView, _super);\n    function AssistView() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Assist')\n    ], AssistView.prototype, \"type\", void 0);\n    __decorate([\n        Property('')\n    ], AssistView.prototype, \"name\", void 0);\n    __decorate([\n        Property()\n    ], AssistView.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property()\n    ], AssistView.prototype, \"viewTemplate\", void 0);\n    return AssistView;\n}(ChildProperty));\nexport { AssistView };\n/**\n * The promptToolbarSettings property maps the list of the promptToolbarSettings and binds the data to the prompt.\n */\nvar PromptToolbarSettings = /** @class */ (function (_super) {\n    __extends(PromptToolbarSettings, _super);\n    function PromptToolbarSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('100%')\n    ], PromptToolbarSettings.prototype, \"width\", void 0);\n    __decorate([\n        Collection([], ToolbarItem)\n    ], PromptToolbarSettings.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], PromptToolbarSettings.prototype, \"itemClicked\", void 0);\n    return PromptToolbarSettings;\n}(ChildProperty));\nexport { PromptToolbarSettings };\n/**\n * The responseToolbarSettings property maps the list of the responseToolbarSettings and binds the data to the output items.\n */\nvar ResponseToolbarSettings = /** @class */ (function (_super) {\n    __extends(ResponseToolbarSettings, _super);\n    function ResponseToolbarSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('100%')\n    ], ResponseToolbarSettings.prototype, \"width\", void 0);\n    __decorate([\n        Collection([], ToolbarItem)\n    ], ResponseToolbarSettings.prototype, \"items\", void 0);\n    __decorate([\n        Event()\n    ], ResponseToolbarSettings.prototype, \"itemClicked\", void 0);\n    return ResponseToolbarSettings;\n}(ChildProperty));\nexport { ResponseToolbarSettings };\n/**\n * The `AIAssistView` component is designed to enhance user interaction by integrating AI driven assistance features.\n * It provides a seamless interface for incorporating suggestions & AI responses.\n *\n * ```html\n *  <div id='defaultAIAssistView'></div>\n * ```\n * ```typescript\n *  let aiAssistObj: AIAssistView = new AIAssistView();\n *  aiAssistObj.appendTo('#defaultAIAssistView');\n * ```\n */\nvar AIAssistView = /** @class */ (function (_super) {\n    __extends(AIAssistView, _super);\n    /**\n     * Constructor for creating the component\n     *\n     * @param {AIAssistViewModel} options - Specifies the AIAssistViewModel model.\n     * @param {string | HTMLElement} element - Specifies the element to render as component.\n     * @private\n     */\n    function AIAssistView(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        _this.toolbarItems = [];\n        _this.displayContents = [];\n        _this.preTagElements = [];\n        return _this;\n    }\n    /**\n     * Initialize the event handler\n     *\n     * @private\n     * @returns {void}\n     */\n    AIAssistView.prototype.preRender = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('e-' + this.getModuleName());\n        }\n    };\n    AIAssistView.prototype.getDirective = function () {\n        return 'EJS-AIASSISTVIEW';\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - It returns the current module name.\n     * @private\n     */\n    AIAssistView.prototype.getModuleName = function () {\n        return 'aiassistview';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @private\n     * @returns {string} - It returns the persisted data.\n     */\n    AIAssistView.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    AIAssistView.prototype.render = function () {\n        this.renderPromptView();\n    };\n    AIAssistView.prototype.renderPromptView = function () {\n        this.setDimension(this.element, this.width, this.height);\n        this.renderViews();\n        this.renderToolbar();\n        this.wireEvents();\n    };\n    AIAssistView.prototype.renderToolbar = function () {\n        this.updateHeaderToolbar();\n        if (this.assistViewTemplateIndex < 0) {\n            this.displayContents.unshift(this.contentWrapper);\n        }\n        else {\n            this.displayContents.unshift(this.assistCustomSection);\n        }\n        this.previousElement = this.displayContents[this.activeView];\n        this.renderHeaderToolbar();\n        this.viewWrapper = this.element.querySelector('.e-view-content');\n        this.updateActiveView();\n        this.addCssClass(this.element, this.cssClass);\n        this.updateHeader(this.showHeader, this.toolbarHeader, this.viewWrapper);\n        this.aiAssistViewRendered = true;\n        this.addRtlClass(this.element, this.enableRtl);\n    };\n    AIAssistView.prototype.renderViews = function () {\n        this.assistViewTemplateIndex = -1;\n        this.aiAssistViewRendered = false;\n        this.isAssistView = false;\n        this.isOutputRenderingStop = false;\n        this.isResponseRequested = false;\n        this.renderViewSections(this.element, 'e-view-header', 'e-view-content');\n        var isAssistViewAssigned = false;\n        var assistView;\n        var customViewTemplate;\n        var customViewCount = 1;\n        if (this.views.length > 0) {\n            for (var index = 0; index < this.views.length; index++) {\n                if (this.views[parseInt(index.toString(), 10)].type.toLocaleLowerCase() === 'assist' && !isAssistViewAssigned) {\n                    assistView = {\n                        text: this.views[parseInt(index.toString(), 10)].name || 'AI Assist',\n                        prefixIcon: this.views[parseInt(index.toString(), 10)].iconCss || 'e-icons e-assistview-icon',\n                        cssClass: ASSISTHEADER,\n                        htmlAttributes: { 'data-index': this.element.id + '_view_0' }\n                    };\n                    this.toolbarItems.unshift(assistView);\n                    if (this.views[parseInt(index.toString(), 10)].viewTemplate) {\n                        this.assistViewTemplateIndex = index;\n                    }\n                    isAssistViewAssigned = true;\n                    this.isAssistView = true;\n                }\n                else if (this.views[parseInt(index.toString(), 10)].type.toLocaleLowerCase() === 'custom') {\n                    customViewTemplate = this.createElement('div', { attrs: { class: 'e-customview-content-section-' + customViewCount + ' e-custom-view' } });\n                    this.getContextObject('customViewTemplate', customViewTemplate, -1, index);\n                    this.displayContents.push(customViewTemplate);\n                    this.toolbarItems.push({\n                        text: this.views[parseInt(index.toString(), 10)].name || '',\n                        prefixIcon: this.views[parseInt(index.toString(), 10)].iconCss || '',\n                        cssClass: 'e-aiassist-header-text e-custom-view-header',\n                        htmlAttributes: { 'data-index': this.element.id + '_view_' + customViewCount.toString() }\n                    });\n                    customViewCount++;\n                }\n            }\n        }\n        if (this.views.length === 0 || !isAssistViewAssigned) {\n            assistView = {\n                text: 'AI Assist',\n                prefixIcon: 'e-icons e-assistview-icon',\n                cssClass: ASSISTHEADER,\n                htmlAttributes: { 'data-index': this.element.id + '_view_0' }\n            };\n            this.toolbarItems.unshift(assistView);\n            isAssistViewAssigned = true;\n        }\n        if (this.assistViewTemplateIndex >= 0 && this.views[this.assistViewTemplateIndex].viewTemplate) {\n            this.assistCustomSection = this.createElement('div', { attrs: { class: 'e-assistview-content-section', 'data-index': this.element.id + '_view_0' } });\n            this.getContextObject('assistViewTemplate', this.assistCustomSection, -1, this.assistViewTemplateIndex);\n        }\n        else {\n            this.renderDefaultView();\n        }\n    };\n    AIAssistView.prototype.renderHeaderToolbar = function () {\n        var _this = this;\n        this.toolbar = new Toolbar({\n            items: this.toolbarItems,\n            height: '100%',\n            clicked: function (args) {\n                var eventItemArgs = {\n                    type: args.item.type,\n                    text: args.item.text,\n                    iconCss: args.item.prefixIcon,\n                    cssClass: args.item.cssClass,\n                    tooltip: args.item.tooltipText,\n                    template: args.item.template,\n                    disabled: args.item.disabled,\n                    visible: args.item.visible,\n                    align: args.item.align,\n                    tabIndex: args.item.tabIndex\n                };\n                var eventArgs = {\n                    item: eventItemArgs,\n                    event: args.originalEvent,\n                    cancel: false\n                };\n                if (_this.toolbarSettings.itemClicked) {\n                    _this.toolbarSettings.itemClicked.call(_this, eventArgs);\n                }\n                if (!eventArgs.cancel) {\n                    if (args.item.htmlAttributes) {\n                        var currentIndex = parseInt(args.item.htmlAttributes['data-index'].split(_this.element.id + '_view_')[1], 10);\n                        if (currentIndex !== _this.activeView) {\n                            var prevOnChange = _this.isProtectedOnChange;\n                            _this.isProtectedOnChange = true;\n                            var previousIndex = _this.getIndex(_this.activeView);\n                            _this.activeView = parseInt(args.item.htmlAttributes['data-index'].split(_this.element.id + '_view_')[1], 10);\n                            _this.updateActiveView(previousIndex);\n                            _this.isProtectedOnChange = prevOnChange;\n                        }\n                    }\n                }\n            }\n        });\n        this.toolbarHeader = this.element.querySelector('.e-view-header');\n        var toolbarEle = this.createElement('div');\n        this.toolbar.appendTo(toolbarEle);\n        this.toolbar.element.setAttribute('aria-label', 'assist-view-toolbar-header');\n        this.toolbarHeader.appendChild(toolbarEle);\n    };\n    AIAssistView.prototype.updateHeaderToolbar = function () {\n        if (this.toolbarSettings.items.length > 0) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var pushToolbar = this.toolbarSettings.items.map(function (item) { return ({\n                type: item.type,\n                template: item.template,\n                disabled: item.disabled,\n                cssClass: item.cssClass,\n                visible: item.visible,\n                tooltipText: item.tooltip,\n                prefixIcon: item.iconCss,\n                text: item.text,\n                align: item.align\n            }); });\n            this.toolbarItems = this.toolbarItems.concat(pushToolbar);\n        }\n    };\n    AIAssistView.prototype.getIndex = function (currentIndex) {\n        return (((currentIndex) > (this.views.length - (this.isAssistView ? 1 : 0))) || (currentIndex < 0)) ?\n            0 : currentIndex;\n    };\n    AIAssistView.prototype.updateActiveView = function (previousIndex) {\n        var activeViewIndex = this.getIndex(this.activeView);\n        if (!this.aiAssistViewRendered) {\n            this.appendView(activeViewIndex);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.toolbar.tbarEle[parseInt(activeViewIndex.toString(), 10)]) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                this.toolbar.tbarEle[parseInt(activeViewIndex.toString(), 10)].classList.add('e-active');\n            }\n        }\n        else if (previousIndex !== activeViewIndex) {\n            this.removePreviousView(previousIndex, activeViewIndex);\n            this.appendView(activeViewIndex);\n        }\n        this.previousElement = this.displayContents[parseInt(activeViewIndex.toString(), 10)];\n    };\n    AIAssistView.prototype.appendView = function (activeViewIndex) {\n        //updating the new view section according to the activeView property\n        if (activeViewIndex === 0 && this.assistViewTemplateIndex < 0) {\n            this.viewWrapper.append(this.contentWrapper, this.stopResponding, this.footer);\n        }\n        else if (activeViewIndex === 0 && this.assistViewTemplateIndex >= 0) {\n            this.viewWrapper.append(this.assistCustomSection);\n        }\n        else {\n            this.viewWrapper.append(this.displayContents[parseInt(activeViewIndex.toString(), 10)]);\n        }\n    };\n    AIAssistView.prototype.removePreviousView = function (previousIndex, activeViewIndex) {\n        // removing the previously binded element\n        this.viewWrapper.removeChild(this.previousElement);\n        if (previousIndex === 0 && this.assistViewTemplateIndex < 0) {\n            this.viewWrapper.removeChild(this.stopResponding);\n            this.viewWrapper.removeChild(this.footer);\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (this.toolbar.tbarEle[parseInt(activeViewIndex.toString(), 10)]) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.toolbar.tbarEle[parseInt(activeViewIndex.toString(), 10)].classList.add('e-active');\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (previousIndex >= 0 && this.toolbar.tbarEle[parseInt(previousIndex.toString(), 10)]) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.toolbar.tbarEle[parseInt(previousIndex.toString(), 10)].classList.remove('e-active');\n        }\n    };\n    AIAssistView.prototype.renderDefaultView = function () {\n        var viewWrapper = this.element.querySelector('.e-view-content');\n        this.createViewComponents(viewWrapper);\n        this.contentWrapper = this.element.querySelector('.e-views');\n        this.contentWrapper.setAttribute('data-index', this.element.id + '_view_0');\n        var contentContainer = this.element.querySelector('.e-view-container');\n        this.content = this.getElement('contentContainer');\n        this.footer = this.getElement('footer');\n        var footerClass = \"e-footer \" + (this.footerTemplate ? 'e-footer-template' : '');\n        this.footer.className = footerClass;\n        this.renderContent();\n        this.renderAssistViewFooter();\n        this.renderBannerView(this.bannerTemplate, contentContainer, 'bannerTemplate');\n        contentContainer.append(this.content);\n        this.renderStopResponding();\n    };\n    AIAssistView.prototype.renderStopResponding = function () {\n        this.stopResponding = this.createElement('div', { attrs: { class: 'e-stop-response', tabIndex: '0', 'aria-label': 'Stop Responding', role: 'button' } });\n        var stopRespondingIcon = this.createElement('span', { attrs: { class: 'e-icons e-assist-stop' } });\n        this.stopRespondingContent = this.createElement('span', { attrs: { class: 'e-stop-response-text' } });\n        this.l10n = new L10n('aiassistview', { stopResponseText: 'Stop Responding' }, this.locale);\n        this.updateStopRespondingTitle();\n        this.appendChildren(this.stopResponding, stopRespondingIcon, this.stopRespondingContent);\n    };\n    AIAssistView.prototype.updateStopRespondingTitle = function () {\n        this.l10n.setLocale(this.locale);\n        this.stopRespondingContent.textContent = this.l10n.getConstant('stopResponseText');\n    };\n    AIAssistView.prototype.renderContent = function () {\n        this.renderSuggestions(this.promptSuggestions, this.promptSuggestionsHeader, this.promptSuggestionItemTemplate, 'promptSuggestion', 'promptSuggestionItemTemplate', this.onSuggestionClick);\n        this.renderOutputContent();\n        if (this.outputElement) {\n            this.renderSkeleton();\n        }\n    };\n    AIAssistView.prototype.renderOutputContent = function (isMethodCall) {\n        var _this = this;\n        this.outputElement = this.getElement('outputElement');\n        if (this.responseToolbarSettings.items.length === 0) {\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.responseToolbarSettings.items = [\n                { iconCss: 'e-icons e-assist-copy', tooltip: 'Copy', cssClass: 'check' },\n                { iconCss: 'e-icons e-assist-like', tooltip: 'Like' },\n                { iconCss: 'e-icons e-assist-dislike', tooltip: 'Dislike' }\n            ];\n            this.isProtectedOnChange = prevOnChange;\n        }\n        if (this.prompts) {\n            this.prompts.forEach(function (prompt, i) {\n                _this.renderOutputContainer(prompt.prompt, prompt.response, i);\n            });\n        }\n        if (this.suggestionsElement && this.content.contains(this.suggestionsElement)) {\n            this.content.insertBefore(this.outputElement, this.suggestionsElement);\n        }\n        else {\n            this.content.appendChild(this.outputElement);\n        }\n        if (isMethodCall) {\n            this.aiAssistViewRendered = true;\n        }\n    };\n    AIAssistView.prototype.renderAssistViewFooter = function () {\n        this.textareaObj = this.renderFooterContent(this.footerTemplate, this.footer, this.prompt, this.promptPlaceholder, this.showClearButton, this.getRowCount(this.prompt), 'e-assist-textarea');\n        var sendIconClass = 'e-assist-send e-icons disabled';\n        if (!this.footerTemplate) {\n            this.sendIcon = this.renderSendIcon(sendIconClass, this.footer);\n        }\n        if (this.textareaObj) {\n            this.textareaObj.input = this.handleInput.bind(this);\n            this.activateSendIcon(this.textareaObj.value.length);\n        }\n    };\n    AIAssistView.prototype.handleInput = function (args) {\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        this.prompt = args.value;\n        this.isProtectedOnChange = prevOnChange;\n        this.activateSendIcon(args.value.length);\n        this.updateTextAreaObject(args.value);\n        var eventArgs = {\n            value: args.value,\n            previousValue: args.previousValue,\n            event: args.event,\n            element: this.textareaObj.element\n        };\n        this.trigger('promptChanged', eventArgs);\n    };\n    AIAssistView.prototype.updateTextAreaObject = function (textValue) {\n        var rowCount = this.getRowCount(textValue);\n        this.textareaObj.rows = rowCount;\n        this.textareaObj.cssClass = (rowCount >= 10) ? 'show-scrollbar' : 'hide-scrollbar';\n    };\n    AIAssistView.prototype.getRowCount = function (textValue) {\n        var lines = textValue.split('\\n').length;\n        return (lines < 10 ? (lines >= 1 ? lines : 1) : 10);\n    };\n    AIAssistView.prototype.activateSendIcon = function (value) {\n        this.sendIcon.classList.toggle('disabled', value === 0);\n        this.sendIcon.classList.toggle('enabled', value > 0);\n    };\n    AIAssistView.prototype.footerKeyHandler = function (e) {\n        this.keyHandler(e, 'footer');\n    };\n    AIAssistView.prototype.stopResponseKeyHandler = function (e) {\n        this.keyHandler(e, 'stopresponse');\n    };\n    AIAssistView.prototype.wireEvents = function () {\n        this.wireFooterEvents(this.sendIcon, this.footer, this.footerTemplate);\n        if (this.stopResponding) {\n            EventHandler.add(this.stopResponding, 'click', this.respondingStopper, this);\n            EventHandler.add(this.stopResponding, 'keydown', this.stopResponseKeyHandler, this);\n        }\n    };\n    AIAssistView.prototype.unWireEvents = function () {\n        this.unWireFooterEvents(this.sendIcon, this.footer, this.footerTemplate);\n        if (this.stopResponding) {\n            EventHandler.remove(this.stopResponding, 'click', this.respondingStopper);\n            EventHandler.remove(this.stopResponding, 'keydown', this.stopResponseKeyHandler);\n        }\n        this.detachCodeCopyEventHandler();\n    };\n    AIAssistView.prototype.detachCodeCopyEventHandler = function () {\n        this.preTagElements.forEach(function (_a) {\n            var preTag = _a.preTag, handler = _a.handler;\n            var copyIcon = preTag.querySelector('.e-code-copy');\n            EventHandler.remove(copyIcon, 'click', handler);\n        });\n        this.preTagElements = [];\n    };\n    AIAssistView.prototype.keyHandler = function (event, value) {\n        if (event.key === 'Enter' && !event.shiftKey) {\n            switch (value) {\n                case 'footer':\n                    event.preventDefault();\n                    if (!this.isResponseRequested) {\n                        this.textareaObj.value = '';\n                        this.updateTextAreaObject(this.textareaObj.value);\n                        this.onSendIconClick();\n                    }\n                    break;\n                case 'stopresponse':\n                    this.respondingStopper();\n                    break;\n            }\n        }\n    };\n    AIAssistView.prototype.respondingStopper = function () {\n        this.isOutputRenderingStop = true;\n        this.isResponseRequested = false;\n        if (this.outputElement.hasChildNodes) {\n            this.outputElement.removeChild(this.skeletonContainer);\n        }\n        this.stopResponding.classList.remove('e-btn-active');\n    };\n    AIAssistView.prototype.onSuggestionClick = function (e) {\n        this.suggestionsElement.hidden = true;\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        this.prompt = e.target.innerText;\n        this.isProtectedOnChange = prevOnChange;\n        this.onSendIconClick();\n    };\n    AIAssistView.prototype.onSendIconClick = function () {\n        if (this.isResponseRequested || !this.prompt.trim()) {\n            return;\n        }\n        this.isResponseRequested = true;\n        if (this.suggestionsElement) {\n            this.suggestionsElement.hidden = true;\n        }\n        this.isOutputRenderingStop = false;\n        this.stopResponding.classList.add('e-btn-active');\n        this.addPrompt();\n        this.createOutputElement();\n        var eventArgs = {\n            cancel: false,\n            responseToolbarItems: this.responseToolbarSettings.items,\n            prompt: this.prompt,\n            promptSuggestions: this.promptSuggestions\n        };\n        if (!this.footerTemplate) {\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.prompt = this.textareaObj.value = '';\n            this.isProtectedOnChange = prevOnChange;\n            this.updateTextAreaObject(this.textareaObj.value);\n            this.activateSendIcon(this.textareaObj.value.length);\n        }\n        this.trigger('promptRequest', eventArgs);\n        if (this.contentWrapper) {\n            this.updateScroll(this.contentWrapper);\n        }\n    };\n    AIAssistView.prototype.addPrompt = function () {\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        this.prompts = this.prompts.concat([{ prompt: this.prompt, response: null, isResponseHelpful: null }]);\n        this.isProtectedOnChange = prevOnChange;\n    };\n    AIAssistView.prototype.getContextObject = function (templateName, contentElement, index, arrayPosition) {\n        var template;\n        var context = {};\n        var contextIndex = index >= 0 ? index : -1;\n        var contextPrompt = index >= 0 ? this.prompts[parseInt(contextIndex.toString(), 10)].prompt : '';\n        var contextOutput = index >= 0 ? this.prompts[parseInt(contextIndex.toString(), 10)].response : '';\n        switch (templateName.toLowerCase()) {\n            case 'promptitemtemplate': {\n                template = this.promptItemTemplate;\n                context = { prompt: contextPrompt, toolbarItems: this.promptToolbarSettings.items, index: contextIndex };\n                break;\n            }\n            case 'responseitemtemplate': {\n                template = this.responseItemTemplate;\n                context = {\n                    prompt: contextPrompt,\n                    response: contextOutput,\n                    index: contextIndex,\n                    toolbarItems: this.responseToolbarSettings.items,\n                    output: contextOutput\n                };\n                break;\n            }\n            case 'customviewtemplate':\n            case 'assistviewtemplate': {\n                template = this.views[parseInt(arrayPosition.toString(), 10)].viewTemplate || '';\n                break;\n            }\n        }\n        this.updateContent(template, contentElement, context, templateName);\n    };\n    AIAssistView.prototype.createOutputElement = function () {\n        this.outputSuggestionEle = this.createElement('div', { attrs: { id: \"e-prompt-item_\" + (this.prompts.length - 1), class: \"e-prompt-container \" + (this.promptItemTemplate ? 'e-prompt-item-template' : '') } });\n        this.renderPrompt(this.prompt, this.prompts.length - 1);\n        this.outputElement.append(this.outputSuggestionEle, this.skeletonContainer);\n        this.skeletonContainer.hidden = false;\n    };\n    AIAssistView.prototype.renderOutputContainer = function (promptText, outputText, index, isMethodCall) {\n        var outputContainer = this.createElement('div', { attrs: { id: \"e-response-item_\" + index, class: \"e-output-container \" + (this.responseItemTemplate ? 'e-response-item-template' : '') } });\n        this.renderOutput(outputContainer, promptText, outputText, isMethodCall, index);\n        if (promptText) {\n            this.outputElement.append(this.outputSuggestionEle);\n        }\n        this.outputElement.append(outputContainer);\n        if (this.stopResponding) {\n            this.stopResponding.classList.remove('e-btn-active');\n        }\n        if (!this.isOutputRenderingStop && !this.content.contains(this.suggestionsElement) && this.suggestionsElement) {\n            this.content.append(this.suggestionsElement);\n        }\n    };\n    AIAssistView.prototype.renderOutput = function (outputContainer, promptText, outputText, isMethodCall, index) {\n        var promptIcon = this.createElement('span', { attrs: {\n                class: 'e-output-icon e-icons ' + (this.responseIconCss || (this.isAssistView && this.views[0].iconCss) || 'e-assistview-icon')\n            } });\n        var aiOutputEle = this.createElement('div', { attrs: { class: 'e-output' } });\n        if (!this.aiAssistViewRendered || isMethodCall) {\n            if (!isNOU(promptText)) {\n                this.outputSuggestionEle = this.createElement('div', { attrs: { id: \"e-prompt-item_\" + index, class: \"e-prompt-container \" + (this.promptItemTemplate ? 'e-prompt-item-template' : '') } });\n                this.renderPrompt(promptText, index);\n            }\n        }\n        var lastPrompt = { prompt: promptText, response: outputText };\n        if (lastPrompt.response) {\n            if (this.responseItemTemplate) {\n                this.getContextObject('responseItemTemplate', aiOutputEle, index);\n                if (this.outputElement.querySelector('.e-skeleton')) {\n                    this.outputElement.removeChild(this.skeletonContainer);\n                }\n                if (this.contentFooterEle) {\n                    this.contentFooterEle.classList.remove('e-assist-toolbar-active');\n                }\n                this.renderOutputToolbarItems(index);\n                aiOutputEle.append(this.contentFooterEle);\n                outputContainer.append(aiOutputEle);\n            }\n            else {\n                this.renderOutputTextContainer(lastPrompt.response, aiOutputEle, index);\n                outputContainer.append(promptIcon, aiOutputEle);\n            }\n        }\n        else if (this.aiAssistViewRendered) {\n            if (this.outputElement.querySelector('.e-skeleton')) {\n                this.outputElement.removeChild(this.skeletonContainer);\n            }\n            if (this.suggestionsElement) {\n                this.suggestionsElement.hidden = false;\n            }\n        }\n    };\n    AIAssistView.prototype.renderOutputTextContainer = function (response, aiOutputEle, index, isMethodCall) {\n        var _this = this;\n        if (this.contentFooterEle) {\n            this.contentFooterEle.classList.remove('e-assist-toolbar-active');\n        }\n        this.outputContentBodyEle = this.createElement('div', { attrs: { class: 'e-content-body', tabindex: '0' } });\n        if (!isMethodCall) {\n            this.outputContentBodyEle.innerHTML = response;\n            var preTags = Array.from(this.outputContentBodyEle.querySelectorAll('pre'));\n            preTags.forEach(function (preTag) {\n                var copyIcon = document.createElement('span');\n                copyIcon.className = 'e-icons e-code-copy e-assist-copy';\n                preTag.insertBefore(copyIcon, preTag.firstChild);\n                _this.preTagElements.push({ preTag: preTag, handler: _this.getCopyHandler(preTag) });\n                EventHandler.add(copyIcon, 'click', _this.preTagElements[_this.preTagElements.length - 1].handler);\n            });\n        }\n        this.renderOutputToolbarItems(index);\n        this.appendChildren(aiOutputEle, this.outputContentBodyEle, this.contentFooterEle);\n    };\n    AIAssistView.prototype.getCopyHandler = function (preTag) {\n        return function () {\n            var preText = preTag.innerText;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            window.navigator.clipboard.writeText(preText);\n            var copyIcon = preTag.querySelector('.e-code-copy');\n            copyIcon.className = 'e-icons e-code-copy e-assist-check';\n            setTimeout(function () {\n                copyIcon.className = 'e-icons e-code-copy e-assist-copy';\n            }, 1000);\n        };\n    };\n    AIAssistView.prototype.renderOutputToolbarItems = function (index) {\n        this.contentFooterEle = this.createElement('div', { attrs: { class: 'e-content-footer e-assist-toolbar-active' } });\n        var footerContent = this.createElement('div');\n        this.renderResponseToolbar(index);\n        if (this.aiAssistViewRendered) {\n            if (this.outputElement.querySelector('.e-skeleton')) {\n                this.outputElement.removeChild(this.skeletonContainer);\n            }\n            if (this.suggestionsElement) {\n                this.suggestionsElement.hidden = false;\n            }\n        }\n        this.responseToolbarEle.appendTo(footerContent);\n        this.responseToolbarEle.element.setAttribute('aria-label', \"response-toolbar-\" + index);\n        this.contentFooterEle.appendChild(footerContent);\n    };\n    AIAssistView.prototype.renderResponseToolbar = function (index) {\n        var _this = this;\n        var pushToolbar = this.responseToolbarSettings.items.map(function (item) {\n            var toolbarItem = {\n                type: item.type,\n                visible: item.visible,\n                disabled: item.disabled,\n                tooltipText: item.tooltip,\n                template: item.template,\n                prefixIcon: item.iconCss,\n                text: item.text,\n                cssClass: item.cssClass,\n                align: item.align,\n                width: _this.responseToolbarSettings.width\n            };\n            if (toolbarItem.prefixIcon === 'e-icons e-assist-like' && _this.prompts[parseInt(index.toString(), 10)].isResponseHelpful) {\n                toolbarItem.prefixIcon = 'e-icons e-assist-like-filled';\n            }\n            else if (toolbarItem.prefixIcon === 'e-icons e-assist-dislike' && _this.prompts[parseInt(index.toString(), 10)].isResponseHelpful === false) {\n                toolbarItem.prefixIcon = 'e-icons e-assist-dislike-filled';\n            }\n            return toolbarItem;\n        });\n        this.responseToolbarEle = new Toolbar({\n            items: pushToolbar,\n            clicked: function (args) {\n                var eventItemArgs = {\n                    type: args.item.type,\n                    text: args.item.text,\n                    iconCss: args.item.prefixIcon,\n                    cssClass: args.item.cssClass,\n                    tooltip: args.item.tooltipText,\n                    template: args.item.template,\n                    disabled: args.item.disabled,\n                    visible: args.item.visible,\n                    align: args.item.align,\n                    tabIndex: args.item.tabIndex\n                };\n                var eventArgs = {\n                    item: eventItemArgs,\n                    event: args.originalEvent,\n                    cancel: false,\n                    dataIndex: index\n                };\n                if (_this.responseToolbarSettings.itemClicked) {\n                    _this.responseToolbarSettings.itemClicked.call(_this, eventArgs);\n                }\n                if (!eventArgs.cancel) {\n                    _this.handleItemClick(args, index);\n                }\n            }\n        });\n    };\n    AIAssistView.prototype.getClipBoardContent = function (value) {\n        var tempElement = document.createElement('div');\n        tempElement.innerHTML = value;\n        tempElement.style.top = '0';\n        tempElement.style.left = '0';\n        tempElement.style.position = 'fixed';\n        tempElement.style.opacity = '0';\n        document.body.appendChild(tempElement);\n        navigator.clipboard.write([\n            new ClipboardItem({\n                'text/html': new Blob([tempElement.innerHTML], { type: 'text/html' }),\n                'text/plain': new Blob([tempElement.innerText], { type: 'text/plain' })\n            })\n        ]);\n        document.body.removeChild(tempElement);\n    };\n    AIAssistView.prototype.handleItemClick = function (args, index) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        args.item.controlParent.element.querySelector('.e-assist-dislike');\n        if (args.item.prefixIcon === 'e-icons e-assist-copy') {\n            this.getClipBoardContent(this.prompts[parseInt(index.toString(), 10)].response);\n            args.item.prefixIcon = 'e-icons e-assist-check';\n            this.responseToolbarEle.dataBind();\n            setTimeout(function () {\n                args.item.prefixIcon = 'e-icons e-assist-copy';\n                _this.responseToolbarEle.dataBind();\n            }, 1000);\n        }\n        var icon = args.item.prefixIcon;\n        var isLikeInteracted = icon === 'e-icons e-assist-like-filled' || icon === 'e-icons e-assist-like';\n        var isDislikeInteracted = icon === 'e-icons e-assist-dislike-filled' || icon === 'e-icons e-assist-dislike';\n        if (isLikeInteracted || isDislikeInteracted) {\n            var isHelpful = null;\n            if (isLikeInteracted) {\n                isHelpful = this.prompts[parseInt(index.toString(), 10)].isResponseHelpful === true ? null : true;\n            }\n            else if (isDislikeInteracted) {\n                isHelpful = this.prompts[parseInt(index.toString(), 10)].isResponseHelpful === false ? null : false;\n            }\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.prompts[parseInt(index.toString(), 10)].isResponseHelpful = isHelpful;\n            var promptItem = this.prompts[parseInt(index.toString(), 10)];\n            // eslint-disable-next-line  @typescript-eslint/no-explicit-any\n            var controlParentItems = args.item.controlParent.items;\n            if (isLikeInteracted) {\n                if (promptItem.isResponseHelpful === true) {\n                    args.item.prefixIcon = 'e-icons e-assist-like-filled';\n                    if (controlParentItems && controlParentItems.length > 2) {\n                        controlParentItems[2].prefixIcon = 'e-icons e-assist-dislike';\n                    }\n                }\n                else {\n                    args.item.prefixIcon = 'e-icons e-assist-like';\n                }\n            }\n            else if (isDislikeInteracted) {\n                if (promptItem.isResponseHelpful === false) {\n                    args.item.prefixIcon = 'e-icons e-assist-dislike-filled';\n                    if (controlParentItems && controlParentItems.length > 1) {\n                        controlParentItems[1].prefixIcon = 'e-icons e-assist-like';\n                    }\n                }\n                else {\n                    args.item.prefixIcon = 'e-icons e-assist-dislike';\n                }\n            }\n            this.responseToolbarEle.dataBind();\n            this.isProtectedOnChange = prevOnChange;\n        }\n    };\n    AIAssistView.prototype.renderPrompt = function (promptText, promptIndex) {\n        var outputPrompt = this.createElement('div', { attrs: { class: 'e-prompt-text', tabindex: '0' } });\n        var promptContent = this.createElement('div', { attrs: { class: 'e-prompt-content' } });\n        var promptToolbarContainer = this.createElement('div', { attrs: { class: 'e-prompt-toolbar' } });\n        var promptToolbar = this.createElement('div');\n        var userIcon = this.createElement('span', { attrs: { class: this.promptIconCss ? 'e-prompt-icon e-icons '\n                    + this.promptIconCss : '' } });\n        if (this.promptItemTemplate) {\n            this.getContextObject('promptItemTemplate', this.outputSuggestionEle, promptIndex);\n        }\n        else {\n            outputPrompt.innerHTML = promptText;\n            this.appendChildren(promptContent, outputPrompt);\n            if (this.promptIconCss) {\n                promptContent.appendChild(userIcon);\n            }\n            this.outputSuggestionEle.append(promptContent);\n        }\n        this.renderPromptToolbar(promptToolbar, promptIndex);\n        promptToolbarContainer.append(promptToolbar);\n        this.appendChildren(this.outputSuggestionEle, promptToolbarContainer);\n    };\n    AIAssistView.prototype.renderPromptToolbar = function (element, promptIndex) {\n        var _this = this;\n        var pushToolbar = [];\n        if (this.promptToolbarSettings.items.length === 0) {\n            pushToolbar = [\n                { prefixIcon: 'e-icons e-assist-edit', tooltipText: 'Edit' },\n                { prefixIcon: 'e-icons e-assist-copy', tooltipText: 'Copy' }\n            ];\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.promptToolbarSettings.items = [\n                { iconCss: 'e-icons e-assist-edit', tooltip: 'Edit' },\n                { iconCss: 'e-icons e-assist-copy', tooltip: 'Copy' }\n            ];\n            this.isProtectedOnChange = prevOnChange;\n        }\n        else {\n            pushToolbar = this.promptToolbarSettings.items.map(function (item) { return ({\n                type: item.type,\n                template: item.template,\n                disabled: item.disabled,\n                cssClass: item.cssClass,\n                visible: item.visible,\n                tooltipText: item.tooltip,\n                prefixIcon: item.iconCss,\n                text: item.text,\n                align: item.align,\n                width: _this.promptToolbarSettings.width\n            }); });\n        }\n        this.promptToolbarEle = new Toolbar({\n            items: pushToolbar,\n            clicked: function (args) {\n                var eventItemArgs = {\n                    type: args.item.type,\n                    text: args.item.text,\n                    iconCss: args.item.prefixIcon,\n                    cssClass: args.item.cssClass,\n                    tooltip: args.item.tooltipText,\n                    template: args.item.template,\n                    disabled: args.item.disabled,\n                    visible: args.item.visible,\n                    align: args.item.align,\n                    tabIndex: args.item.tabIndex\n                };\n                var eventArgs = {\n                    item: eventItemArgs,\n                    event: args.originalEvent,\n                    cancel: false,\n                    dataIndex: promptIndex\n                };\n                if (_this.promptToolbarSettings.itemClicked) {\n                    _this.promptToolbarSettings.itemClicked.call(_this, eventArgs);\n                }\n                if (!eventArgs.cancel) {\n                    if (args.item.prefixIcon === 'e-icons e-assist-edit') {\n                        _this.onEditIconClick(promptIndex);\n                    }\n                    if (args.item.prefixIcon === 'e-icons e-assist-copy') {\n                        _this.getClipBoardContent(_this.prompts[parseInt(promptIndex.toString(), 10)].prompt);\n                        args.item.prefixIcon = 'e-icons e-assist-check';\n                        _this.promptToolbarEle.dataBind();\n                        setTimeout(function () {\n                            args.item.prefixIcon = 'e-icons e-assist-copy';\n                            _this.promptToolbarEle.dataBind();\n                        }, 1000);\n                    }\n                }\n            }\n        });\n        this.promptToolbarEle.appendTo(element);\n        this.promptToolbarEle.element.setAttribute('aria-label', \"prompt-toolbar-\" + promptIndex);\n    };\n    AIAssistView.prototype.renderSkeleton = function () {\n        this.skeletonContainer = this.createElement('div', { attrs: { class: 'e-output-container' } });\n        var outputViewWrapper = this.createElement('div', { attrs: { class: 'e-output', style: 'width: 70%;' } });\n        var skeletonIconEle = this.createElement('span', { attrs: { class: 'e-output-icon e-skeleton e-skeleton-text e-shimmer-wave' } });\n        var skeletonBodyEle = this.createElement('div', { attrs: { class: 'e-loading-body' } });\n        var skeletonFooterEle = this.createElement('div', { attrs: { class: 'e-loading-footer' } });\n        var _a = [\n            this.createElement('div', { attrs: { class: 'e-skeleton e-skeleton-text e-shimmer-wave', style: 'width: 100%; height: 15px;' } }),\n            this.createElement('div', { attrs: { class: 'e-skeleton e-skeleton-text e-shimmer-wave', style: 'width: 75%; height: 15px;' } }),\n            this.createElement('div', { attrs: { class: 'e-skeleton e-skeleton-text e-shimmer-wave', style: 'width: 50%; height: 15px;' } })\n        ], skeletonLine1 = _a[0], skeletonLine2 = _a[1], skeletonLine3 = _a[2];\n        var footerSkeleton = [\n            this.createElement('div', { attrs: { class: 'e-skeleton e-skeleton-text e-shimmer-wave', style: 'width: 100%; height: 30px;' } })\n        ][0];\n        this.appendChildren(skeletonBodyEle, skeletonLine1, skeletonLine2, skeletonLine3);\n        skeletonFooterEle.append(footerSkeleton);\n        this.appendChildren(outputViewWrapper, skeletonBodyEle, skeletonFooterEle);\n        this.appendChildren(this.skeletonContainer, skeletonIconEle, outputViewWrapper);\n    };\n    AIAssistView.prototype.onEditIconClick = function (promptIndex) {\n        if (this.textareaObj) {\n            if (this.suggestionsElement) {\n                this.suggestionsElement.hidden = true;\n            }\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.textareaObj.value = this.prompt = this.prompts[parseInt(promptIndex.toString(), 10)].prompt;\n            this.updateTextAreaObject(this.textareaObj.value);\n            this.textareaObj.focusIn();\n            this.isProtectedOnChange = prevOnChange;\n            this.activateSendIcon(this.prompt.length);\n        }\n    };\n    AIAssistView.prototype.updateIcons = function (newCss, isPromptIconCss) {\n        if (isPromptIconCss === void 0) { isPromptIconCss = false; }\n        var elements;\n        if (this.outputElement) {\n            if (isPromptIconCss) {\n                newCss = 'e-prompt-icon e-icons ' + newCss;\n                elements = this.outputElement.querySelectorAll('.e-prompt-icon');\n            }\n            else {\n                newCss = ' e-output-icon e-icons ' + newCss;\n                elements = this.outputElement.querySelectorAll('.e-output-icon');\n            }\n        }\n        for (var index = 0; index < (elements && elements.length); index++) {\n            removeClass([elements[parseInt(index.toString(), 10)]], elements[parseInt(index.toString(), 10)].classList.toString().trim().split(' '));\n            addClass([elements[parseInt(index.toString(), 10)]], newCss.trim().split(' '));\n        }\n    };\n    AIAssistView.prototype.updateToolbarSettings = function (previousToolbar) {\n        var previousToolbarIndex = 0;\n        for (var index = this.views.length; index < this.toolbarItems.length; index++) {\n            if (previousToolbar.items[parseInt(previousToolbarIndex.toString(), 10)] === this.toolbarItems[parseInt(index.toString(), 10)]) {\n                this.toolbarItems.splice(index, 1);\n            }\n        }\n        this.updateHeaderToolbar();\n        this.toolbar.items = this.toolbarItems;\n    };\n    AIAssistView.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.unWireEvents();\n        this.destroyAndNullify(this.textareaObj);\n        this.destroyAndNullify(this.responseToolbarEle);\n        this.destroyAndNullify(this.promptToolbarEle);\n        this.destroyAndNullify(this.toolbar);\n        this.destroyAssistView();\n        //private html elements nullify\n        remove(this.viewWrapper);\n        this.viewWrapper = null;\n        this.aiAssistViewRendered = null;\n        this.assistViewTemplateIndex = null;\n        this.toolbarItems = [];\n        this.displayContents = [];\n        this.isOutputRenderingStop = null;\n        this.isResponseRequested = null;\n        this.suggestionHeader = null;\n        this.previousElement = null;\n        this.assistCustomSection = null;\n        this.preTagElements = [];\n        // properties nullify\n        this.toolbarSettings = this.promptToolbarSettings = this.responseToolbarSettings = {};\n        if (this.cssClass) {\n            removeClass([this.element], this.cssClass.split(' '));\n        }\n        this.element.classList.remove('e-rtl');\n    };\n    AIAssistView.prototype.destroyAssistView = function () {\n        var properties = [\n            'toolbarHeader',\n            'sendIcon',\n            'suggestions',\n            'skeletonContainer',\n            'outputElement',\n            'outputSuggestionEle',\n            'contentFooterEle',\n            'footer',\n            'assistCustomSection',\n            'content',\n            'stopRespondingContent',\n            'stopResponding',\n            'contentWrapper'\n        ];\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            var element = prop;\n            this.removeAndNullify(this[element]);\n            this[element] = null;\n        }\n    };\n    /**\n     * Executes the specified prompt in the AIAssistView component. The method accepts a string representing the prompt.\n     *\n     * @param {string} prompt - The prompt text to be executed. It must be a non-empty string.\n     *\n     * @returns {void}\n     */\n    AIAssistView.prototype.executePrompt = function (prompt) {\n        if (!isNOU(prompt) && prompt.trim().length > 0) {\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.prompt = prompt;\n            this.isProtectedOnChange = prevOnChange;\n            this.onSendIconClick();\n        }\n    };\n    /**\n     * Adds a response to the last prompt or appends a new Prompt data in the AIAssistView component.\n     *\n     * @param {string | Object} promptData - The response to be added. Can be a string representing the response or an object containing both the prompt and the response.\n     * - If `outputResponse` is a string, it updates the response for the last prompt in the prompts collection.\n     * - If `outputResponse` is an Object, it can either update the response of an existing prompt if the prompt matches or append a new Prompt data.\n     * @returns {void}\n     */\n    AIAssistView.prototype.addPromptResponse = function (promptData) {\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        if (!this.isOutputRenderingStop) {\n            if (typeof promptData === 'string') {\n                if (!this.isResponseRequested) {\n                    this.prompts = this.prompts.concat([{ prompt: null, response: null, isResponseHelpful: null }]);\n                }\n                this.prompts[this.prompts.length - 1].response = promptData;\n                this.renderOutputContainer(undefined, promptData, this.prompts.length - 1, false);\n            }\n            if (typeof promptData === 'object') {\n                var tPrompt = {\n                    prompt: promptData.prompt,\n                    response: promptData.response,\n                    isResponseHelpful: isNOU(promptData.isResponseHelpful) ? null :\n                        promptData.isResponseHelpful\n                };\n                if (this.prompt === tPrompt.prompt) {\n                    this.prompts[this.prompts.length - 1].response = tPrompt.response;\n                    this.prompts[this.prompts.length - 1].isResponseHelpful = tPrompt.isResponseHelpful;\n                    this.renderOutputContainer(undefined, tPrompt.response, this.prompts.length - 1, false);\n                }\n                else {\n                    this.prompts = this.prompts.concat([tPrompt]);\n                    this.renderOutputContainer(tPrompt.prompt, tPrompt.response, this.prompts.length - 1, true);\n                }\n            }\n            this.isResponseRequested = false;\n        }\n        this.isProtectedOnChange = prevOnChange;\n    };\n    /**\n     * Called if any of the property value is changed.\n     *\n     * @param  {AIAssistViewModel} newProp - Specifies new properties\n     * @param  {AIAssistViewModel} oldProp - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    AIAssistView.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'width':\n                case 'height':\n                    this.setDimension(this.element, this.width, this.height);\n                    break;\n                case 'cssClass':\n                    this.updateCssClass(this.element, newProp.cssClass, oldProp.cssClass);\n                    break;\n                case 'promptIconCss':\n                    this.updateIcons(newProp.promptIconCss, true);\n                    break;\n                case 'responseIconCss':\n                    this.updateIcons(newProp.responseIconCss);\n                    break;\n                case 'showHeader':\n                    this.updateHeader(this.showHeader, this.toolbarHeader, this.viewWrapper);\n                    break;\n                case 'promptSuggestions':\n                    if (this.suggestionsElement) {\n                        this.suggestionsElement.remove();\n                    }\n                    if (!this.isOutputRenderingStop) {\n                        this.renderSuggestions(this.promptSuggestions, this.promptSuggestionsHeader, this.promptSuggestionItemTemplate, 'promptSuggestion', 'promptSuggestionItemTemplate', this.onSuggestionClick);\n                    }\n                    break;\n                case 'showClearButton':\n                    this.textareaObj.showClearButton = this.showClearButton;\n                    break;\n                case 'promptPlaceholder':\n                    this.textareaObj.placeholder = this.promptPlaceholder;\n                    break;\n                case 'promptSuggestionsHeader': {\n                    this.suggestionHeader.innerHTML = this.promptSuggestionsHeader;\n                    var suggestionHeaderElem = this.element.querySelector('.e-suggestions .e-suggestion-header');\n                    if (!suggestionHeaderElem) {\n                        this.suggestionsElement.append(this.suggestionHeader);\n                    }\n                    break;\n                }\n                case 'activeView': {\n                    var previousViewIndex = this.getIndex(oldProp.activeView);\n                    this.updateActiveView(previousViewIndex);\n                    break;\n                }\n                case 'enableRtl':\n                    this.element.classList[this.enableRtl ? 'add' : 'remove']('e-rtl');\n                    break;\n                case 'toolbarSettings':\n                    this.updateToolbarSettings(oldProp.toolbarSettings);\n                    break;\n                case 'promptToolbarSettings':\n                case 'responseToolbarSettings':\n                case 'prompts':\n                    this.isOutputRenderingStop = false;\n                    if (this.outputElement) {\n                        remove(this.outputElement);\n                    }\n                    if (this.stopResponding) {\n                        this.stopResponding.classList.remove('e-btn-active');\n                    }\n                    this.aiAssistViewRendered = false;\n                    this.renderOutputContent(true);\n                    this.detachCodeCopyEventHandler();\n                    break;\n                case 'prompt':\n                    if (!this.footerTemplate) {\n                        this.textareaObj.value = this.prompt;\n                    }\n                    break;\n                case 'locale':\n                    if (this.assistViewTemplateIndex < 0) {\n                        this.updateStopRespondingTitle();\n                    }\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"prompt\", void 0);\n    __decorate([\n        Property('Type prompt for assistance...')\n    ], AIAssistView.prototype, \"promptPlaceholder\", void 0);\n    __decorate([\n        Collection([], Prompt)\n    ], AIAssistView.prototype, \"prompts\", void 0);\n    __decorate([\n        Property([])\n    ], AIAssistView.prototype, \"promptSuggestions\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"promptSuggestionsHeader\", void 0);\n    __decorate([\n        Property(true)\n    ], AIAssistView.prototype, \"showHeader\", void 0);\n    __decorate([\n        Complex({ items: [] }, ToolbarSettings)\n    ], AIAssistView.prototype, \"toolbarSettings\", void 0);\n    __decorate([\n        Property(0)\n    ], AIAssistView.prototype, \"activeView\", void 0);\n    __decorate([\n        Property(null)\n    ], AIAssistView.prototype, \"promptIconCss\", void 0);\n    __decorate([\n        Property(null)\n    ], AIAssistView.prototype, \"responseIconCss\", void 0);\n    __decorate([\n        Property('100%')\n    ], AIAssistView.prototype, \"width\", void 0);\n    __decorate([\n        Property('100%')\n    ], AIAssistView.prototype, \"height\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"cssClass\", void 0);\n    __decorate([\n        Collection([], AssistView)\n    ], AIAssistView.prototype, \"views\", void 0);\n    __decorate([\n        Complex({ width: null, items: [] }, PromptToolbarSettings)\n    ], AIAssistView.prototype, \"promptToolbarSettings\", void 0);\n    __decorate([\n        Complex({ width: null, items: [] }, ResponseToolbarSettings)\n    ], AIAssistView.prototype, \"responseToolbarSettings\", void 0);\n    __decorate([\n        Property(false)\n    ], AIAssistView.prototype, \"showClearButton\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"footerTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"promptItemTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"responseItemTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"promptSuggestionItemTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], AIAssistView.prototype, \"bannerTemplate\", void 0);\n    __decorate([\n        Event()\n    ], AIAssistView.prototype, \"promptRequest\", void 0);\n    __decorate([\n        Event()\n    ], AIAssistView.prototype, \"promptChanged\", void 0);\n    AIAssistView = __decorate([\n        NotifyPropertyChanges\n    ], AIAssistView);\n    return AIAssistView;\n}(InterActiveChatBase));\nexport { AIAssistView };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n// eslint-disable-next-line @typescript-eslint/triple-slash-reference\n///<reference path='../interactive-chat-base/interactive-chat-base-model.d.ts'/>\nimport { NotifyPropertyChanges, Property, getUniqueID, isNullOrUndefined as isNOU, EventHandler, L10n } from '@syncfusion/ej2-base';\nimport { Internationalization, ChildProperty, Collection, removeClass, Event, Complex } from '@syncfusion/ej2-base';\nimport { InterActiveChatBase, ToolbarSettings } from '../interactive-chat-base/interactive-chat-base';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { Fab } from '@syncfusion/ej2-buttons';\nvar MessageStatus = /** @class */ (function (_super) {\n    __extends(MessageStatus, _super);\n    function MessageStatus() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], MessageStatus.prototype, \"iconCss\", void 0);\n    __decorate([\n        Property('')\n    ], MessageStatus.prototype, \"text\", void 0);\n    __decorate([\n        Property('')\n    ], MessageStatus.prototype, \"tooltip\", void 0);\n    return MessageStatus;\n}(ChildProperty));\nexport { MessageStatus };\n/**\n * Represents a user model for a messages in the chatUI component.\n */\nvar User = /** @class */ (function (_super) {\n    __extends(User, _super);\n    function User() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], User.prototype, \"id\", void 0);\n    __decorate([\n        Property('Default')\n    ], User.prototype, \"user\", void 0);\n    __decorate([\n        Property('')\n    ], User.prototype, \"avatarUrl\", void 0);\n    __decorate([\n        Property('')\n    ], User.prototype, \"avatarBgColor\", void 0);\n    __decorate([\n        Property('')\n    ], User.prototype, \"cssClass\", void 0);\n    return User;\n}(ChildProperty));\nexport { User };\n/**\n *  Represents a model for a messages in the chatUI component.\n */\nvar Message = /** @class */ (function (_super) {\n    __extends(Message, _super);\n    function Message() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('')\n    ], Message.prototype, \"id\", void 0);\n    __decorate([\n        Property('')\n    ], Message.prototype, \"text\", void 0);\n    __decorate([\n        Complex({}, User)\n    ], Message.prototype, \"author\", void 0);\n    __decorate([\n        Property('')\n    ], Message.prototype, \"timeStamp\", void 0);\n    __decorate([\n        Property('')\n    ], Message.prototype, \"timeStampFormat\", void 0);\n    __decorate([\n        Complex({}, MessageStatus)\n    ], Message.prototype, \"status\", void 0);\n    return Message;\n}(ChildProperty));\nexport { Message };\nvar ChatUI = /** @class */ (function (_super) {\n    __extends(ChatUI, _super);\n    /**\n     * Constructor for creating the component\n     *\n     * @param {ChatUIModel} options - Specifies the ChatUIModel model.\n     * @param {string | HTMLElement} element - Specifies the element to render as component.\n     * @private\n     */\n    function ChatUI(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        _this.batchSize = 100;\n        _this.initialLoadSize = 100;\n        return _this;\n    }\n    /**\n     * Initialize the event handler\n     *\n     * @private\n     * @returns {void}\n     */\n    ChatUI.prototype.preRender = function () {\n        if (!this.element.id) {\n            this.element.id = getUniqueID('e-' + this.getModuleName());\n        }\n    };\n    ChatUI.prototype.getDirective = function () {\n        return 'EJS-CHATUI';\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - It returns the current module name.\n     * @private\n     */\n    ChatUI.prototype.getModuleName = function () {\n        return 'chat-ui';\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     *\n     * @private\n     * @returns {string} - It returns the persisted data.\n     */\n    ChatUI.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    ChatUI.prototype.render = function () {\n        this.renderChatUIView();\n    };\n    ChatUI.prototype.renderChatUIView = function () {\n        this.intl = new Internationalization();\n        this.setDimension(this.element, this.width, this.height);\n        this.renderViewSections(this.element, 'e-chat-header', 'e-chat-content');\n        this.viewWrapper = this.element.querySelector('.e-chat-content');\n        this.chatHeader = this.element.querySelector('.e-chat-header');\n        this.renderChatHeader();\n        this.renderChatContentElement();\n        this.renderChatSuggestionsElement();\n        this.renderChatFooterContent();\n        this.addCssClass(this.element, this.cssClass);\n        this.addRtlClass(this.element, this.enableRtl);\n        this.updateHeader(this.showHeader, this.chatHeader, this.viewWrapper);\n        if (isNOU(this.messages) || this.messages.length <= 0) {\n            this.renderBannerView(this.emptyChatTemplate, this.messageWrapper, 'emptyChatTemplate');\n            this.isEmptyChatTemplateRendered = isNOU(this.messageWrapper.querySelector('.e-banner-view')) ? false : true;\n        }\n        this.wireEvents();\n        this.renderTypingIndicator();\n        this.scrollToBottom();\n    };\n    ChatUI.prototype.renderChatHeader = function () {\n        if (this.headerText) {\n            var headerContainer = this.createElement('div', { className: 'e-header' });\n            if (this.headerIconCss) {\n                var iconElement = this.createElement('span', { className: \"e-header-icon e-icons \" + this.headerIconCss });\n                headerContainer.appendChild(iconElement);\n            }\n            var headerTextElement = this.createElement('div', { className: 'e-header-text' });\n            headerTextElement.innerHTML = this.headerText;\n            headerContainer.appendChild(headerTextElement);\n            this.chatHeader.appendChild(headerContainer);\n            this.renderChatHeaderToolbar(headerContainer);\n        }\n    };\n    ChatUI.prototype.renderChatHeaderToolbar = function (headerContainer) {\n        var _this = this;\n        if (!isNOU(this.headerToolbar) && this.headerToolbar.items.length > 0) {\n            var toolbarEle = this.createElement('div', { attrs: { class: 'e-chat-toolbar' } });\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var pushToolbar = this.headerToolbar.items.map(function (item) { return ({\n                type: item.type,\n                template: item.template,\n                disabled: item.disabled,\n                cssClass: item.cssClass,\n                visible: item.visible,\n                tooltipText: item.tooltip,\n                prefixIcon: item.iconCss,\n                text: item.text,\n                align: item.align\n            }); });\n            this.toolbar = new Toolbar({\n                items: pushToolbar,\n                height: '100%',\n                clicked: function (args) {\n                    var eventItemArgs = {\n                        type: args.item.type,\n                        text: args.item.text,\n                        iconCss: args.item.prefixIcon,\n                        cssClass: args.item.cssClass,\n                        tooltip: args.item.tooltipText,\n                        template: args.item.template,\n                        disabled: args.item.disabled,\n                        visible: args.item.visible,\n                        align: args.item.align,\n                        tabIndex: args.item.tabIndex\n                    };\n                    var eventArgs = {\n                        item: eventItemArgs,\n                        event: args.originalEvent,\n                        cancel: false\n                    };\n                    if (_this.headerToolbar.itemClicked) {\n                        _this.headerToolbar.itemClicked.call(_this, eventArgs);\n                    }\n                }\n            });\n            this.toolbar.appendTo(toolbarEle);\n            headerContainer.appendChild(toolbarEle);\n        }\n    };\n    ChatUI.prototype.updateHeaderToolbar = function () {\n        var headerContainer = this.chatHeader.querySelector('.e-header');\n        if (!isNOU(this.toolbar)) {\n            var pushToolbar = this.headerToolbar.items.map(function (item) { return ({\n                type: item.type,\n                template: item.template,\n                disabled: item.disabled,\n                cssClass: item.cssClass,\n                visible: item.visible,\n                tooltipText: item.tooltip,\n                prefixIcon: item.iconCss,\n                text: item.text,\n                align: item.align\n            }); });\n            this.toolbar.items = pushToolbar;\n        }\n        else {\n            this.renderChatHeaderToolbar(headerContainer);\n        }\n    };\n    ChatUI.prototype.renderChatContentElement = function () {\n        this.messageWrapper = this.createElement('div', { className: 'e-message-wrapper' });\n        this.viewWrapper.prepend(this.messageWrapper);\n        this.renderMessageGroup(this.messageWrapper);\n        this.content = this.createElement('div', { attrs: { class: 'e-typing-suggestions' } });\n        this.viewWrapper.append(this.content);\n        this.renderScrollDown();\n    };\n    ChatUI.prototype.renderScrollDown = function () {\n        var scrollDownButton = this.createElement('button', { id: 'scrollDownButton' });\n        this.downArrowIcon = new Fab({\n            iconCss: 'e-icons e-chat-scroll-down',\n            position: 'BottomRight',\n            target: this.content,\n            isPrimary: false\n        });\n        this.downArrowIcon.appendTo(scrollDownButton);\n    };\n    ChatUI.prototype.renderMessageGroup = function (chatContentWrapper) {\n        var _this = this;\n        if (this.loadOnDemand) {\n            createSpinner({ target: this.messageWrapper });\n            this.startIndex = Math.max(0, this.messages.length - this.initialLoadSize);\n            var initialMessages = this.messages.slice(this.startIndex);\n            initialMessages.forEach(function (msg, i) {\n                var currIndex = _this.startIndex + i;\n                var prevIndex = i === 0 ? -1 : currIndex - 1;\n                _this.renderGroup(chatContentWrapper, msg, false, currIndex, prevIndex);\n            });\n        }\n        else {\n            this.messages.forEach(function (msg, i) {\n                _this.renderGroup(chatContentWrapper, msg, false, i, i - 1);\n            });\n        }\n    };\n    ChatUI.prototype.isTimeBreakAdded = function (chatContentWrapper, loadOldChat) {\n        return loadOldChat ?\n            chatContentWrapper.firstElementChild.classList.contains('e-timebreak') :\n            chatContentWrapper.lastElementChild.classList.contains('e-timebreak');\n    };\n    ChatUI.prototype.renderGroup = function (chatContentWrapper, msg, loadOldChat, index, prevIndex) {\n        var messageGroup;\n        if (!loadOldChat) {\n            this.updateMessageTimeFormats(msg, index);\n            this.handleTimeBreak(prevIndex, index, loadOldChat);\n        }\n        if (msg.author.id === this.user.id) {\n            if ((msg.author.id !== this.lastUser) || (this.showTimeBreak && this.isTimeBreakAdded(chatContentWrapper, loadOldChat))) {\n                messageGroup = this.createElement('div', { className: \"e-message-group e-right \" + (this.messageTemplate ? 'e-message-item-template' : '') });\n                this.manageChatContent(loadOldChat, chatContentWrapper, messageGroup);\n                this.addGroupItems(msg, messageGroup, false, true, index, loadOldChat);\n            }\n            else {\n                var length_1 = this.element.querySelectorAll('.e-message-group.e-right').length;\n                messageGroup = this.element.querySelectorAll('.e-message-group.e-right')[loadOldChat ? 0 : length_1 - 1];\n                this.addGroupItems(msg, messageGroup, false, true, index, loadOldChat);\n            }\n        }\n        else {\n            if (this.lastUser !== msg.author.id || this.isTimeVaries(index, prevIndex)) {\n                messageGroup = this.createElement('div', { className: \"e-message-group e-left \" + (this.messageTemplate ? 'e-message-item-template' : '') });\n                var avatarElement = this.createAvatarIcon(msg.author, false);\n                if (!this.messageTemplate) {\n                    messageGroup.prepend(avatarElement);\n                }\n                this.manageChatContent(loadOldChat, chatContentWrapper, messageGroup);\n                if (this.loadOnDemand) {\n                    this.loadLeftGroupOnDemand(msg, loadOldChat, index, messageGroup);\n                }\n                else {\n                    this.createLeftGroupItems(messageGroup, msg, index);\n                    this.addGroupItems(msg, messageGroup, true, false, index, loadOldChat);\n                }\n            }\n            else {\n                var length_2 = this.element.querySelectorAll('.e-message-group.e-left').length;\n                messageGroup = this.element.querySelectorAll('.e-message-group.e-left')[loadOldChat ? 0 : length_2 - 1];\n                if (!loadOldChat) {\n                    this.addGroupItems(msg, messageGroup, false, false, index, loadOldChat);\n                }\n                else {\n                    this.loadLeftGroupOnDemand(msg, loadOldChat, index, messageGroup);\n                }\n            }\n        }\n        this.lastUser = msg.author.id;\n    };\n    ChatUI.prototype.isTimeVaries = function (index, prevIndex) {\n        var currentMessageDate = this.getMessageDate(index);\n        currentMessageDate.setHours(0, 0, 0, 0);\n        var lastMessageDate = this.getMessageDate(prevIndex);\n        lastMessageDate.setHours(0, 0, 0, 0);\n        return currentMessageDate.getTime() !== lastMessageDate.getTime();\n    };\n    ChatUI.prototype.loadLeftGroupOnDemand = function (msg, loadOldChat, index, messageGroup) {\n        // To check if the previous author is the same as the current author. If not, create a group header.\n        var isAnyMsgPresent = this.messages[index - 1] ? true : false;\n        var prevAuthorId = isAnyMsgPresent ? this.messages[index - 1].author.id : '';\n        var shouldCreateHeader = prevAuthorId !== msg.author.id ? true : false;\n        if (shouldCreateHeader || this.isTimeVaries(index, index - 1)) {\n            this.addGroupItems(msg, messageGroup, true, false, index, loadOldChat);\n            this.createLeftGroupItems(messageGroup, msg, index);\n        }\n        else {\n            this.addGroupItems(msg, messageGroup, false, false, index, loadOldChat);\n        }\n    };\n    ChatUI.prototype.createLeftGroupItems = function (messageGroup, msg, index) {\n        if (this.messageTemplate) {\n            return;\n        }\n        var userHeaderContainer = this.createElement('div', {\n            className: 'e-message-header-container'\n        });\n        var userHeader = this.createElement('div', {\n            className: 'e-message-header'\n        });\n        userHeader.innerHTML = msg.author.user;\n        var timeSpan = this.getTimeStampElement(msg.timeStamp\n            ? msg.timeStamp\n            : new Date(), msg.timeStampFormat, index);\n        this.appendChildren(userHeaderContainer, userHeader, timeSpan);\n        this.insertBeforeChildren(messageGroup, userHeaderContainer);\n    };\n    ChatUI.prototype.createAvatarIcon = function (author, isTypingUser) {\n        var userName = author.user.trim();\n        var nameParts = userName.split(' ');\n        var initials = nameParts.length > 1\n            ? \"\" + nameParts[0][0] + nameParts[nameParts.length - 1][0]\n            : userName[0];\n        var avatarIcon = this.createElement((!isNOU(author.avatarUrl) && author.avatarUrl !== '') ? 'img' : 'span', { className: \" \" + (!isTypingUser ? 'e-message-icon' : 'e-user-icon') + \" \" + author.cssClass });\n        if (author.avatarBgColor) {\n            avatarIcon.style.backgroundColor = author.avatarBgColor;\n        }\n        if (!isNOU(author.avatarUrl) && author.avatarUrl !== '') {\n            avatarIcon.src = author.avatarUrl;\n            avatarIcon.alt = userName;\n        }\n        else {\n            avatarIcon.innerHTML = initials;\n        }\n        return avatarIcon;\n    };\n    ChatUI.prototype.getTimeStampElement = function (timeStamp, timeStampFormat, index) {\n        var formattedTime = this.getFormattedTime(timeStamp, timeStampFormat);\n        return this.createElement('div', {\n            className: 'e-time',\n            innerHTML: this.showTimeStamp ? formattedTime : ''\n        });\n    };\n    ChatUI.prototype.updateTimeFormats = function (timeStampFormat, fullTime, index) {\n        if (this.messages[parseInt(index.toString(), 10)]) {\n            var prevOnChange = this.isProtectedOnChange;\n            this.isProtectedOnChange = true;\n            this.messages[parseInt(index.toString(), 10)].timeStamp = this.intl.parseDate(fullTime, { format: 'dd/MM/yyyy hh:mm a' });\n            this.messages[parseInt(index.toString(), 10)].timeStampFormat = timeStampFormat;\n            this.isProtectedOnChange = prevOnChange;\n        }\n    };\n    ChatUI.prototype.getFormattedTime = function (timeStamp, timeStampFormat) {\n        return this.intl.formatDate(timeStamp, { format: this.getFormat(timeStampFormat) });\n    };\n    ChatUI.prototype.getFormat = function (timeStampFormat) {\n        var hasValue = !isNOU(timeStampFormat) && timeStampFormat.length > 0;\n        return hasValue ? timeStampFormat\n            : (!isNOU(this.timeStampFormat) && this.timeStampFormat.length) ? this.timeStampFormat : 'dd/MM/yyyy hh:mm a';\n    };\n    ChatUI.prototype.addGroupItems = function (msg, messageGroup, isUserTimeStampRendered, showStatus, index, loadOldChat) {\n        var messageItem = this.createElement('div', { className: 'e-message-item' });\n        var messageStatusWrapper = this.createElement('div', { className: 'e-status-wrapper' });\n        var timeSpan = this.getTimeStampElement(msg.timeStamp ? msg.timeStamp : new Date(), msg.timeStampFormat, index);\n        var textElement = this.createElement('div', {\n            className: 'e-text',\n            innerHTML: msg.text\n        });\n        if (this.messageTemplate) {\n            this.getContextObject('messageTemplate', messageGroup, index, msg);\n        }\n        else {\n            if (!isUserTimeStampRendered) {\n                messageItem.appendChild(timeSpan);\n            }\n            if (showStatus) {\n                var messageElement = this.createElement('div', { className: 'e-status-item' });\n                var statusIcon = this.createElement('span', { attrs: { class: \"e-status-icon \" + (msg.status ? msg.status.iconCss : ''), title: \"\" + (msg.status ? msg.status.tooltip : '') } });\n                var statusText = this.createElement('div', { innerHTML: msg.status ? msg.status.text : '', className: 'e-status-text' });\n                this.appendChildren(messageElement, textElement, statusIcon);\n                this.appendChildren(messageStatusWrapper, messageElement, statusText);\n                messageItem.appendChild(messageStatusWrapper);\n            }\n            else {\n                messageItem.appendChild(textElement);\n            }\n            this.manageChatContent(loadOldChat, messageGroup, messageItem);\n        }\n    };\n    ChatUI.prototype.manageChatContent = function (loadOldChat, parentItem, ChildItem) {\n        if (loadOldChat) {\n            parentItem.prepend(ChildItem);\n        }\n        else {\n            parentItem.appendChild(ChildItem);\n        }\n    };\n    ChatUI.prototype.createTimebreakElement = function (date) {\n        var timebreakDiv = this.createElement('div', { className: \"e-timebreak \" + (this.timeBreakTemplate ? 'e-timebreak-template' : '') });\n        var formattedTime = this.getFormattedTime(date, 'MMMM d, yyyy');\n        if (this.timeBreakTemplate) {\n            this.getContextObject('timeBreakTemplate', timebreakDiv, null, null, date);\n        }\n        else {\n            var timeStampEle = this.createElement('span', { className: 'e-timestamp' });\n            timeStampEle.innerHTML = formattedTime;\n            timebreakDiv.appendChild(timeStampEle);\n        }\n        return timebreakDiv;\n    };\n    ChatUI.prototype.handleTimeBreak = function (lastMsgIndex, index, loadOldChat) {\n        if (!this.showTimeBreak) {\n            return;\n        }\n        var currentMessageDate = this.getMessageDate(index);\n        currentMessageDate.setHours(0, 0, 0, 0);\n        if (lastMsgIndex === -1) {\n            this.messageWrapper.appendChild(this.createTimebreakElement(currentMessageDate));\n        }\n        else if (index > 0) {\n            var lastMessageDate = this.getMessageDate(lastMsgIndex);\n            lastMessageDate.setHours(0, 0, 0, 0);\n            if ((currentMessageDate.getTime() !== lastMessageDate.getTime()) && !loadOldChat) {\n                this.messageWrapper.appendChild(this.createTimebreakElement(currentMessageDate));\n            }\n        }\n    };\n    ChatUI.prototype.renderNewMessage = function (msg, index) {\n        if (this.isEmptyChatTemplateRendered) {\n            var introContainer = this.messageWrapper.querySelector('.e-banner-view');\n            this.messageWrapper.removeChild(introContainer);\n            this.isEmptyChatTemplateRendered = false;\n        }\n        this.renderGroup(this.messageWrapper, msg, false, index, index - 1);\n    };\n    ChatUI.prototype.loadMoreMessages = function () {\n        var _this = this;\n        if (this.startIndex <= 0) {\n            return;\n        }\n        var currentScrollOffset = this.messageWrapper.scrollHeight - this.messageWrapper.scrollTop;\n        showSpinner(this.messageWrapper);\n        setTimeout(function () {\n            hideSpinner(_this.messageWrapper);\n            var endIndex = _this.startIndex; // To slice up to the previously rendered message items.\n            _this.startIndex = Math.max(0, _this.startIndex - _this.batchSize);\n            var nextBatchMessages = _this.messages.slice(_this.startIndex, endIndex);\n            nextBatchMessages.reverse().forEach(function (msg, i) {\n                var currIndex = (endIndex - i) - 1; // To pass the actual index of the reversed item.\n                var prevIndex = currIndex + 1;\n                _this.updateMessageTimeFormats(msg, currIndex);\n                var currentMessageDate = _this.getMessageDate(currIndex);\n                currentMessageDate.setHours(0, 0, 0, 0);\n                var lastMessageDate = _this.getMessageDate(prevIndex);\n                lastMessageDate.setHours(0, 0, 0, 0);\n                if (currIndex >= 0) {\n                    if (currentMessageDate.getTime() === lastMessageDate.getTime()) {\n                        var prevTimeBreak = _this.messageWrapper.querySelectorAll('.e-timebreak')[0];\n                        if (prevTimeBreak) {\n                            prevTimeBreak.remove();\n                        }\n                    }\n                }\n                _this.renderGroup(_this.messageWrapper, msg, true, currIndex, prevIndex);\n                _this.messageWrapper.prepend(_this.createTimebreakElement(currentMessageDate));\n                _this.messageWrapper.scrollTop = _this.messageWrapper.scrollHeight - currentScrollOffset;\n            });\n        }, 1000);\n    };\n    ChatUI.prototype.updateMessageTimeFormats = function (msg, index) {\n        var fullTime = this.getFormattedTime(msg.timeStamp\n            ? msg.timeStamp\n            : new Date(), 'dd/MM/yyyy hh:mm a');\n        this.updateTimeFormats(msg.timeStampFormat, fullTime, index);\n    };\n    ChatUI.prototype.getMessageDate = function (index) {\n        return new Date(this.messages[parseInt(index.toString(), 10)].timeStamp);\n    };\n    ChatUI.prototype.renderChatSuggestionsElement = function () {\n        if (!isNOU(this.suggestions) && this.suggestions.length > 0) {\n            this.renderSuggestions(this.suggestions, null, this.suggestionTemplate, 'suggestion', 'suggestionTemplate', this.onSuggestionClick);\n        }\n    };\n    ChatUI.prototype.handleSuggestionUpdate = function () {\n        if (this.suggestionsElement) {\n            this.suggestionsElement.remove();\n        }\n        if (!isNOU(this.suggestions) && this.suggestions.length > 0) {\n            this.renderSuggestions(this.suggestions, null, this.suggestionTemplate, 'suggestion', 'suggestionTemplate', this.onSuggestionClick);\n        }\n        this.toggleScrollIcon();\n    };\n    ChatUI.prototype.onSuggestionClick = function (e) {\n        this.suggestionsElement.hidden = true;\n        this.textareaObj.value = e.target.innerText;\n        this.onSendIconClick(e);\n    };\n    ChatUI.prototype.renderChatFooterContent = function () {\n        this.footer = this.getElement('footer');\n        var footerClass = \"e-footer \" + (this.footerTemplate ? 'e-footer-template' : '');\n        this.footer.className = footerClass;\n        this.renderChatFooter();\n        this.viewWrapper.append(this.footer);\n        this.updateFooter(this.showFooter, this.footer);\n    };\n    ChatUI.prototype.renderChatFooter = function () {\n        var _this = this;\n        this.textareaObj = this.renderFooterContent(this.footerTemplate, this.footer, '', this.placeholder, false, this.getRowCount(''), 'e-chat-textarea');\n        var sendIconClass = 'e-chat-send e-icons disabled';\n        if (!this.footerTemplate) {\n            this.sendIcon = this.renderSendIcon(sendIconClass, this.footer);\n        }\n        if (this.textareaObj) {\n            this.textareaObj.input = this.handleInput.bind(this);\n            this.textareaObj.blur = function (args) { return _this.triggerUserTyping(args.event, args.value); };\n            if (!isNOU(this.textareaObj.value)) {\n                this.activateSendIcon(this.textareaObj.value.length);\n            }\n        }\n    };\n    ChatUI.prototype.handleInput = function (args) {\n        this.triggerUserTyping(args.event, args.value);\n        this.activateSendIcon(args.value.length);\n        this.updateTextAreaObject(args.value);\n    };\n    ChatUI.prototype.triggerUserTyping = function (event, value) {\n        var eventArgs = {\n            event: event,\n            message: value,\n            user: this.user,\n            isTyping: event.type === 'blur' ? false : value.length > 0 ? true : false\n        };\n        this.trigger('userTyping', eventArgs);\n    };\n    ChatUI.prototype.renderTypingIndicator = function () {\n        var _this = this;\n        this.l10n = new L10n('chat-ui', {\n            oneUserTyping: '{0} is typing',\n            twoUserTyping: '{0} and {1} are typing',\n            threeUserTyping: '{0}, {1}, and {2} other are typing',\n            multipleUsersTyping: '{0}, {1}, and {2} others are typing'\n        }, this.locale);\n        if (this.indicatorWrapper) {\n            this.indicatorWrapper.remove();\n        }\n        if (!this.typingUsers || this.typingUsers.length === 0) {\n            return;\n        }\n        this.indicatorWrapper = this.createElement('div', {\n            className: \"e-typing-indicator \" + (this.typingUsersTemplate ? 'e-typing-indicator-template' : '')\n        });\n        if (this.typingUsersTemplate) {\n            this.getContextObject('typingUsersTemplate', this.indicatorWrapper, null, null, null);\n        }\n        else {\n            this.typingUsers.slice(0, 3).forEach(function (user) {\n                var avatarElement = _this.createAvatarIcon(user, true);\n                _this.indicatorWrapper.appendChild(avatarElement);\n            });\n            var typingMessage = this.createElement('span', { className: 'e-user-text' });\n            this.indicatorWrapper.appendChild(typingMessage);\n            this.updateUserText();\n            var indicatorContainer = this.createElement('div', { className: 'e-indicator-wrapper' });\n            for (var i = 0; i < 3; i++) {\n                var indicator = this.createElement('span', {\n                    className: 'e-indicator'\n                });\n                this.appendChildren(indicatorContainer, indicator);\n            }\n            this.indicatorWrapper.appendChild(indicatorContainer);\n        }\n        this.content.prepend(this.indicatorWrapper);\n    };\n    ChatUI.prototype.updateUserText = function () {\n        var _this = this;\n        if (this.typingUsersTemplate) {\n            return;\n        }\n        this.l10n.setLocale(this.locale);\n        var userNames = this.typingUsers.filter(function (user) { return user.user !== _this.user.user; })\n            .map(function (user) { return user.user; });\n        var displayText = this.getTypingMessage(userNames);\n        var typingMessage = this.indicatorWrapper.querySelector('.e-user-text');\n        typingMessage.innerHTML = displayText;\n    };\n    ChatUI.prototype.getTypingMessage = function (userNames) {\n        if (userNames.length >= 3) {\n            return this.l10n.getConstant(userNames.length > 3 ? 'multipleUsersTyping' : 'threeUserTyping')\n                .replace('{0}', userNames[0].toString())\n                .replace('{1}', userNames[1].toString())\n                .replace('{2}', (userNames.length - 2).toString());\n        }\n        else {\n            var userTemplate = this.l10n.getConstant(userNames.length === 2 ? 'twoUserTyping' : 'oneUserTyping');\n            return userNames.length === 2\n                ? userTemplate.replace('{0}', userNames[0].toString()).replace('{1}', userNames[1].toString())\n                : userTemplate.replace('{0}', userNames[0].toString());\n        }\n    };\n    ChatUI.prototype.updateTypingUsers = function (users) {\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        this.typingUsers = users;\n        this.isProtectedOnChange = prevOnChange;\n        this.renderTypingIndicator();\n    };\n    ChatUI.prototype.updateTextAreaObject = function (textValue) {\n        var rowCount = this.getRowCount(textValue);\n        this.textareaObj.rows = rowCount;\n        this.textareaObj.cssClass = (rowCount >= 10) ? 'show-scrollbar' : 'hide-scrollbar';\n    };\n    ChatUI.prototype.getRowCount = function (textValue) {\n        var lines = textValue.split('\\n').length;\n        return (lines < 10 ? (lines >= 1 ? lines : 1) : 10);\n    };\n    ChatUI.prototype.activateSendIcon = function (value) {\n        this.sendIcon.classList.toggle('disabled', value === 0);\n        this.sendIcon.classList.toggle('enabled', value > 0);\n    };\n    ChatUI.prototype.updateHeaderIcon = function () {\n        var existingIconElement = this.element.querySelector('.e-header-icon');\n        if (existingIconElement) {\n            existingIconElement.className = \"e-header-icon e-icons \" + this.headerIconCss;\n        }\n        else {\n            var headerContainer = this.element.querySelector('.e-header');\n            if (headerContainer) {\n                var iconElement = this.createElement('span', {\n                    className: \"e-header-icon e-icons \" + this.headerIconCss\n                });\n                headerContainer.prepend(iconElement);\n            }\n        }\n    };\n    ChatUI.prototype.updateHeaderText = function () {\n        if (this.headerText) {\n            var headerTextEle = this.element.querySelector('.e-header-text');\n            if (headerTextEle) {\n                headerTextEle.innerHTML = this.headerText;\n            }\n        }\n    };\n    ChatUI.prototype.renderUpdatedMessage = function () {\n        this.lastUser = '';\n        this.messageWrapper.innerHTML = '';\n        this.renderMessageGroup(this.messageWrapper);\n    };\n    ChatUI.prototype.onSendIconClick = function (event) {\n        var _this = this;\n        if (!this.textareaObj.value.trim()) {\n            return;\n        }\n        var newMessageObj = {\n            id: getUniqueID('e-message-'),\n            author: this.user,\n            text: this.textareaObj.value\n        };\n        var prevOnChange = this.isProtectedOnChange;\n        this.textareaObj.value = '';\n        this.activateSendIcon(this.textareaObj.value.length);\n        var eventArgs = {\n            cancel: false,\n            message: newMessageObj\n        };\n        this.triggerUserTyping(event, '');\n        this.trigger('messageSend', eventArgs, function (args) {\n            if (args.cancel) {\n                return;\n            }\n            newMessageObj = args.message;\n            _this.isProtectedOnChange = true;\n            _this.messages = _this.messages.concat([newMessageObj]);\n            _this.isProtectedOnChange = prevOnChange;\n            _this.renderNewMessage(newMessageObj, (_this.messages.length - 1));\n        });\n        if (this.suggestionsElement) {\n            this.suggestionsElement.hidden = false;\n        }\n        this.scrollToBottom();\n    };\n    ChatUI.prototype.getContextObject = function (templateName, contentElement, index, message, currentMessagedate) {\n        var template;\n        var context = {};\n        switch (templateName.toLowerCase()) {\n            case 'messagetemplate': {\n                template = this.messageTemplate;\n                context = { message: message, index: index };\n                break;\n            }\n            case 'timebreaktemplate': {\n                template = this.timeBreakTemplate;\n                context = { messageDate: currentMessagedate };\n                break;\n            }\n            case 'typinguserstemplate': {\n                template = this.typingUsersTemplate;\n                context = { users: this.typingUsers };\n                break;\n            }\n        }\n        this.updateContent(template, contentElement, context, templateName);\n    };\n    ChatUI.prototype.handleAutoScroll = function () {\n        if (this.isScrollAtBottom) {\n            this.updateScroll(this.messageWrapper);\n        }\n        if (this.autoScrollToBottom) {\n            this.updateScroll(this.messageWrapper);\n        }\n        this.toggleScrollIcon();\n    };\n    ChatUI.prototype.footerKeyHandler = function (e) {\n        this.keyHandler(e, 'footer');\n    };\n    ChatUI.prototype.scrollBottomKeyHandler = function (e) {\n        this.keyHandler(e, 'scrollBottom');\n    };\n    ChatUI.prototype.keyHandler = function (event, value) {\n        if (event.key === 'Enter' && !event.shiftKey) {\n            switch (value) {\n                case 'footer':\n                    event.preventDefault();\n                    this.onSendIconClick(event);\n                    this.updateTextAreaObject(this.textareaObj.value);\n                    break;\n                case 'scrollBottom':\n                    this.scrollToBottom();\n                    break;\n            }\n        }\n    };\n    ChatUI.prototype.updateFooter = function (showFooter, footerElement) {\n        if (!showFooter) {\n            footerElement.hidden = true;\n        }\n        else {\n            footerElement.hidden = false;\n        }\n    };\n    ChatUI.prototype.handleScroll = function () {\n        var atBottom = this.checkScrollAtBottom();\n        if (atBottom) {\n            this.toggleClassName(this.downArrowIcon.element, atBottom, 'downArrow');\n            var suggestionEle = this.element.querySelector('.e-suggestions');\n            if (suggestionEle) {\n                this.toggleClassName(suggestionEle, atBottom, 'suggestion');\n                if (!atBottom || !this.isScrollAtBottom) {\n                    this.updateScroll(this.messageWrapper);\n                }\n            }\n        }\n        if (this.loadOnDemand && this.messageWrapper.scrollTop === 0) {\n            this.loadMoreMessages();\n        }\n        this.isScrollAtBottom = atBottom;\n    };\n    ChatUI.prototype.checkScrollAtBottom = function () {\n        var scrollThreshold = 5;\n        var scrollTop = Math.floor(this.messageWrapper.scrollTop);\n        var scrollHeight = Math.floor(this.messageWrapper.scrollHeight);\n        var clientHeight = Math.floor(this.messageWrapper.clientHeight);\n        return scrollHeight - scrollTop <= clientHeight + scrollThreshold;\n    };\n    ChatUI.prototype.toggleClassName = function (element, atBottom, name) {\n        switch (name) {\n            case 'downArrow':\n                element.classList.toggle('e-arrowdown-hide', atBottom);\n                element.classList.toggle('e-arrowdown-show', !atBottom);\n                break;\n            case 'suggestion':\n                element.classList.toggle('e-show-suggestions', atBottom);\n                element.classList.toggle('e-hide-suggestions', !atBottom);\n                break;\n            case 'scroll':\n                element.classList.toggle('e-scroll-smooth', !atBottom);\n                break;\n        }\n    };\n    ChatUI.prototype.toggleScrollIcon = function () {\n        var atBottom = this.checkScrollAtBottom();\n        this.toggleClassName(this.downArrowIcon.element, atBottom, 'downArrow');\n        var suggestionEle = this.element.querySelector('.e-suggestions');\n        if (suggestionEle) {\n            this.toggleClassName(suggestionEle, atBottom, 'suggestion');\n            if (atBottom) {\n                this.updateScroll(this.messageWrapper);\n            }\n        }\n        this.isScrollAtBottom = atBottom;\n    };\n    ChatUI.prototype.scrollBtnClick = function () {\n        this.toggleClassName(this.messageWrapper, false, 'scroll');\n        this.scrollToBottom();\n        this.toggleClassName(this.messageWrapper, true, 'scroll');\n    };\n    ChatUI.prototype.wireEvents = function () {\n        this.wireFooterEvents(this.sendIcon, this.footer, this.footerTemplate);\n        EventHandler.add(this.messageWrapper, 'scroll', this.handleScroll, this);\n        EventHandler.add(this.downArrowIcon.element, 'click', this.scrollBtnClick, this);\n        EventHandler.add(this.downArrowIcon.element, 'keydown', this.scrollBottomKeyHandler, this);\n    };\n    ChatUI.prototype.unwireEvents = function () {\n        this.unWireFooterEvents(this.sendIcon, this.footer, this.footerTemplate);\n        EventHandler.remove(this.messageWrapper, 'scroll', this.handleScroll);\n        EventHandler.remove(this.downArrowIcon.element, 'click', this.scrollBtnClick);\n        EventHandler.remove(this.downArrowIcon.element, 'keydown', this.scrollBottomKeyHandler);\n    };\n    ChatUI.prototype.destroyChatUI = function () {\n        var properties = [\n            'content',\n            'sendIcon',\n            'footer',\n            'indicatorWrapper',\n            'messageWrapper',\n            'viewWrapper',\n            'chatHeader'\n        ];\n        for (var _i = 0, properties_1 = properties; _i < properties_1.length; _i++) {\n            var prop = properties_1[_i];\n            var element = prop;\n            this.removeAndNullify(this[element]);\n            this[element] = null;\n        }\n    };\n    /**\n     * Scrolls to the last message in the conversation area of the Chat UI component.\n     * This method allows programmatic control to ensure the chat view is scrolled to the bottom, typically used when new messages are added or to refocus on the most recent conversation.\n     *\n     * @returns {void}\n     */\n    ChatUI.prototype.scrollToBottom = function () {\n        this.updateScroll(this.messageWrapper);\n        this.toggleScrollIcon();\n    };\n    /**\n     * Appends a new message to the end of the Chat UI conversation area.\n     * This method adds the specified message as the latest entry in the chat:\n     *\n     * @function addMessage\n     * @param {string | MessageModel} message - The message to be added to the conversation. Accepts either a plain text string or a `MessageModel` object.\n     * - If `message` is a string, a `MessageModel` will be automatically created with the current user’s details, and the message will be appended.\n     * - If `message` is an instance of `MessageModel`, it can represent a message from either the current user or another participant and will be appended directly.\n     * @returns {void} No return value.\n     */\n    ChatUI.prototype.addMessage = function (message) {\n        if (isNOU(message)) {\n            return;\n        }\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        if (typeof message === 'string') {\n            var newMessageObj = {\n                id: getUniqueID('e-message-'),\n                author: this.user,\n                text: message,\n                timeStamp: new Date(),\n                timeStampFormat: this.timeStampFormat\n            };\n            this.messages = this.messages.concat([newMessageObj]);\n            this.renderNewMessage(newMessageObj, (this.messages.length - 1));\n        }\n        else {\n            this.messages = this.messages.concat([message]);\n            this.renderNewMessage(message, (this.messages.length - 1));\n        }\n        this.handleAutoScroll();\n        this.isProtectedOnChange = prevOnChange;\n    };\n    /**\n     * Updates an existing message in the Chat UI component.\n     * This method allows for modifying a message that has already been added to the conversation.\n     * It requires the unique identifier of the message to be updated and the new message content as a `MessageModel`.\n     *\n     * @function updateMessage\n     * @param {MessageModel} message - The updated message content represented as a `MessageModel`.\n     * @param {string} msgId - The unique identifier of the message to be updated.\n     * @returns {void} No return value.\n     */\n    ChatUI.prototype.updateMessage = function (message, msgId) {\n        var prevOnChange = this.isProtectedOnChange;\n        this.isProtectedOnChange = true;\n        this.messages = this.messages.map(function (messageItem) {\n            return messageItem.id === msgId ? __assign({}, messageItem, message) : messageItem;\n        });\n        this.renderUpdatedMessage();\n        this.isProtectedOnChange = prevOnChange;\n    };\n    ChatUI.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.unwireEvents();\n        if (this.cssClass) {\n            removeClass([this.element], this.cssClass.split(' '));\n        }\n        this.element.classList.remove('e-rtl');\n        this.destroyAndNullify(this.textareaObj);\n        this.destroyAndNullify(this.downArrowIcon);\n        this.destroyAndNullify(this.toolbar);\n        this.destroyChatUI();\n        this.intl = null;\n        this.lastUser = null;\n    };\n    /**\n     * Called if any of the property value is changed.\n     *\n     * @param  {ChatUIModel} newProp - Specifies new properties\n     * @param  {ChatUIModel} oldProp - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ChatUI.prototype.onPropertyChanged = function (newProp, oldProp) {\n        for (var _i = 0, _a = Object.keys(newProp); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'width':\n                case 'height':\n                    this.setDimension(this.element, this.width, this.height);\n                    break;\n                case 'placeholder':\n                    if (this.textareaObj) {\n                        this.textareaObj.placeholder = this.placeholder;\n                    }\n                    break;\n                case 'cssClass':\n                    this.updateCssClass(this.element, newProp.cssClass, oldProp.cssClass);\n                    break;\n                case 'enableRtl':\n                    this.element.classList[this.enableRtl ? 'add' : 'remove']('e-rtl');\n                    break;\n                case 'showHeader':\n                    this.updateHeader(this.showHeader, this.chatHeader, this.viewWrapper);\n                    break;\n                case 'headerText':\n                    this.updateHeaderText();\n                    break;\n                case 'headerIconCss':\n                    this.updateHeaderIcon();\n                    break;\n                case 'messages': {\n                    this.renderUpdatedMessage();\n                    this.handleAutoScroll();\n                    break;\n                }\n                case 'user': {\n                    var newUser = {\n                        id: newProp.user.id,\n                        user: newProp.user.user,\n                        avatarUrl: newProp.user.avatarUrl,\n                        avatarBgColor: newProp.user.avatarBgColor,\n                        cssClass: newProp.user.cssClass\n                    };\n                    this.user = __assign({}, this.user, newUser);\n                    break;\n                }\n                case 'showTimeStamp':\n                case 'timeStampFormat':\n                case 'showTimeBreak':\n                    if (this.messages.length > 0) {\n                        this.renderUpdatedMessage();\n                    }\n                    break;\n                case 'showFooter':\n                    this.updateFooter(this.showFooter, this.footer);\n                    break;\n                case 'autoScrollToBottom':\n                    this.handleAutoScroll();\n                    break;\n                case 'suggestions':\n                    this.handleSuggestionUpdate();\n                    break;\n                case 'typingUsers':\n                    this.updateTypingUsers(this.typingUsers);\n                    break;\n                case 'locale':\n                    if (!this.typingUsers || this.typingUsers.length === 0) {\n                        return;\n                    }\n                    this.updateUserText();\n                    break;\n                case 'headerToolbar':\n                    this.updateHeaderToolbar();\n                    break;\n                case 'currencyCode':\n                    this.refresh();\n                    break;\n            }\n        }\n    };\n    __decorate([\n        Property('100%')\n    ], ChatUI.prototype, \"width\", void 0);\n    __decorate([\n        Property('100%')\n    ], ChatUI.prototype, \"height\", void 0);\n    __decorate([\n        Complex({}, User)\n    ], ChatUI.prototype, \"user\", void 0);\n    __decorate([\n        Property('Chat')\n    ], ChatUI.prototype, \"headerText\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"headerIconCss\", void 0);\n    __decorate([\n        Property('Type your message…')\n    ], ChatUI.prototype, \"placeholder\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(true)\n    ], ChatUI.prototype, \"showHeader\", void 0);\n    __decorate([\n        Property(true)\n    ], ChatUI.prototype, \"showFooter\", void 0);\n    __decorate([\n        Complex({ items: [] }, ToolbarSettings)\n    ], ChatUI.prototype, \"headerToolbar\", void 0);\n    __decorate([\n        Property([])\n    ], ChatUI.prototype, \"suggestions\", void 0);\n    __decorate([\n        Property(false)\n    ], ChatUI.prototype, \"showTimeBreak\", void 0);\n    __decorate([\n        Collection([], Message)\n    ], ChatUI.prototype, \"messages\", void 0);\n    __decorate([\n        Collection([], User)\n    ], ChatUI.prototype, \"typingUsers\", void 0);\n    __decorate([\n        Property('dd/MM/yyyy hh:mm a')\n    ], ChatUI.prototype, \"timeStampFormat\", void 0);\n    __decorate([\n        Property(true)\n    ], ChatUI.prototype, \"showTimeStamp\", void 0);\n    __decorate([\n        Property(false)\n    ], ChatUI.prototype, \"autoScrollToBottom\", void 0);\n    __decorate([\n        Property(false)\n    ], ChatUI.prototype, \"loadOnDemand\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"suggestionTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"footerTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"emptyChatTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"messageTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"timeBreakTemplate\", void 0);\n    __decorate([\n        Property('')\n    ], ChatUI.prototype, \"typingUsersTemplate\", void 0);\n    __decorate([\n        Event()\n    ], ChatUI.prototype, \"messageSend\", void 0);\n    __decorate([\n        Event()\n    ], ChatUI.prototype, \"userTyping\", void 0);\n    ChatUI = __decorate([\n        NotifyPropertyChanges\n    ], ChatUI);\n    return ChatUI;\n}(InterActiveChatBase));\nexport { ChatUI };\n"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","ToolbarItem","_super","apply","Property","ChildProperty","ToolbarSettings","Collection","Event","InterActiveChatBase","options","element","call","preRender","getModuleName","getPersistData","addOnPersist","render","setDimension","width","height","style","isNOU","formatUnit","addCssClass","cssClass","classList","add","addRtlClass","isRtl","updateCssClass","newClass","oldClass","removeClass","trim","split","addClass","updateHeader","showHeader","headerElement","viewWrapper","hidden","renderViewSections","headerClassName","viewClassName","headerWrapper","createElement","attrs","class","appendChild","createViewComponents","contentWrapper","viewContainer","updateScroll","scrollElement","scrollTo","scrollHeight","getElement","className","createSuggestionElement","suggestionHeader","suggestionContainer","suggestionHeaderElement","suggestionListElement","renderSuggestions","suggestionsArray","suggestionTemplate","contextName","templateName","onSuggestionClick","isSuggestionTemplate","_a","suggestionsElement","suggestionContainerClass","suggestionList","renderSuggestionList","innerHTML","append","content","suggestionWrapper","_this","suggestionsListElement","tabindex","forEach","suggestion","attributes","EventHandler","suggestionItemHandler","suggestionContext","index","parseInt","toString","updateContent","event","shiftKey","renderBannerView","bannerTemplate","parentElement","introContainer","prepend","template","contentElement","context","isReact","clearTemplate","notCompile","isVue","ctn","getTemplateFunction","renderReactTemplates","renderFooterContent","footerTemplate","footer","prompt","promptPlaceholder","showClearButton","rowCount","textareaEle","renderFooter","textareaElement","textareaObj","TextArea","rows","cols","placeholder","resizeMode","value","appendTo","renderSendIcon","sendIconClass","sendIcon","role","aria-label","appendChildren","children","_i","insertBeforeChildren","wireFooterEvents","onSendIconClick","footerKeyHandler","unWireFooterEvents","remove","removeAndNullify","parentNode","destroyAndNullify","obj","destroy","tempEle","select","tagName","outerHTML","e","compile","onPropertyChanged","newProp","oldProp","NotifyPropertyChanges","Component","ASSISTHEADER","Prompt","AssistViewType","AssistView","PromptToolbarSettings","ResponseToolbarSettings","AIAssistView","toolbarItems","displayContents","preTagElements","id","getUniqueID","getDirective","renderPromptView","renderViews","renderToolbar","wireEvents","updateHeaderToolbar","assistViewTemplateIndex","unshift","assistCustomSection","previousElement","activeView","renderHeaderToolbar","querySelector","updateActiveView","toolbarHeader","aiAssistViewRendered","enableRtl","isAssistView","isOutputRenderingStop","isResponseRequested","assistView","customViewTemplate","isAssistViewAssigned","customViewCount","views","type","toLocaleLowerCase","getContextObject","push","text","name","prefixIcon","iconCss","htmlAttributes","data-index","viewTemplate","renderDefaultView","toolbar","Toolbar","items","clicked","args","eventArgs","item","tooltip","tooltipText","disabled","visible","align","tabIndex","originalEvent","cancel","toolbarSettings","itemClicked","prevOnChange","isProtectedOnChange","previousIndex","getIndex","toolbarEle","setAttribute","pushToolbar","map","concat","currentIndex","activeViewIndex","removePreviousView","appendView","tbarEle","stopResponding","removeChild","contentContainer","footerClass","renderContent","renderAssistViewFooter","renderStopResponding","stopRespondingIcon","stopRespondingContent","l10n","L10n","stopResponseText","locale","updateStopRespondingTitle","setLocale","textContent","getConstant","promptSuggestions","promptSuggestionsHeader","promptSuggestionItemTemplate","renderOutputContent","outputElement","renderSkeleton","isMethodCall","responseToolbarSettings","prompts","renderOutputContainer","response","contains","insertBefore","getRowCount","input","handleInput","bind","activateSendIcon","updateTextAreaObject","previousValue","trigger","textValue","lines","toggle","keyHandler","stopResponseKeyHandler","respondingStopper","unWireEvents","detachCodeCopyEventHandler","preTag","handler","copyIcon","preventDefault","hasChildNodes","skeletonContainer","innerText","addPrompt","createOutputElement","responseToolbarItems","isResponseHelpful","arrayPosition","contextIndex","contextPrompt","contextOutput","toLowerCase","promptItemTemplate","promptToolbarSettings","responseItemTemplate","output","outputSuggestionEle","renderPrompt","promptText","outputText","outputContainer","renderOutput","promptIcon","responseIconCss","aiOutputEle","lastPrompt","contentFooterEle","renderOutputToolbarItems","renderOutputTextContainer","outputContentBodyEle","from","querySelectorAll","document","firstChild","getCopyHandler","preText","window","navigator","clipboard","writeText","setTimeout","footerContent","renderResponseToolbar","responseToolbarEle","toolbarItem","dataIndex","handleItemClick","getClipBoardContent","tempElement","top","left","position","opacity","body","write","ClipboardItem","text/html","Blob","text/plain","controlParent","dataBind","icon","isLikeInteracted","isDislikeInteracted","isHelpful","promptItem","controlParentItems","promptIndex","outputPrompt","promptContent","promptToolbarContainer","promptToolbar","userIcon","promptIconCss","renderPromptToolbar","promptToolbarEle","onEditIconClick","outputViewWrapper","skeletonIconEle","skeletonBodyEle","skeletonFooterEle","skeletonLine1","skeletonLine2","skeletonLine3","footerSkeleton","focusIn","updateIcons","newCss","isPromptIconCss","elements","updateToolbarSettings","previousToolbar","splice","destroyAssistView","properties_1","executePrompt","addPromptResponse","promptData","undefined","tPrompt","keys","previousViewIndex","Complex","__assign","assign","t","s","n","MessageStatus","User","Message","ChatUI","batchSize","initialLoadSize","renderChatUIView","intl","Internationalization","chatHeader","renderChatHeader","renderChatContentElement","renderChatSuggestionsElement","renderChatFooterContent","messages","emptyChatTemplate","messageWrapper","isEmptyChatTemplateRendered","renderTypingIndicator","scrollToBottom","headerText","headerContainer","headerIconCss","iconElement","headerTextElement","renderChatHeaderToolbar","headerToolbar","renderMessageGroup","renderScrollDown","scrollDownButton","downArrowIcon","Fab","isPrimary","chatContentWrapper","loadOnDemand","createSpinner","startIndex","Math","max","slice","msg","currIndex","prevIndex","renderGroup","isTimeBreakAdded","loadOldChat","firstElementChild","lastElementChild","messageGroup","updateMessageTimeFormats","handleTimeBreak","author","user","lastUser","showTimeBreak","messageTemplate","manageChatContent","addGroupItems","length_1","isTimeVaries","avatarElement","createAvatarIcon","loadLeftGroupOnDemand","createLeftGroupItems","length_2","currentMessageDate","getMessageDate","setHours","lastMessageDate","getTime","userHeaderContainer","userHeader","timeSpan","getTimeStampElement","timeStamp","Date","timeStampFormat","isTypingUser","userName","nameParts","initials","avatarIcon","avatarUrl","avatarBgColor","backgroundColor","src","alt","formattedTime","getFormattedTime","showTimeStamp","updateTimeFormats","fullTime","parseDate","format","formatDate","getFormat","isUserTimeStampRendered","showStatus","messageItem","messageStatusWrapper","textElement","messageElement","statusIcon","status","title","statusText","parentItem","ChildItem","createTimebreakElement","date","timebreakDiv","timeBreakTemplate","timeStampEle","lastMsgIndex","renderNewMessage","loadMoreMessages","currentScrollOffset","scrollTop","showSpinner","hideSpinner","endIndex","reverse","prevTimeBreak","suggestions","handleSuggestionUpdate","toggleScrollIcon","renderChatFooter","updateFooter","showFooter","blur","triggerUserTyping","message","isTyping","oneUserTyping","twoUserTyping","threeUserTyping","multipleUsersTyping","indicatorWrapper","typingUsers","typingUsersTemplate","typingMessage","updateUserText","indicatorContainer","indicator","userNames","filter","displayText","getTypingMessage","replace","userTemplate","updateTypingUsers","users","updateHeaderIcon","existingIconElement","updateHeaderText","headerTextEle","renderUpdatedMessage","newMessageObj","currentMessagedate","messageDate","handleAutoScroll","isScrollAtBottom","autoScrollToBottom","scrollBottomKeyHandler","footerElement","handleScroll","atBottom","checkScrollAtBottom","toggleClassName","suggestionEle","floor","clientHeight","scrollBtnClick","unwireEvents","destroyChatUI","addMessage","updateMessage","msgId","newUser","refresh"],"mappings":"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"}