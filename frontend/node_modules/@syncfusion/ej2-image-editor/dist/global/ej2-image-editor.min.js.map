{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/action/crop.js","../../src/image-editor/action/draw.js","../../src/image-editor/action/export.js","../../src/image-editor/action/filter.js","../../src/image-editor/action/freehand-draw.js","../../src/image-editor/action/selection.js","../../src/image-editor/action/shape.js","../../src/image-editor/action/transform.js","../../src/image-editor/action/undo-redo.js","../../src/image-editor/base/image-editor.js","../../src/image-editor/base/enum.js","../../src/image-editor/renderer/toolbar.js"],"sourcesContent":["import { Browser, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Crop = /** @class */ (function () {\n    function Crop(parent) {\n        this.croppedDegree = 0; // Specifies the degree when crop is performed\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 }; // To redraw old image when navigate to crop tab\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Crop.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Crop.prototype.addEventListener = function () {\n        this.parent.on('crop', this.cropping, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Crop.prototype.removeEventListener = function () {\n        this.parent.off('crop', this.cropping);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Crop.prototype.cropping = function (args) {\n        this.updateCropPvtVar();\n        switch (args.prop) {\n            case 'cropCircle':\n                this.cropCircle(args.value['context'], args.value['isSave'], args.value['isFlip']);\n                break;\n            case 'setCurrSelPoints':\n                this.setCurrSelPoints(args.value['isSetDimension']);\n                break;\n            case 'updateRotatePan':\n                this.updateRotatePan();\n                break;\n            case 'crop':\n                this.crop(args.value['obj']);\n                break;\n            case 'calcRatio':\n                this.calcRatio(args.value['obj'], args.value['dimension']);\n                break;\n            case 'getCurrFlipState':\n                this.getCurrFlipState(args.value['panObj']);\n                break;\n            case 'getPreviousCropCurrentObj':\n                args.value['obj']['prevObj'] = this.prevCropCurrObj;\n                break;\n            case 'setPreviousCropCurrentObj':\n                this.prevCropCurrObj = args.value['obj'];\n                break;\n            case 'setCropDestPoints':\n                this.cropDestPoints = args.value['point'];\n                break;\n            case 'getTempFlipPanPoint':\n                args.value['obj']['point'] = this.tempFlipPanPoint;\n                break;\n            case 'setTempFlipPanPoint':\n                if (isNullOrUndefined(args.value['isAdd'])) {\n                    this.tempFlipPanPoint = args.value['point'];\n                }\n                else {\n                    this.tempFlipPanPoint.x += args.value['point'].x;\n                    this.tempFlipPanPoint.y += args.value['point'].y;\n                }\n                break;\n            case 'getPreventScaling':\n                args.value['obj']['bool'] = this.isPreventScaling;\n                break;\n            case 'adjustStraightenForShapes':\n                this.adjustStraightenForShapes(args.value['type'], args.value['isInitialRotated']);\n                break;\n            case 'resizeWrapper':\n                this.resizeWrapper();\n                break;\n            case 'setTransformCrop':\n                this.isTransformCrop = args.value['bool'];\n                break;\n            case 'setInitCrop':\n                this.isInitCrop = args.value['bool'];\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'revertTransform':\n                this.revertTransform(args.value['type'], args.value['coll']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Crop.prototype.getModuleName = function () {\n        return 'crop';\n    };\n    Crop.prototype.updateCropPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Crop.prototype.reset = function () {\n        this.prevCropCurrObj = null;\n        this.croppedDegree = 0;\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.isTransformCrop = false;\n    };\n    Crop.prototype.cropImg = function (isRotateCrop) {\n        var parent = this.parent;\n        var isNullCrop = isNullOrUndefined(isRotateCrop);\n        var resizeIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        var actPoint = parent.activeObj.activePoint;\n        var img = parent.img;\n        var isRotated = false;\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            var currentValue = parent.rotateFlipColl[i];\n            if (currentValue === 90 || currentValue === -90) {\n                isRotated = true;\n            }\n        }\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        if (isNullCrop || resizeIcon) {\n            this.croppedDegree = parent.transform.degree;\n        }\n        if (isNullCrop && (parent.transform.degree !== 0) || isRotated) {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.rotateCrop();\n        }\n        else if (isNullCrop && parent.transform.currFlipState !== '') {\n            this.updateCropObj();\n            var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.flipCrop();\n        }\n        else {\n            this.adjustStraightenForShapes('initial', false);\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n            var ratio = this.calcRatio();\n            if (isNullCrop || !isRotateCrop) { // isRotateCrop is NULL or False\n                this.updateCropObj();\n                parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                var point = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n                parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n                parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n                this.cropDestPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            }\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actPoint.width * ratio.width,\n                    height: actPoint.height * ratio.height, obj: obj, isImgShape: null } });\n            var maxDimension = obj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.img = { srcLeft: (actPoint.startX * ratio.width) - (img.destLeft * ratio.width),\n                srcTop: (actPoint.startY * ratio.height) - (img.destTop * ratio.height),\n                srcWidth: (actPoint.width * ratio.width), srcHeight: (actPoint.height * ratio.height),\n                destLeft: (parent.lowerCanvas.clientWidth - maxDimension.width) / 2,\n                destTop: (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2,\n                destWidth: maxDimension.width, destHeight: maxDimension.height };\n            var temp = this.lowerContext.filter;\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.cropObjColl();\n            parent.transform.straighten = 0;\n            parent.activeObj = activeObj;\n            this.cropFreehandDrawColl();\n            parent.shapeColl = [];\n            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') {\n                this.cropCircle(this.lowerContext);\n            }\n            else {\n                parent.isCircleCrop = false;\n            }\n            this.lowerContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currObjType.isCustomCrop = false;\n            parent.pan(false);\n            parent.transform.defaultZoomFactor = 0;\n        }\n    };\n    Crop.prototype.adjustStraightenForShapes = function (type, isInitialRotated) {\n        var parent = this.parent;\n        var center = {\n            x: parent.img.destLeft + parent.img.destWidth / 2,\n            y: parent.img.destTop + parent.img.destHeight / 2\n        };\n        for (var _i = 0, _a = parent.objColl; _i < _a.length; _i++) {\n            var obj = _a[_i];\n            if (['rectangle', 'ellipse', 'text', 'image', 'redact'].indexOf(obj.shape) !== -1) {\n                if (isInitialRotated || obj.rotatedAngle !== 0) {\n                    var _b = obj.activePoint, startX = _b.startX, startY = _b.startY, width = _b.width, height = _b.height;\n                    var angle = type === 'initial' ? obj.rotatedAngle : -obj.rotatedAngle;\n                    var diffX = startX + width / 2 - center.x;\n                    var diffY = startY + height / 2 - center.y;\n                    var cosAngle = Math.cos(angle);\n                    var sinAngle = Math.sin(angle);\n                    var centerX = cosAngle * diffX - sinAngle * diffY + center.x;\n                    var centerY = sinAngle * diffX + cosAngle * diffY + center.y;\n                    var diffXUpdated = centerX - startX - width / 2;\n                    var diffYUpdated = centerY - startY - height / 2;\n                    obj.activePoint.startX += diffXUpdated;\n                    obj.activePoint.startY += diffYUpdated;\n                    obj.activePoint.endX += diffXUpdated;\n                    obj.activePoint.endY += diffYUpdated;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateCropObj = function () {\n        this.parent.afterCropActions = [];\n        var object = { currObj: {} };\n        this.parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var obj = object['currObj'];\n        obj.straighten = this.parent.transform.straighten;\n        this.parent.cropObj = extend({}, obj, {}, true);\n    };\n    Crop.prototype.rotateCrop = function () {\n        var parent = this.parent;\n        var flipState = this.getCurrFlipState();\n        var shape = parent.activeObj.shape || '';\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n        parent.objColl.push(parent.activeObj);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var tempCurrSelObj = extend({}, parent.currSelectionPoint, {}, true);\n        var preventSelObj = { bool: null };\n        parent.notify('transform', { prop: 'getPreventSelect', onPropertyChange: false, value: { obj: preventSelObj } });\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: true } });\n        var coll = extend([], parent.rotateFlipColl, [], true);\n        this.panToSelRangle(true);\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        // For reverse straightening\n        var straighten = parent.transform.straighten;\n        if (straighten !== 0) {\n            parent.transform.straighten = 0;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        this.resetZoom();\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        this.revertTransform('initial', coll);\n        // Perform straighten\n        if (straighten !== 0) {\n            parent.transform.straighten = (flipState === 'horizontal' || flipState === 'vertical') ? -straighten : straighten;\n            parent.straightenBaseImageCanvas();\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.transform.degree = 0;\n        // Checking for selection inside image\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        var count = 0;\n        while (straighten !== 0 && object['isIntersect']) {\n            count++;\n            if (count === 50) {\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: 0.025, zoomPoint: null }, isResize: null });\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        }\n        this.cropImg(true);\n        this.revertTransform('reverse', coll);\n        parent.afterCropActions = afterCropActions;\n        parent.currSelectionPoint = tempCurrSelObj;\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: preventSelObj['bool'] } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n    };\n    Crop.prototype.revertTransform = function (type, coll) {\n        var parent = this.parent;\n        var obj = { isRotate: false };\n        if (type === 'initial') {\n            for (var i = coll.length - 1; i >= 0; i--) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n        else {\n            this.updateFlipState();\n            for (var i = 0, len = coll.length; i < len; i++) {\n                var value = coll[i];\n                switch (value) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(value.toString()) } });\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.updateFlipState = function () {\n        var parent = this.parent;\n        var objColl = parent.objColl;\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            objColl[i].shapeFlip = '';\n        }\n        // eslint-disable-next-line\n        var pointColl = parent.pointColl;\n        for (var i = 0; i < parent.freehandCounter; i++) {\n            pointColl[i].shapeFlip = '';\n        }\n    };\n    Crop.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var zoomFactor = parent.transform.zoomFactor;\n            var isUndoRedo = parent.isUndoRedo;\n            parent.setProperties({ zoomSettings: { zoomFactor: (zoomFactor * 10) } }, true);\n            parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n            for (var i = 0; i < (zoomFactor * 10); i++) {\n                parent.isUndoRedo = true;\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n            }\n            parent.isUndoRedo = isUndoRedo;\n            parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        }\n    };\n    Crop.prototype.flipCrop = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        parent.panPoint.totalPannedPoint.x += this.tempFlipPanPoint.x;\n        parent.panPoint.totalPannedPoint.y += this.tempFlipPanPoint.y;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        var tempFlipColl = obj['flipColl'];\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: [] } });\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        if (parent.transform.degree === 0) {\n            var panX = -parent.cropObj.totalPannedPoint.x;\n            var panY = -parent.cropObj.totalPannedPoint.y;\n            parent.img.destLeft += panX;\n            parent.img.destTop += panY;\n            parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            parent.objColl.pop();\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n        }\n        this.resetZoom();\n        parent.currSelectionPoint = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        parent.objColl.pop();\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.cropImg(true);\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.transform.currFlipState = tempCurrFlipState;\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: tempFlipColl } });\n        this.lowerContext.filter = 'none';\n        this.updateFlipState();\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n    };\n    Crop.prototype.cropObjColl = function () {\n        var parent = this.parent;\n        var point;\n        var shape;\n        var obj;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                obj = parent.objColl[i];\n                point = obj.activePoint;\n                var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                shape = obj.shape;\n                obj.imageRatio = { startX: ((point.startX - startX) / width),\n                    startY: ((point.startY - startY) / height),\n                    endX: ((point.endX - startX) / width), endY: ((point.endY - startY) / height),\n                    width: width / point.width, height: height / point.height };\n                var degree = void 0;\n                var size = void 0;\n                switch (shape) {\n                    case 'text':\n                        degree = (obj.shapeDegree === 0) ? parent.transform.degree : parent.transform.degree - obj.shapeDegree;\n                        size = (degree === 0 || Math.abs(degree) === 180) ? point.width : point.height;\n                        obj.textSettings.fontRatio = size / obj.textSettings.fontSize;\n                        break;\n                    case 'line':\n                    case 'arrow':\n                        this.cropPointCollection(i);\n                        if (shape === 'arrow') {\n                            parent.notify('shape', { prop: 'updateArrowRatio', onPropertyChange: false, value: { obj: obj } });\n                        }\n                        break;\n                    case 'path':\n                        this.cropPointCollection(i);\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.cropPointCollection = function (i) {\n        var parent = this.parent;\n        var shape = parent.objColl[i].shape;\n        var x;\n        var y;\n        var width;\n        var height;\n        var point = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (shape === 'path') {\n            x = point.startX;\n            y = point.startY;\n            width = point.width;\n            height = point.height;\n        }\n        else {\n            x = destLeft;\n            y = destTop;\n            width = destWidth;\n            height = destHeight;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var pointColl = parent.objColl[i].pointColl;\n        for (var n = 0, len = pointColl.length; n < len; n++) {\n            pointColl[n].ratioX = (pointColl[n].x - x) / width;\n            pointColl[n].ratioY = (pointColl[n].y - y) / height;\n        }\n    };\n    Crop.prototype.cropFreehandDrawColl = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].ratioX = (parent.points[l].x - startX) / width;\n                parent.points[l].ratioY = (parent.points[l].y - startY) / height;\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'updateCropPtsForSel', onPropertyChange: false });\n    };\n    Crop.prototype.resetAnnotations = function () {\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n    };\n    Crop.prototype.setCurrSelPoints = function (isSetDimension) {\n        var parent = this.parent;\n        parent.allowDownScale = false;\n        var destPoint = this.cropDestPoints;\n        var filter = this.lowerContext.filter;\n        var isCropTab = parent.isCropTab;\n        parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n            destLeft: destPoint.startX, destTop: destPoint.startY, destWidth: destPoint.width, destHeight: destPoint.height };\n        var img = parent.img;\n        var currSelPoint = parent.currSelectionPoint;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (isSetDimension) {\n            parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        }\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        if (this.croppedDegree === 0 && parent.transform.degree === 0 && currSelPoint\n            && currSelPoint.shape !== 'crop-circle' && currSelPoint.shape !== 'crop-square') {\n            img.destLeft = destPoint.startX;\n            img.destTop = destPoint.startY;\n            img.destWidth = destPoint.width;\n            img.destHeight = destPoint.height;\n        }\n        if (parent.transform.degree === 0) {\n            img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: true } });\n        var cropObjColl = extend([], parent.objColl, null, true);\n        var cropPointColl = extend([], parent.pointColl, null, true);\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        this.resetAnnotations();\n        if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n            parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n        }\n        this.panToSelRangle();\n        parent.isCropTab = isCropTab;\n        parent.objColl = cropObjColl;\n        parent.pointColl = cropPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                    ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n        }\n        if (parent.cropObj.activeObj.shape) {\n            var destPoints = { startX: img.destLeft, startY: img.destTop, width: img.destWidth, height: img.destHeight };\n            if (currSelPoint && currSelPoint.activePoint) {\n                var _a = currSelPoint.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n                img.destLeft = startX;\n                img.destTop = startY;\n                img.destWidth = width;\n                img.destHeight = height;\n            }\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            img.destLeft = destPoints.startX;\n            img.destTop = destPoints.startY;\n            img.destWidth = destPoints.width;\n            img.destHeight = destPoints.height;\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            cropObjColl = extend([], parent.objColl, null, true);\n            cropPointColl = extend([], parent.pointColl, null, true);\n            parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n            this.resetAnnotations();\n            var object = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n            var cropSelPointColl = object['selPointColl'];\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n            parent.cropObj.filter = this.lowerContext.filter;\n            var actObj = extend({}, parent.currSelectionPoint, null, true);\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: null } });\n            parent.activeObj = extend({}, actObj, null, true);\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currSelectionPoint = null;\n            parent.isCircleCrop = false;\n            if (parent.transform.degree !== 0) {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.objColl = cropObjColl;\n            parent.pointColl = cropPointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                        ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n            }\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: cropSelPointColl } } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.adjustStraightenForShapes('reverse', false);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'drawPannImage', onPropertyChange: false,\n                    value: { point: { x: 0, y: 0 } } });\n            }\n            else {\n                if (isNullOrUndefined(parent.activeObj.shape) && parent.cropObj.activeObj.shape) {\n                    parent.activeObj = extend({}, parent.cropObj.activeObj, null, true);\n                }\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            }\n            parent.activeObj = activeObj;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: null } });\n            if (!this.isInitCrop && parent.transform.degree === 0 && parent.cropObj.currFlipState !== '' &&\n                parent.cropObj.cropZoom !== 0) {\n                this.isInitCrop = true;\n                var obj = { activeObj: null };\n                parent.notify('draw', { prop: 'getStraightenActObj', onPropertyChange: false, value: { obj: obj } });\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                parent.notify('draw', { prop: 'setStraightenActObj', onPropertyChange: false, value: { activeObj: obj['activeObj'] } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'croptransform',\n                        isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.isInitCrop = false;\n            }\n        }\n        else {\n            this.adjustStraightenForShapes('reverse', true);\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: true } });\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.lowerContext.filter = temp;\n            parent.currSelectionPoint = null;\n        }\n        if (document.querySelector('.e-ie-straighten-value-span')) {\n            document.querySelector('.e-ie-straighten-value-span').innerHTML = parent.transform.straighten.toString() + '&#176';\n        }\n    };\n    Crop.prototype.panToSelRangle = function (isReverse) {\n        var parent = this.parent;\n        var pannedPoint = parent.cropObj.totalPannedClientPoint;\n        var panX = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.x : pannedPoint.x : 0;\n        var panY = parent.transform.degree !== 0 ? isReverse ? -pannedPoint.y : pannedPoint.y : 0;\n        if (parent.transform.degree !== 0) {\n            parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n            parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n            parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n        }\n    };\n    Crop.prototype.cropCircle = function (context, isSave, isFlip) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n        var temp = context.filter;\n        context.filter = 'none';\n        context.globalCompositeOperation = 'destination-in';\n        context.beginPath();\n        var centerX = isNullOrUndefined(isSave) ? destLeft + (destWidth / 2) : context.canvas.width / 2;\n        var centerY = isNullOrUndefined(isSave) ? destTop + (destHeight / 2) : context.canvas.height / 2;\n        var radius = isSave ? context.canvas.width / 2 : destWidth / 2;\n        context.arc(centerX, centerY, radius, 0, Math.PI * 2);\n        context.closePath();\n        context.fill();\n        context.restore();\n        context.globalCompositeOperation = 'source-over';\n        parent.currObjType.isActiveObj = parent.isCircleCrop = true;\n        context.filter = temp;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n    };\n    Crop.prototype.getCurrCropState = function () {\n        var parent = this.parent;\n        var flipState = '';\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        flipState = this.getCurrFlipState();\n        if (parent.transform.degree === -90 || parent.transform.degree === -270) {\n            if (flipState === 'horizontal') {\n                flipState = 'vertical';\n            }\n            else if (flipState === 'vertical') {\n                flipState = 'horizontal';\n            }\n        }\n        if (flipState === '') {\n            flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n        }\n        return flipState;\n    };\n    Crop.prototype.updateRotatePan = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.panPoint.currentPannedPoint)) {\n            return;\n        }\n        var panRegion = '';\n        var degree = parent.transform.degree;\n        var _a = parent.panPoint.currentPannedPoint, x = _a.x, y = _a.y;\n        if (parent.rotateFlipColl.length > 0 && typeof (parent.rotateFlipColl[0]) === 'number'\n            && degree < 0) {\n            panRegion = this.getCurrCropState();\n        }\n        else {\n            panRegion = this.getCurrFlipState();\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (degree === 90 || (degree === -90 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -270 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === 'horizontal' || panRegion === '') {\n                    parent.img.destLeft += y;\n                }\n                else {\n                    parent.img.destLeft -= y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop -= x;\n                }\n                else {\n                    parent.img.destTop += x;\n                }\n            }\n            else if (degree === 270 || (degree === -270 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (degree === -90 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destLeft -= y;\n                }\n                else {\n                    parent.img.destLeft += y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop += x;\n                }\n                else {\n                    parent.img.destTop -= x;\n                }\n            }\n        }\n        else {\n            if (degree === 180 || degree === -180) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destLeft -= x;\n                }\n                else {\n                    parent.img.destLeft += x;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destTop -= y;\n                }\n                else {\n                    parent.img.destTop += y;\n                }\n            }\n        }\n    };\n    Crop.prototype.crop = function (obj) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var object = { isCropToolbar: parent.isCropToolbar };\n            if (parent.currObjType.isUndoAction && !object['isCropToolbar']) {\n                parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n            }\n            var transitionArgs = { cancel: false, startPoint: { x: startX, y: startY },\n                endPoint: { x: endX, y: endY }, preventScaling: false };\n            if (!object['isCropToolbar']) {\n                parent.trigger('cropping', transitionArgs);\n                parent.editCompleteArgs = transitionArgs;\n            }\n            this.cropEvent(transitionArgs, obj, object);\n        }\n    };\n    Crop.prototype.cropEvent = function (transitionArgs, obj, object) {\n        var parent = this.parent;\n        var splitWords;\n        if (!transitionArgs.cancel) {\n            splitWords = parent.activeObj.shape ? parent.activeObj.shape.split('-') : [];\n            if (!parent.disabled && parent.activeObj.horTopLine && (parent.currObjType.isCustomCrop || (splitWords.length > 0 &&\n                splitWords[0] === 'crop'))) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                obj.isCrop = true;\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var prevObj = extend({}, this.prevCropCurrObj, {}, true);\n                if (transitionArgs.preventScaling) {\n                    this.isPreventScaling = true;\n                }\n                else {\n                    this.isPreventScaling = false;\n                }\n                this.cropImg();\n                if (this.isPreventScaling) {\n                    parent.aspectWidth = parent.img.destWidth;\n                    parent.aspectHeight = parent.img.destHeight;\n                }\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                parent.isCropTab = false;\n                parent.transform.zoomFactor = 0;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                if (!Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: parent.cropObj.destPoints.width, height: parent.cropObj.destPoints.height } });\n                var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                if (!object['isCropToolbar'] && (isNullOrUndefined(aspectIcon) && isNullOrUndefined(nonAspectIcon))) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                }\n                this.resizeWrapper();\n                if (Browser.isDevice) {\n                    this.updateUndoRedoColl(prevObj, prevCropObj, object);\n                }\n            }\n        }\n    };\n    Crop.prototype.updateUndoRedoColl = function (prevObj, prevCropObj, object) {\n        var parent = this.parent;\n        var currSelPtObj = { prevCurrSelectionPoint: parent.prevCurrSelectionPoint };\n        prevObj.currSelectionPoint = extend({}, currSelPtObj['prevCurrSelectionPoint'], {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'crop', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        if (!object['isCropToolbar']) {\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Crop.prototype.resizeWrapper = function () {\n        var parent = this.parent;\n        if (Browser.isDevice) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var elem = parent.element;\n            var ctxToolbar = elem.querySelector('#' + elem.id + '_contextualToolbarArea');\n            if (ctxToolbar && ctxToolbar.style.position === '' && !this.isTransformCrop) {\n                ctxToolbar.style.position = 'absolute';\n                parent.isStraightening = false;\n                parent.update();\n                parent.notify('filter', { prop: 'setAdjustmentValue', value: { adjustmentValue: parent.canvasFilter } });\n            }\n        }\n    };\n    Crop.prototype.calcRatio = function (obj, dimension) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = dimension || parent.baseImgCanvas, width = _b.width, height = _b.height;\n        var widthRatio = (degree === 0 || degree % 180 === 0) ? width / destWidth : height / destWidth;\n        var heightRatio = (degree === 0 || degree % 180 === 0) ? height / destHeight : width / destHeight;\n        if (obj) {\n            obj['width'] = widthRatio;\n            obj['height'] = heightRatio;\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    Crop.prototype.getCurrFlipState = function (panObj) {\n        var parent = this.parent;\n        var obj = { panRegion: '' };\n        var object = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: object } });\n        parent.rotateFlipColl = object['collection'];\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            parent.notify('transform', { prop: 'setCurrPanRegion', onPropertyChange: false,\n                value: { region: obj['panRegion'], type: parent.rotateFlipColl[i], obj: obj } });\n        }\n        if (panObj) {\n            panObj['panRegion'] = obj['panRegion'];\n        }\n        return obj['panRegion'];\n    };\n    return Crop;\n}());\nexport { Crop };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\n/* eslint-disable no-constant-condition */\n/* eslint-disable radix */\nimport { extend, isNullOrUndefined, Browser, getComponent } from '@syncfusion/ej2-base';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Draw = /** @class */ (function () {\n    function Draw(parent) {\n        this.isInitialLoading = false; // Specifies whether image is loaded for the first time or not (for applying initial filter)\n        this.fileName = '';\n        this.isErrorImage = false;\n        this.isShapeTextInserted = false;\n        this.isRotateZoom = false; // To restore zoomed image on selection crop selection\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, outlineColor: '', radius: null, outlineWidth: null }; // restore stroke settings on cancel\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false }; // restore text settings on cancel\n        this.tempAdjValue = ''; // for temp internal slider value\n        this.tempFilter = ''; // restore filter style on cancel\n        this.tempUndoRedoStep = 0;\n        this.tempFreehandCounter = 0;\n        this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null; // Restore zoom factor on cancel\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.zoomCrop = { width: 0, height: 0 };\n        this.isImageEdited = false;\n        this.isFileChanged = false;\n        this.isNewPath = false;\n        this.isResizeSelect = false;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.origDim = { width: 0, height: 0 };\n        this.isImageApply = false;\n        this.imgCanvasPoints = [];\n        this.isCropSelect = false;\n        this.isDownScale = false;\n        this.preventStraightening = false;\n        this.tempObjColl = [];\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        this.tempPointColl = {};\n        this.imageBackgroundColor = '';\n        this.allowRedactStraighten = true;\n        this.isNullExtension = true;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Draw.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Draw.prototype.addEventListener = function () {\n        this.parent.on('draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Draw.prototype.removeEventListener = function () {\n        this.parent.off('draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Draw.prototype.draw = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'drawObject':\n                this.drawObject(args.value['canvas'], args.value['obj'], args.value['isCropRatio'], args.value['points'], args.value['isPreventDrag'], args.value['saveContext'], args.value['isPreventSelection']);\n                break;\n            case 'updateActiveObject':\n                this.updateActiveObject(args.value['actPoint'], args.value['obj'], args.value['isMouseMove'], args.value['x'], args.value['y']);\n                break;\n            case 'clearOuterCanvas':\n                this.clearOuterCanvas(args.value['context']);\n                break;\n            case 'setDestPoints':\n                this.setDestPoints();\n                break;\n            case 'updateCurrTransState':\n                this.updateCurrTransState(args.value['type'], args.value['isPreventDestination'], args.value['isRotatePan']);\n                break;\n            case 'currTransState':\n                this.currTransState(args.value['type'], args.value['isPreventDestination'], args.value['context'], args.value['isPreventCircleCrop']);\n                break;\n            case 'setTransform':\n                this.setTransform(args.value['context'], args.value['value'], args.value['isReverse']);\n                break;\n            case 'render-image':\n                this.renderImage(args.value['isMouseWheel'], args.value['isPreventClearRect'], args.value['isFrame'], args.value['isStraighten']);\n                break;\n            case 'draw-image-to-canvas':\n                this.drawImgToCanvas(args.value['dimension']);\n                break;\n            case 'update-canvas':\n                this.updateCanvas();\n                break;\n            case 'performCancel':\n                this.performCancel(args.value['isContextualToolbar'], args.value['isUndoRedo'], args.value['isFinalCancel']);\n                break;\n            case 'updateFlipPan':\n                this.updateFlipPan(args.value['tempSelectionObj']);\n                break;\n            case 'select':\n                this.select(args.value['type'], args.value['startX'], args.value['startY'], args.value['width'], args.value['height']);\n                break;\n            case 'callUpdateCurrTransState':\n                this.callUpdateCurrTransState();\n                break;\n            case 'resetPanPoints':\n                this.resetPanPoints();\n                break;\n            case 'setClientTransDim':\n                this.setClientTransDim(args.value['isPreventDimension']);\n                break;\n            case 'redrawImgWithObj':\n                this.redrawImgWithObj();\n                break;\n            case 'setCurrentObj':\n                this.setCurrentObj(args.value['obj'], args.value['isUndoRedo'], args.value['isCircleCrop']);\n                break;\n            case 'performPointZoom':\n                this.performPointZoom(args.value['x'], args.value['y'], args.value['type'], args.value['isResize']);\n                break;\n            case 'open':\n                this.open(args.value['data']);\n                break;\n            case 'isInitialLoading':\n                this.isInitialLoading = args.value['isInitialLoading'];\n                break;\n            case 'isInitialLoaded':\n                this.getInitialLoaded(args.value['object']);\n                break;\n            case 'fileSelect':\n                this.fileSelect(args.value['inputElement'], args.value['args']);\n                break;\n            case 'getFileName':\n                args.value['obj']['fileName'] = this.fileName;\n                args.value['obj']['fileType'] = this.fileType;\n                break;\n            case 'getErrorImage':\n                args.value['obj']['isErrorImage'] = this.isErrorImage;\n                break;\n            case 'getInitialZoomValue':\n                args.value['obj']['initialZoomValue'] = this.initZoomValue;\n                break;\n            case 'setShapeTextInsert':\n                this.isShapeTextInserted = args.value['bool'];\n                break;\n            case 'resetCurrentSelectionPoint':\n                this.currSelPoint = null;\n                break;\n            case 'setRotateZoom':\n                this.isRotateZoom = args.value['isRotateZoom'];\n                break;\n            case 'setTempStrokeSettings':\n                this.tempStrokeSettings = args.value['tempStrokeSettings'];\n                break;\n            case 'setTempTextSettings':\n                this.tempTextSettings = args.value['tempTextSettings'];\n                break;\n            case 'setTempAdjustmentValue':\n                this.tempAdjValue = args.value['tempAdjustmentValue'];\n                break;\n            case 'getTempAdjustmentValue':\n                args.value['obj']['value'] = this.tempAdjValue;\n                break;\n            case 'setTempFilter':\n                this.tempFilter = args.value['tempFilter'];\n                break;\n            case 'setTempUndoRedoStep':\n                this.tempUndoRedoStep = args.value['tempUndoRedoStep'];\n                break;\n            case 'setTempFreehandCounter':\n                this.tempFreehandCounter = args.value['tempFreehandCounter'];\n                break;\n            case 'setTempCurrentFreehandDrawIndex':\n                this.tempCurrFhdIndex = args.value['tempCurrentFreehandDrawIndex'];\n                break;\n            case 'setTempZoomFactor':\n                this.tempZoomFactor = args.value['tempZoomFactor'];\n                break;\n            case 'setCancelAction':\n                this.isCancelAction = args.value['bool'];\n                break;\n            case 'getRotatedFlipCropSelection':\n                args.value['bool']['isSelected'] = this.rotatedFlipCropSel;\n                break;\n            case 'getPrevActObj':\n                args.value['obj']['prevActObj'] = this.prevActObj;\n                break;\n            case 'setPrevActObj':\n                this.prevActObj = args.value['prevActObj'];\n                break;\n            case 'setZoomCropWidth':\n                this.zoomCrop.width = args.value['width'];\n                this.zoomCrop.height = args.value['height'];\n                break;\n            case 'setImageEdited':\n                this.isImageEdited = true;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'setNewPath':\n                this.isNewPath = args.value['bool'];\n                break;\n            case 'getNewPath':\n                args.value['obj']['isNewPath'] = this.isNewPath;\n                break;\n            case 'getArrowDimension':\n                args.value['obj']['arrowDimension'] = extend({}, this.arrowDimension, {}, true);\n                break;\n            case 'setArrowDimension':\n                this.arrowDimension = args.value['arrowDimension'];\n                break;\n            case 'moveToSelectionRange':\n                this.moveToSelectionRange(args.value['type'], args.value['activeObj']);\n                break;\n            case 'setResizeSelect':\n                this.isResizeSelect = args.value['bool'];\n                break;\n            case 'applyFrame':\n                this.applyFrame(args.value['ctx'], args.value['frame'], args.value['preventImg']);\n                break;\n            case 'drawImage':\n                this.drawImage();\n                break;\n            case 'downScaleImgCanvas':\n                this.downScaleImgCanvas(args.value['ctx'], args.value['isImgAnnotation'], args.value['isHFlip'], args.value['isVFlip']);\n                break;\n            case 'downScale':\n                this.downScale(args.value['canvas'], args.value['width'], args.value['height']);\n                break;\n            case 'resetFrameZoom':\n                this.resetFrameZoom(args.value['isOk']);\n                break;\n            case 'triggerFrameChange':\n                args.value['obj']['frameChangeEventArgs'] = this.triggerFrameChange(args.value['prevFrameSettings']);\n                break;\n            case 'setImageApply':\n                this.isImageApply = args.value['bool'];\n                break;\n            case 'zoomToSel':\n                this.zoomToSel(args.value['activeObj'], args.value['isToolbar']);\n                break;\n            case 'getStraightenActObj':\n                args.value['obj']['activeObj'] = this.straightenActObj;\n                break;\n            case 'setStraightenActObj':\n                this.straightenActObj = args.value['activeObj'];\n                break;\n            case 'updateImgCanvasPoints':\n                this.updateImgCanvasPoints();\n                break;\n            case 'isLinesIntersect':\n                args.value['obj']['isIntersect'] = this.isLinesIntersect(args.value['obj']);\n                break;\n            case 'getImageCanvasPoints':\n                args.value['obj']['points'] = this.imgCanvasPoints;\n                break;\n            case 'setDestForStraighten':\n                this.setDestForStraighten();\n                break;\n            case 'setTempDestForStraighten':\n                this.tempStraightenDestPoints = extend({}, this.straightenDestPoints, {}, true);\n                break;\n            case 'getStraightenInitZoom':\n                args.value['obj']['zoomFactor'] = this.straightenInitZoom;\n                break;\n            case 'setStraightenInitZoom':\n                this.straightenInitZoom = args.value['zoomFactor'];\n                break;\n            case 'isPointsInsideImg':\n                args.value['obj']['bool'] = this.checkPointPosition(args.value['x'], args.value['y'], this.imgCanvasPoints[0].x, this.imgCanvasPoints[0].y, this.imgCanvasPoints[1].x, this.imgCanvasPoints[1].y, this.imgCanvasPoints[2].x, this.imgCanvasPoints[2].y, this.imgCanvasPoints[3].x, this.imgCanvasPoints[3].y) !== 'inside';\n                break;\n            case 'setIsCropSelect':\n                this.isCropSelect = args.value['bool'];\n                break;\n            case 'updateCropSelection':\n                this.updateCropSelection();\n                break;\n            case 'updateCropSelObj':\n                this.updateCropSelObj();\n                break;\n            case 'redrawDownScale':\n                this.redrawDownScale();\n                break;\n            case 'updateFinetune':\n                this.updateFinetune();\n                break;\n            case 'isSelOutsideImg':\n                args.value['obj']['bool'] = this.isSelOutsideImg();\n                break;\n            case 'resetStraightenDestPoints':\n                this.straightenDestPoints = null;\n                break;\n            case 'checkPointPosition':\n                args.value['obj']['position'] = this.checkPointPosition(args.value['obj']['x'], args.value['obj']['y'], args.value['obj']['x1'], args.value['obj']['y1'], args.value['obj']['x2'], args.value['obj']['y2'], args.value['obj']['x3'], args.value['obj']['y3'], args.value['obj']['x4'], args.value['obj']['y4']);\n                break;\n            case 'updateTempObjColl':\n                this.tempObjColl = extend([], this.parent.objColl, [], true);\n                break;\n            case 'resetTempObjColl':\n                this.tempObjColl = null;\n                break;\n            case 'updateTempPointColl':\n                this.tempPointColl = extend({}, this.parent.pointColl, {}, true);\n                break;\n            case 'resetTempPointColl':\n                this.tempPointColl = {};\n                break;\n            case 'showDialogPopup':\n                this.showDialogPopup();\n                break;\n            case 'imageBackgroundColor':\n                this.imageBackgroundColor = args.value['color'];\n                break;\n            case 'getImageBackgroundColor':\n                args.value['obj']['color'] = this.imageBackgroundColor;\n                break;\n            case 'setTempStrokeWidth':\n                this.tempStrokeWidth = args.value['strokeWidth'];\n                break;\n            case 'setNullExtension':\n                this.isNullExtension = args.value['extension'];\n                break;\n        }\n    };\n    Draw.prototype.getModuleName = function () {\n        return 'draw';\n    };\n    Draw.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.tempZoomFactor)) {\n            this.tempZoomFactor = parent.transform.zoomFactor;\n        }\n        if (this.tempTextSettings.fontFamily === '') {\n            this.tempTextSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Draw.prototype.reset = function () {\n        this.isInitialLoading = this.isErrorImage = this.isNewPath = this.isResizeSelect = false;\n        this.isShapeTextInserted = false;\n        this.isImageApply = false;\n        this.isNullExtension = true;\n        this.initZoomValue = null;\n        this.tempFilter = '';\n        this.origDim = { width: 0, height: 0 };\n        this.currSelPoint = null;\n        this.isRotateZoom = false;\n        this.tempAdjValue = '';\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.tempTextSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.tempUndoRedoStep = this.tempFreehandCounter = this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null;\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.prevActObj = null;\n        this.tempStraightenDestPoints = null;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.straightenActObj = null;\n        this.imgCanvasPoints = [];\n        this.straightenInitZoom = null;\n        this.allowRedactStraighten = true;\n        this.tempObjColl = [];\n        this.tempPointColl = {};\n        this.imageBackgroundColor = '';\n        this.tempStrokeWidth = null;\n        this.straightenDestPoints = null;\n        this.isCropSelect = this.isDownScale = this.preventStraightening = false;\n    };\n    Draw.prototype.redrawDownScale = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.isDownScale = true;\n            this.renderImage();\n            this.isDownScale = false;\n            if (activeObj.shape) {\n                this.drawObject('duplicate', activeObj);\n            }\n        }\n    };\n    Draw.prototype.updateFinetune = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n            var filter = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('draw', { prop: 'redrawDownScale' });\n            var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n            var ctx = this.lowerContext;\n            var imageData = ctx.getImageData(0, 0, ctx.canvas.width, ctx.canvas.height);\n            parent.inMemoryCanvas.width = imageData.width;\n            parent.inMemoryCanvas.height = imageData.height;\n            inMemoryContext.putImageData(imageData, 0, 0);\n            this.lowerContext.filter = filter;\n            parent.notify('draw', { prop: 'redrawDownScale' });\n        }\n    };\n    Draw.prototype.drawImage = function () {\n        this.applyFrame(this.lowerContext, this.parent.frameObj.type);\n    };\n    Draw.prototype.drawObject = function (canvas, obj, isCropRatio, points, isPreventDrag, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = parent.activeObj.activePoint;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var canvasDraw;\n        canvas = canvas.toLowerCase();\n        if (canvas === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        if (!isPreventDrag && actObj.shape) {\n            this.setDragLimit();\n        }\n        if (parent.currObjType.shape) {\n            var splitWords = parent.currObjType.shape.split('-');\n            if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n                this.drawCropRatio();\n            }\n        }\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actObj.strokeSettings)) {\n            var obj_1 = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n            actObj.strokeSettings = obj_1['strokeSettings'];\n        }\n        if (isNullOrUndefined(actObj.strokeSettings.strokeWidth)) {\n            actObj.strokeSettings.strokeWidth = 2;\n        }\n        if (obj) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n        if (points && points.startX && points.startY && points.endX && points.endY && points.width && points.height) {\n            actPoint.startX = points.startX;\n            actPoint.startY = points.startY;\n            actPoint.endX = points.endX;\n            actPoint.endY = points.endY;\n            actPoint.width = points.width;\n            actPoint.height = points.height;\n        }\n        this.updateActiveObject();\n        actObj = parent.activeObj;\n        actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(actPoint.startX) && isNullOrUndefined(actPoint.startY)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var obj_2 = { keyHistory: '' };\n            parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: obj_2 } });\n            actObj.keyHistory = obj_2['keyHistory'];\n        }\n        var isCrop = false;\n        if (canvas !== 'original') {\n            var splitWords = void 0;\n            if (actObj.shape) {\n                splitWords = actObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                if (points && points.startX && points.startY && points.endX && points.endY && points.width && points.height) {\n                    actPoint.startX = points.startX;\n                    actPoint.startY = points.startY;\n                    actPoint.endX = points.endX;\n                    actPoint.endY = points.endY;\n                    actPoint.width = points.width;\n                    actPoint.height = points.height;\n                }\n                else {\n                    actPoint = actObj.activePoint;\n                }\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n                this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n            }\n            if (isNullOrUndefined(isPreventSelection) && (canvasDraw === this.lowerContext || canvasDraw === this.upperContext)) {\n                this.rotateContext('initial', canvasDraw);\n                this.drawOuterSelection(canvasDraw);\n                this.rotateContext('reverse', canvasDraw);\n            }\n        }\n        parent.currObjType.isActiveObj = true;\n        var object = { keyHistory: '' };\n        parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: object } });\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape, saveContext, isPreventSelection);\n        }\n        else if (object['keyHistory'] !== '' && parent.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text', saveContext, isPreventSelection);\n        }\n        else if (actObj.shape) {\n            this.drawShapeObj(canvas, actObj.shape, saveContext, isPreventSelection);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined, saveContext, isPreventSelection);\n        }\n        if (canvas === 'duplicate' && isCrop && actObj.shape !== 'crop-circle' && parent.frameObj.type !== 'none') {\n            this.applyFrame(this.upperContext, parent.frameObj.type);\n            this.drawCornerCircles(this.upperContext);\n        }\n    };\n    Draw.prototype.rotateContext = function (type, ctx) {\n        var parent = this.parent;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        var _c = parent.activeObj.activePoint, startX = _c.startX, startY = _c.startY, width = _c.width, height = _c.height;\n        if (shape === 'line' || shape === 'arrow') {\n            return;\n        }\n        var rotationAngle = (type === 'initial') ? rotatedAngle : -rotatedAngle;\n        var translateX;\n        var translateY;\n        if (parent.transform.straighten === 0 && !parent.isCropTab) {\n            translateX = startX + (width / 2);\n            translateY = startY + (height / 2);\n        }\n        else {\n            translateX = destLeft + (destWidth / 2);\n            translateY = destTop + (destHeight / 2);\n        }\n        ctx.translate(translateX, translateY);\n        ctx.rotate(rotationAngle);\n        ctx.translate(-translateX, -translateY);\n    };\n    Draw.prototype.setDragLimit = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.activeObj, shape = _a.shape, rotatedAngle = _a.rotatedAngle;\n        if (actPoint && shape !== 'image' && shape !== 'line' && rotatedAngle === 0 && parent.activeObj.preventShapeDragOut) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            if (actPoint.startX < destLeft) {\n                actPoint.startX = destLeft;\n                actPoint.endX = Math.min(actPoint.startX + actPoint.width, destLeft + destWidth);\n            }\n            else if (actPoint.endX > destLeft + destWidth) {\n                actPoint.endX = destLeft + destWidth;\n                actPoint.startX = Math.max(actPoint.endX - actPoint.width, destLeft);\n            }\n            if (actPoint.startY < destTop) {\n                actPoint.startY = destTop;\n            }\n            else if (actPoint.endY > destTop + destHeight) {\n                actPoint.endY = destTop + destHeight;\n                actPoint.startY = Math.max(actPoint.endY - actPoint.height, destTop);\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.drawCropRatio = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x;\n        var y;\n        var width;\n        var height;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.zoomFactor > 0 && this.currSelPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.drawCustomSelection('crop-custom', null, null, null, null);\n            if (parent.transform.straighten !== 0) {\n                actPoint = parent.activeObj.activePoint;\n            }\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = actPoint.width < actPoint.height ? actPoint.width : actPoint.height;\n                height = width;\n            }\n            else {\n                width = actPoint.width;\n                height = actPoint.height;\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.activeObj = activeObj;\n            parent.currObjType.shape = activeObj.shape;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isCustomCrop = false;\n        }\n        else {\n            width = destWidth;\n            height = destHeight;\n            if (destLeft < 0) {\n                width += destLeft;\n            }\n            if (destTop < 0) {\n                height += destTop;\n            }\n            if (destLeft + destWidth > parent.lowerCanvas.width) {\n                width -= (destLeft + destWidth - parent.lowerCanvas.width);\n            }\n            if (destTop + destHeight > parent.lowerCanvas.height) {\n                height -= (destTop + destHeight - parent.lowerCanvas.height);\n            }\n        }\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                parent.notify('selection', { prop: 'setDragDirection', onPropertyChange: false, value: { width: width, height: height } });\n                actPoint = parent.activeObj.activePoint;\n                if (parent.lowerCanvas.width < (actPoint.endX - actPoint.startX)) {\n                    actPoint.startX = 7.5;\n                    actPoint.endX = parent.lowerCanvas.width - 7.5;\n                }\n                if (parent.lowerCanvas.height < (actPoint.endY - actPoint.startY)) {\n                    actPoint.startY = 7.5;\n                    actPoint.endY = parent.lowerCanvas.height - 7.5;\n                }\n                if (width === destWidth && height === destHeight) {\n                    actPoint.startX += destLeft;\n                    actPoint.startY += destTop;\n                    actPoint.endX += destLeft;\n                    actPoint.endY += destTop;\n                }\n                if (parent.lowerCanvas.width > parent.lowerCanvas.height) {\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    actPoint.width = actPoint.height;\n                    actPoint.endX = actPoint.startX + actPoint.width;\n                }\n                else {\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.width;\n                    actPoint.endY = actPoint.startY + actPoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n            case 'crop-2:3':\n                x = 2;\n                y = 3;\n                break;\n            case 'crop-3:4':\n                x = 3;\n                y = 4;\n                break;\n            case 'crop-4:5':\n                x = 4;\n                y = 5;\n                break;\n            case 'crop-5:7':\n                x = 5;\n                y = 7;\n                break;\n            case 'crop-9:16':\n                x = 9;\n                y = 16;\n                break;\n            default:\n                x = parseInt(parent.currObjType.shape.toLowerCase().split('crop-')[1].split(':')[0]);\n                y = parseInt(parent.currObjType.shape.toLowerCase().split('crop-')[1].split(':')[1]);\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            parent.notify('selection', { prop: 'calcShapeRatio', onPropertyChange: false,\n                value: { x: x, y: y, imgWidth: width, imgHeight: height } });\n            if (width === destWidth && height === destHeight) {\n                this.updatePoints();\n            }\n            actPoint = parent.activeObj.activePoint;\n        }\n        if (actPoint.startX < destLeft) {\n            var diff = (destLeft - actPoint.startX) + 7.5;\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        if (actPoint.startY < destTop) {\n            var diff = (destTop - actPoint.startY) + 7.5;\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        this.adjToCenter();\n        this.enlargeToImg();\n        if (parent.transform.straighten !== 0) {\n            this.adjToStraighten();\n            this.updateActiveObject(parent.activeObj.activePoint, parent.activeObj);\n        }\n        var object = { isIntersect: null, arr: null };\n        var count = 0;\n        actPoint = parent.activeObj.activePoint;\n        if (parent.transform.straighten !== 0) {\n            while (this.isLinesIntersect(object) && count < 100) {\n                count++;\n                var diff = (actPoint.width * 1) / 100;\n                actPoint.startX += diff;\n                actPoint.endX -= diff;\n                diff = (actPoint.height * 1) / 100;\n                actPoint.startY += diff;\n                actPoint.endY -= diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n        }\n        this.straightenInitZoom = parent.transform.zoomFactor;\n        this.straightenActObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n        parent.notify('draw', { prop: 'setDestForStraighten' });\n    };\n    Draw.prototype.adjToCenter = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var diffX = ((parent.lowerCanvas.width) / 2) - (actPoint.endX - actPoint.width / 2);\n        var diffY = ((parent.lowerCanvas.height) / 2) - (actPoint.endY - actPoint.height / 2);\n        actPoint.startX += diffX;\n        actPoint.endX += diffX;\n        actPoint.startY += diffY;\n        actPoint.endY += diffY;\n        if (actPoint.startX < (destLeft >= 7.5 ? destLeft : 7.5)) {\n            var diff = ((destLeft >= 7.5 ? destLeft : 0) - actPoint.startX);\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        else if (actPoint.endX > destLeft + destWidth) {\n            var diff = (actPoint.endX - (destLeft + destWidth));\n            actPoint.startX -= diff;\n            actPoint.endX -= diff;\n        }\n        if (actPoint.startY < (destTop >= 7.5 ? destTop : 7.5)) {\n            var diff = ((destTop >= 7.5 ? destTop : 0) - actPoint.startY);\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        else if (actPoint.endY > destTop + destHeight) {\n            var diff = (actPoint.endY - (destTop + destHeight));\n            actPoint.startY -= diff;\n            actPoint.endY -= diff;\n        }\n    };\n    Draw.prototype.enlargeToImg = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            var actPoint = parent.activeObj.activePoint;\n            var tempActPoint = extend({}, actPoint, {}, true);\n            var count = 0;\n            while (true) {\n                // Increase width and height by 5% from center to enlarge the crop selection\n                count++;\n                var diff = (actPoint.width * 5) / 100;\n                actPoint.startX -= diff;\n                actPoint.endX += diff;\n                diff = (actPoint.height * 5) / 100;\n                actPoint.startY -= diff;\n                actPoint.endY += diff;\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.updateActiveObject(actPoint, parent.activeObj);\n                var object = { isIntersect: null, arr: null };\n                this.updateImgCanvasPoints();\n                this.isLinesIntersect(object);\n                if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] ||\n                    actPoint.startX < 7.5 || actPoint.startY < 7.5 || count === 100) {\n                    actPoint = extend({}, tempActPoint, {}, true);\n                    diff = (actPoint.width * 1) / 100;\n                    actPoint.startX += diff;\n                    actPoint.endX -= diff;\n                    diff = (actPoint.height * 1) / 100;\n                    actPoint.startY += diff;\n                    actPoint.endY -= diff;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    this.updateActiveObject(actPoint, parent.activeObj);\n                    break;\n                }\n                tempActPoint = extend({}, actPoint, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateActiveObject = function (actPoint, obj, isMouseMove, x, y) {\n        var parent = this.parent;\n        actPoint = actPoint ? actPoint : extend({}, parent.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, parent.activeObj, {}, true);\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var startX = actPoint.startX, startY = actPoint.startY, endX = actPoint.endX, endY = actPoint.endY, width = actPoint.width, height = actPoint.height;\n        x = x ? x : 0;\n        y = y ? y : 0;\n        var horCircleWidth = width / 2;\n        var verCircleHeight = height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: startX + x, startY: startY - y,\n            endX: endX + x, endY: endY + y };\n        obj.horBottomLine = { startX: startX - x, startY: endY - y,\n            endX: endX - x, endY: endY + y };\n        obj.verLeftLine = { startX: startX + x, startY: startY - y,\n            endX: startX - y, endY: endY - y };\n        obj.verRightLine = { startX: endX + x, startY: startY + y,\n            endX: endX - x, endY: endY + y };\n        obj.topLeftCircle = { startX: startX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topCenterCircle = { startX: startX + horCircleWidth, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topRightCircle = { startX: endX, startY: startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerLeftCircle = { startX: startX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerRightCircle = { startX: endX, startY: startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomLeftCircle = { startX: startX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomCenterCircle = { startX: startX + horCircleWidth, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomRightCircle = { startX: endX, startY: endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        if (obj.rotatedAngle === 0) {\n            obj.rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                y: obj.bottomCenterCircle.startY + 25 };\n            obj.rotationCirclePoint.ratioX = (obj.rotationCirclePoint.x - parent.img.destLeft) / parent.img.destWidth;\n            obj.rotationCirclePoint.ratioY = (obj.rotationCirclePoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    Draw.prototype.drawOuterSelection = function (canvasDraw, isCropCircle) {\n        var splitWords;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth = (0.5);\n        var tempObj = extend({}, actObj, {}, true);\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (((splitWords && splitWords[0] === 'crop') || actObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n            this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n        }\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.fillStyle = parent.themeColl[parent.theme]['secondaryColor'];\n        var degree;\n        if (tempObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - tempObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else if (actObj.shape === 'path') {\n            canvasDraw.beginPath();\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl[0]) {\n                canvasDraw.moveTo(activeObj.pointColl[0].x, activeObj.pointColl[0].y);\n                if (activeObj.pointColl.length > 1) {\n                    for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                        actPoint.endX = activeObj.pointColl[i].x;\n                        actPoint.endY = activeObj.pointColl[i].y;\n                        canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n                    }\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else {\n            this.drawCornerCircles(canvasDraw);\n        }\n        if (parent.selectionSettings.showCircle && (splitWords === undefined || splitWords[0] !== 'crop')) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            if (actObj.shape === 'text') {\n                canvasDraw.lineWidth *= 2;\n                canvasDraw.beginPath();\n                this.drawRotationArcLine(canvasDraw);\n                canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.beginPath();\n                canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n                canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.lineWidth /= 2;\n            }\n            else {\n                if (parent.activeObj.shape !== 'redact') {\n                    this.drawCenterCircles(canvasDraw);\n                }\n            }\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n        tempObj.rotationCircleLine = actObj.rotationCircleLine;\n        parent.activeObj = extend({}, tempObj, {}, true);\n    };\n    Draw.prototype.drawArrowHead = function (canvasDraw, isStartHead) {\n        var headType = isStartHead ? this.parent.activeObj.start : this.parent.activeObj.end;\n        switch (headType) {\n            case 'arrowSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSolid(canvasDraw, true) : this.arrowSolid(canvasDraw, false);\n                break;\n            case 'arrow':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrow(canvasDraw, true) : this.arrow(canvasDraw, false);\n                break;\n            case 'circleSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircleSolid(canvasDraw, true) : this.arrowCircleSolid(canvasDraw, false);\n                break;\n            case 'circle':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircle(canvasDraw, true) : this.arrowCircle(canvasDraw, false);\n                break;\n            case 'bar':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowBar(canvasDraw, true) : this.arrowBar(canvasDraw, false);\n                break;\n            case 'square':\n            case 'squareSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSquareStart(canvasDraw) : this.arrowSquareEnd(canvasDraw);\n                break;\n        }\n    };\n    Draw.prototype.drawShapeObj = function (canvas, shape, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        var _a = actObj.strokeSettings, strokeColor = _a.strokeColor, fillColor = _a.fillColor, strokeWidth = _a.strokeWidth;\n        var currentShape = shape !== undefined ? shape : parent.currObjType.shape;\n        parent.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        var shapeType = parent.currObjType.shape.toLowerCase();\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'redact'];\n        if (shapeColl.indexOf(shapeType) !== -1) {\n            actObj.shape = parent.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = fillColor;\n        }\n        var horLineWidth = actPoint.width / 3;\n        var verLineHeight = actPoint.height / 3;\n        var selectionWidth = actPoint.endX - actPoint.startX;\n        var selectionHeight = actPoint.endY - actPoint.startY;\n        this.rotateContext('initial', canvasDraw);\n        var degree;\n        var tempFillStyle = canvasDraw.fillStyle;\n        var activeObj;\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'redact':\n                this.drawRedact(canvasDraw, actObj);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                parent.currObjType.isRedact = true;\n                break;\n            case 'ellipse':\n                selectionWidth = Math.abs(selectionWidth);\n                selectionHeight = Math.abs(selectionHeight);\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (fillColor !== '') {\n                    canvasDraw.fillStyle = fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), Math.abs((selectionWidth / 2) - (strokeWidth)), Math.abs((selectionHeight / 2) - (strokeWidth)), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'arrow':\n                if (actObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - actObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                canvasDraw.fillStyle = canvasDraw.strokeStyle;\n                if (isNullOrUndefined(actObj.triangleDirection)) {\n                    actObj.triangleDirection = 'right';\n                }\n                if (isNullOrUndefined(actObj.start)) {\n                    actObj.start = 'none';\n                }\n                if (isNullOrUndefined(actObj.end)) {\n                    actObj.end = 'arrowSolid';\n                }\n                this.drawArrowHead(canvasDraw, true);\n                this.drawArrowHead(canvasDraw, false);\n                if (actObj.end === 'none' && actObj.start !== 'circle' && actObj.start !== 'square') {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                canvasDraw.fillStyle = tempFillStyle;\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'path':\n                activeObj = extend({}, parent.activeObj, {}, true);\n                if (activeObj.pointColl.length > 1) {\n                    var obj = { shape: null };\n                    parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n                    if (obj['shape'] === 'path' && parent.isShapeDrawing) {\n                        var nextPoint = { x: 0, y: 0 };\n                        for (var i = 0, len = activeObj.pointColl.length; i < len; i++) {\n                            if (isNullOrUndefined(activeObj.pointColl[i + 1])) {\n                                nextPoint.x = activeObj.activePoint.endX;\n                                nextPoint.y = activeObj.activePoint.endY;\n                            }\n                            else {\n                                nextPoint.x = activeObj.pointColl[i + 1].x;\n                                nextPoint.y = activeObj.pointColl[i + 1].y;\n                            }\n                            actPoint.startX = activeObj.pointColl[i].x;\n                            actPoint.startY = activeObj.pointColl[i].y;\n                            actPoint.endX = nextPoint.x;\n                            actPoint.endY = nextPoint.y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                            if (Browser.isDevice) {\n                                activeObj.activePoint.endX = nextPoint.x;\n                                activeObj.activePoint.endY = nextPoint.y;\n                            }\n                        }\n                    }\n                    else {\n                        for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                            actPoint.startX = activeObj.pointColl[i - 1].x;\n                            actPoint.startY = activeObj.pointColl[i - 1].y;\n                            actPoint.endX = activeObj.pointColl[i].x;\n                            actPoint.endY = activeObj.pointColl[i].y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    parent.activeObj = actObj = activeObj;\n                }\n                else {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'image':\n                this.shapeImage(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.drawSelection(horLineWidth, verLineHeight);\n                parent.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n        this.rotateContext('reverse', canvasDraw);\n    };\n    Draw.prototype.updatePoints = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop;\n        actPoint.startX += destLeft;\n        actPoint.startY += destTop;\n        actPoint.endX += destLeft;\n        actPoint.endY += destTop;\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n    };\n    Draw.prototype.updateWidthHeight = function (obj) {\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        obj.activePoint.width = endX - startX;\n        obj.activePoint.height = endY - startY;\n        return obj;\n    };\n    Draw.prototype.drawCornerCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var tempObj = parent.activeObj;\n        canvasDraw.beginPath();\n        canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        if (parent.selectionSettings.showCircle) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            canvasDraw.lineWidth *= 2;\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n            canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n            canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n            canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n            canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            canvasDraw.lineWidth /= 2;\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n    };\n    Draw.prototype.drawCenterCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var actObj = parent.activeObj;\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        if (actObj.shape === 'arrow' || actObj.shape === 'line') {\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else if (actObj.shape === 'path') {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl.length > 1) {\n                for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                    actPoint.startX = activeObj.pointColl[i - 1].x;\n                    actPoint.startY = activeObj.pointColl[i - 1].y;\n                    actPoint.endX = activeObj.pointColl[i].x;\n                    actPoint.endY = activeObj.pointColl[i].y;\n                    canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n                    canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n                    canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n                    canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = actObj = activeObj;\n            }\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, actObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else {\n            this.drawRotationArcLine(canvasDraw);\n            canvasDraw.lineTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n        }\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        if (actObj.shape !== 'arrow' && actObj.shape !== 'line' && actObj.shape !== 'path') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y);\n            canvasDraw.arc(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y, actObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth /= 2;\n    };\n    Draw.prototype.drawRotationArcLine = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        if (isNullOrUndefined(actObj.rotationCircleLine)) {\n            actObj.rotationCircleLine = 22.5;\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.flipObjColl) {\n            for (var i = 0, len = actObj.flipObjColl.length; i < len; i++) {\n                var flipStr = actObj.flipObjColl[i].toLowerCase();\n                if (flipStr === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (flipStr === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        switch (degree) {\n            case 0:\n            case 360:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                break;\n            case 90:\n            case -270:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n            case 180:\n            case -180:\n                if (isVerticalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.bottomCenterCircle.startX,\n                        y: actObj.bottomCenterCircle.startY + actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y - actObj.rotationCircleLine);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.topCenterCircle.startX,\n                        y: actObj.topCenterCircle.startY - actObj.rotationCircleLine };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x, actObj.rotationCirclePoint.y + actObj.rotationCircleLine);\n                }\n                break;\n            case 270:\n            case -90:\n                if (isHorizontalflip) {\n                    actObj.rotationCirclePoint = { x: actObj.centerLeftCircle.startX -\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x + actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                else {\n                    actObj.rotationCirclePoint = { x: actObj.centerRightCircle.startX +\n                            actObj.rotationCircleLine, y: actObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(actObj.rotationCirclePoint.x - actObj.rotationCircleLine, actObj.rotationCirclePoint.y);\n                }\n                break;\n        }\n    };\n    Draw.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var _b = actObj.strokeSettings, fillColor = _b.fillColor, strokeColor = _b.strokeColor, strokeWidth = _b.strokeWidth, radius = _b.radius;\n        if (actObj.shape) {\n            splitWords = actObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = strokeColor;\n        }\n        canvasDraw.beginPath();\n        var obj = { width: 0, height: 0 };\n        var ratio = { width: 1, height: 1 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n        ratio = obj;\n        var isTempCanvas = canvasDraw.canvas.id === parent.element.id + '_tempCanvas';\n        var zoomFactor = parent.transform.zoomFactor;\n        var baseRadius = isTempCanvas ? radius * 10 * ((ratio.width + ratio.height) / 2) : radius * 10;\n        var adjustedRadius = baseRadius + (baseRadius * zoomFactor);\n        if (radius !== null) {\n            if (parent.isSafari) {\n                this.drawRoundedRect(canvasDraw, startX, startY, width, height, adjustedRadius);\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                canvasDraw.roundRect(startX, startY, width, height, adjustedRadius);\n            }\n        }\n        else {\n            canvasDraw.rect(startX, startY, width, height);\n        }\n        if (fillColor !== '') {\n            canvasDraw.fillStyle = fillColor;\n            canvasDraw.fill();\n        }\n        if (radius !== null) {\n            if (parent.isSafari) {\n                this.drawRoundedRect(canvasDraw, startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth), adjustedRadius);\n            }\n            else {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                canvasDraw.roundRect(startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth), adjustedRadius);\n            }\n        }\n        else {\n            canvasDraw.rect(startX + strokeWidth, startY + strokeWidth, width - (2 * strokeWidth), height - (2 * strokeWidth));\n        }\n        canvasDraw.fillStyle = strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawRoundedRect = function (canvasDraw, startX, startY, width, height, radius) {\n        var rectRadius = Math.max(0, Math.min(radius, width / 2, height / 2));\n        canvasDraw.moveTo(startX + rectRadius, startY);\n        canvasDraw.arcTo(startX + width, startY, startX + width, startY + height, rectRadius);\n        canvasDraw.arcTo(startX + width, startY + height, startY, startY + height, rectRadius);\n        canvasDraw.arcTo(startX, startY + height, startX, startY, rectRadius);\n        canvasDraw.arcTo(startX, startY, startX + width, startY, rectRadius);\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        this.upperContext.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        actObj.horTopInnerLine = { startX: startX, startY: startY +\n                verLineHeight, endX: endX, endY: endY + verLineHeight };\n        actObj.horBottomInnerLine = { startX: startX, startY: startY + (2 * verLineHeight), endX: endX, endY: endY + (2 * verLineHeight) };\n        actObj.verLeftInnerLine = { startX: startX + horLineWidth,\n            startY: startY, endX: startX + horLineWidth, endY: endY };\n        actObj.verRightInnerLine = { startX: startX + (2 * horLineWidth),\n            startY: startY, endX: startX + (2 * horLineWidth), endY: endY };\n        this.upperContext.moveTo(actObj.horTopInnerLine.startX, actObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(actObj.horTopInnerLine.endX, actObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(actObj.horBottomInnerLine.startX, actObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(actObj.horBottomInnerLine.endX, actObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(actObj.verLeftInnerLine.startX, actObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(actObj.verLeftInnerLine.endX, actObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(actObj.verRightInnerLine.startX, actObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(actObj.verRightInnerLine.endX, actObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    Draw.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width;\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.25)';\n        canvasDraw.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2);\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(parent.activeObj.horTopLine.startX + (selectionWidth / 2), parent.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((endX - startX) / 2) + startX, ((endY - startY) / 2) + startY, (width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, true);\n        parent.currObjType.shape = '';\n    };\n    Draw.prototype.shapeLine = function (canvasDraw, x1, y1, x2, y2) {\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.parent.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(x1, y1);\n        canvasDraw.lineTo(x2, y2);\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    Draw.prototype.manipulateSaveCtx = function (canvasDraw, x, y) {\n        if (canvasDraw !== this.lowerContext && canvasDraw !== this.upperContext) {\n            var obj = { width: 0, height: 0 };\n            this.parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            var ratio = obj;\n            if (x) {\n                x *= (ratio.width);\n            }\n            if (y) {\n                y *= (ratio.height);\n            }\n        }\n        return { x: x, y: y };\n    };\n    Draw.prototype.arrow = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        canvasDraw.lineWidth = strWidth;\n        var x = this.arrowDimension['arrow']['width'];\n        var y = this.arrowDimension['arrow']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrow = actObj.start === 'arrow';\n        var isEndArrow = actObj.end === 'arrow';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        var isStartCircleOrSquare = actObj.start === 'circle' || actObj.start === 'square';\n        if ((start && actObj.triangleDirection === 'left' || actObj.triangleDirection === 'right') &&\n            ((isStartArrow && actObj.end === 'none') || (isStartArrow && !isEndCircleOrSquare && !isStartCircleOrSquare)) ||\n            (!start && (isEndArrow && actObj.start === 'none' || !isStartArrow && !isEndCircleOrSquare && !isStartCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, -x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, -x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n        }\n    };\n    Draw.prototype.arrowSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var x = this.arrowDimension['arrowSolid']['width'];\n        var y = this.arrowDimension['arrowSolid']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        var isStartArrowSolid = actObj.start === 'arrowSolid';\n        var isEndArrowSolid = actObj.end === 'arrowSolid';\n        var isEndCircleOrSquare = actObj.end === 'circle' || actObj.end === 'square';\n        var isStartCircleOrSquare = actObj.start === 'circle' || actObj.start === 'square';\n        if ((start && (isStartArrowSolid && actObj.end === 'none') || (isStartArrowSolid && !isEndCircleOrSquare && !isStartCircleOrSquare)) ||\n            (!start && (isEndArrowSolid && actObj.start === 'none' || !isStartArrowSolid && !isEndCircleOrSquare && !isStartCircleOrSquare))) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(strWidth, 0);\n            canvasDraw.lineTo(-x + y / 2, y / 2);\n            canvasDraw.lineTo(-x + y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(0 - strWidth, 0);\n            canvasDraw.lineTo(x - y / 2, y / 2);\n            canvasDraw.lineTo(x - y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowSquareStart = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartSquare = actObj.start === 'square';\n        var isEndCircle = actObj.end === 'circle';\n        var isStartSquareSolid = actObj.start === 'squareSolid';\n        var isEndCircleSolid = actObj.end === 'circleSolid';\n        if ((isStartSquare && actObj.end === 'none') || (isStartSquare && !isEndCircle && actObj.start !== 'square') ||\n            (isStartSquareSolid && isEndCircleSolid)) {\n            this.shapeLine(canvasDraw, startX, startY, endX, endY);\n        }\n        canvasDraw.lineWidth = (strWidth);\n        canvasDraw.beginPath();\n        canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            this.squareStartIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n        }\n        else if (actObj.triangleDirection === 'right') {\n            canvasDraw.lineWidth = (strWidth);\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.start === 'squareSolid' && actObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.start === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareStartIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.start === 'square' && actObj.end !== 'square' && actObj.end !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (actObj.start === 'square' && actObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowSquareEnd = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + strWidth;\n        y = point.y + strWidth;\n        this.dx = endX - startX;\n        this.dy = endY - startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        canvasDraw.lineWidth = (strWidth);\n        if (actObj.triangleDirection === 'right') {\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if (actObj.end === 'squareSolid' && actObj.start === 'none') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = endX - (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = endY - (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, startX, startY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n        else if (actObj.triangleDirection === 'left') {\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            if (actObj.end === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            actObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = startX + (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = startY + (y / 2) * Math.sin(angle);\n            if (actObj.end === 'square' && actObj.start !== 'square' && actObj.start !== 'circle') {\n                this.shapeLine(canvasDraw, endX, endY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if (actObj.start === 'circle' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if (actObj.start === 'square' && actObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            else if (actObj.end === 'squareSolid' && actObj.start === 'none') {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n        }\n    };\n    Draw.prototype.arrowCircle = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') ||\n            (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (startX - endX) + this.dy * (startY - endY));\n            var c = (startX - endX) * (startX - endX) + (startY - endY) *\n                (startY - endY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = startX + this.dx * t2;\n                var intersectionY1 = startY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    this.endCircleIntersectX1 = endX - this.dx * t2;\n                    this.endCircleIntersectY1 = endY - this.dy * t2;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.startCircleIntersectX1, this.startCircleIntersectY1, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, startX, startY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    canvasDraw.stroke();\n                    canvasDraw.closePath();\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, startX, startY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') ||\n            (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = startX - endX;\n            this.dy = startY - endY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (endX - startX) + this.dy * (endY - startY));\n            var c = (endX - startX) * (endX - startX) + (endY - startY) *\n                (endY - startY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = endX + this.dx * t2;\n                var intersectionY1 = endY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    this.endCircleIntersectX1 = startX - this.dx * t2;\n                    this.endCircleIntersectY1 = startY - this.dy * t2;\n                    if (actObj.start === 'circle' && actObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    else if (actObj.start === 'circle' && actObj.end !== 'circle' && actObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, endX, endY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (actObj.end === 'circle' && (actObj.start !== 'circle' && actObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, endX, endY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowCircleSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var isStartCircleSolid = actObj.start === 'circleSolid';\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                (!start && (actObj.end === 'circleSolid' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(endX, endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (isStartCircleSolid && actObj.end === 'none') ||\n                (isStartCircleSolid && actObj.end !== 'circle' && actObj.end !== 'square')) ||\n                !start && (actObj.end === 'circleSolid' && actObj.start === 'none')) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(startX, startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            actObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n    };\n    Draw.prototype.arrowBar = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var strWidth = actObj.strokeSettings.strokeWidth;\n        if ((start && actObj.triangleDirection === 'left') || (!start && actObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none') ||\n                (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && ((actObj.end === 'bar' && actObj.start === 'none') ||\n                    (actObj.end === 'bar' && (actObj.start !== 'circle' && actObj.start !== 'square'))))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(endX, endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(-x + y / 4, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-endX, -endY);\n            actObj.rotatedAngle = angle;\n        }\n        else if ((start && actObj.triangleDirection === 'right') || (!start && actObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = strWidth;\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            if ((start && (actObj.start === 'bar' && actObj.end === 'none')\n                || (actObj.start === 'bar' && (actObj.end !== 'circle' && actObj.end !== 'square'))) ||\n                (!start && (actObj.end === 'bar' && actObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, startX, startY, endX, endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + strWidth;\n            y = point.y + strWidth;\n            this.dx = endX - startX;\n            this.dy = endY - startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(startX, startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(y / 4 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-startX, -startY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.shapeImage = function (canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var ctx = actObj.imageCanvas.getContext('2d');\n        if (canvasDraw === this.lowerContext && this.isImageApply) {\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: actObj\n                        .imageElement.width, height: actObj.imageElement.height, obj: dimObj, isImgShape: null } });\n            if (width < (dimObj['width'] / 5) || height < (dimObj['height'] / 5)) {\n                ctx.clearRect(0, 0, actObj.imageCanvas.width, actObj.imageCanvas.height);\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: false } });\n                this.isImageApply = false;\n            }\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = width;\n        imgPoint.height = height;\n        if (actObj.flipObjColl.length === 4) {\n            actObj.flipObjColl = [];\n            actObj.shapeFlip = '';\n        }\n        imgPoint.startX = ((width - imgPoint.width) / 2) + startX;\n        imgPoint.startY = ((height - imgPoint.height) / 2) + startY;\n        var temp = canvasDraw.globalAlpha;\n        canvasDraw.globalAlpha = actObj.opacity;\n        if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n            this.rotateImage(canvasDraw);\n        }\n        else {\n            canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        }\n        canvasDraw.globalAlpha = temp;\n        parent.currObjType.isText = false;\n    };\n    Draw.prototype.shapeText = function (canvasDraw) {\n        var parent = this.parent;\n        var filter = canvasDraw.filter;\n        var actObj = parent.activeObj;\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        var rows = actObj.keyHistory.split('\\n');\n        var _b = actObj.textSettings, fontFamily = _b.fontFamily, bold = _b.bold, italic = _b.italic;\n        var fontSize = actObj.textSettings.fontSize;\n        var lHeight = fontSize + fontSize * 0.25;\n        var lineHeight = ((lHeight * rows.length) - (fontSize * rows.length)) / rows.length;\n        canvasDraw.filter = 'none';\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempFill = canvasDraw.fillStyle;\n        if (actObj.strokeSettings.fillColor !== '') {\n            canvasDraw.fillStyle = actObj.strokeSettings.fillColor;\n            canvasDraw.fillRect(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height);\n        }\n        canvasDraw.fillStyle = tempFill;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * fontSize * 0.85) + (i * lineHeight);\n            if (parent.transform.degree === -360) {\n                parent.transform.degree = 0;\n            }\n            if (parent.transform.degree === 0 || parent.transform.degree === 180) {\n                if (fontSize > height) {\n                    fontSize = actObj.textSettings.fontSize = height - (height * 0.1);\n                }\n            }\n            else {\n                if (fontSize > width) {\n                    fontSize = actObj.textSettings.fontSize = width - (width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = actObj.strokeSettings.outlineColor;\n            canvasDraw.fillStyle = actObj.strokeSettings.strokeColor;\n            var tempWidth = canvasDraw.lineWidth;\n            var obj = { width: 0, height: 0 };\n            var ratio = { width: 1, height: 1 };\n            parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            ratio = obj;\n            var isTempCanvas = canvasDraw.canvas.id === parent.element.id + '_tempCanvas';\n            var baseWidth = Math.max(1, actObj.strokeSettings.outlineWidth / 2);\n            if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(actObj.strokeSettings.outlineColor)) {\n                canvasDraw.lineWidth = baseWidth * ((isTempCanvas ? Math.floor((fontSize - 1) / 60) :\n                    Math.floor((fontSize - 1) / 16)) * 0.5 + 0.5);\n                if (isTempCanvas) {\n                    canvasDraw.lineWidth *= ((ratio.width + ratio.height) / 2);\n                    if (parent.transform.degree !== 0) {\n                        canvasDraw.lineWidth /= 1.8;\n                    }\n                }\n            }\n            else {\n                canvasDraw.lineWidth = 0;\n            }\n            var textStyle = '';\n            if (bold) {\n                textStyle = 'bold ';\n            }\n            if (italic) {\n                textStyle = 'italic ';\n            }\n            if (bold && italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n            if (actObj.flipObjColl.length === 4) {\n                actObj.flipObjColl = [];\n                actObj.shapeFlip = '';\n            }\n            if (actObj.rotateFlipColl && actObj.rotateFlipColl.length > 0) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.strokeText(text, startX + fontSize * 0.1, startY + yPoint);\n                canvasDraw.fillText(text, startX + fontSize * 0.1, startY + yPoint);\n            }\n            canvasDraw.lineWidth = tempWidth;\n        }\n        canvasDraw.filter = filter;\n        parent.currObjType.isText = false;\n        if (this.upperContext === canvasDraw) {\n            this.drawOuterSelection(canvasDraw);\n        }\n    };\n    Draw.prototype.updateActPoint = function (degree, canvasDraw) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var actPoint = actObj.activePoint;\n        if (degree.toLowerCase() === 'horizontal') {\n            if (actPoint.startX <= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width / 2 + ((canvasDraw.canvas.width / 2) - actPoint.endX);\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startX >= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width - actPoint.endX;\n                actPoint.endX = actPoint.startX + actPoint.width;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (actPoint.startY <= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height / 2 + ((canvasDraw.canvas.height / 2) - actPoint.endY);\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n            else if (actPoint.startY >= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height - actPoint.endY;\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, actObj);\n                parent.activeObj = actObj;\n            }\n        }\n        return actPoint;\n    };\n    Draw.prototype.rotateImage = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actObj.activePoint.width :\n            actObj.activePoint.height;\n        imgPoint.startX = actObj.activePoint.startX;\n        imgPoint.startY = actObj.activePoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                tempDegree = coll;\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.height : actObj.activePoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actObj.activePoint.width :\n                    actObj.activePoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = canvasDraw.canvas.width - (actObj.activePoint.startX + actObj.activePoint.width);\n                    startY += ((actObj.activePoint.width - imgPoint.height) / 2);\n                    startX = imgPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - (actObj.activePoint.startY + actObj.activePoint.height);\n                    startX += ((actObj.activePoint.height - imgPoint.width) / 2);\n                    startY = imgPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actObj.activePoint.startX = startX;\n                actObj.activePoint.startY = startY;\n                actObj.activePoint.endX = actObj.activePoint.startX + imgPoint.width;\n                actObj.activePoint.endY = actObj.activePoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    actObj.activePoint = this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    actObj.activePoint = this.updateActPoint('vertical', canvasDraw);\n                }\n                imgPoint.startX = actObj.activePoint.startX;\n                imgPoint.startY = actObj.activePoint.startY;\n            }\n            imgPoint.startX = actObj.activePoint.startX;\n            imgPoint.startY = actObj.activePoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        canvasDraw.drawImage(actObj.imageCanvas, imgPoint.startX, imgPoint.startY, imgPoint.width, imgPoint.height);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.rotateText = function (canvasDraw) {\n        var parent = this.parent;\n        var degree;\n        var actObj = parent.activeObj;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        var actPoint = parent.activeObj.activePoint;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var imgPoint = { startX: 0, startY: 0, width: 0, height: 0 };\n        imgPoint.width = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.height : actPoint.width;\n        imgPoint.height = degree % 90 === 0 && degree % 180 !== 0 ? actPoint.width : actPoint.height;\n        imgPoint.startX = actPoint.startX;\n        imgPoint.startY = actPoint.startY;\n        var startX = imgPoint.startX;\n        var startY = imgPoint.startY;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempDegree;\n        var tempColl = [];\n        canvasDraw.save();\n        for (var i = 0, len = actObj.rotateFlipColl.length; i < len; i++) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var coll = actObj.rotateFlipColl[i];\n            tempColl.push(coll);\n            if (typeof (coll) === 'number') {\n                tempDegree = coll;\n                if (tempDegree === -450) {\n                    tempDegree = -90;\n                }\n                if (tempDegree < 0) {\n                    tempDegree = 360 + tempDegree;\n                }\n                imgPoint.width = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.height : actPoint.width;\n                imgPoint.height = tempDegree % 90 === 0 && tempDegree % 180 !== 0 ? actPoint.width : actPoint.height;\n                canvasDraw.translate(canvasDraw.canvas.width / 2, canvasDraw.canvas.height / 2);\n                canvasDraw.rotate(Math.PI / 180 * coll);\n                canvasDraw.translate(-canvasDraw.canvas.height / 2, -canvasDraw.canvas.width / 2);\n                if ((tempDegree % 90 === 0 && tempDegree % 270 !== 0) || tempDegree === 0) {\n                    startY = (canvasDraw.canvas.width - actPoint.endX);\n                    startX = actPoint.startY;\n                }\n                else if (tempDegree % 270 === 0) {\n                    startX = canvasDraw.canvas.height - actPoint.endY;\n                    startY = actPoint.startX;\n                }\n                imgPoint.startX = startX;\n                imgPoint.startY = startY;\n                actPoint.startX = startX;\n                actPoint.startY = startY;\n                actPoint.endX = actPoint.startX + imgPoint.width;\n                actPoint.endY = actPoint.startY + imgPoint.height;\n                actObj = this.updateWidthHeight(actObj);\n            }\n            else {\n                if (coll === 'horizontal' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'vertical';\n                }\n                else if (coll === 'vertical' && degree % 90 === 0 && degree % 180 !== 0) {\n                    coll = 'horizontal';\n                }\n                if (coll === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                }\n                else if (coll === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                }\n                actObj.activePoint = actPoint = this.updateActPoint(coll, canvasDraw);\n                imgPoint.startX = actPoint.startX;\n                imgPoint.startY = actPoint.startY;\n            }\n            imgPoint.startX = actPoint.startX;\n            imgPoint.startY = actPoint.startY;\n            startX = imgPoint.startX;\n            startY = imgPoint.startY;\n        }\n        if (actObj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: actObj } });\n        }\n        startY += actObj.textSettings.fontSize * 0.4;\n        this.textFlipDegree(canvasDraw, startX, startY);\n        canvasDraw.restore();\n        parent.activeObj = tempActiveObj;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var parent = this.parent;\n        var actObj = parent.activeObj;\n        var rows = actObj.keyHistory.split('\\n');\n        var fontSize = actObj.textSettings.fontSize;\n        var lineHeight = ((fontSize * rows.length) - (fontSize * rows.length)) / rows.length;\n        var yPoint = (fontSize * 0.85) + lineHeight;\n        for (var i = 0, len = rows.length; i < len; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (fontSize * 0.85);\n                }\n                yPoint += fontSize + fontSize * 0.15;\n            }\n            canvasDraw.strokeText(text, startX + fontSize * 0.15, startY +\n                yPoint + (i > 0 ? fontSize * 0.25 : -fontSize * 0.35));\n            canvasDraw.fillText(text, startX + fontSize * 0.15, startY +\n                yPoint + (i > 0 ? fontSize * 0.25 : -fontSize * 0.35));\n        }\n    };\n    Draw.prototype.clearOuterCanvas = function (context) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var left = destLeft > 0 ? destLeft : 0;\n        var top = destTop > 0 ? destTop : 0;\n        context.clearRect(0, 0, left, parent.lowerCanvas.height);\n        context.clearRect(destLeft + destWidth, 0, parent.lowerCanvas.width - (destLeft + destWidth), parent.lowerCanvas.height);\n        context.clearRect(0, 0, parent.lowerCanvas.width, top);\n        context.clearRect(0, destTop + destHeight, parent.lowerCanvas.width, parent.lowerCanvas.height - (destTop + destHeight));\n        if (parent.transform.currFlipState !== '') {\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n        }\n    };\n    Draw.prototype.setDestPoints = function () {\n        var maxDimension;\n        var parent = this.parent;\n        var _a = parent.transform, degree = _a.degree, zoomFactor = _a.zoomFactor;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcHeight, height: parent.img.srcWidth, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.height;\n                parent.img.destHeight = maxDimension.width;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.height) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.width) / 2;\n            parent.img.destWidth = maxDimension.height;\n            parent.img.destHeight = maxDimension.width;\n        }\n        else {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * zoomFactor);\n                maxDimension.height += (maxDimension.height * zoomFactor);\n                parent.img.destWidth = maxDimension.width;\n                parent.img.destHeight = maxDimension.height;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            if (degree === 0) {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            }\n            else {\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            }\n            parent.img.destWidth = maxDimension.width;\n            parent.img.destHeight = maxDimension.height;\n        }\n    };\n    Draw.prototype.updateCurrTransState = function (type, isPreventDestination, isRotatePan, isStraighten) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        if (type === 'initial') {\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            if (isNullOrUndefined(isPreventDestination)) {\n                this.setDestPoints();\n            }\n        }\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            this.currTransState(type, true, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n            if (isRotatePan) {\n                parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop +=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            if (isRotatePan) {\n                parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop -=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n        }\n        else {\n            this.currTransState(type, null, null, isRotatePan);\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '' && parent.transform.straighten === 0 &&\n                isNullOrUndefined(isStraighten)) {\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n            }\n        }\n    };\n    Draw.prototype.currTransState = function (type, isPreventDimension, context, isPreventCircleCrop) {\n        var parent = this.parent;\n        context = context ? context : this.lowerContext;\n        if (type === 'initial') {\n            this.setTransformColl(context, type);\n        }\n        else if (type === 'reverse') {\n            this.setTransformColl(context, type);\n            this.setClientTransDim(isPreventDimension);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle'\n                && isNullOrUndefined(isPreventCircleCrop))) {\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n                }\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop -= parent.panPoint.totalPannedClientPoint.y;\n                }\n            }\n        }\n    };\n    Draw.prototype.setTransformColl = function (context, type) {\n        var parent = this.parent;\n        if (type === 'initial') {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                this.setTransform(context, parent.rotateFlipColl[i]);\n            }\n        }\n        else if (type === 'reverse') {\n            for (var i = parent.rotateFlipColl.length - 1; i >= 0; i--) {\n                this.setTransform(context, parent.rotateFlipColl[i], true);\n            }\n        }\n    };\n    Draw.prototype.setTransform = function (context, value, isReverse) {\n        var parent = this.parent;\n        if (isReverse && value === 90) {\n            value = -90;\n        }\n        else if (isReverse && value === -90) {\n            value = 90;\n        }\n        if (value === 'horizontal' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'vertical';\n        }\n        else if (value === 'vertical' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'horizontal';\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        if (isNullOrUndefined(isReverse)) {\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n        switch (value) {\n            case 90:\n            case -90:\n                context.translate(context.canvas.width / 2, context.canvas.height / 2);\n                context.rotate(Math.PI / 180 * value);\n                context.translate(-context.canvas.width / 2, -context.canvas.height / 2);\n                break;\n            case 'horizontal':\n                context.translate(context.canvas.width, 0);\n                context.scale(-1, 1);\n                break;\n            case 'vertical':\n                context.translate(0, context.canvas.height);\n                context.scale(1, -1);\n                break;\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: false } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n    };\n    Draw.prototype.drawImgToCanvas = function (maxDimension) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.img.destWidth = maxDimension.width;\n        parent.img.destHeight = maxDimension.height;\n        if (this.isInitialLoading) {\n            parent.notify('filter', { prop: 'initFilter', onPropertyChange: false });\n            this.isInitialLoading = false;\n        }\n        var temp = this.lowerContext.filter;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.drawImage();\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.renderImage = function (isMouseWheel, isPreventClearRect, isFrame, isStraighten) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        if (isNullOrUndefined(isPreventClearRect)) {\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        }\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        else {\n            if (parent.transform.zoomFactor !== 0) {\n                this.isRotateZoom = true;\n            }\n            this.updateCurrTransState('initial', null, null, isStraighten);\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        else {\n            this.updateCurrTransState('reverse', null, null, isStraighten);\n            this.isRotateZoom = false;\n        }\n        if (isFrame) {\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        else {\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        }\n        this.clearOuterCanvas(this.lowerContext);\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        parent.baseImg.src = src;\n        parent.baseImg.onload = function () {\n            parent.imgSrc = src;\n            if (!parent.isUndoRedo) {\n                parent.notify('filter', { prop: 'update-finetunes', onPropertyChange: false });\n            }\n            proxy.lowerContext.drawImage(parent.baseImg, 0, 0, proxy.parent.lowerCanvas.width, proxy.parent.lowerCanvas.height);\n            var isCropped = false;\n            var isSameDimension = false;\n            if (parent.isImageUpdated) {\n                var _a = parent.img, srcWidth = _a.srcWidth, srcHeight = _a.srcHeight;\n                var _b = parent.baseImgCanvas, width = _b.width, height = _b.height;\n                isCropped = srcWidth !== width || srcHeight !== height;\n                isSameDimension = parent.baseImg.width === width && parent.baseImg.height === height;\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            proxy.updateBaseImgCanvas();\n            var fileOpened = { fileName: _this.fileName, fileType: _this.fileType, isValidImage: true };\n            proxy.updateCanvas(isCropped, isSameDimension);\n            if (parent.currObjType.isUndoZoom) {\n                parent.currObjType.isUndoZoom = false;\n                proxy.parent.lowerCanvas.style.display = 'block';\n            }\n            parent.isUndoRedo = _this.isErrorImage = false;\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: Browser.isDevice, isOkBtn: null,\n                    isResize: null, isFrame: null, isMainToolbar: true };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n                parent.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                var eventargs = { isApplyBtn: false, isDevice: false, isOkBtn: null };\n                parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            if (parent.isImageLoaded && parent.element.style.opacity !== '0.5') {\n                parent.trigger('fileOpened', fileOpened);\n                var action = { action: 'file-open', actionEventArgs: fileOpened };\n                parent.triggerEditCompleteEvent(action);\n            }\n        };\n        parent.baseImg.onerror = function () {\n            hideSpinner(parent.element);\n            proxy.isErrorImage = true;\n            proxy.errorLoading();\n        };\n    };\n    Draw.prototype.errorLoading = function () {\n        var parent = this.parent;\n        var fileOpened = { fileName: null, fileType: null, isValidImage: false };\n        parent.trigger('fileOpened', fileOpened);\n    };\n    Draw.prototype.updateBaseImgCanvas = function () {\n        var parent = this.parent;\n        parent.baseImgCanvas.width = parent.baseImg.width;\n        parent.baseImgCanvas.height = parent.baseImg.height;\n        parent.baseImgCanvas.getContext('2d').drawImage(parent.baseImg, 0, 0);\n    };\n    Draw.prototype.updateCanvas = function (isCropped, isSameDimension) {\n        var parent = this.parent;\n        if (!parent.isImageUpdated || !isCropped) {\n            parent.img.srcWidth = parent.baseImgCanvas.width;\n            parent.img.srcHeight = parent.baseImgCanvas.height;\n        }\n        else if (!isSameDimension && isCropped) {\n            parent.img.srcLeft = 0;\n            parent.img.srcTop = 0;\n            parent.img.srcWidth = parent.baseImgCanvas.width;\n            parent.img.srcHeight = parent.baseImgCanvas.height;\n            parent.currSelectionPoint = null;\n            parent.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n                degree: 0, currFlipState: '', straighten: 0, destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                zoomFactor: 0, previousZoomValue: 0, aspectWidth: null, aspectHeight: null, frame: 'none', straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        this.drawImgToCanvas(maxDimension);\n        this.origDim.width = parent.img.destWidth;\n        this.origDim.height = parent.img.destHeight;\n        this.zoomCrop.width = parent.img.destWidth;\n        this.zoomCrop.height = parent.img.destHeight;\n        parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n            value: { width: parent.img.destWidth, height: parent.img.destHeight } });\n        var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        parent.notify('crop', { prop: 'setCropDestPoints', onPropertyChange: false, value: { point: point } });\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if (parent.img.destWidth > 0 && parent.img.destHeight > 0) {\n            parent.isImageLoaded = true;\n        }\n        if (parent.isUndoRedo) {\n            if (parent.transform.currFlipState !== '') {\n                parent.notify('transform', { prop: 'flipImage', onPropertyChange: false,\n                    value: { direction: parent.toPascalCase(parent.transform.currFlipState) } });\n            }\n        }\n        if (parent.disabled) {\n            parent.element.setAttribute('class', 'e-disabled');\n        }\n        if (parent.zoomSettings.zoomFactor !== 1 || parent.zoomSettings.zoomPoint) {\n            parent.zoom(parent.zoomSettings.zoomFactor, parent.zoomSettings.zoomPoint);\n        }\n        if (isNullOrUndefined(this.initZoomValue)) {\n            this.initZoomValue = parent.zoomSettings.zoomFactor;\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.resetFrameZoom = function (isOk) {\n        var parent = this.parent;\n        if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n            var temp = parent.tempFrameZoomLevel;\n            parent.tempFrameZoomLevel = null;\n            parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: temp, zoomPoint: null, isResize: true } });\n            var obj = parent.cancelCropSelection;\n            if (isOk && obj) {\n                obj.previousObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.currentObj.frameObj = extend({}, parent.frameObj, null, true);\n                obj.previousObj.frame = obj.currentObj.frame = parent.frameObj.type;\n            }\n            this.updateCropSelObj();\n            parent.cancelCropSelection = null;\n        }\n    };\n    Draw.prototype.performCancel = function (isContextualToolbar, isUndoRedo, isFinalCancel) {\n        var parent = this.parent;\n        if (isFinalCancel) {\n            parent.noPushUndo = false;\n        }\n        var straightenObj = { bool: parent.isStraightening };\n        isContextualToolbar = isContextualToolbar ? isContextualToolbar : false;\n        var obj = { bool: false };\n        parent.allowDownScale = true;\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (isNullOrUndefined(isUndoRedo) && JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            extend(parent.frameObj, parent.tempFrameObj);\n            this.renderImage(null, null, true);\n        }\n        this.resetFrameZoom(false);\n        var editCompleteArgs = { action: '' };\n        if (obj['bool']) {\n            editCompleteArgs['action'] = 'freehand-draw';\n            parent.notify('freehand-draw', { prop: 'cancelFhd', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            editCompleteArgs['action'] = 'text-editing';\n            parent.textArea.style.display = 'none';\n            parent.textArea.value = '';\n            parent.textArea.style.transform = '';\n            if (this.prevActObj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.activeObj.strokeSettings = this.tempStrokeSettings;\n                parent.activeObj.textSettings = this.tempTextSettings;\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            if (this.isShapeTextInserted) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (parent.drawingShape) {\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            }\n        }\n        else if ((!parent.activeObj.shape || parent.activeObj.shape !== 'redact') && (((!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) &&\n            document.querySelector('#' + parent.element.id + '_sliderWrapper')) || parent.currObjType.isFiltered)) {\n            editCompleteArgs['action'] = parent.isFinetuneBtnClick ? 'fine-tune' : 'filter';\n            this.lowerContext.filter = this.tempAdjValue;\n            parent.canvasFilter = this.tempAdjValue;\n            parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.tempAdjValue } });\n            parent.initialAdjustmentValue = this.tempAdjValue;\n            if (this.lowerContext.filter.split(' ').length > 1 &&\n                this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: false } });\n            }\n            parent.currentFilter = this.tempFilter;\n            parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.redrawImgWithObj();\n            parent.currObjType.isFiltered = false;\n            var obj_3 = { tempAdjustmentLevel: null };\n            parent.notify('filter', { prop: 'getTempAdjustmentLevel', onPropertyChange: false, value: { obj: obj_3 } });\n            parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false,\n                value: { adjustmentLevel: extend({}, obj_3['tempAdjustmentLevel'], {}, true) } });\n            parent.notify('undo-redo', { prop: 'setUndoRedoStep', onPropertyChange: false, value: { step: this.tempUndoRedoStep } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.isCustomCrop = false;\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n            this.clearOuterCanvas(this.lowerContext);\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            if (parent.activeObj.shape && parent.activeObj.shape === 'image') {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.drawingShape) {\n                parent.drawingShape = null;\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            }\n        }\n        else {\n            if ((!parent.activeObj.shape || parent.activeObj.shape !== 'redact') && isContextualToolbar && (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool']))) {\n                var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            else {\n                this.cancelItems(editCompleteArgs);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.togglePan = true;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                }\n                else {\n                    parent.togglePan = false;\n                    parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                }\n            }\n        }\n        this.isShapeTextInserted = false;\n        this.isNewPath = false;\n        parent.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n        parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n        if (isFinalCancel) {\n            parent.noPushUndo = false;\n        }\n        parent.drawingShape = null;\n        parent.notify('draw', { prop: 'resetTempObjColl' });\n        parent.notify('draw', { prop: 'resetTempPointColl' });\n        parent.isMaskImage = parent.isFinetuneBtnClick = false;\n        var actionArgs = { action: 'cancel', actionEventArgs: editCompleteArgs };\n        parent.triggerEditCompleteEvent(actionArgs);\n    };\n    Draw.prototype.cancelItems = function (editCompleteArgs) {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var id = parent.element.id;\n        var ascpectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n        var splitWords;\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'redact'];\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && parent.isCropTab) {\n            parent.isCropTab = false;\n            parent.transform.zoomFactor = parent.transform.defaultZoomFactor;\n        }\n        if (parent.isResize) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            if (ascpectIcon || nonAspectIcon || parent.currentToolbar === 'resize-toolbar') {\n                editCompleteArgs['action'] = 'resize';\n                var obj = { width: null, height: null };\n                parent.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj } });\n                var point = { x: obj['width'], y: obj['height'] };\n                var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n                var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n                if (point && point.x && point.y && !isNullOrUndefined(parent.aspectWidth)) {\n                    if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                        parent.notify('transform', { prop: 'resizeImage', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                    }\n                    else {\n                        var bool = parent.currObjType.isUndoAction;\n                        parent.currObjType.isUndoAction = false;\n                        parent.notify('transform', { prop: 'resizeCrop', value: { width: parent.aspectWidth, height: parent.aspectHeight } });\n                        parent.currObjType.isUndoAction = bool;\n                    }\n                }\n                var obj1 = { prevCropObj: parent.prevCropObj };\n                var obj2 = { prevObj: parent.prevObj };\n                parent.notify('toolbar', { prop: 'getPrevCropObj', onPropertyChange: false, value: { obj: obj1 } });\n                parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj2 } });\n                if (obj1['prevCropObj'] && obj2['prevObj']) {\n                    parent.objColl = [];\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.cropObj = extend({}, obj1['prevCropObj'], {}, true);\n                    this.setCurrentObj(obj2['prevObj']);\n                    parent.objColl = obj2['prevObj']['objColl'];\n                    parent.pointColl = obj2['prevObj']['pointColl'];\n                    parent.freehandCounter = parent.pointColl.length;\n                    parent.transform.straighten = 0;\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                    var currObj = parent.currSelectionPoint ?\n                        extend({}, parent.currSelectionPoint, {}, true) : null;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                    parent.currSelectionPoint = currObj;\n                    if (obj2['prevObj'].zoomFactor) {\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                    }\n                    parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                        value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                }\n                parent.isResize = false;\n                parent.notify('transform', { prop: 'setResizedImgAngle', onPropertyChange: false, value: { angle: null } });\n                var temp = parent.isCropTab;\n                parent.isCropTab = false;\n                this.updateCropSelObj();\n                parent.cancelCropSelection = null;\n                parent.isCropTab = temp;\n            }\n        }\n        switch (true) {\n            case parent.togglePen:\n                editCompleteArgs['action'] = 'freehand-draw';\n                this.cancelPen();\n                break;\n            case parent.activeObj.shape === 'text':\n                editCompleteArgs['action'] = 'text';\n                this.cancelText();\n                break;\n            case shapes.indexOf(parent.activeObj.shape) !== -1:\n                editCompleteArgs['action'] = parent.activeObj.shape;\n                this.cancelShape();\n                parent.currObjType.isRedact = false;\n                break;\n            case isCropSelection:\n                editCompleteArgs['action'] = 'crop-selection';\n                this.cancelSelection();\n                break;\n            default:\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                break;\n        }\n        parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        parent.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n    };\n    Draw.prototype.cancelPen = function () {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.togglePen = false;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        // eslint-disable-next-line\n        var tempPointsColl = extend([], parent.pointColl, [], true);\n        parent.pointColl = {};\n        for (var i = 0; i < this.tempFreehandCounter; i++) {\n            parent.pointColl[i] = tempPointsColl[i];\n        }\n        parent.freehandCounter = this.tempFreehandCounter;\n        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex', value: { value: this.tempCurrFhdIndex } });\n        parent.activeObj.strokeSettings = this.tempStrokeSettings;\n        parent.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: parent.activeObj.strokeSettings, strokeColor: null,\n                fillColor: null, strokeWidth: null, radius: null } });\n        parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: this.tempStrokeWidth } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        this.tempPointColl = {};\n        this.renderImage();\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelText = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n            value: { textSettings: this.tempTextSettings, fontFamily: null, fontSize: null } });\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null, radius: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var len = object['appliedUndoRedoColl'].length;\n            var appliedColl = object['appliedUndoRedoColl'][len - 1];\n            if (this.prevActObj && appliedColl && appliedColl.currentObjColl.length &&\n                appliedColl.currentObjColl[appliedColl.currentObjColl.length - 1].currIndex === this.prevActObj.currIndex) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false,\n            italic: false, underline: false };\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        this.renderImage();\n        this.tempObjColl = [];\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelShape = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null, radius: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else if (this.isNewPath) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.renderImage();\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var obj = void 0;\n            for (var i = 0, iLen = object['appliedUndoRedoColl'].length; i < iLen; i++) {\n                var currObjColl = object['appliedUndoRedoColl'][i].currentObjColl;\n                for (var j = 0, jLen = currObjColl.length; j < jLen; j++) {\n                    if (this.prevActObj && this.prevActObj.currIndex &&\n                        currObjColl[j].currIndex === this.prevActObj.currIndex) {\n                        obj = currObjColl[0];\n                        break;\n                    }\n                }\n            }\n            if (this.prevActObj && obj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            if (object['appliedUndoRedoColl'][(undoRedoObj['undoRedoStep'] - 1)]) {\n                parent.objColl =\n                    extend([], object['appliedUndoRedoColl'][(undoRedoObj['undoRedoStep'] - 1)].currentObjColl, [], true);\n            }\n            else {\n                parent.objColl = [];\n            }\n            this.renderImage();\n        }\n        parent.currObjType.isDragging = false;\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        parent.objColl = extend([], this.tempObjColl, [], true);\n        parent.pointColl = extend([], this.tempPointColl, [], true);\n        this.renderImage();\n        this.tempObjColl = [];\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok', isCancel: true } });\n    };\n    Draw.prototype.cancelSelection = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            var obj = { value: parent.tempStraighten };\n            parent.transform.straighten = obj['value'];\n            parent.straightenBaseImageCanvas();\n            parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.activeObj } });\n            parent.notify('crop', { prop: 'resizeWrapper' });\n            this.updateCropSelObj();\n            // eslint-disable-next-line max-len\n            if (this.tempStraightenDestPoints && JSON.stringify(this.tempStraightenDestPoints) !== JSON.stringify(this.straightenDestPoints)) {\n                this.straightenDestPoints = extend({}, this.tempStraightenDestPoints, {}, true);\n            }\n        }\n    };\n    Draw.prototype.updateCropSelObj = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            parent.cropObj = extend({}, parent.cancelCropSelection.previousCropObj, {}, true);\n            parent.afterCropActions = parent.cancelCropSelection.previousObj.afterCropActions;\n            parent.notify('undo-redo', { prop: 'undoDefault', onPropertyChange: false, value: { obj: parent.cancelCropSelection } });\n            parent.currSelectionPoint = extend({}, parent.cancelCropSelection.previousCropObj.activeObj, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n            this.clearOuterCanvas(this.lowerContext);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n    };\n    Draw.prototype.updateCropSelection = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.cancelCropSelection = { operation: 'cropTransform', previousObj: currentObj, currentObj: currentObj,\n            previousObjColl: currentObj.objColl, currentObjColl: currentObj.objColl,\n            previousPointColl: currentObj.pointColl, currentPointColl: currentObj.pointColl,\n            previousSelPointColl: currentObj.selPointColl, currentSelPointColl: currentObj.selPointColl,\n            previousCropObj: extend({}, parent.cropObj, {}, true),\n            currentCropObj: extend({}, parent.cropObj, {}, true),\n            previousText: null, currentText: null, filter: null, isCircleCrop: parent.isCircleCrop };\n    };\n    Draw.prototype.updateFlipPan = function (tempSelectionObj) {\n        var parent = this.parent;\n        if (parent.transform.currFlipState !== '') {\n            var temp = this.lowerContext.filter;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('transform', { prop: 'rotatedFlip', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (tempSelectionObj) {\n                this.drawObject('duplicate', tempSelectionObj);\n            }\n        }\n    };\n    Draw.prototype.select = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.allowDownScale = false;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var previousObj = object['currObj'];\n            previousObj.objColl = extend([], parent.objColl, [], true);\n            previousObj.pointColl = extend([], parent.pointColl, [], true);\n            previousObj.afterCropActions = parent.afterCropActions;\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            previousObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('crop', { prop: 'setPreviousCropCurrentObj', onPropertyChange: false, value: { obj: previousObj } });\n            if (parent.transform.zoomFactor > 0 && parent.activeObj.shape &&\n                parent.activeObj.shape.split('-')[0] === 'crop' && isNullOrUndefined(this.currSelPoint)) {\n                this.currSelPoint = extend({}, parent.activeObj, {}, true);\n            }\n            var isPrevent = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isPrevent = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isPrevent = true;\n            }\n            var obj = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: obj } });\n            var prevObj = obj['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.upperCanvas.style.display = 'block';\n            if (parent.currSelectionPoint || parent.transform.defaultZoomFactor !== 0 ||\n                (parent.transform.degree !== 0 && parent.panPoint.totalPannedInternalPoint.x !== 0 &&\n                    parent.panPoint.totalPannedInternalPoint.y !== 0 && !isPrevent)) {\n                parent.isCircleCrop = false;\n                if (parent.transform.defaultZoomFactor !== 0 && !this.isResizeSelect) {\n                    var isCropTab = parent.isCropTab;\n                    parent.isCropTab = false;\n                    parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n                    parent.isCropTab = isCropTab;\n                    this.resetPanPoints();\n                }\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                parent.isCircleCrop = false;\n                if (!this.isResizeSelect) {\n                    parent.notify('crop', { prop: 'setCurrSelPoints', onPropertyChange: false, value: { isSetDimension: true } });\n                }\n                parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n                if (isNullOrUndefined(parent.cropObj.activeObj.shape)) {\n                    parent.currObjType.shape = 'crop-' + type;\n                    this.drawNewSelection(type, startX, startY, width, height);\n                }\n            }\n            else {\n                if (!this.isCropSelect) {\n                    parent.notify('crop', { prop: 'adjustStraightenForShapes', onPropertyChange: false,\n                        value: { type: 'reverse', isInitialRotated: true } });\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                    this.renderImage();\n                }\n                else {\n                    this.isCropSelect = false;\n                }\n                if (type === 'custom') {\n                    parent.currObjType.shape = '';\n                }\n                this.drawNewSelection(type, startX, startY, width, height);\n            }\n        }\n    };\n    Draw.prototype.drawNewSelection = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        var points;\n        var cropShape = 'crop-' + type.toLowerCase();\n        if (cropShape === 'crop-custom') {\n            if (parent.currObjType.shape === '' || parent.currObjType.shape === 'crop-custom') {\n                this.drawCustomSelection('crop-custom', startX, startY, width, height);\n                this.adjToStraighten();\n                this.updateSelectionInsert();\n                if (parent.isStraightening) {\n                    this.straightenActObj = extend({}, parent.activeObj, {}, true);\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n            }\n        }\n        else if (cropShape === 'crop-canvas') {\n            parent.upperCanvas.style.display = 'block';\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        else {\n            parent.currObjType.isCustomCrop = false;\n            parent.currObjType.shape = cropShape;\n            if (width && height) {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                    width: width, height: height };\n            }\n            else if (width && cropShape === 'crop-circle') {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                    width: width, height: width };\n            }\n            parent.activeObj.shape = cropShape;\n            this.updateSelectionInsert(points);\n        }\n    };\n    Draw.prototype.updateSelectionInsert = function (points) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var selectionSettings = { type: parent.getSelectionType(obj['shapeSettingsObj']['type']), startX: obj['shapeSettingsObj']['startX'],\n            startY: obj['shapeSettingsObj']['startY'], width: obj['shapeSettingsObj']['width'], height: obj['shapeSettingsObj']['height'] };\n        var selectionChangingArgs = { action: 'insert', previousSelectionSettings: selectionSettings,\n            currentSelectionSettings: selectionSettings };\n        parent.trigger('selectionChanging', selectionChangingArgs);\n        parent.editCompleteArgs = selectionChangingArgs;\n        parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n            value: { selectionSettings: selectionChangingArgs.currentSelectionSettings } });\n        if (selectionChangingArgs.currentSelectionSettings.type === 'Custom') {\n            this.drawObject('duplicate', parent.activeObj, null, null, true);\n        }\n        else {\n            if (actPoint.startX !== 0 || actPoint.startY !== 0 ||\n                actPoint.width !== 0 || actPoint.height !== 0) {\n                points = { startX: actPoint.startX, startY: actPoint.startY,\n                    endX: actPoint.endX, endY: actPoint.endY,\n                    width: actPoint.width, height: actPoint.height };\n            }\n            this.drawObject('duplicate', null, true, points);\n        }\n    };\n    Draw.prototype.drawCustomSelection = function (cropShape, startX, startY, width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        parent.currObjType.isCustomCrop = true;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.currObjType.shape = parent.activeObj.shape = cropShape.toLowerCase();\n        if (!isNullOrUndefined(startX) && !isNullOrUndefined(startY) && !isNullOrUndefined(width) && !isNullOrUndefined(height)) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = startX + width;\n            actPoint.endY = startY + height;\n            actPoint.width = width;\n            actPoint.height = height;\n        }\n        else if (width && height) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            actPoint.width = width;\n            actPoint.height = height;\n            actPoint.startX = destLeft + ((destWidth / 2) - (width / 2));\n            actPoint.startY = destTop + ((destHeight / 2) - (height / 2));\n        }\n        else {\n            if (isNullOrUndefined(parent.transform.zoomFactor) || parent.transform.zoomFactor === 0) {\n                var _b = parent.img, destLeft_1 = _b.destLeft, destTop_1 = _b.destTop, destWidth_1 = _b.destWidth, destHeight_1 = _b.destHeight;\n                var lowerCanvasWidth_1 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_1 = parent.lowerCanvas.height;\n                var activePoint_1 = actPoint;\n                if (destLeft_1 >= 0 && destTop_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else if (destLeft_1 >= 0) {\n                    activePoint_1.startX = destLeft_1;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = destLeft_1 + destWidth_1;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n                else if (destTop_1 >= 0) {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = destTop_1;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = destTop_1 + destHeight_1;\n                }\n                else {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n            }\n            else {\n                var _c = parent.img, destLeft_2 = _c.destLeft, destTop_2 = _c.destTop, destWidth_2 = _c.destWidth, destHeight_2 = _c.destHeight;\n                var lowerCanvasWidth_2 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_2 = parent.lowerCanvas.height;\n                var activePoint_2 = actPoint;\n                activePoint_2.startX = Math.max(destLeft_2 > 0 ? destLeft_2 : 7.5, destLeft_2);\n                activePoint_2.startY = Math.max(destTop_2 > 0 ? destTop_2 : 7.5, destTop_2);\n                activePoint_2.endX = Math.min(destLeft_2 + destWidth_2 + 15 < lowerCanvasWidth_2 ? destLeft_2 + destWidth_2 - 15 :\n                    lowerCanvasWidth_2 - 15, destLeft_2 + destWidth_2);\n                activePoint_2.endY = Math.min(destTop_2 + destHeight_2 + 15 < lowerCanvasHeight_2 ? destTop_2 + destHeight_2 - 15 :\n                    lowerCanvasHeight_2 - 15, destTop_2 + destHeight_2);\n            }\n            var _d = parent.img, destLeft = _d.destLeft, destTop = _d.destTop, destWidth = _d.destWidth, destHeight = _d.destHeight;\n            var lowerCanvasWidth = parent.lowerCanvas.clientWidth;\n            var lowerCanvasHeight = parent.lowerCanvas.clientHeight;\n            var activePoint = actPoint;\n            activePoint.startX = Math.max(activePoint.startX, destLeft);\n            activePoint.startY = Math.max(activePoint.startY, destTop);\n            activePoint.endX = Math.min(activePoint.endX, destLeft + destWidth);\n            activePoint.endY = Math.min(activePoint.endY, destTop + destHeight);\n            if (parent.transform.straighten > 0) {\n                if (this.imgCanvasPoints[0].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[0].x;\n                }\n                if (this.imgCanvasPoints[0].y > activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[0].y;\n                }\n                if (this.imgCanvasPoints[2].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[2].x;\n                }\n                if (this.imgCanvasPoints[2].y < activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[2].x;\n                }\n            }\n            else if (parent.transform.straighten < 0) {\n                if (this.imgCanvasPoints[3].x > activePoint.startX) {\n                    activePoint.startX = this.imgCanvasPoints[3].x;\n                }\n                if (this.imgCanvasPoints[3].y < activePoint.startY) {\n                    activePoint.startY = this.imgCanvasPoints[3].y;\n                }\n                if (this.imgCanvasPoints[1].x < activePoint.endX) {\n                    activePoint.endX = this.imgCanvasPoints[1].x;\n                }\n                if (this.imgCanvasPoints[1].y > activePoint.endY) {\n                    activePoint.endY = this.imgCanvasPoints[1].x;\n                }\n            }\n            if (activePoint.startX === destLeft && destLeft + destWidth > lowerCanvasWidth) {\n                activePoint.endX = lowerCanvasWidth - 15;\n            }\n            if (activePoint.startY === destTop && destTop + destHeight > lowerCanvasHeight) {\n                activePoint.endY = lowerCanvasHeight - 15;\n            }\n            if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                var temp = parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                parent.activeObj.activePoint.endX = temp;\n            }\n            if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                var temp = parent.activeObj.activePoint.startY;\n                parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                parent.activeObj.activePoint.endY = temp;\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n            this.updateActiveObject(actPoint, parent.activeObj);\n            this.adjActObj();\n        }\n        this.updateSelectionInsert();\n    };\n    Draw.prototype.adjToStraighten = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten !== 0 && parent.isStraightening) {\n            var actPoint = parent.activeObj.activePoint;\n            actPoint.startX += 7.5;\n            actPoint.startY += 7.5;\n            actPoint.endX -= 7.5;\n            actPoint.endY -= 7.5;\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.adjActObj = function () {\n        var parent = this.parent;\n        if (parent.transform.straighten === 0) {\n            return;\n        }\n        var actPoint = parent.activeObj.activePoint;\n        var tempActPoint = extend({}, actPoint, {}, true);\n        var count = 0;\n        while (true) {\n            count++;\n            var object = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            if (object['arr'][0] || object['arr'][1] || object['arr'][2] || object['arr'][3] || count === 100) {\n                actPoint = extend({}, tempActPoint, {}, true);\n                break;\n            }\n            tempActPoint = extend({}, actPoint, {}, true);\n            actPoint.startX -= 5;\n            actPoint.endX += 5;\n            actPoint.width = actPoint.endX - actPoint.startX;\n            this.updateActiveObject(actPoint, parent.activeObj);\n        }\n    };\n    Draw.prototype.callUpdateCurrTransState = function () {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.isRotateZoom = true;\n        this.updateCurrTransState('initial');\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        var temp = this.lowerContext.filter;\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        }\n        this.drawImage();\n        this.updateCurrTransState('reverse');\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        this.isRotateZoom = false;\n        parent.objColl = tempObjColl;\n        var tempTogglePen = parent.togglePen;\n        parent.togglePen = false;\n        this.lowerContext.filter = 'none';\n        var widthObj = { penStrokeWidth: null };\n        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        parent.img.destLeft -= parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop -= parent.panPoint.totalPannedInternalPoint.y;\n        parent.togglePen = tempTogglePen;\n        this.lowerContext.filter = temp;\n        parent.activeObj = tempActiveObj;\n    };\n    Draw.prototype.resetPanPoints = function () {\n        this.parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n    };\n    Draw.prototype.setClientTransDim = function (isPreventDimension) {\n        var parent = this.parent;\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destHeight) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destWidth + 1) / 2;\n            var temp = parent.img.destWidth;\n            parent.img.destWidth = parent.img.destHeight;\n            parent.img.destHeight = temp;\n        }\n        else {\n            if (isNullOrUndefined(isPreventDimension)) {\n                parent.img.destLeft = (parent.lowerCanvas.clientWidth - parent.img.destWidth) / 2;\n                parent.img.destTop = (parent.lowerCanvas.clientHeight - parent.img.destHeight + 1) / 2;\n            }\n        }\n    };\n    Draw.prototype.redrawImgWithObj = function () {\n        var parent = this.parent;\n        var obj = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = obj['canvasFilter'];\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            this.callUpdateCurrTransState();\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        else {\n            this.callUpdateCurrTransState();\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.setCurrentObj = function (obj, isUndoRedo, isCircleCropped) {\n        var parent = this.parent;\n        var isObj = obj ? true : false;\n        if (!isObj) {\n            parent.cropObj.aspectWidth = parent.aspectWidth;\n            parent.cropObj.aspectHeight = parent.aspectHeight;\n            parent.cropObj.frame = parent.frameObj.type;\n        }\n        obj = obj ? obj : parent.cropObj;\n        parent.transform.cropZoomFactor = obj.cropZoom;\n        parent.transform.defaultZoomFactor = obj.defaultZoom;\n        this.straightenInitZoom = obj.straightenZoom;\n        if (!isObj) {\n            parent.transform.zoomFactor = obj.cropZoom;\n        }\n        else {\n            if (obj.activeObj.shape && obj.activeObj.shape.split('-')[0] === 'crop') {\n                parent.transform.zoomFactor = obj.cropZoom;\n            }\n            else {\n                parent.transform.zoomFactor = obj.defaultZoom;\n            }\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: obj.zoomFactor } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false, value: { previousZoomValue: obj.previousZoomValue } });\n        parent.panPoint.totalPannedPoint = extend({}, obj.totalPannedPoint, {}, true);\n        parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n        parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        var point = extend({}, obj.tempFlipPanPoint, {}, true);\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: point } });\n        parent.rotateFlipColl = extend([], obj.rotateFlipColl, [], true);\n        parent.transform.degree = obj.degree;\n        parent.frameObj.type = obj.frame;\n        parent.transform.currFlipState = obj.currFlipState;\n        parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.adjustmentLevel } });\n        parent.notify('filter', { prop: 'setTempAdjVal' });\n        parent.currentFilter = obj.currentFilter;\n        parent.notify('filter', { prop: 'setTempFilVal' });\n        if (parent.transform.straighten !== obj.straighten || isUndoRedo) {\n            parent.transform.straighten = obj.straighten;\n            parent.straightenBaseImageCanvas();\n        }\n        parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n            destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n            srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n        parent.aspectWidth = obj.aspectWidth;\n        parent.aspectHeight = obj.aspectHeight;\n        if (obj.afterCropActions) {\n            parent.afterCropActions = obj.afterCropActions;\n        }\n        this.lowerContext.filter = obj.filter;\n        parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: obj.isBrightAdjust } });\n        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.bgColor } });\n        var isCircleCrop = parent.isCircleCrop;\n        var currSelectionPoint;\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            currSelectionPoint = null;\n        }\n        else {\n            currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            parent.currSelectionPoint = null;\n        }\n        parent.isCircleCrop = false;\n        if (isCircleCropped) {\n            parent.frameObj.type = 'none';\n        }\n        this.drawCropSelectionImage(obj, false);\n        if (parent.transform.degree !== 0) {\n            if (parent.transform.currFlipState === '') {\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n            }\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n            parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n            parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        }\n        parent.activeObj = extend({}, obj.activeObj, {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate', null, null, null, true);\n        }\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        var isAfterCropAction = false;\n        if (parent.afterCropActions.length > 0) {\n            var object = { collection: parent.afterCropActions };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.afterCropActions, isRotateFlipCollection: null, obj: object } });\n            parent.afterCropActions = object['collection'];\n        }\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        if (!isObj && afterCropActions.length > 0) {\n            isAfterCropAction = true;\n            for (var i = 0, len = afterCropActions.length; i < len; i++) {\n                if (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip') {\n                    parent.activeObj = extend({}, currSelectionPoint, {}, true);\n                    this.rotatedFlipCropSel = true;\n                }\n                parent.notify('transform', { prop: 'updateTransform', onPropertyChange: false, value: { text: afterCropActions[i] } });\n            }\n            activeObj = extend({}, parent.activeObj, {}, true);\n            this.resetPanPoints();\n            parent.activeObj = activeObj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n            if (obj.degree !== parent.transform.degree) {\n                parent.transform.cropZoomFactor = null;\n                parent.transform.zoomFactor = 0;\n            }\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            if (this.rotatedFlipCropSel) {\n                this.rotatedFlipCropSel = false;\n            }\n        }\n        parent.afterCropActions = afterCropActions;\n        if (!this.isCancelAction && !isAfterCropAction) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n        }\n        parent.activeObj = activeObj;\n        parent.isCircleCrop = isCircleCrop;\n        if (isNullOrUndefined(currSelectionPoint)) {\n            parent.currSelectionPoint = null;\n        }\n        else {\n            parent.currSelectionPoint = extend({}, currSelectionPoint, {}, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n        }\n    };\n    Draw.prototype.drawCropSelectionImage = function (obj, isObj) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        if (isObj) {\n            this.updateCurrTransState('initial');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.drawImage();\n        if (isObj) {\n            this.updateCurrTransState('reverse');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        parent.img.destLeft = parent.cropObj.destPoints.startX;\n        parent.img.destTop = parent.cropObj.destPoints.startY;\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        this.lowerContext.filter = 'none';\n        parent.img = { destLeft: obj.destPoints.startX, destTop: obj.destPoints.startY, destWidth: obj.destPoints.width,\n            destHeight: obj.destPoints.height, srcLeft: obj.srcPoints.startX, srcTop: obj.srcPoints.startY,\n            srcWidth: obj.srcPoints.width, srcHeight: obj.srcPoints.height };\n        if (obj.activeObj.activePoint.width !== 0 && obj.activeObj.activePoint.height !== 0) {\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.img.destLeft = obj.activeObj.activePoint.startX;\n            parent.img.destTop = obj.activeObj.activePoint.startY;\n            parent.img.destWidth = obj.activeObj.activePoint.width;\n            parent.img.destHeight = obj.activeObj.activePoint.height;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        parent.activeObj = activeObj;\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.performPointZoom = function (x, y, type, isResize, value) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var isCropSelection = false;\n        if (parent.activeObj.shape && parent.activeObj.shape.indexOf('crop-') > -1) {\n            isCropSelection = true;\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !isCropSelection) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                parent.okBtn();\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        var ratioX = (x - destLeft) / destWidth;\n        var ratioY = (y - destTop) / destHeight;\n        var isUndoRedo = parent.isUndoRedo;\n        parent.isUndoRedo = true;\n        parent.setProperties({ zoomSettings: { zoomPoint: { x: x, y: y } } }, true);\n        var zoomValue = value ? value : (type === 'zoomIn') ? .1 : -.1;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: zoomValue, zoomPoint: null, isResize: isResize } });\n        parent.isUndoRedo = isUndoRedo;\n        this.panToPoint(x, y, ratioX, ratioY);\n    };\n    Draw.prototype.panToPoint = function (x, y, ratioX, ratioY) {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var destLeft = parent.img.destLeft;\n            var destTop = parent.img.destTop;\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft = x - (ratioX * parent.img.destWidth);\n                parent.img.destTop = y - (ratioY * parent.img.destHeight);\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                var straightenObj = { straightenPoint: null };\n                parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n                    value: { obj: straightenObj } });\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                    value: { x: null, y: null, ratioX: null, ratioY: null } });\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.panPoint.currentPannedPoint = { x: (x - (ratioX * parent.img.destWidth)) - destLeft,\n                    y: (y - (ratioY * parent.img.destHeight)) - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n                    parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false,\n                        value: { x: straightenObj['straightenPoint']['x'], y: straightenObj['straightenPoint']['y'],\n                            ratioX: straightenObj['straightenPoint']['ratioX'], ratioY: straightenObj['straightenPoint']['ratioY'] } });\n                }\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                        y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n            this.adjustPanning(activeObj);\n            var isActObj = false;\n            for (var i = 0; i < parent.objColl.length; i++) {\n                if (JSON.stringify(activeObj.activePoint) === JSON.stringify(parent.objColl[i].activePoint)) {\n                    isActObj = true;\n                    break;\n                }\n            }\n            if (!isActObj) {\n                parent.activeObj = activeObj;\n            }\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n        }\n    };\n    Draw.prototype.adjustPanning = function (activeObj) {\n        var parent = this.parent;\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        if (width !== 0 && height !== 0) {\n            var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n            var point = { x: 0, y: 0 };\n            if (destLeft > startX) {\n                point.x = destLeft - startX;\n            }\n            else if (destLeft + destWidth < startX + width) {\n                point.x = (destLeft + destWidth) - (startX + width);\n            }\n            if (destTop > startY) {\n                point.y = destTop - startY;\n            }\n            else if (destTop + destHeight < startY + height) {\n                point.y = (destTop + destHeight) - (startY + height);\n            }\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                parent.panPoint.currentPannedPoint = { x: parent.img.destLeft - destLeft, y: parent.img.destTop - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                        y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n        }\n    };\n    Draw.prototype.panToSel = function () {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        var _a = activeObj.activePoint, startX = _a.startX, startY = _a.startY, width = _a.width, height = _a.height;\n        this.allowRedactStraighten = true;\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false,\n            value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var panX = (startX + (width / 2)) - straightenObj['straightenPoint']['x'];\n            var panY = (startY + (height / 2)) - straightenObj['straightenPoint']['y'];\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft += panX;\n                parent.img.destTop += panY;\n                parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                parent.notify('transform', { prop: 'setTempPanMove', value: { point: null } });\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n            var _b = parent.img, destLeft_3 = _b.destLeft, destTop_3 = _b.destTop, destWidth_3 = _b.destWidth, destHeight_3 = _b.destHeight;\n            var points = this.imgCanvasPoints;\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            points.forEach(function (point) {\n                point.x = (point.ratioX * destWidth_3) + destLeft_3;\n                point.y = (point.ratioY * destHeight_3) + destTop_3;\n            });\n            this.imgCanvasPoints = points;\n            var count = 0;\n            if (parent.transform.straighten === 3 && !this.preventStraightening) {\n                this.preventStraightening = true;\n                var temp = parent.prevStraightenedDegree;\n                parent.prevStraightenedDegree = parent.transform.straighten;\n                parent.setStraighten(0);\n                parent.setStraighten(3);\n                parent.prevStraightenedDegree = temp;\n                this.preventStraightening = false;\n            }\n            while (this.isLinesIntersect() && parent.transform.straighten !== 0 && parent.transform.straighten !== 360 && count < 100) {\n                count++;\n                this.performPointZoom(parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2), parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2), 'zoomIn', false, 0.025);\n                this.updateImgCanvasPoints();\n            }\n        }\n    };\n    Draw.prototype.drawZoomPanImage = function (x, y) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: x, y: y, panRegion: '' } });\n        this.renderImage(true);\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.panPoint.totalPannedPoint.x += x;\n        parent.panPoint.totalPannedPoint.y += y;\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: { x: 0, y: 0 } } });\n    };\n    Draw.prototype.openNewImage = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var toolbar = document.querySelector('#' + id + '_currPos');\n        if (toolbar) {\n            toolbar.style.display = 'none';\n        }\n        var obj = { defToolbarItems: null };\n        parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj } });\n        if (obj['defToolbarItems'] && obj['defToolbarItems'].length === 0 &&\n            (isNullOrUndefined(document.getElementById(id + '_toolbar'))) &&\n            parent.element.querySelector('#' + id + '_toolbarArea')) {\n            var height = parent.element.querySelector('#' + id + '_toolbarArea').clientHeight;\n            parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: height } });\n        }\n        parent.reset();\n        parent.update();\n        parent.transform.degree = 0;\n        parent.transform.zoomFactor = 0;\n        parent.isImageLoaded = false;\n        parent.currSelectionPoint = null;\n        var type = typeof (this.openURL);\n        if (type === 'string') {\n            var fileName = this.openURL.split('.');\n            if (fileName.length > 1) {\n                fileName = fileName[fileName.length - 2].split('/');\n                this.fileName = fileName[fileName.length - 1];\n            }\n            else {\n                this.fileName = 'ImageEditor';\n            }\n            this.fileType = this.getFileExtensionFromURL(this.openURL);\n            if (this.fileType) {\n                this.fileType = parent.toPascalCase(this.fileType);\n                var fileType = this.fileType.toLowerCase();\n                if (fileType === 'jpg' || fileType === 'jpeg') {\n                    this.fileType = 'Jpeg';\n                    fileType = 'jpeg';\n                }\n                if (fileType !== 'jpeg' && fileType !== 'png' && fileType !== 'svg' && fileType !== 'webp') {\n                    this.fileType = null;\n                }\n            }\n            this.imageOnLoad(this.openURL);\n            if (typeof (this.openURL) !== 'string' || this.openURL.indexOf('localhost') === -1) {\n                this.getImageSizeFromURL(this.openURL.toString(), function (imageSizeMB) {\n                    if (imageSizeMB !== null) {\n                        _this.parent.notify('toolbar', { prop: 'setInitialSize', value: { value: +imageSizeMB } });\n                    }\n                });\n            }\n        }\n        else {\n            this.fileName = 'ImageEditor';\n            this.fileType = null;\n            parent.lowerCanvas = document.querySelector('#' + id + '_lowerCanvas');\n            parent.upperCanvas = document.querySelector('#' + id + '_upperCanvas');\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n            this.upperContext = parent.upperCanvas.getContext('2d');\n            parent.clearContext(this.lowerContext);\n            parent.clearContext(this.upperContext);\n            parent.clearContext(inMemoryContext);\n            parent.inMemoryCanvas.width = this.openURL.width;\n            parent.inMemoryCanvas.height = this.openURL.height;\n            inMemoryContext.putImageData(this.openURL, 0, 0);\n            parent.baseImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n    };\n    Draw.prototype.getImageSizeFromURL = function (imageUrl, callback) {\n        return __awaiter(this, void 0, void 0, function () {\n            var response, contentLength, imageSizeMB, ex_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        return [4 /*yield*/, fetch(imageUrl, { method: 'HEAD' })];\n                    case 1:\n                        response = _a.sent();\n                        contentLength = parseInt(response.headers.get('content-length') || '0', 10);\n                        imageSizeMB = contentLength;\n                        callback(imageSizeMB);\n                        return [3 /*break*/, 3];\n                    case 2:\n                        ex_1 = _a.sent();\n                        // eslint-disable-next-line no-console\n                        console.log(ex_1.message);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    Draw.prototype.dlgBtnClick = function () {\n        this.parent.export();\n        this.applyDialogOption();\n    };\n    Draw.prototype.dlgCloseBtnClick = function () {\n        this.applyDialogOption();\n    };\n    Draw.prototype.applyDialogOption = function () {\n        var parent = this.parent;\n        if (this.isFileChanged) {\n            parent.isImageLoaded = this.isFileChanged = false;\n            parent.reset();\n            this.checkToolbarTemplate(this.inputElem, this.openURL);\n        }\n        else {\n            this.reset();\n            this.openNewImage();\n        }\n        getComponent(document.getElementById(parent.element.id + '_dialog'), 'dialog').destroy();\n        this.isImageEdited = false;\n    };\n    Draw.prototype.showDialogPopup = function () {\n        var parent = this.parent;\n        var headerObj = { key: 'ConfirmDialogHeader' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n        var contentObj = { key: 'ConfirmDialogContent' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n        var yesObj = { key: 'Yes' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: yesObj } });\n        var noObj = { key: 'No' };\n        parent.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: noObj } });\n        parent.element.querySelector('#' + parent.element.id + '_dialog').style.display = 'block';\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: '<span>' + contentObj['value'] + '</span>',\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: noObj['value'], iconCss: 'e-icons e-close' }\n                },\n                { click: this.dlgBtnClick.bind(this),\n                    buttonModel: { content: yesObj['value'], isPrimary: true, iconCss: 'e-icons e-check' } }\n            ]\n        });\n        dialog.appendTo('#' + parent.element.id + '_dialog');\n    };\n    Draw.prototype.restoreOldImage = function () {\n        var _this = this;\n        var parent = this.parent;\n        var dropArea = document.getElementById(this.parent.element.id + '_dropArea');\n        var extension = parent.getExtensionArray();\n        var openURLType = typeof this.openURL;\n        if (openURLType !== 'string') {\n            this.openImageData(dropArea);\n            return;\n        }\n        var fileType = this.getFileExtensionFromURL(this.openURL);\n        if (fileType) {\n            fileType = fileType.toLowerCase();\n            fileType = (fileType === 'jpg' || fileType === 'jpeg') ? 'jpeg' : fileType;\n        }\n        var isAllowedFileType = (fileType ? (extension.indexOf(fileType) > -1 ||\n            (fileType === 'jpeg' && (parent.uploadSettings.allowedExtensions.indexOf('jpg') > -1 ||\n                parent.uploadSettings.allowedExtensions.indexOf('jpeg') > -1))) : false) || this.isNullExtension;\n        if ((this.openURL.indexOf('data:image/') > -1 && this.openURL.indexOf('base64') > -1) ||\n            this.openURL.indexOf('blob') > -1) {\n            this.openImageData(dropArea, true);\n        }\n        else if (parent.uploadSettings.minFileSize || parent.uploadSettings.maxFileSize) {\n            this.getImageSizeFromURL(this.openURL.toString(), function (imageSizeMB) {\n                var isInvalidSize = (parent.uploadSettings.minFileSize && imageSizeMB < parent.uploadSettings.minFileSize) ||\n                    (parent.uploadSettings.maxFileSize && imageSizeMB > parent.uploadSettings.maxFileSize);\n                _this.handleFileSize(!isAllowedFileType || isInvalidSize, dropArea, !isAllowedFileType);\n            });\n        }\n        else {\n            this.handleFileSize(!isAllowedFileType, dropArea, !isAllowedFileType);\n        }\n    };\n    Draw.prototype.handleFileSize = function (isError, dropArea, fileTypeError) {\n        var parent = this.parent;\n        if (isError) {\n            this.errorLoading();\n            parent.showDialogPopup('unsupported', fileTypeError);\n            if (dropArea && !parent.isImageLoaded) {\n                dropArea.style.display = 'block';\n            }\n        }\n        else {\n            if (dropArea) {\n                dropArea.style.display = 'none';\n            }\n            if (this.parent.isImageLoaded) {\n                this.reset();\n            }\n            this.openNewImage();\n        }\n    };\n    Draw.prototype.openImageData = function (dropArea, isBase64) {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var canvas = parent.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        if (!parent.uploadSettings.minFileSize && !parent.uploadSettings.maxFileSize) {\n            this.handleFileSize(false, dropArea, false);\n            return;\n        }\n        if (isBase64) {\n            var img_1 = new Image();\n            img_1.src = this.openURL;\n            img_1.onload = function () {\n                ctx.canvas.width = img_1.width;\n                ctx.canvas.height = img_1.height;\n                ctx.drawImage(img_1, 0, 0);\n                proxy.getImageSize(canvas, dropArea);\n            };\n        }\n        else {\n            canvas.width = this.openURL.width;\n            canvas.height = this.openURL.height;\n            ctx.putImageData(this.openURL, 0, 0);\n            this.getImageSize(canvas, dropArea);\n        }\n    };\n    Draw.prototype.getImageSize = function (canvas, dropArea) {\n        var parent = this.parent;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        canvas.toBlob((function (blob) {\n            if ((parent.uploadSettings.minFileSize && blob.size < parent.uploadSettings.minFileSize) ||\n                (parent.uploadSettings.maxFileSize && blob.size > parent.uploadSettings.maxFileSize)) {\n                this.handleFileSize(true, dropArea, false);\n            }\n            else {\n                this.handleFileSize(false, dropArea, false);\n            }\n        }).bind(this), 'image/jpeg', 1);\n    };\n    Draw.prototype.open = function (data) {\n        if (!this.parent.disabled) {\n            this.openURL = data;\n            this.restoreOldImage();\n        }\n    };\n    Draw.prototype.getInitialLoaded = function (object) {\n        object['isInitialLoaded'] = this.isInitialLoading;\n    };\n    Draw.prototype.getFileExtensionFromURL = function (url) {\n        var lastDotIndex = url.lastIndexOf('.');\n        if (lastDotIndex !== -1) {\n            return url.slice(lastDotIndex + 1).toLowerCase();\n        }\n        else if (url.indexOf('base64') !== -1) {\n            return url.slice(url.indexOf('/') + 1, url.indexOf(';')).toLowerCase();\n        }\n        return null;\n    };\n    Draw.prototype.fileSelect = function (inputElement, args) {\n        var parent = this.parent;\n        var dropArea = document.getElementById(parent.element.id + '_dropArea');\n        if (dropArea) {\n            dropArea.style.display = 'none';\n        }\n        if (!parent.disabled) {\n            var filesData = void 0;\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var fileData = void 0;\n            if (args.target) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = args.target.files[0];\n                fileData = filesData;\n            }\n            else {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                filesData = fileData = args.filesData[0].rawFile;\n            }\n            var fileExtension = void 0;\n            if (fileData.name) {\n                var fileExtensionArray = fileData.name.split('.');\n                fileExtension = fileExtensionArray[fileExtensionArray.length - 1].toLowerCase();\n            }\n            var extension = parent.getExtensionArray();\n            var isJPG = ((fileExtension === 'jpg' || fileExtension === 'jpeg') && (parent.uploadSettings.allowedExtensions.indexOf('jpg') > -1 || parent.uploadSettings.allowedExtensions.indexOf('jpeg') > -1));\n            if ((fileExtension && (extension.indexOf(fileExtension) === -1 && !isJPG)) ||\n                ((parent.uploadSettings.minFileSize && fileData.size < parent.uploadSettings.minFileSize) ||\n                    (parent.uploadSettings.maxFileSize && fileData.size > parent.uploadSettings.maxFileSize))) {\n                this.errorLoading();\n                return;\n            }\n            showSpinner(parent.element);\n            parent.element.style.opacity = '0.5';\n            this.inputElem = inputElement;\n            fileExtension = fileData.name && fileData.name.split('.')[1];\n            if (fileExtension) {\n                var fileType = parent.toPascalCase(fileExtension);\n                if (fileType === 'JPG' || fileType === 'Jpg') {\n                    this.fileType = 'Jpeg';\n                }\n                else {\n                    this.fileType = fileType;\n                }\n            }\n            else {\n                this.fileType = null;\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var URL_1 = window.URL;\n            var url = URL_1.createObjectURL(filesData);\n            this.openURL = url;\n            // eslint-disable-next-line max-len\n            if (parent.isImageLoaded && !parent.isChangesSaved && (this.isImageEdited || parent.pointColl.length > 0 || parent.objColl.length > 0)) {\n                this.isFileChanged = true;\n                this.showDialogPopup();\n            }\n            else {\n                this.checkToolbarTemplate(inputElement, url);\n            }\n        }\n    };\n    Draw.prototype.checkToolbarTemplate = function (inputElement, url) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbarTemplate)) {\n            parent.reset();\n            parent.update();\n        }\n        this.fileName = inputElement.value.split('\\\\')[inputElement.value.split('\\\\').length - 1];\n        this.fileName = this.fileName.split('.')[0];\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    Draw.prototype.moveToSelectionRange = function (type, activeObj) {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            var isRotated = false;\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                var degree = parent.rotateFlipColl[i];\n                if (degree === 90 || degree === -90) {\n                    isRotated = true;\n                    break;\n                }\n            }\n            if (isRotated) {\n                if (parent.transform.degree === 0) {\n                    return;\n                }\n                var zoomFactor = parent.transform.zoomFactor;\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                var currObj = parent.objColl[parent.objColl.length - 1];\n                if (type === 'rotateleft' || type === 'rotateright') {\n                    if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                        if (currObj.activePoint.width < activeObj.activePoint.height) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null, isResize: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                    else {\n                        if (currObj.activePoint.height < activeObj.activePoint.width) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (currObj.activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(currObj) ||\n                                    this.isSelectionOutsideCanvas(currObj)) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null }, isResize: null });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null }, isResize: null });\n                            }\n                        }\n                    }\n                }\n                var panX = (parent.lowerCanvas.clientWidth / 2) - (currObj.activePoint.startX +\n                    (currObj.activePoint.width / 2));\n                var panY = ((parent.lowerCanvas.clientHeight + 1) / 2) - (currObj.activePoint.startY +\n                    (currObj.activePoint.height / 2));\n                if (isNullOrUndefined(parent.activeObj.shape)) {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                }\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += panX;\n                    parent.img.destTop += panY;\n                    parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                    parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                }\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1]);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n    };\n    Draw.prototype.isSelectionBiggerThanCanvas = function (obj) {\n        var isBigger = false;\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = parent.img, destLeft = _b.destLeft, destTop = _b.destTop, destWidth = _b.destWidth, destHeight = _b.destHeight;\n        if (startX <= destLeft || startY <= destTop || endX >= destLeft + destWidth || endY >= destTop + destHeight) {\n            isBigger = true;\n        }\n        return isBigger;\n    };\n    Draw.prototype.isSelectionOutsideCanvas = function (obj) {\n        var isOutside = false;\n        var parent = this.parent;\n        if ((obj.activePoint.height < parent.lowerCanvas.height - parent.toolbarHeight) ||\n            (obj.activePoint.width < parent.lowerCanvas.width)) {\n            isOutside = true;\n        }\n        return isOutside;\n    };\n    Draw.prototype.downScaleImgCanvas = function (ctx, isImgAnnotation, isHFlip, isVFlip) {\n        var parent = this.parent;\n        var canvas = isImgAnnotation ? parent.activeObj.imageCanvas : parent.baseImgCanvas;\n        var img = isImgAnnotation ? parent.activeObj.imageElement : parent.baseImg;\n        var width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.img.destWidth;\n        var height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.img.destHeight;\n        var obj = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.height, height: img.width, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        else {\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: img.width, height: img.height, obj: obj, isImgShape: isImgAnnotation } });\n        }\n        if (isImgAnnotation || (parent.allowDownScale && !parent.isCropTab && !parent.isCropToolbar && img.width !== 0 && img.height !== 0\n            && obj['width'] * 0.75 > width && obj['height'] * 0.75 > height)) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = isImgAnnotation ? img.width : parent.img.srcWidth;\n            tempCanvas.height = isImgAnnotation ? img.height : parent.img.srcHeight;\n            if (isImgAnnotation) {\n                tempCanvas.getContext('2d').drawImage(img, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            else {\n                if (this.imageBackgroundColor !== '') {\n                    ctx.fillStyle = this.imageBackgroundColor;\n                    ctx.fillRect(parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                }\n                tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            }\n            if (isImgAnnotation || this.isDownScale) {\n                this.downScale(tempCanvas, width, height, isImgAnnotation);\n            }\n            if (isImgAnnotation) {\n                ctx.canvas.width = tempCanvas.width;\n                ctx.canvas.height = tempCanvas.height;\n                if (isHFlip && isVFlip) {\n                    ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                    ctx.scale(-1, 1);\n                    ctx.translate(0, parent.activeObj.imageCanvas.height);\n                    ctx.scale(1, -1);\n                }\n                else {\n                    if (isHFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isHorImageFlip) || !parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = true;\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                        else if (parent.activeObj.isHorImageFlip) {\n                            parent.activeObj.isHorImageFlip = false;\n                        }\n                        if (parent.activeObj.isVerImageFlip) {\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                    }\n                    else if (isVFlip) {\n                        if (isNullOrUndefined(parent.activeObj.isVerImageFlip) || !parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = true;\n                            ctx.translate(0, parent.activeObj.imageCanvas.height);\n                            ctx.scale(1, -1);\n                        }\n                        else if (parent.activeObj.isVerImageFlip) {\n                            parent.activeObj.isVerImageFlip = false;\n                        }\n                        if (parent.activeObj.isHorImageFlip) {\n                            ctx.translate(parent.activeObj.imageCanvas.width, 0);\n                            ctx.scale(-1, 1);\n                        }\n                    }\n                }\n                ctx.drawImage(tempCanvas, 0, 0);\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n            }\n            else if (parent.isFinetuning) {\n                ctx.save();\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\n                ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                ctx.restore();\n            }\n            else {\n                ctx.drawImage(tempCanvas, 0, 0, tempCanvas.width, tempCanvas.height, parent.img.destLeft, parent.img.destTop, tempCanvas.width, tempCanvas.height);\n            }\n        }\n        else {\n            if ((isNullOrUndefined(isImgAnnotation) || !isImgAnnotation) && parent.baseImgCanvas.width !== 0 &&\n                parent.baseImgCanvas.height !== 0) {\n                if (this.imageBackgroundColor !== '') {\n                    ctx.fillStyle = this.imageBackgroundColor;\n                    ctx.fillRect(parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                }\n                ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n            }\n        }\n        if (parent.isSafari) {\n            parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: ctx } });\n        }\n    };\n    Draw.prototype.downScale = function (canvas, width, height, isImgAnnotation) {\n        var parent = this.parent;\n        if (isImgAnnotation && parent.isStraightening) {\n            return;\n        }\n        var widthSource = canvas.width;\n        var heightSource = canvas.height;\n        width = Math.round(width);\n        height = Math.round(height);\n        var widthRatio = widthSource / width;\n        var heightRatio = heightSource / height;\n        var halfWidthRatio = Math.ceil(widthRatio / 2);\n        var halfHeightRatio = Math.ceil(heightRatio / 2);\n        var ctx = canvas.getContext('2d');\n        var img = ctx.getImageData(0, 0, widthSource, heightSource);\n        var img2 = ctx.createImageData(width, height);\n        var data = img.data;\n        var data2 = img2.data;\n        for (var j = 0; j < height; j++) {\n            for (var i = 0; i < width; i++) {\n                var x2 = (i + j * width) * 4;\n                var weight = 0;\n                var weights = 0;\n                var alphaWeights = 0;\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n                var centerY = (j + 0.5) * heightRatio;\n                var startY = Math.floor(j * heightRatio);\n                var stopY = Math.ceil((j + 1) * heightRatio);\n                for (var y = startY; y < stopY; y++) {\n                    var dy = Math.abs(centerY - (y + 0.5)) / halfHeightRatio;\n                    var centerX = (i + 0.5) * widthRatio;\n                    var w0 = dy * dy; //pre-calc part of w\n                    var startX = Math.floor(i * widthRatio);\n                    var stopX = Math.ceil((i + 1) * widthRatio);\n                    for (var x = startX; x < stopX; x++) {\n                        var dx = Math.abs(centerX - (x + 0.5)) / halfWidthRatio;\n                        var w = Math.sqrt(w0 + dx * dx);\n                        if (w >= 1) {\n                            continue;\n                        }\n                        weight = 2 * w * w * w - 3 * w * w + 1;\n                        var xPos = 4 * (x + y * widthSource);\n                        a += weight * data[xPos + 3];\n                        alphaWeights += weight;\n                        weight = weight * data[xPos + 3] / 250;\n                        r += weight * data[xPos];\n                        g += weight * data[xPos + 1];\n                        b += weight * data[xPos + 2];\n                        weights += weight;\n                    }\n                }\n                data2[x2] = r / weights;\n                data2[x2 + 1] = g / weights;\n                data2[x2 + 2] = b / weights;\n                data2[x2 + 3] = a / alphaWeights;\n            }\n        }\n        canvas.width = isImgAnnotation ? parent.activeObj.activePoint.width : parent.lowerCanvas.width;\n        canvas.height = isImgAnnotation ? parent.activeObj.activePoint.height : parent.lowerCanvas.height;\n        ctx.putImageData(img2, 0, 0);\n    };\n    Draw.prototype.drawImgToCtx = function (ctx, preventImg) {\n        var parent = this.parent;\n        if (ctx.canvas.id !== parent.element.id + '_tempCanvas' && ctx !== this.upperContext && isNullOrUndefined(preventImg)) {\n            this.downScaleImgCanvas(ctx, null, null, null);\n        }\n    };\n    Draw.prototype.getFrameColor = function (frameObj, ctx, points) {\n        var parent = this.parent;\n        var color = parent.frameObj.color;\n        if (frameObj.gradientColor) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var gradient = ctx.createLinearGradient(points.startX, points.startY, points.startX + points.width, points.startY + points.height);\n            gradient.addColorStop(0, frameObj.color);\n            gradient.addColorStop(1, frameObj.gradientColor);\n            color = gradient;\n        }\n        else {\n            color = frameObj.color;\n        }\n        return color;\n    };\n    Draw.prototype.applyFrame = function (ctx, frame, preventImg) {\n        var parent = this.parent;\n        parent.frameObj.type = frame;\n        var tempLineWidth;\n        var ratio = { width: 1, height: 1 };\n        var points = { startX: parent.img.destLeft - ctx.lineWidth, startY: parent.img.destTop - ctx.lineWidth,\n            width: parent.img.destWidth + (2 * ctx.lineWidth), height: parent.img.destHeight + (2 * ctx.lineWidth) };\n        var frameObj = { type: parent.frameObj.type, color: parent.frameObj.color, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset / 2, radius: parent.frameObj.radius,\n            amount: parent.frameObj.amount, border: parent.frameObj.border, gradientColor: parent.frameObj.gradientColor };\n        var zoomFactor = parent.transform.zoomFactor;\n        if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n            var newWidth = ctx.canvas.width;\n            var newHeight = ctx.canvas.height;\n            var obj = { width: 0, height: 0 };\n            parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: newWidth, height: newHeight } } });\n            ratio = obj;\n            frameObj.size *= ((ratio.width + ratio.height) / 2);\n            frameObj.inset *= ((ratio.width + ratio.height) / 2);\n            frameObj.offset *= ((ratio.width + ratio.height) / 2);\n            frameObj.radius *= ((ratio.width + ratio.height) / 2);\n            points = { startX: 0, startY: 0, width: ctx.canvas.width, height: ctx.canvas.height };\n            parent.notify('export', { prop: 'updateSaveContext', onPropertyChange: false, value: { context: ctx } });\n        }\n        else if (ctx === this.upperContext && parent.activeObj.shape) {\n            points = { startX: parent.activeObj.activePoint.startX - ctx.lineWidth, startY: parent.activeObj.activePoint.startY\n                    - ctx.lineWidth, width: parent.activeObj.activePoint.width + (2 * ctx.lineWidth), height: parent.activeObj.activePoint.height + (2 * ctx.lineWidth) };\n        }\n        else if (isNullOrUndefined(preventImg)) {\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        }\n        var valueForty = (40 * ((ratio.width + ratio.height) / 2));\n        var valueFifty = (50 * ((ratio.width + ratio.height) / 2));\n        if (ctx !== this.upperContext) {\n            frameObj.size += (frameObj.size * zoomFactor);\n            frameObj.inset += (frameObj.inset * zoomFactor);\n            frameObj.offset += (frameObj.offset * zoomFactor);\n            frameObj.radius += (frameObj.radius * zoomFactor);\n            valueForty += (valueForty * zoomFactor);\n            valueFifty += (valueFifty * zoomFactor);\n        }\n        if (ctx === this.upperContext && parent.activeObj.shape) {\n            if ((frame === 'mat' && ((points.width - (2 * frameObj.size) < 0) || (points.height - (2 * frameObj.size) < 0))) ||\n                (frame === 'bevel' && (points.width - (2 * frameObj.size) < 40 || points.height - (2 * frameObj.size) < 40)) ||\n                ((frame === 'inset') && (points.startX + points.width - frameObj.offset - (points.startX + frameObj.offset) < 0 ||\n                    points.startY + points.height - frameObj.offset - (points.startY + frameObj.offset) < 0)) ||\n                (frame === 'hook' && (points.width - (2 * frameObj.size) < 50 || points.height - (2 * frameObj.size) < 50))) {\n                return;\n            }\n        }\n        var bevelObj = { bevelFilter: ctx.filter };\n        var filter = ctx.filter;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop ||\n            (ctx === this.lowerContext && parent.isCropTab)) {\n            this.drawImgToCtx(ctx, preventImg);\n        }\n        else {\n            switch (frame) {\n                case 'none':\n                    this.drawImgToCtx(ctx, preventImg);\n                    break;\n                case 'mat':\n                    this.drawImgToCtx(ctx, preventImg);\n                    while (((points.width - (2 * frameObj.size) < 0) ||\n                        (points.height - (2 * frameObj.size) < 0)) && frameObj.size > 0) {\n                        frameObj.size -= 20;\n                    }\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.rect(points.startX, points.startY, points.width, points.height);\n                    ctx.rect(points.startX + frameObj.size, points.startY + frameObj.size, points.width -\n                        (2 * frameObj.size), points.height - (2 * frameObj.size));\n                    ctx.fill('evenodd');\n                    ctx.closePath();\n                    break;\n                case 'bevel':\n                    ctx.filter = 'none';\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.beginPath();\n                    ctx.fillRect(points.startX, points.startY, points.width, points.height);\n                    ctx.closePath();\n                    points.startX += frameObj.size;\n                    points.startY += frameObj.size;\n                    points.width -= (2 * frameObj.size);\n                    points.height -= (2 * frameObj.size);\n                    while ((points.width - (2 * frameObj.size) < 40 ||\n                        points.height - (2 * frameObj.size) < 40) && frameObj.size > 0) {\n                        points.startX -= frameObj.size;\n                        points.startY -= frameObj.size;\n                        points.width += (2 * frameObj.size);\n                        points.height += (2 * frameObj.size);\n                        frameObj.size -= 20;\n                        points.startX += frameObj.size;\n                        points.startY += frameObj.size;\n                        points.width -= (2 * frameObj.size);\n                        points.height -= (2 * frameObj.size);\n                    }\n                    ctx.fillStyle = this.getFrameColor(frameObj, ctx, points);\n                    ctx.save();\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + valueForty, points.startY);\n                    ctx.lineTo(points.startX + points.width - valueForty, points.startY);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY, points.startX + points.width, points.startY + valueForty);\n                    ctx.lineTo(points.startX + points.width, points.startY + points.height - valueForty);\n                    ctx.quadraticCurveTo(points.startX + points.width, points.startY + points.height, points.startX + points.width - valueForty, points.startY + points.height);\n                    ctx.lineTo(points.startX + valueForty, points.startY + points.height);\n                    ctx.quadraticCurveTo(points.startX, points.startY + points.height, points.startX, points.startY + points.height\n                        - valueForty);\n                    ctx.lineTo(points.startX, points.startY + valueForty);\n                    ctx.quadraticCurveTo(points.startX, points.startY, points.startX + valueForty, points.startY);\n                    ctx.closePath();\n                    ctx.clip();\n                    ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    if (ctx.canvas.id === parent.element.id + '_tempCanvas') {\n                        preventImg = null;\n                        ctx.filter = 'none';\n                        ctx.drawImage(parent.inMemoryCanvas, 0, 0);\n                        ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                    }\n                    else {\n                        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n                        if (preventImg) {\n                            preventImg = null;\n                            if (parent.transform.zoomFactor !== 0) {\n                                this.isRotateZoom = true;\n                            }\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.updateCurrTransState('initial');\n                            this.drawImgToCtx(ctx, preventImg);\n                            this.updateCurrTransState('reverse');\n                            this.isRotateZoom = false;\n                            parent.frameObj.type = 'none';\n                            ctx.filter = 'none';\n                            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                                value: { ctx: ctx, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                            parent.frameObj.type = 'bevel';\n                            ctx.filter = filter === 'none' ? parent.canvasFilter : filter;\n                        }\n                        else {\n                            parent.notify('filter', { prop: 'getBevelFilter', onPropertyChange: false, value: { obj: bevelObj } });\n                            ctx.filter = bevelObj['bevelFilter'];\n                            this.drawImgToCtx(ctx, preventImg);\n                        }\n                    }\n                    ctx.restore();\n                    break;\n                case 'line':\n                    this.drawImgToCtx(ctx, preventImg);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    for (var i = 0; i < parent.frameObj.amount; i++) {\n                        if (i > 0) {\n                            points.startX += frameObj.offset;\n                            points.startY += frameObj.offset;\n                            points.width -= (2 * frameObj.offset);\n                            points.height -= (2 * frameObj.offset);\n                        }\n                        var arcY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        var lineY = points.startY + frameObj.inset + frameObj.radius;\n                        var arcX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var lineX = points.startX + frameObj.inset + frameObj.radius;\n                        var arcX1 = points.startX + frameObj.inset + frameObj.radius;\n                        var lineX2 = points.startX + points.width - frameObj.inset - frameObj.radius;\n                        var arcY1 = points.startY + frameObj.inset + frameObj.radius;\n                        var lineY2 = points.startY + points.height - frameObj.inset - frameObj.radius;\n                        if (arcY2 >= lineY && arcX2 >= lineX && arcX1 <= lineX2 && arcY1 <= lineY2) {\n                            ctx.filter = 'none';\n                            ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                            if (frameObj.border === 'dashed') {\n                                ctx.setLineDash([ctx.lineWidth * 2.5, ctx.lineWidth * 1.5]);\n                            }\n                            else if (frameObj.border === 'dotted') {\n                                ctx.setLineDash([ctx.lineWidth, ctx.lineWidth]);\n                            }\n                            ctx.beginPath();\n                            ctx.moveTo(points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + frameObj.inset);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset, points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset -\n                                frameObj.radius);\n                            ctx.arcTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + points.width - frameObj.inset - frameObj.radius, points.startY + points.height\n                                - frameObj.inset, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset + frameObj.radius, points.startY + points.height - frameObj.inset);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset, points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - frameObj.radius, frameObj.radius);\n                            ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + frameObj.radius);\n                            ctx.arcTo(points.startX + frameObj.inset, points.startY + frameObj.inset, points.startX + frameObj.inset + frameObj.radius, points.startY + frameObj.inset, frameObj.radius);\n                            ctx.closePath();\n                            ctx.stroke();\n                            ctx.setLineDash([]);\n                        }\n                    }\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'inset':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.offset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.offset, points.startY + frameObj.inset);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.offset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.moveTo(points.startX + points.width - frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.offset, points.startY + points.height - frameObj.inset);\n                    ctx.moveTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.offset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.offset);\n                    ctx.stroke();\n                    ctx.closePath();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n                case 'hook':\n                    this.drawImgToCtx(ctx, preventImg);\n                    ctx.filter = 'none';\n                    ctx.strokeStyle = this.getFrameColor(frameObj, ctx, points);\n                    tempLineWidth = ctx.lineWidth;\n                    ctx.lineWidth = frameObj.size / 10;\n                    ctx.beginPath();\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + frameObj.inset + valueFifty);\n                    ctx.moveTo(points.startX + points.width - frameObj.inset - valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + points.width - frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.moveTo(points.startX + frameObj.inset + valueFifty, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset);\n                    ctx.lineTo(points.startX + frameObj.inset, points.startY + points.height - frameObj.inset - valueFifty);\n                    ctx.stroke();\n                    ctx.lineWidth = tempLineWidth;\n                    break;\n            }\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: ctx, isSave: ctx.canvas.id === parent.element.id + '_tempCanvas' ? true : null, isFlip: null } });\n            }\n            ctx.filter = filter;\n        }\n    };\n    Draw.prototype.triggerFrameChange = function (prevFrameSettings) {\n        var parent = this.parent;\n        var currFrameSettings = { type: parent.toPascalCase(parent.frameObj.type),\n            color: parent.frameObj.color, gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size,\n            inset: parent.frameObj.inset, offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n            frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n        var frameChange = { cancel: false, previousFrameSetting: prevFrameSettings,\n            currentFrameSetting: currFrameSettings };\n        parent.trigger('frameChange', frameChange);\n        parent.editCompleteArgs = frameChange;\n        if (!frameChange.cancel) {\n            this.setFrameObj(frameChange.currentFrameSetting);\n        }\n        return frameChange;\n    };\n    Draw.prototype.setFrameObj = function (currFrameSettings) {\n        var parent = this.parent;\n        parent.frameObj.type = currFrameSettings.type.toLowerCase();\n        parent.frameObj.color = currFrameSettings.color;\n        parent.frameObj.gradientColor = currFrameSettings.gradientColor;\n        parent.frameObj.size = currFrameSettings.size;\n        parent.frameObj.inset = currFrameSettings.inset;\n        parent.frameObj.offset = currFrameSettings.offset;\n        parent.frameObj.radius = currFrameSettings.borderRadius;\n        parent.frameObj.border = currFrameSettings.frameLineStyle.toLowerCase();\n        parent.frameObj.amount = currFrameSettings.lineCount;\n    };\n    Draw.prototype.zoomToSel = function (activeObj, isToolbar) {\n        var parent = this.parent;\n        if (this.straightenActObj && JSON.stringify(this.straightenActObj.activePoint) === JSON.stringify(activeObj.activePoint)) {\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            this.allowRedactStraighten = false;\n            if (parent.transform.straighten === 0) {\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.transform.straighten = 360;\n                while (true) {\n                    if (!isNullOrUndefined(this.straightenInitZoom) &&\n                        (Math.round(parent.transform.zoomFactor * Math.pow(10, 3)) / Math.pow(10, 3)) >\n                            (Math.round(this.straightenInitZoom * Math.pow(10, 3)) / Math.pow(10, 3))) {\n                        this.setZoomPan('out');\n                        if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                            this.performDummyZoom();\n                            break;\n                        }\n                        if (parent.transform.degree === 0) {\n                            parent.transform.zoomFactor -= 0.025;\n                            parent.transform.cropZoomFactor -= 0.025;\n                        }\n                    }\n                    else {\n                        this.performDummyZoom();\n                        break;\n                    }\n                }\n                parent.transform.straighten = 0;\n                parent.img = { destLeft: parent.img.destLeft, destTop: parent.img.destTop, destWidth: parent.img.destWidth,\n                    destHeight: parent.img.destHeight, srcLeft: parent.img.srcLeft, srcTop: parent.img.srcTop,\n                    srcWidth: parent.img.srcWidth, srcHeight: parent.img.srcHeight };\n            }\n            else {\n                if (isNullOrUndefined(this.straightenInitZoom)) {\n                    this.straightenInitZoom = parent.transform.zoomFactor;\n                }\n                if (this.straightenInitZoom - parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -(this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                else if (this.straightenInitZoom - parent.transform.zoomFactor < 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: (this.straightenInitZoom - parent.transform.zoomFactor), zoomPoint: null, isResize: true } });\n                }\n                parent.activeObj = extend({}, activeObj, null, true);\n                parent.transform.zoomFactor += 0.001;\n                this.calcStraightenedPoints(isToolbar);\n            }\n        }\n        else {\n            this.straightenActObj = extend({}, activeObj, null, true);\n            parent.activeObj = extend({}, this.straightenActObj, null, true);\n            this.straightenInitZoom = parent.transform.zoomFactor;\n            this.calcStraightenedPoints(isToolbar);\n        }\n    };\n    Draw.prototype.isDestPointSmall = function () {\n        var parent = this.parent;\n        var img = parent.img;\n        var destPoints = { startX: img.destLeft, startY: img.destTop,\n            width: img.destWidth, height: img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var isSmall = false;\n        if (this.straightenDestPoints.destWidth && this.straightenDestPoints.destHeight &&\n            (img.destWidth < this.straightenDestPoints.destWidth || img.destHeight < this.straightenDestPoints.destHeight)) {\n            isSmall = true;\n        }\n        img.destLeft = destPoints.startX;\n        img.destTop = destPoints.startY;\n        img.destWidth = destPoints.width;\n        img.destHeight = destPoints.height;\n        parent.img = img;\n        return isSmall;\n    };\n    Draw.prototype.calcStraightenedPoints = function (isToolbar) {\n        var parent = this.parent;\n        var destWidth = parent.img.destWidth;\n        var destHeight = parent.img.destHeight;\n        if (isNullOrUndefined(parent.transform.zoomFactor)) {\n            parent.transform.zoomFactor += 0.025;\n        }\n        this.updateImgCanvasPoints();\n        var _loop_1 = function () {\n            if (this_1.isLinesIntersect() || this_1.isSelOutsideImg() || (isToolbar && this_1.isDestPointSmall())) {\n                parent.activeObj = extend({}, this_1.straightenActObj, null, true);\n                this_1.setZoomPan('in');\n                if (destWidth === parent.img.destWidth && destHeight === parent.img.destHeight) {\n                    this_1.performDummyZoom();\n                    return \"break\";\n                }\n                if (parent.transform.degree === 0) {\n                    parent.transform.zoomFactor += 0.025;\n                    parent.transform.cropZoomFactor += 0.025;\n                }\n                var points = this_1.imgCanvasPoints;\n                var left_1 = parent.img.destLeft;\n                var top_1 = parent.img.destTop;\n                var width_1 = parent.img.destWidth;\n                var height_1 = parent.img.destHeight;\n                points.forEach(function (point) {\n                    point.x = (point.ratioX * width_1) + left_1;\n                    point.y = (point.ratioY * height_1) + top_1;\n                });\n                this_1.imgCanvasPoints = points;\n            }\n            else {\n                this_1.performDummyZoom();\n                return \"break\";\n            }\n        };\n        var this_1 = this;\n        while (true) {\n            var state_1 = _loop_1();\n            if (state_1 === \"break\")\n                break;\n        }\n    };\n    Draw.prototype.performDummyZoom = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: 0.025, zoomPoint: null, isResize: true } });\n        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: -0.025, zoomPoint: null, isResize: true } });\n        var zoom = parent.transform.zoomFactor * 10;\n        if (zoom < 1) {\n            zoom = 1 + (zoom / 10);\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: zoom } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n            value: { previousZoomValue: zoom } });\n        this.panToSel();\n    };\n    Draw.prototype.setZoomPan = function (type) {\n        var parent = this.parent;\n        var obj = { maxDimension: null };\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'cropZoom', onPropertyChange: false,\n                value: { value: type === 'in' ? 0.025 : -0.025, selectionObj: parent.activeObj, obj: obj } });\n            parent.img.destWidth = obj['maxDimension']['width'];\n            parent.img.destHeight = obj['maxDimension']['height'];\n        }\n        else {\n            parent.transform.zoomFactor += (type === 'in' ? 0.025 : -0.025);\n            parent.transform.cropZoomFactor += (type === 'in' ? 0.025 : -0.025);\n            this.updateCurrTransState('initial');\n            this.isRotateZoom = true;\n            this.setDestPoints();\n            this.isRotateZoom = false;\n            this.updateCurrTransState('reverse');\n        }\n    };\n    Draw.prototype.updateImgCanvasPoints = function () {\n        var parent = this.parent;\n        var points = this.getImagePoints();\n        var obj = { width: 0, height: 0 };\n        var width = parent.baseImgCanvas.width;\n        var height = parent.baseImgCanvas.height;\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        width = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.height : ratio.width;\n        height = parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0 ?\n            ratio.width : ratio.height;\n        var p1;\n        var p2;\n        var p3;\n        var p4;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.transform.straighten > 0) {\n            p1 = { x: destLeft + (points[0].x / width), y: destTop };\n            p2 = { x: destLeft + destWidth, y: destTop + (points[1].y / height) };\n            p3 = { x: destLeft + destWidth - (points[0].x / width), y: destTop + destHeight };\n            p4 = { x: destLeft, y: destTop + destHeight - (points[1].y / height) };\n        }\n        else if (parent.transform.straighten < 0) {\n            p1 = { x: destLeft, y: destTop + (points[0].y / height) };\n            p2 = { x: destLeft + (points[1].x / width), y: destTop };\n            p3 = { x: destLeft + destWidth, y: destTop + destHeight - (points[0].y / height) };\n            p4 = { x: destLeft + destWidth - (points[1].x / width), y: destTop + destHeight };\n        }\n        else if (parent.transform.straighten === 0) {\n            p1 = { x: destLeft, y: destTop };\n            p2 = { x: destLeft + destWidth, y: destTop };\n            p3 = { x: destLeft + destWidth, y: destTop + destHeight };\n            p4 = { x: destLeft, y: destTop + destHeight };\n        }\n        p1.ratioX = (p1.x - destLeft) / destWidth;\n        p1.ratioY = (p1.y - destTop) / destHeight;\n        p2.ratioX = (p2.x - destLeft) / destWidth;\n        p2.ratioY = (p2.y - destTop) / destHeight;\n        p3.ratioX = (p3.x - destLeft) / destWidth;\n        p3.ratioY = (p3.y - destTop) / destHeight;\n        p4.ratioX = (p4.x - destLeft) / destWidth;\n        p4.ratioY = (p4.y - destTop) / destHeight;\n        this.imgCanvasPoints = [p1, p2, p3, p4];\n    };\n    Draw.prototype.isLinesIntersect = function (obj) {\n        var parent = this.parent;\n        var point = parent.activeObj.activePoint;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n            var center = { x: startX + (width / 2), y: startY +\n                    (height / 2) };\n            var cosAngle = Math.cos(parent.activeObj.rotatedAngle);\n            var sinAngle = Math.sin(parent.activeObj.rotatedAngle);\n            var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n            var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n            var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n            var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n                y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n            var imgPoints_1 = this.imgCanvasPoints;\n            var isTopIntersect_1 = this.doIntersect(p1, p2, imgPoints_1[0], imgPoints_1[1]);\n            var isRightIntersect_1 = this.doIntersect(p2, p4, imgPoints_1[1], imgPoints_1[2]);\n            var isBottomIntersect_1 = this.doIntersect(p3, p4, imgPoints_1[2], imgPoints_1[3]);\n            var isLeftIntersect_1 = this.doIntersect(p1, p3, imgPoints_1[3], imgPoints_1[0]);\n            if (obj) {\n                obj['arr'] = [isTopIntersect_1, isRightIntersect_1, isBottomIntersect_1, isLeftIntersect_1];\n            }\n            return isTopIntersect_1 || isRightIntersect_1 || isBottomIntersect_1 || isLeftIntersect_1;\n        }\n        var imgPoints = this.imgCanvasPoints;\n        var isTopIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.endX, y: point.startY }, imgPoints[0], imgPoints[1]);\n        var isRightIntersect = this.doIntersect({ x: point.endX, y: point.startY }, { x: point.endX, y: point.endY }, imgPoints[1], imgPoints[2]);\n        var isBottomIntersect = this.doIntersect({ x: point.startX, y: point.endY }, { x: point.endX, y: point.endY }, imgPoints[2], imgPoints[3]);\n        var isLeftIntersect = this.doIntersect({ x: point.startX, y: point.startY }, { x: point.startX, y: point.endY }, imgPoints[3], imgPoints[0]);\n        var isTopLeftInsideRect = this.isInsideRect(imgPoints[0]);\n        var isTopRightInsideRect = this.isInsideRect(imgPoints[1]);\n        var isBottomRightInsideRect = this.isInsideRect(imgPoints[2]);\n        var isBottomLeftInsideRect = this.isInsideRect(imgPoints[3]);\n        if (obj) {\n            obj['arr'] = [isTopIntersect, isRightIntersect, isBottomIntersect, isLeftIntersect];\n        }\n        return isTopIntersect || isRightIntersect || isBottomIntersect || isLeftIntersect ||\n            isTopLeftInsideRect || isTopRightInsideRect || isBottomRightInsideRect || isBottomLeftInsideRect ||\n            (imgPoints[0].x > point.startX && imgPoints[1].x < point.endX &&\n                imgPoints[2].x < point.endX && imgPoints[3].x > point.startX &&\n                imgPoints[0].y < point.startY && imgPoints[1].y < point.startY &&\n                imgPoints[2].y > point.endY && imgPoints[3].y > point.endY) ||\n            (imgPoints[0].x < point.startX && imgPoints[1].x > point.endX &&\n                imgPoints[2].x > point.endX && imgPoints[3].x < point.startX &&\n                imgPoints[0].y > point.startY && imgPoints[1].y > point.startY &&\n                imgPoints[2].y < point.endY && imgPoints[3].y < point.endY);\n    };\n    Draw.prototype.isSelOutsideImg = function () {\n        var parent = this.parent;\n        var points = this.imgCanvasPoints;\n        var actPoint = parent.activeObj.activePoint;\n        return (this.checkPointPosition(actPoint.startX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.startY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.startX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside' ||\n            this.checkPointPosition(actPoint.endX, actPoint.endY, points[0].x, points[0].y, points[1].x, points[1].y, points[2].x, points[2].y, points[3].x, points[3].y) !== 'inside');\n    };\n    Draw.prototype.calcTriangleArea = function (x1, y1, x2, y2, x3, y3) {\n        return Math.abs((x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2)) / 2);\n    };\n    Draw.prototype.checkPointPosition = function (x, y, x1, y1, x2, y2, x3, y3, x4, y4) {\n        var area1 = this.calcTriangleArea(x, y, x1, y1, x4, y4);\n        var area2 = this.calcTriangleArea(x, y, x4, y4, x3, y3);\n        var area3 = this.calcTriangleArea(x, y, x3, y3, x2, y2);\n        var area4 = this.calcTriangleArea(x, y, x2, y2, x1, y1);\n        var areaRectangle = this.calcTriangleArea(x1, y1, x2, y2, x3, y3) + this.calcTriangleArea(x3, y3, x4, y4, x1, y1);\n        if (area1 + area2 + area3 + area4 > areaRectangle) {\n            return 'outside';\n        }\n        else if (area1 + area2 + area3 + area4 === areaRectangle && (area1 === 0 || area2 === 0 || area3 === 0 || area4 === 0)) {\n            return 'on';\n        }\n        else {\n            return 'inside';\n        }\n    };\n    Draw.prototype.getImagePoints = function () {\n        var point = [];\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var width = parent.baseImg.width;\n        var height = parent.baseImg.height;\n        var obj = { dim: null, width: height, height: width, angle: parent.transform.straighten };\n        obj['dim'] = parent.getRotatedCanvasDim(obj['width'], obj['height'], obj['angle']);\n        var baseImgCanvasWidth = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['width'] : parent.baseImgCanvas.width;\n        var baseImgCanvasHeight = degree % 90 === 0 && degree % 180 !== 0 ? obj['dim']['height'] : parent.baseImgCanvas.height;\n        var baseImgWidth = degree % 90 === 0 && degree % 180 !== 0 ? height : width;\n        var baseImgHeight = degree % 90 === 0 && degree % 180 !== 0 ? width : height;\n        var centerX = baseImgCanvasWidth / 2;\n        var centerY = baseImgCanvasHeight / 2;\n        var startX = centerX - (baseImgWidth / 2);\n        var startY = centerY - (baseImgHeight / 2);\n        var endX = centerX + (baseImgWidth / 2);\n        var endY = centerY + (baseImgHeight / 2);\n        var center = { x: centerX, y: centerY };\n        var radians = parent.transform.straighten * (Math.PI / 180);\n        var p1 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p2 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (startY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (startY - center.y) + center.y };\n        var p3 = { x: Math.cos(radians) * (endX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (endX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        var p4 = { x: Math.cos(radians) * (startX - center.x) - Math.sin(radians) * (endY - center.y) + center.x,\n            y: Math.sin(radians) * (startX - center.x) + Math.cos(radians) * (endY - center.y) + center.y };\n        point.push(p1);\n        point.push(p2);\n        point.push(p3);\n        point.push(p4);\n        return point;\n    };\n    Draw.prototype.doIntersect = function (a, b, c, d) {\n        var point1 = this.initiation(a, b, c);\n        var point2 = this.initiation(a, b, d);\n        var point3 = this.initiation(c, d, a);\n        var point4 = this.initiation(c, d, b);\n        if (point1 !== point2 && point3 !== point4) {\n            return true;\n        }\n        if (point1 === 0 && this.onSegment(a, c, b)) {\n            return true;\n        }\n        if (point2 === 0 && this.onSegment(a, d, b)) {\n            return true;\n        }\n        if (point3 === 0 && this.onSegment(c, a, d)) {\n            return true;\n        }\n        if (point4 === 0 && this.onSegment(c, b, d)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.initiation = function (a, b, c) {\n        var value = (b.y - a.y) * (c.x - b.x) - (b.x - a.x) * (c.y - b.y);\n        if (value === 0) {\n            return 0;\n        }\n        return (value > 0) ? 1 : 2;\n    };\n    Draw.prototype.onSegment = function (a, b, c) {\n        if (b.x <= Math.max(a.x, c.x) && b.x >= Math.min(a.x, c.x) &&\n            b.y <= Math.max(a.y, c.y) && b.y >= Math.min(a.y, c.y)) {\n            return true;\n        }\n        return false;\n    };\n    Draw.prototype.isInsideRect = function (point) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var isInside = false;\n        if (point.x >= actPoint.startX && point.x <= actPoint.endX &&\n            point.y >= actPoint.startY && point.y <= actPoint.endY) {\n            isInside = true;\n        }\n        return isInside;\n    };\n    Draw.prototype.setDestForStraighten = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(this.straightenDestPoints)) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            // If straightening performed, then destination points are set in non-straightened state\n            parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n            this.straightenDestPoints = extend({}, parent.img, {}, true);\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n            parent.img.destWidth = destWidth;\n            parent.img.destHeight = destHeight;\n        }\n    };\n    Draw.prototype.drawRedact = function (canvasDraw, obj) {\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var _b = obj.activePoint, width = _b.width, height = _b.height;\n        var isSaveCtx = false;\n        var canvas = canvasDraw.canvas;\n        if (canvas.id.indexOf('_tempCanvas') !== -1) {\n            isSaveCtx = true;\n        }\n        var img = this.parent.img;\n        if (width <= 0 || height <= 0) {\n            return;\n        }\n        else if (this.parent.isCropTab) {\n            canvasDraw.drawImage(obj.redactImage, 0, 0, obj.redactImage.width, obj.redactImage.height, startX, startY, width, height);\n        }\n        else {\n            var offscreenCanvas = document.createElement('canvas');\n            var offscreenCtx = offscreenCanvas.getContext('2d');\n            var imageWidth = canvas.width;\n            var imageHeight = canvas.height;\n            var tempRatio = Math.min(imageWidth, imageHeight) / 1000;\n            var straighten = this.parent.transform.straighten !== 0 ? this.parent.transform.straighten :\n                this.parent.cropObj.straighten;\n            if (this.allowRedactStraighten && straighten !== 0) {\n                var tempCanvas = document.createElement('canvas');\n                var tempCtx = tempCanvas.getContext('2d');\n                if (isSaveCtx) {\n                    tempCanvas.width = canvas.width;\n                    tempCanvas.height = canvas.height;\n                    tempCtx.drawImage(canvas, 0, 0);\n                }\n                else {\n                    tempCanvas.width = img.destWidth;\n                    tempCanvas.height = img.destHeight;\n                    tempCtx.drawImage(this.lowerContext.canvas, img.destLeft, img.destTop, img.destWidth, img.destHeight, 0, 0, img.destWidth, img.destHeight);\n                }\n                var radians = -straighten * Math.PI / 180;\n                var straightenCanvas = document.createElement('canvas');\n                var straightenCtx = straightenCanvas.getContext('2d');\n                straightenCanvas.width = tempCanvas.width;\n                straightenCanvas.height = tempCanvas.height;\n                if (img.destWidth > canvas.width && !isSaveCtx) {\n                    straightenCanvas.width = canvas.width;\n                }\n                if (img.destHeight > canvas.height && !isSaveCtx) {\n                    straightenCanvas.height = canvas.height;\n                }\n                straightenCtx.save();\n                straightenCtx.translate(tempCanvas.width / 2, tempCanvas.height / 2);\n                straightenCtx.rotate(radians);\n                straightenCtx.drawImage(tempCanvas, -tempCanvas.width / 2, -tempCanvas.height / 2);\n                straightenCtx.restore();\n                if (img.destLeft > 0 && !isSaveCtx) {\n                    startX -= img.destLeft;\n                    endX -= img.destLeft;\n                }\n                if (img.destTop > 0 && !isSaveCtx) {\n                    startY -= img.destTop;\n                    endY -= img.destTop;\n                }\n                var center = { x: startX + (width / 2), y: startY + (height / 2) };\n                var cosAngle = Math.cos(straighten * Math.PI / 180);\n                var sinAngle = Math.sin(straighten * Math.PI / 180);\n                var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n                if (!isSaveCtx) {\n                    center = { x: img.destWidth / 2, y: img.destHeight / 2 };\n                    if (img.destWidth > canvas.width) {\n                        center.x = canvas.width / 2;\n                    }\n                    if (img.destHeight > canvas.height) {\n                        center.y = canvas.height / 2;\n                    }\n                }\n                else {\n                    center = { x: canvas.width / 2, y: canvas.height / 2 };\n                }\n                cosAngle = Math.cos(radians);\n                sinAngle = Math.sin(radians);\n                var newP1 = { x: cosAngle * (p1.x - center.x) - sinAngle * (p1.y - center.y) + center.x,\n                    y: sinAngle * (p1.x - center.x) + cosAngle * (p1.y - center.y) + center.y };\n                var newP2 = { x: cosAngle * (p2.x - center.x) - sinAngle * (p2.y - center.y) + center.x,\n                    y: sinAngle * (p2.x - center.x) + cosAngle * (p2.y - center.y) + center.y };\n                var newP3 = { x: cosAngle * (p3.x - center.x) - sinAngle * (p3.y - center.y) + center.x,\n                    y: sinAngle * (p3.x - center.x) + cosAngle * (p3.y - center.y) + center.y };\n                var tempWidth = isSaveCtx ? canvasDraw.canvas.width : img.destWidth;\n                var tempHeight = isSaveCtx ? canvasDraw.canvas.height : img.destHeight;\n                var rotatedWidth = Math.abs(tempWidth * Math.cos(radians)) + Math.abs(tempHeight * Math.sin(radians));\n                var rotatedHeight = Math.abs(tempWidth * Math.sin(radians)) + Math.abs(tempHeight * Math.cos(radians));\n                straightenCanvas.width = rotatedWidth;\n                straightenCanvas.height = rotatedHeight;\n                straightenCtx.save();\n                straightenCtx.translate(rotatedWidth / 2, rotatedHeight / 2);\n                straightenCtx.rotate(radians);\n                straightenCtx.drawImage(tempCanvas, -tempCanvas.width / 2, -tempCanvas.height / 2);\n                straightenCtx.restore();\n                if (this.parent.activeObj.redactType === 'blur') {\n                    offscreenCanvas.width = width;\n                    offscreenCanvas.height = height;\n                    offscreenCtx.drawImage(straightenCanvas, newP1.x + ((rotatedWidth - tempCanvas.width) / 2), newP1.y + ((rotatedHeight - tempCanvas.height) / 2), newP2.x - newP1.x, newP3.y - newP2.y, 0, 0, width, height);\n                }\n                else {\n                    var pixelSize = (obj.redactPixelate / 100) * 20;\n                    if (isSaveCtx) {\n                        pixelSize = tempRatio * (obj.redactPixelate / 100) * 35;\n                    }\n                    offscreenCanvas.width = Math.ceil(width / pixelSize);\n                    offscreenCanvas.height = Math.ceil(height / pixelSize);\n                    offscreenCtx.drawImage(straightenCanvas, newP1.x + ((rotatedWidth - tempCanvas.width) / 2), newP1.y + ((rotatedHeight - tempCanvas.height) / 2), newP2.x - newP1.x, newP3.y - newP2.y, 0, 0, offscreenCanvas.width, offscreenCanvas.height);\n                }\n            }\n            if (this.parent.activeObj.redactType === 'blur') {\n                if (straighten === 0) {\n                    offscreenCanvas.width = width;\n                    offscreenCanvas.height = height;\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, width, height);\n                }\n                if (isSaveCtx) {\n                    var blur_1 = tempRatio * ((obj.redactBlur / 100) * 34);\n                    offscreenCtx.filter = \"blur(\" + blur_1 + \"px)\";\n                }\n                else {\n                    offscreenCtx.filter = \"blur(\" + (obj.redactBlur / 100) * 17 + \"px)\";\n                }\n                offscreenCtx.drawImage(offscreenCanvas, 0, 0);\n                if (straighten === 0) {\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, width, height);\n                }\n                else {\n                    if (img.destLeft > 0 && !isSaveCtx) {\n                        startX += img.destLeft;\n                        endX += img.destLeft;\n                    }\n                    if (img.destTop > 0 && !isSaveCtx) {\n                        startY += img.destTop;\n                        endY += img.destTop;\n                    }\n                }\n                if (this.parent.isSafari) {\n                    this.parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: offscreenCtx } });\n                }\n                canvasDraw.drawImage(offscreenCanvas, 0, 0, width, height, startX, startY, width, height);\n            }\n            else {\n                var pixelSize = (obj.redactPixelate / 100) * 20;\n                if (isSaveCtx) {\n                    pixelSize = tempRatio * (obj.redactPixelate / 100) * 35;\n                }\n                if (straighten === 0) {\n                    offscreenCanvas.width = Math.ceil(width / pixelSize);\n                    offscreenCanvas.height = Math.ceil(height / pixelSize);\n                    offscreenCtx.drawImage((isSaveCtx) ? canvas : this.lowerContext.canvas, startX, startY, width, height, 0, 0, offscreenCanvas.width, offscreenCanvas.height);\n                }\n                else {\n                    if (img.destLeft > 0 && !isSaveCtx) {\n                        startX += img.destLeft;\n                        endX += img.destLeft;\n                    }\n                    if (img.destTop > 0 && !isSaveCtx) {\n                        startY += img.destTop;\n                        endY += img.destTop;\n                    }\n                }\n                canvasDraw.imageSmoothingEnabled = false;\n                canvasDraw.drawImage(offscreenCanvas, 0, 0, offscreenCanvas.width, offscreenCanvas.height, startX, startY, width, height);\n            }\n            obj.redactImage = this.parent.createElement('canvas');\n            obj.redactImage.width = offscreenCanvas.width;\n            obj.redactImage.height = offscreenCanvas.height;\n            obj.redactImage.getContext('2d').drawImage(offscreenCanvas, 0, 0);\n            canvasDraw.beginPath();\n            canvasDraw.rect(startX, startY, width, height);\n            canvasDraw.rect(startX, startY, width, height);\n            canvasDraw.fill('evenodd');\n            canvasDraw.closePath();\n        }\n    };\n    return Draw;\n}());\nexport { Draw };\n","/* eslint-disable max-len */\nimport { extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Export = /** @class */ (function () {\n    function Export(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Export.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Export.prototype.addEventListener = function () {\n        this.parent.on('export', this.export, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Export.prototype.removeEventListener = function () {\n        this.parent.off('export', this.export);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Export.prototype.export = function (args) {\n        this.parent.notify('toolbar', { prop: 'refreshShapeDrawing', onPropertyChange: false });\n        this.updatePvtVar();\n        switch (args.prop) {\n            case 'export':\n                this.exportImg(args.value['type'], args.value['fileName'], args.value['imgQuality']);\n                break;\n            case 'exportToCanvas':\n                this.exportToCanvas(args.value['object']);\n                break;\n            case 'updateSaveContext':\n                this.updateSaveContext(args.value['context']);\n                break;\n            case 'setImageQuality':\n                this.imageQuality = args.value['value'];\n                break;\n            case 'drawAnnotation':\n                this.drawAnnotation(args.value['context'], args.value['ratio']);\n                break;\n        }\n    };\n    Export.prototype.getModuleName = function () {\n        return 'export';\n    };\n    Export.prototype.updatePvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Export.prototype.exportImg = function (type, fileName, imgQuality) {\n        var parent = this.parent;\n        var obj = { fileName: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var imageName = obj['fileName'];\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            var obj_1 = { canvasFilter: this.parent.canvasFilter };\n            this.lowerContext.filter = obj_1['canvasFilter'];\n            type = type ? type : 'Png';\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            var beforeSave = { cancel: false, fileName: fileName ? fileName : imageName,\n                fileType: type, imageQuality: imgQuality };\n            parent.trigger('beforeSave', beforeSave);\n            this.beforeSaveEvent(beforeSave, type, fileName, imageName, imgQuality);\n        }\n    };\n    Export.prototype.beforeSaveEvent = function (observableSaveArgs, type, fileName, imageName, imgQuality) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.currObjType.isSave = true;\n            fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n            var lowerCaseType = type.toLowerCase();\n            fileName = fileName || imageName;\n            if (lowerCaseType === 'svg') {\n                this.toSVGImg(fileName);\n            }\n            else {\n                this.toBlobFn(fileName, lowerCaseType, imgQuality);\n            }\n            var saved = { fileName: fileName ? fileName : imageName, fileType: type };\n            parent.trigger('saved', saved);\n            var actionArgs = { action: 'save', actionEventArgs: saved };\n            parent.triggerEditCompleteEvent(actionArgs);\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.lowerCanvas.style.left = parent.upperCanvas.style.left = '';\n            parent.lowerCanvas.style.top = parent.upperCanvas.style.top = '';\n            parent.lowerCanvas.style.maxWidth = parent.upperCanvas.style.maxWidth = '';\n            parent.lowerCanvas.style.maxHeight = parent.upperCanvas.style.maxHeight = '';\n        }\n    };\n    Export.prototype.toSVGImg = function (fileName) {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        var dataUrl = tempCanvas.toDataURL();\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', tempCanvas.style.maxWidth);\n        svg.setAttribute('height', tempCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', tempCanvas.height.toString());\n        img.setAttributeNS(null, 'width', tempCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + tempCanvas.width + \"\\\"\") + (\" height=\\\"\" + tempCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    Export.prototype.toBlobFn = function (fileName, type, imgQuality) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        if (!isNullOrUndefined(imgQuality)) {\n            imgQuality = imgQuality > 1 ? 1 : (imgQuality <= 0 ? 0.01 : imgQuality);\n            this.imageQuality = imgQuality ? imgQuality : null;\n        }\n        var tempCanvas = this.exportToCanvas();\n        var imagetype = (type === 'jpeg' ? 'image/jpeg' : (type === 'webp' ? 'image/webp' : 'image/png'));\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        tempCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n        }, imagetype, this.imageQuality ? this.imageQuality : null);\n    };\n    Export.prototype.exportToCanvas = function (object) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var tempCropObj = extend({}, parent.cropObj, {}, true);\n        var tempObj = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: tempObj } });\n        var prevObj = tempObj['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        if (this.parent.aspectWidth) {\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n            parent.notify('toolbar', { prop: 'resizeClick', value: { bool: false } });\n            parent.okBtn();\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = this.parent.aspectHeight;\n                height = this.parent.aspectWidth;\n            }\n            else {\n                width = this.parent.aspectWidth;\n                height = this.parent.aspectHeight;\n            }\n            parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n        }\n        else if (parent.currSelectionPoint) {\n            width = parent.img.srcWidth;\n            height = parent.img.srcHeight;\n        }\n        else {\n            width = parent.baseImgCanvas.width;\n            height = parent.baseImgCanvas.height;\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        var tempContextFilter = this.lowerContext.filter;\n        // Manipulating blur value\n        if (this.lowerContext.filter !== 'none') {\n            var splitWords = this.lowerContext.filter.split(' ');\n            var value = parseFloat(splitWords[5].split('(')[1]);\n            value *= ((ratio.width + ratio.height) / 2);\n            splitWords[5] = 'blur(' + value + 'px)';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n        var tempCanvas = parent.createElement('canvas', {\n            id: parent.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n        });\n        var tempContext = tempCanvas.getContext('2d');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: dimObj } });\n        var maxDimension = dimObj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n        var temp = this.lowerContext.filter;\n        tempContext.filter = this.lowerContext.filter;\n        this.downScaleImgCanvas(tempContext, width, height);\n        this.lowerContext.filter = temp;\n        if (parent.transform.degree !== 0 || parent.transform.currFlipState !== '' || parent.transform.straighten !== 0) {\n            this.updateSaveContext(tempContext);\n            this.exportTransformedImage(tempContext);\n        }\n        if (parent.isSafari) {\n            parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: tempContext } });\n        }\n        this.drawAnnotation(tempContext, ratio);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: tempContext, isSave: true, isFlip: null } });\n        }\n        this.updateFrame(tempContext, true);\n        this.lowerContext.filter = tempContextFilter;\n        parent.canvasFilter = tempContextFilter;\n        if (object) {\n            object['canvas'] = tempCanvas;\n        }\n        if (parent.aspectWidth) {\n            parent.objColl = [];\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: [] } } });\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: prevObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: prevObj.selPointColl } } });\n            parent.cropObj = tempCropObj;\n            parent.objColl = extend([], prevObj.objColl, [], true);\n            parent.pointColl = extend([], prevObj.pointColl, [], true);\n            parent.freehandCounter = parent.pointColl.length;\n            parent.transform.straighten = 0;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            this.lowerContext.filter = prevObj.filter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n        return tempCanvas;\n    };\n    Export.prototype.drawAnnotation = function (tempContext, ratio) {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var nonRedact = parent.shapeColl.filter(function (item) { return item.shape !== 'redact'; });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var redact = parent.shapeColl.filter(function (item) { return item.shape === 'redact'; });\n        parent.shapeColl = redact.concat(nonRedact);\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order) {\n                if (parent.shapeColl[i].currIndex && parent.shapeColl[i].currIndex.indexOf('shape') > -1) {\n                    parent.objColl = [];\n                    parent.objColl.push(extend({}, parent.shapeColl[i], {}, true));\n                    this.drawShape(tempContext, ratio);\n                }\n                else if (parent.shapeColl[i].id && parent.shapeColl[i].id.indexOf('pen') > -1) {\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.pointColl.push(extend({}, parent.shapeColl[i], {}, true));\n                    parent.freehandCounter = parent.pointColl.length;\n                    this.drawPen(tempContext, ratio);\n                }\n            }\n        }\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n    };\n    Export.prototype.drawShape = function (tempContext, ratio) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            var indexObj = { index: null };\n            parent.notify('shape', { prop: 'getSmallestIndex', onPropertyChange: false, value: { obj: indexObj } });\n            var index = indexObj['index'];\n            var objColl = extend([], parent.objColl, [], true);\n            var tempObjColl = extend([], parent.objColl, [], true);\n            while (objColl.length > 0) {\n                var found = false;\n                for (var i = 0; i < objColl.length; i++) {\n                    var currentObj = objColl[i];\n                    if (isNullOrUndefined(currentObj.order)) {\n                        objColl.splice(i, 1);\n                        i--;\n                        continue;\n                    }\n                    if (currentObj.order === index) {\n                        var temp_1 = tempContext.filter;\n                        tempContext.filter = 'none';\n                        var currObj = objColl[i];\n                        var activePoint = currObj.activePoint;\n                        // Subtracting destination left and top points\n                        activePoint.startX -= parent.img.destLeft;\n                        activePoint.startY -= parent.img.destTop;\n                        activePoint.endX -= parent.img.destLeft;\n                        activePoint.endY -= parent.img.destTop;\n                        activePoint.width = activePoint.endX - activePoint.startX;\n                        activePoint.height = activePoint.endY - activePoint.startY;\n                        // Manipulating points\n                        activePoint.startX *= ratio.width;\n                        activePoint.startY *= ratio.height;\n                        activePoint.endX *= ratio.width;\n                        activePoint.endY *= ratio.height;\n                        activePoint.width = activePoint.endX - activePoint.startX;\n                        activePoint.height = activePoint.endY - activePoint.startY;\n                        currObj.strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / 2);\n                        if (currObj.shape === 'text') {\n                            currObj.textSettings.fontSize *= ((ratio.width + ratio.height) / 2);\n                        }\n                        else if (currObj.shape === 'path') {\n                            for (var l = 0; l < currObj.pointColl.length; l++) {\n                                currObj.pointColl[l].x =\n                                    (currObj.pointColl[l].x - parent.img.destLeft) * ratio.width;\n                                currObj.pointColl[l].y =\n                                    (currObj.pointColl[l].y - parent.img.destTop) * ratio.height;\n                            }\n                        }\n                        else if (currObj.shape === 'image') {\n                            parent.activeObj = extend({}, objColl[i], {}, true);\n                            parent.notify('selection', { prop: 'upgradeImageQuality', onPropertyChange: false });\n                            objColl[i] = extend({}, parent.activeObj, {}, true);\n                        }\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'saveContext', obj: objColl[i], isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: tempContext, isPreventSelection: null } });\n                        tempContext.filter = temp_1;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        index++;\n                        var indexBool = { bool: false };\n                        parent.notify('shape', { prop: 'isIndexInObjColl', onPropertyChange: false, value: { obj: indexBool, index: index } });\n                        if (!indexBool['bool']) {\n                            index++;\n                        }\n                        objColl.splice(i, 1);\n                        found = true;\n                        break; // Exit the loop to start from the beginning\n                    }\n                }\n                if (!found) {\n                    break; // If no matching order was found, exit the loop\n                }\n            }\n            tempContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.objColl = tempObjColl;\n        }\n    };\n    Export.prototype.drawPen = function (tempContext, ratio) {\n        var parent = this.parent;\n        if (parent.freehandCounter > 0) {\n            var widthObj = { penStrokeWidth: null };\n            parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n                var len = parent.points.length;\n                parent.pointColl[n].strokeWidth *= ((ratio.width + ratio.height) / 2);\n                for (var l = 0; l < len; l++) {\n                    parent.points[l].x = (parent.points[l].x - parent.img.destLeft) * ratio.width;\n                    parent.points[l].y = (parent.points[l].y - parent.img.destTop) * ratio.height;\n                }\n            }\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: tempContext, points: null } });\n            parent.pointColl = tempPointColl;\n            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n        }\n    };\n    Export.prototype.downScaleImgCanvas = function (ctx, width, height) {\n        var parent = this.parent;\n        var canvas = parent.baseImgCanvas;\n        var img = parent.baseImg;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: img.width, height: img.height, obj: obj, isImgShape: null } });\n        var bgObj = { color: null };\n        parent.notify('draw', { prop: 'getImageBackgroundColor', value: { obj: bgObj } });\n        if (bgObj['color'] !== '') {\n            ctx.fillStyle = bgObj['color'];\n            ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        }\n        if (obj['width'] > width && obj['height'] > height) {\n            var tempCanvas = parent.createElement('canvas', {\n                id: parent.element.id + '_downScaleCanvas', attrs: { name: 'canvasImage' }\n            });\n            tempCanvas.width = this.parent.img.srcWidth;\n            tempCanvas.height = this.parent.img.srcHeight;\n            tempCanvas.getContext('2d').drawImage(canvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, tempCanvas.width, tempCanvas.height);\n            parent.notify('draw', { prop: 'downScale', value: { canvas: tempCanvas, width: width, height: height } });\n            ctx.drawImage(tempCanvas, 0, 0);\n        }\n        else {\n            ctx.drawImage(parent.baseImgCanvas, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, width, height);\n        }\n    };\n    Export.prototype.updateFrame = function (tempContext, isAnnotation) {\n        if (this.parent.frameObj.type !== 'none') {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            this.parent.notify('draw', { prop: 'applyFrame', value: { ctx: tempContext, frame: this.parent.frameObj.type, preventImg: isAnnotation } });\n            tempContext.filter = temp;\n        }\n    };\n    Export.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    Export.prototype.exportTransformedImage = function (tempContext) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        if (parent.rotateFlipColl.length > 0) {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var flip = parent.rotateFlipColl[i];\n                if (typeof flip === 'number') {\n                    this.exportRotate(tempContext, flip);\n                }\n                else if (flip === 'horizontal') {\n                    this.exportFlip(tempContext, true, false);\n                }\n                else if (flip === 'vertical') {\n                    this.exportFlip(tempContext, false, true);\n                }\n            }\n        }\n        parent.transform.degree = degree;\n    };\n    Export.prototype.exportRotate = function (tempContext, degree) {\n        var parent = this.parent;\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.setMaxDim(parent.transform.degree, tempContext.canvas);\n        tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n        tempContext.rotate(Math.PI / 180 * degree);\n        tempContext.drawImage(parent.inMemoryCanvas, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.exportFlip = function (tempContext, flipHorizontal, flipVertical) {\n        tempContext.clearRect(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        if (flipHorizontal) {\n            tempContext.translate(tempContext.canvas.width, 0);\n            tempContext.scale(-1, 1);\n        }\n        if (flipVertical) {\n            tempContext.translate(0, tempContext.canvas.height);\n            tempContext.scale(1, -1);\n        }\n        tempContext.drawImage(this.parent.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.updateSaveContext = function (tempContext) {\n        var inMemoryContext = this.parent.inMemoryCanvas.getContext('2d');\n        tempContext.setTransform(1, 0, 0, 1, 0, 0);\n        var imageData = tempContext.getImageData(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.parent.inMemoryCanvas.width = imageData.width;\n        this.parent.inMemoryCanvas.height = imageData.height;\n        inMemoryContext.putImageData(imageData, 0, 0);\n    };\n    Export.prototype.setMaxDim = function (degree, tempCanvas) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.height;\n                newHeight = this.parent.baseImgCanvas.width;\n            }\n            else {\n                newWidth = this.parent.img.srcHeight;\n                newHeight = this.parent.img.srcWidth;\n            }\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            if (isNullOrUndefined(this.parent.currSelectionPoint)) {\n                newWidth = this.parent.baseImgCanvas.width;\n                newHeight = this.parent.baseImgCanvas.height;\n            }\n            else {\n                newWidth = this.parent.img.srcWidth;\n                newHeight = this.parent.img.srcHeight;\n            }\n        }\n        if (!isNullOrUndefined(this.parent.aspectWidth)) {\n            newWidth = this.parent.aspectWidth;\n            newHeight = this.parent.aspectHeight;\n        }\n        tempCanvas.width = newWidth;\n        tempCanvas.height = newHeight;\n        var obj = { width: 0, height: 0 };\n        this.parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: newWidth, height: newHeight, obj: obj, isImgShape: null } });\n        var maxDimension = obj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    return Export;\n}());\nexport { Export };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar Filter = /** @class */ (function () {\n    function Filter(parent) {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for toolbar slider value\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false }; // for temp toolbar slider value\n        this.adjustmentValue = ''; // for internal slider value\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempFilVal = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Filter.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on('filter', this.filter, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        this.parent.off('filter', this.filter);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Filter.prototype.filter = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'finetuneImage':\n                this.finetuneImage(args.value['option'], args.value['value']);\n                break;\n            case 'applyImageFilter':\n                this.setFilter(args.value['option']);\n                break;\n            case 'update-finetunes':\n                this.updateFinetunes();\n                break;\n            case 'set-adjustment':\n                this.setAdjustment(args.value['operation']);\n                break;\n            case 'initFilter':\n                this.initFilter();\n                break;\n            case 'setCurrAdjValue':\n                this.setCurrAdjValue(args.value['type'], args.value['value']);\n                break;\n            case 'updateAdj':\n                this.updateAdj(args.value['type'], args.value['value'], args.value['isPreview'], args.value['ctx']);\n                break;\n            case 'getCurrentObj':\n                this.getCurrentObj(args.value['object']);\n                break;\n            case 'getAdjustmentLevel':\n                if (isNullOrUndefined(this.parent.activeObj.opacity)) {\n                    this.adjustmentLevel.transparency = 100;\n                }\n                else {\n                    this.adjustmentLevel.transparency = this.parent.activeObj.opacity * 100;\n                }\n                args.value['obj']['adjustmentLevel'] = this.adjustmentLevel;\n                break;\n            case 'setAdjustmentLevel':\n                this.adjustmentLevel = args.value['adjustmentLevel'];\n                break;\n            case 'getTempAdjustmentLevel':\n                args.value['obj']['tempAdjustmentLevel'] = this.tempAdjustmentLevel;\n                break;\n            case 'setTempAdjustmentLevel':\n                this.tempAdjustmentLevel = args.value['tempAdjustmentLevel'];\n                break;\n            case 'setAdjustmentValue':\n                this.adjustmentValue = args.value['adjustmentValue'];\n                break;\n            case 'getBrightnessAdjusted':\n                args.value['obj']['isBrightnessAdjusted'] = this.isBrightnessAdjusted;\n                break;\n            case 'setBrightnessAdjusted':\n                this.isBrightnessAdjusted = args.value['isBrightnessAdjusted'];\n                if (this.parent.currentFilter.split('_') && this.parent.currentFilter.split('_')[1] === 'cold') {\n                    this.isBrightnessAdjusted = false;\n                }\n                break;\n            case 'getBevelFilter':\n                args.value['obj']['bevelFilter'] = this.bevelFilter;\n                break;\n            case 'setBevelFilter':\n                this.bevelFilter = args.value['bevelFilter'];\n                break;\n            case 'setTempAdjVal':\n                this.tempAdjVal = extend({}, this.adjustmentLevel, {}, true);\n                break;\n            case 'setTempFilVal':\n                this.tempFilVal = this.parent.currentFilter;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'apply-filter':\n                this.applyFilter(args.value['context']);\n                break;\n        }\n    };\n    Filter.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.reset = function () {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n        this.adjustmentValue = this.parent.getDefaultFilter();\n        this.isBrightnessAdjusted = false;\n        this.bevelFilter = 'none';\n        this.tempFilVal = '';\n        this.tempAdjVal = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, transparency: 100, sharpen: false, bw: false };\n    };\n    Filter.prototype.updateFinetunes = function () {\n        var _this = this;\n        var parent = this.parent;\n        var fs = parent.finetuneSettings;\n        if (fs) {\n            var propertiesToSet = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n            propertiesToSet.forEach(function (property) {\n                if (fs[property]) {\n                    _this.adjustmentLevel[property] = fs[property].defaultValue;\n                    _this.tempAdjustmentLevel[property] = fs[property].defaultValue;\n                }\n            });\n            parent.notify('draw', { prop: 'isInitialLoading', onPropertyChange: false, value: { isInitialLoading: true } });\n        }\n    };\n    Filter.prototype.initFilter = function () {\n        this.setFilterAdj('brightness', this.adjustmentLevel.brightness);\n        this.setFilterAdj('contrast', this.adjustmentLevel.contrast);\n        this.setFilterAdj('hue', this.adjustmentLevel.hue);\n        this.setFilterAdj('saturation', this.adjustmentLevel.saturation);\n        this.setFilterAdj('exposure', this.adjustmentLevel.exposure);\n        this.setFilterAdj('opacity', this.adjustmentLevel.opacity);\n        this.setFilterAdj('blur', this.adjustmentLevel.blur);\n    };\n    Filter.prototype.updateAdj = function (type, value, isPreview, ctx) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var splitWords = this.lowerContext.filter.split(' ');\n        var values = [];\n        var brightness = this.getFilterValue(this.adjustmentLevel.brightness);\n        var excludedTypes = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n        if (excludedTypes.indexOf(type) === -1) {\n            if (isNullOrUndefined(isPreview) && (this.adjustmentLevel.sharpen || this.adjustmentLevel.bw)) {\n                parent.isUndoRedo = true;\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                this.lowerContext.filter = temp;\n                parent.isUndoRedo = false;\n            }\n        }\n        var saturate;\n        var bright;\n        var saturatePercent;\n        var contrast;\n        var saturatePercentage;\n        switch (type) {\n            case 'brightness':\n                value = this.getFilterValue(this.adjustmentLevel.exposure) + (value * 0.005);\n                splitWords[0] = 'brightness(' + value + ')';\n                if (this.adjustmentLevel.brightness !== 0) {\n                    value = (this.adjustmentLevel.opacity / 100) - (this.adjustmentLevel.opacity * 0.3) / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                else {\n                    value = this.adjustmentLevel.opacity / 100;\n                    splitWords[4] = 'opacity(' + value + ')';\n                }\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'contrast':\n                splitWords[1] = 'contrast(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'hue':\n                splitWords[2] = 'hue-rotate(' + value + 'deg)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'saturation':\n                splitWords[3] = 'saturate(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'opacity':\n                if (parseFloat(splitWords[0].split('(')[1]) !== 1) {\n                    value -= 0.2;\n                }\n                if (value < 0) {\n                    value = 0;\n                }\n                splitWords[4] = 'opacity(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'blur':\n                splitWords[5] = 'blur(' + value + 'px)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'exposure':\n                if (value > 1) {\n                    value -= 1;\n                    value += brightness;\n                }\n                else if (value < 1) {\n                    value = 1 - value;\n                    value = brightness - value;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'chrome':\n                saturate = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturate *= 100;\n                value = saturate + (saturate * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'cold':\n                // Adjusting Brightness\n                bright = this.getFilterValue(this.adjustmentLevel.brightness);\n                bright *= 100;\n                value = bright * 0.9;\n                value *= 0.01;\n                splitWords[0] = 'brightness(' + value + ')';\n                // Adjusting Contrast\n                contrast = this.getFilterValue(this.adjustmentLevel.contrast);\n                contrast *= 100;\n                value = contrast + (contrast * 0.5);\n                splitWords[1] = 'contrast(' + value + '%)';\n                // Adjusting Saturation\n                saturatePercentage = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercentage *= 100;\n                value = saturatePercentage;\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'warm':\n                saturatePercent = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercent *= 100;\n                value = saturatePercent + (saturatePercent * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                splitWords[6] = 'sepia(25%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'grayscale':\n                splitWords[7] = 'grayscale(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'sepia':\n                splitWords[6] = 'sepia(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'invert':\n                splitWords[8] = 'invert(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                break;\n        }\n        if (type !== 'sharpen' && type !== 'blackandwhite') {\n            if (isNullOrUndefined(isPreview)) {\n                if (type === 'default') {\n                    splitWords = this.getDefaultCurrentFilter(splitWords);\n                }\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n            var tempFilter = void 0;\n            if (parent.frameObj.type === 'bevel') {\n                tempFilter = this.lowerContext.filter;\n                this.bevelFilter = tempFilter;\n            }\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n            }\n            parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n            if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n                parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            if (isNullOrUndefined(isPreview)) {\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            parent.initialAdjustmentValue = splitWords.join(' ');\n            tempFilter = this.lowerContext.filter;\n            this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n            this.bevelFilter = tempFilter;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n            this.lowerContext.filter = tempFilter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            this.isBrightnessAdjusted = brightness !== 1;\n        }\n        var filter = splitWords.join(' ');\n        if (ctx) {\n            ctx.filter = filter;\n        }\n    };\n    Filter.prototype.setTempFilterValue = function (brightness, isPreview, splitWords, type) {\n        if (isPreview) {\n            if (type === 'default') {\n                splitWords = this.getDefaultCurrentFilter(splitWords);\n            }\n            else if (brightness !== 1) {\n                var tempSplitWords = this.lowerContext.filter.split(' ');\n                tempSplitWords[4] = splitWords[4];\n                this.lowerContext.filter = tempSplitWords.join(' ');\n            }\n        }\n        return splitWords;\n    };\n    Filter.prototype.getDefaultCurrentFilter = function (splitWords) {\n        var values = this.adjustmentValue.split(' ');\n        splitWords = [values[0], values[1], values[2], values[3], values[4], values[5], 'sepia(0%)', 'grayscale(0%)', 'invert(0%)'];\n        return splitWords;\n    };\n    Filter.prototype.getFilterValue = function (value) {\n        return (value === 0) ? 1 : 1 + ((value * 0.5) / 100);\n    };\n    Filter.prototype.getSaturationFilterValue = function (value) {\n        return value === 0 ? 1 : 1 + (value / 100);\n    };\n    Filter.prototype.setFilterAdj = function (type, value) {\n        var parent = this.parent;\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        this.adjustmentLevel[\"\" + type] = value;\n        switch (type) {\n            case 'contrast':\n            case 'exposure':\n                value = this.getFilterValue(value);\n                if (type === 'contrast') {\n                    value *= 100;\n                }\n                break;\n            case 'hue':\n                value *= 3;\n                break;\n            case 'saturation':\n                value = this.getSaturationFilterValue(value) * 100;\n                break;\n            case 'opacity':\n                if (value < 10) {\n                    value += 1;\n                }\n                value /= 100;\n                break;\n            case 'blur':\n                if (value !== 0) {\n                    value /= 20;\n                    // Since 0.5 is not working in blur we consider from 1\n                    value += 0.5;\n                }\n                break;\n        }\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, value);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: type, previousObj: prevObj,\n                previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n            } });\n    };\n    Filter.prototype.setFilter = function (type) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        var obj = { currentFilter: this.parent.currentFilter };\n        var prevFilter = obj['currentFilter'];\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, null);\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: type, previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: prevFilter, isCircleCrop: null } });\n    };\n    Filter.prototype.setAdjustment = function (type) {\n        var splitWords = this.lowerContext.filter.split(' ');\n        var value;\n        var valueArr;\n        switch (type) {\n            case 'brightness':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.brightness = this.setFilterValue(value);\n                break;\n            case 'contrast':\n                valueArr = splitWords[1].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.contrast = this.setFilterValue(value);\n                break;\n            case 'hue':\n                valueArr = splitWords[2].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 3;\n                this.adjustmentLevel.hue = value;\n                break;\n            case 'saturation':\n                valueArr = splitWords[3].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.saturation = this.setSaturationFilterValue(value);\n                break;\n            case 'opacity':\n                valueArr = splitWords[4].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                if (value === 0.45) {\n                    value = 40;\n                }\n                else if (value === 0.40) {\n                    value = 30;\n                }\n                else if (value === 0.35) {\n                    value = 20;\n                }\n                else if (value === 0.30) {\n                    value = 10;\n                }\n                else if (value === 0.25) {\n                    value = 0;\n                }\n                else {\n                    value *= 100;\n                }\n                this.adjustmentLevel.opacity = value;\n                break;\n            case 'blur':\n                valueArr = splitWords[5].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value *= 20;\n                this.adjustmentLevel.blur = value;\n                break;\n            case 'exposure':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.exposure = this.setFilterValue(value);\n                break;\n        }\n    };\n    Filter.prototype.setFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : ((value - 1) * 100) / 0.5);\n    };\n    Filter.prototype.setSaturationFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : (value - 1) * 100);\n    };\n    Filter.prototype.finetuneImage = function (finetuneOption, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            switch (finetuneOption.toLowerCase()) {\n                case 'brightness':\n                    this.setFilterAdj('brightness', value);\n                    break;\n                case 'contrast':\n                    this.setFilterAdj('contrast', value);\n                    break;\n                case 'hue':\n                    this.setFilterAdj('hue', value);\n                    break;\n                case 'saturation':\n                    this.setFilterAdj('saturation', value);\n                    break;\n                case 'opacity':\n                    this.setFilterAdj('opacity', value);\n                    break;\n                case 'blur':\n                    this.setFilterAdj('blur', value);\n                    break;\n                case 'exposure':\n                    this.setFilterAdj('exposure', value);\n                    break;\n            }\n            this.parent.canvasFilter = this.lowerContext.filter;\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Filter.prototype.setCurrAdjValue = function (type, value) {\n        var parent = this.parent;\n        this.parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        switch (type) {\n            case 'brightness':\n                this.setFilterAdj('brightness', value);\n                break;\n            case 'contrast':\n                this.setFilterAdj('contrast', value);\n                break;\n            case 'hue':\n                this.setFilterAdj('hue', value);\n                break;\n            case 'saturation':\n                this.setFilterAdj('saturation', value);\n                break;\n            case 'opacity':\n                this.setFilterAdj('opacity', value);\n                break;\n            case 'blur':\n                this.setFilterAdj('blur', value);\n                break;\n            case 'exposure':\n                this.setFilterAdj('exposure', value);\n                break;\n        }\n        parent.isFinetuneBtnClick = true;\n        parent.curFinetuneObjEvent = { finetune: parent.toPascalCase(type), value: value };\n    };\n    Filter.prototype.getCurrentObj = function (dummyObj) {\n        var parent = this.parent;\n        var tempFlipPanPointObj = { point: null };\n        parent.notify('crop', { prop: 'getTempFlipPanPoint', value: { obj: tempFlipPanPointObj } });\n        var zoomObj = { previousZoomValue: null };\n        parent.notify('transform', { prop: 'getPreviousZoomValue', value: { obj: zoomObj } });\n        var straightenObj = { zoomFactor: null };\n        parent.notify('draw', { prop: 'getStraightenInitZoom', value: { obj: straightenObj } });\n        var bgObj = { color: null };\n        parent.notify('draw', { prop: 'getImageBackgroundColor', value: { obj: bgObj } });\n        var obj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n            rotateFlipColl: [], degree: 0, currFlipState: '', zoomFactor: 0, previousZoomValue: 0, straighten: 0,\n            destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: this.isBrightnessAdjusted,\n            aspectWidth: null, aspectHeight: null, straightenZoom: 0, adjustmentLevel: extend({}, this.tempAdjVal, {}, true),\n            currentFilter: this.tempFilVal, imageSource: '', bgColor: '' };\n        obj.cropZoom = parent.transform.cropZoomFactor;\n        obj.defaultZoom = parent.transform.defaultZoomFactor;\n        obj.zoomFactor = parent.zoomSettings.zoomFactor;\n        obj.previousZoomValue = zoomObj['previousZoomValue'];\n        obj.straightenZoom = straightenObj['zoomFactor'];\n        obj.totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, {}, true);\n        obj.totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n        obj.totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n        obj.tempFlipPanPoint = extend({}, tempFlipPanPointObj['point'], {}, true);\n        obj.activeObj = extend({}, parent.activeObj, {}, true);\n        obj.rotateFlipColl = extend([], parent.rotateFlipColl, [], true);\n        obj.degree = parent.transform.degree;\n        obj.straighten = parent.cropObj.straighten;\n        obj.currFlipState = parent.transform.currFlipState;\n        obj.destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, endX: 0, endY: 0,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        obj.srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, endX: 0, endY: 0,\n            width: parent.img.srcWidth, height: parent.img.srcHeight };\n        obj.filter = this.lowerContext.filter;\n        obj.aspectWidth = parent.aspectWidth;\n        obj.aspectHeight = parent.aspectHeight;\n        obj.frame = parent.frameObj.type;\n        obj.frameObj = extend({}, parent.frameObj);\n        obj.imageSource = parent.baseImg.src;\n        obj.bgColor = bgObj['color'];\n        if (dummyObj) {\n            dummyObj['currObj'] = obj;\n        }\n        return obj;\n    };\n    /* Filter safari related codes */\n    Filter.prototype.getValFromPercentage = function (percentage) {\n        var val = parseFloat(percentage);\n        // check for percentages and divide by a hundred\n        if (/%\\s*?$/i.test(percentage)) {\n            val /= 100;\n        }\n        return val;\n    };\n    Filter.prototype.getValFromLength = function (length) {\n        return parseFloat(length);\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.parseFilterString = function (filterString) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filterArray = [];\n        if (filterString && filterString !== 'none') {\n            filterArray = filterString.split(' ').map(function (filter) {\n                var _a = filter.match(/([a-z-]+)\\(([^)]+)\\)/).slice(1, 3), name = _a[0], value = _a[1];\n                return { filter: name, value: value };\n            });\n        }\n        return filterArray;\n    };\n    Filter.prototype.applyFilter = function (context) {\n        var _a = context.canvas, height = _a.height, width = _a.width;\n        var imageData = context.getImageData(0, 0, width, height);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filterArray = this.parseFilterString(context.filter);\n        for (var i = 0, len = filterArray.length; i < len; i++) {\n            switch (filterArray[i].filter) {\n                case 'blur':\n                    imageData = this.blur(context, imageData, filterArray[i].value);\n                    break;\n                case 'brightness':\n                    imageData = this.brightness(imageData, filterArray[i].value);\n                    break;\n                case 'contrast':\n                    imageData = this.contrast(imageData, filterArray[i].value);\n                    break;\n                case 'grayscale':\n                    imageData = this.grayscale(imageData, filterArray[i].value);\n                    break;\n                case 'hue-rotate':\n                    imageData = this.hueRotate(imageData, filterArray[i].value);\n                    break;\n                case 'invert':\n                    imageData = this.invert(imageData, filterArray[i].value);\n                    break;\n                case 'opacity':\n                    imageData = this.opacity(imageData, filterArray[i].value);\n                    break;\n                case 'saturate':\n                    imageData = this.saturate(context, imageData, filterArray[i].value);\n                    break;\n                case 'sepia':\n                    imageData = this.sepia(imageData, filterArray[i].value);\n                    break;\n            }\n        }\n        context.putImageData(imageData, 0, 0);\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.blur = function (context, imageData, radius) {\n        if (radius === void 0) { radius = '0'; }\n        var blurRadius = this.getValFromLength(radius);\n        blurRadius = Math.floor(blurRadius);\n        if (blurRadius <= 0) {\n            return imageData;\n        }\n        var _a = context.canvas, height = _a.height, width = _a.width;\n        var data = imageData.data;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var blurredData = new Uint8ClampedArray(data.length);\n        for (var y = 0; y < height; y++) {\n            for (var x = 0; x < width; x++) {\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n                var count = 0;\n                for (var dy = -blurRadius; dy <= blurRadius; dy++) {\n                    for (var dx = -blurRadius; dx <= blurRadius; dx++) {\n                        var nx = x + dx;\n                        var ny = y + dy;\n                        if (nx >= 0 && nx < width && ny >= 0 && ny < height) {\n                            var offset = (ny * width + nx) * 4;\n                            r += data[offset];\n                            g += data[offset + 1];\n                            b += data[offset + 2];\n                            a += data[offset + 3];\n                            count++;\n                        }\n                    }\n                }\n                var i = (y * width + x) * 4;\n                blurredData[i] = r / count;\n                blurredData[i + 1] = g / count;\n                blurredData[i + 2] = b / count;\n                blurredData[i + 3] = a / count;\n            }\n        }\n        for (var i = 0; i < data.length; i++) {\n            data[i] = blurredData[i];\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.brightness = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '1'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var data = imageData.data;\n            var length_1 = data.length;\n            for (var i = 0; i < length_1; i += 4) {\n                data[i + 0] *= factor;\n                data[i + 1] *= factor;\n                data[i + 2] *= factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.contrast = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '1'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var data = imageData.data;\n            var length_2 = data.length;\n            for (var i = 0; i < length_2; i += 4) {\n                data[i + 0] = ((data[i + 0] / 255 - 0.5) * factor + 0.5) * 255;\n                data[i + 1] = ((data[i + 1] / 255 - 0.5) * factor + 0.5) * 255;\n                data[i + 2] = ((data[i + 2] / 255 - 0.5) * factor + 0.5) * 255;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.grayscale = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_3 = data.length;\n            for (var i = 0; i < length_3; i += 4) {\n                var r = data[i];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                // Calculate the grayscale value using the luminosity method\n                var gray = 0.299 * r + 0.587 * g + 0.114 * b;\n                // Blend the original color with the grayscale value based on the percentage\n                data[i] = r * (1 - factor) + gray * factor;\n                data[i + 1] = g * (1 - factor) + gray * factor;\n                data[i + 2] = b * (1 - factor) + gray * factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.hueRotate = function (imageData, rotation) {\n        if (rotation === void 0) { rotation = '0deg'; }\n        var data = imageData.data;\n        var angle = parseFloat(rotation) * (Math.PI / 180);\n        if (angle > 0) {\n            var cosA = Math.cos(angle);\n            var sinA = Math.sin(angle);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var matrix = [\n                0.213 + cosA * 0.787 - sinA * 0.213, 0.715 - cosA * 0.715 - sinA * 0.715, 0.072 - cosA * 0.072 + sinA * 0.928,\n                0.213 - cosA * 0.213 + sinA * 0.143, 0.715 + cosA * 0.285 + sinA * 0.140, 0.072 - cosA * 0.072 - sinA * 0.283,\n                0.213 - cosA * 0.213 - sinA * 0.787, 0.715 - cosA * 0.715 + sinA * 0.715, 0.072 + cosA * 0.928 + sinA * 0.072\n            ];\n            for (var i = 0; i < data.length; i += 4) {\n                var r = data[i];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                // Apply the hue rotation matrix\n                data[i] = matrix[0] * r + matrix[1] * g + matrix[2] * b;\n                data[i + 1] = matrix[3] * r + matrix[4] * g + matrix[5] * b;\n                data[i + 2] = matrix[6] * r + matrix[7] * g + matrix[8] * b;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.invert = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_4 = data.length;\n            for (var i = 0; i < length_4; i += 4) {\n                data[i + 0] = Math.abs(data[i + 0] - 255 * factor);\n                data[i + 1] = Math.abs(data[i + 1] - 255 * factor);\n                data[i + 2] = Math.abs(data[i + 2] - 255 * factor);\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.opacity = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor >= 0) {\n            var data = imageData.data;\n            var length_5 = data.length;\n            for (var i = 3; i < length_5; i += 4) {\n                data[i] *= factor;\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.saturate = function (context, imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor !== 1) {\n            var _a = context.canvas, width = _a.width, height = _a.height;\n            var data = imageData.data;\n            var lumR = (1 - factor) * 0.3086;\n            var lumG = (1 - factor) * 0.6094;\n            var lumB = (1 - factor) * 0.082;\n            // tslint:disable-next-line no-bitwise\n            var shiftW = width << 2;\n            for (var j = 0; j < height; j++) {\n                var offset = j * shiftW;\n                for (var i = 0; i < width; i++) {\n                    // tslint:disable-next-line no-bitwise\n                    var pos = offset + (i << 2);\n                    var r = data[pos + 0];\n                    var g = data[pos + 1];\n                    var b = data[pos + 2];\n                    data[pos + 0] = (lumR + factor) * r + lumG * g + lumB * b;\n                    data[pos + 1] = lumR * r + (lumG + factor) * g + lumB * b;\n                    data[pos + 2] = lumR * r + lumG * g + (lumB + factor) * b;\n                }\n            }\n        }\n        return imageData;\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    Filter.prototype.sepia = function (imageData, percentage) {\n        if (percentage === void 0) { percentage = '0'; }\n        var factor = this.getValFromPercentage(percentage);\n        if (factor > 1) {\n            factor = 1;\n        }\n        if (factor > 0) {\n            var data = imageData.data;\n            var length_6 = data.length;\n            for (var i = 0; i < length_6; i += 4) {\n                var r = data[i + 0];\n                var g = data[i + 1];\n                var b = data[i + 2];\n                data[i + 0] =\n                    (0.393 * r + 0.769 * g + 0.189 * b) * factor + r * (1 - factor);\n                data[i + 1] =\n                    (0.349 * r + 0.686 * g + 0.168 * b) * factor + g * (1 - factor);\n                data[i + 2] =\n                    (0.272 * r + 0.534 * g + 0.131 * b) * factor + b * (1 - factor);\n            }\n        }\n        return imageData;\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar FreehandDrawing = /** @class */ (function () {\n    function FreehandDrawing(parent) {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = false;\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.isFreehandPointMoved = false;\n        this.pointCounter = 0;\n        // eslint-disable-next-line\n        this.selPointColl = {};\n        this.currFHDIdx = 0; // Specifies id for every freehand drawing - uses while deleting\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.straightenPointAngle = 0;\n        this.isMasking = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FreehandDrawing.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    FreehandDrawing.prototype.addEventListener = function () {\n        this.parent.on('freehand-draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    FreehandDrawing.prototype.removeEventListener = function () {\n        this.parent.off('freehand-draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    FreehandDrawing.prototype.draw = function (args) {\n        this.updateFhdPvtVar();\n        switch (args.prop) {\n            case 'hoverFhd': {\n                this.hoverFhd(args.value['strokeColor'], args.value['strokeWidth']);\n                break;\n            }\n            case 'freehandDownHandler':\n                this.freehandDownHandler(args.value['e'], args.value['canvas']);\n                break;\n            case 'freehandUpHandler':\n                this.freehandUpHandler(args.value['e'], args.value['canvas'], args.value['context']);\n                break;\n            case 'handle-freehand-draw': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                if (this.isFHDIdx(id)) {\n                    this.deleteFhd(id, true);\n                }\n                break;\n            }\n            case 'freehandRedraw':\n                this.freehandRedraw(args.value['context'], args.value['points']);\n                break;\n            case 'deleteFhd': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                this.deleteFhd(id, true);\n                break;\n            }\n            case 'selectFhd': {\n                var id = null;\n                if (args.value['id']) {\n                    id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                }\n                this.selectFhd(id);\n                break;\n            }\n            case 'applyFhd':\n                this.applyFhd();\n                break;\n            case 'cancelFhd':\n                this.cancelFhd();\n                break;\n            case 'updateFHDCurPts':\n                this.updateFHDCurPts();\n                break;\n            case 'rotateFhdColl':\n                this.rotateFhdColl();\n                break;\n            case 'flipFHDColl':\n                this.flipFHDColl(args.value['value']);\n                break;\n            case 'panFHDColl':\n                this.panFHDColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFHDColl':\n                if (args.value && args.value['isPreventApply']) {\n                    this.updateFHDColl(args.value['isPreventApply']);\n                }\n                else {\n                    this.updateFHDColl();\n                }\n                break;\n            case 'zoomFHDColl':\n                this.zoomFHDColl(args.value['isPreventApply']);\n                break;\n            case 'apply-pen-draw':\n                this.applyPenDraw();\n                break;\n            case 'freeHandDraw':\n                this.freeHandDraw(args.value['value']);\n                break;\n            case 'isFHDIdx':\n                this.isFHDIdx(args.value['index'], args.value['obj']);\n                break;\n            case 'getSqPtFD':\n                this.getSqPtFD(args.value['idx'], args.value['obj']);\n                break;\n            case 'getSelPointColl':\n                args.value['obj']['selPointColl'] = extend([], this.selPointColl);\n                break;\n            case 'setSelPointColl':\n                this.selPointColl = extend([], args.value['obj']['selPointColl']);\n                break;\n            case 'pushSelPointColl':\n                this.selPointColl.push(extend([], args.value['obj']['selPointColl']));\n                break;\n            case 'setFreehandDrawHoveredIndex':\n                this.fhdHovIdx = args.value['index'];\n                break;\n            case 'getFreehandDrawHoveredIndex':\n                args.value['obj']['index'] = this.fhdHovIdx;\n                break;\n            case 'setPointCounter':\n                this.pointCounter = args.value['value'];\n                break;\n            case 'getPenStrokeWidth':\n                args.value['obj']['penStrokeWidth'] = this.penStrokeWidth;\n                break;\n            case 'setPenStrokeWidth':\n                this.penStrokeWidth = args.value['value'];\n                break;\n            case 'getCurrentFreehandDrawIndex':\n                args.value['obj']['currentFreehandDrawIndex'] = this.currFHDIdx;\n                break;\n            case 'setCurrentFreehandDrawIndex':\n                this.currFHDIdx = args.value['value'];\n                break;\n            case 'updateCropPtsForSel':\n                this.updateCropPtsForSel();\n                break;\n            case 'getFreehandDrawSelectedId':\n                args.value['obj']['freehandDrawSelectedId'] = this.fhdSelID;\n                break;\n            case 'resetFreehandDrawSelectedId':\n                this.fhdSelID = null;\n                break;\n            case 'getTempFreeHandDrawEditingStyles':\n                args.value['obj']['tempFreeHandDrawEditingStyles'] = this.tempFHDStyles;\n                break;\n            case 'setFreehandSelectedIndex':\n                this.fhdSelIdx = args.value['index'];\n                break;\n            case 'getFreehandSelectedIndex':\n                args.value['obj']['freehandSelectedIndex'] = this.fhdSelIdx;\n                break;\n            case 'setCenterSelPoints':\n                this.setCenterSelPoints();\n                break;\n            case 'getStraightenPoint':\n                args.value['obj']['straightenPoint'] = extend({}, this.straightenPoint, {}, true);\n                break;\n            case 'setStraightenPoint':\n                this.straightenPoint.x = args.value['x'];\n                this.straightenPoint.y = args.value['y'];\n                if (args.value['ratioX'] && args.value['ratioY']) {\n                    this.straightenPoint.ratioX = args.value['ratioX'];\n                    this.straightenPoint.ratioY = args.value['ratioY'];\n                }\n                break;\n            case 'resetStraightenPoint':\n                this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n                this.prevStraightenObj = null;\n                this.straightenPointAngle = 0;\n                break;\n            case 'getStraightenPointAngle':\n                args.value['obj']['angle'] = this.straightenPointAngle;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'triggerShapeChanging':\n                this.triggerShapeChanging(args.value['shapeChangingArgs']);\n                break;\n            case 'setMasking':\n                this.isMasking = args.value['value'];\n                break;\n            case 'resetSelPoints':\n                this.selPoints = [];\n                break;\n        }\n    };\n    FreehandDrawing.prototype.updateFhdPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    FreehandDrawing.prototype.reset = function () {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = this.isFreehandPointMoved = false;\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.selPointColl = {};\n        this.straightenPointAngle = 0;\n        this.fhdHovIdx = null;\n        this.pointCounter = 0;\n        this.fhdSelID = null;\n        this.isMasking = false;\n        this.penStrokeWidth = undefined;\n        this.currFHDIdx = 0;\n        this.fhdSelIdx = null;\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.straightenPoint = { x: null, y: null, ratioX: null, ratioY: null };\n        this.prevStraightenObj = null;\n    };\n    FreehandDrawing.prototype.getModuleName = function () {\n        return 'freehand-draw';\n    };\n    FreehandDrawing.prototype.hoverFhd = function (fillStyle, strokeWidth) {\n        var parent = this.parent;\n        var context = this.upperContext;\n        var idx = -1;\n        if (this.fhdHovIdx > -1) {\n            idx = this.fhdHovIdx;\n        }\n        else {\n            idx = this.fhdSelIdx;\n        }\n        parent.points = extend([], parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = parent.points.length;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        var minStrokeWidth = 0;\n        var maxStrokeWidth = 0;\n        context.fillStyle = fillStyle ? fillStyle : parent.pointColl[idx].strokeColor;\n        context.strokeStyle = context.fillStyle;\n        minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = strokeWidth ?\n            strokeWidth : parent.pointColl[idx].strokeWidth;\n        if (len === 1) {\n            controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n            this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n        }\n        for (var l = 0; l < len - 3; l++) {\n            if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                if (l === 0) {\n                    startPoint = parent.points[l];\n                }\n                else {\n                    startPoint = parent.points[l + 1];\n                }\n                endPoint = parent.points[l + 2];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n        context.closePath();\n        // Outer selection\n        var point = this.getSqPtFD(idx);\n        var tempLineWidth = context.lineWidth;\n        context.lineWidth = 2;\n        context.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        context.beginPath();\n        context.rect(point.startX, point.startY, point.width, point.height);\n        context.stroke();\n        context.closePath();\n        context.lineWidth = tempLineWidth;\n    };\n    FreehandDrawing.prototype.freehandDownHandler = function (e, canvas) {\n        var parent = this.parent;\n        parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        this.lowerContext = parent.lowerCanvas.getContext('2d');\n        parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        this.upperContext = parent.upperCanvas.getContext('2d');\n        this.fhdObj.time = new Date().getTime();\n        this.isFreehandDrawing = true;\n        if (e.type === 'mousedown') {\n            this.freehandDownPoint = { x: e.clientX, y: e.clientY };\n        }\n        else {\n            this.freehandDownPoint = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n        }\n        this.isFreehandPointMoved = false;\n        EventHandler.add(canvas, 'mousemove touchmove', this.freehandMoveHandler, this);\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth,\n            points: null, index: parent.objColl.length + parent.freehandCounter + 1 };\n        var shapeChangingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n    };\n    FreehandDrawing.prototype.freehandUpHandler = function (e, canvas, context) {\n        var rect = canvas.getBoundingClientRect();\n        var parent = this.parent;\n        EventHandler.remove(canvas, 'mousemove touchmove', this.freehandMoveHandler);\n        if (parent.points.length === 0) {\n            if (e.type === 'mouseup') {\n                this.processPoint(e.clientX - rect.left, e.clientY - rect.top, true, context);\n            }\n            else if (e.type === 'touchend' && e.changedTouches) {\n                this.processPoint(e.changedTouches[0].clientX - rect.left, e.changedTouches[0].clientY - rect.top, true, context);\n            }\n            else {\n                if (!this.isFreehandPointMoved) {\n                    this.processPoint(this.freehandDownPoint.x - rect.left, this.freehandDownPoint.y - rect.top, true, context);\n                }\n            }\n        }\n        context.closePath();\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var fhCnt = parent.freehandCounter;\n        var order = parent.objColl.length + parent.freehandCounter + 1;\n        parent.pointColl[fhCnt] = { points: extend([], parent.points), strokeColor: parent.activeObj.strokeSettings.strokeColor,\n            strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState,\n            id: 'pen_' + (this.currFHDIdx + 1), order: order };\n        parent.points = [];\n        this.dummyPoints = [];\n        this.selPointColl[fhCnt] = { points: extend([], this.selPoints) };\n        this.selPoints = [];\n        this.pointCounter = 0;\n        parent.freehandCounter++;\n        this.isFreehandDrawing = false;\n        if (!parent.isMaskImage) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehand-draw', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        var shapeSettings = { id: 'pen_' + (this.currFHDIdx + 1), type: ShapeType.FreehandDraw,\n            startX: this.freehandDownPoint.x, startY: this.freehandDownPoint.y,\n            strokeColor: parent.activeObj.strokeSettings.strokeColor, strokeWidth: this.penStrokeWidth,\n            points: parent.pointColl[this.currFHDIdx].points, index: order };\n        var shapeChangingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        this.triggerShapeChanging(shapeChangingArgs);\n        this.currFHDIdx++;\n    };\n    FreehandDrawing.prototype.freehandMoveHandler = function (e) {\n        this.isFreehandPointMoved = true;\n        var rect = this.parent.upperCanvas.getBoundingClientRect();\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX - rect.left;\n            y = e.clientY - rect.top;\n        }\n        else {\n            x = e.touches[0].clientX - rect.left;\n            y = e.touches[0].clientY - rect.top;\n        }\n        if (this.isFreehandDrawing) {\n            this.upperContext.fillStyle = this.parent.activeObj.strokeSettings.strokeColor;\n            if (this.parent.isMaskImage) {\n                this.upperContext.globalCompositeOperation = 'xor';\n            }\n            this.processPoint(x, y, false, this.upperContext);\n        }\n    };\n    FreehandDrawing.prototype.processPoint = function (x, y, mouseDown, context) {\n        var parent = this.parent;\n        var lastPoint = this.point(x, y, new Date().getTime());\n        lastPoint = parent.points.length > 0 && parent.points[parent.points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= 5 : false;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        this.selPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n            ratioY: (y - parent.img.destTop) / parent.img.destHeight, time: this.fhdObj.time });\n        if (!lastPoint || !(lastPoint && isLastPointTooClose) || mouseDown) {\n            this.fhdObj.time = new Date().getTime();\n            parent.points.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            this.dummyPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            if (this.dummyPoints.length > 2) {\n                if (this.dummyPoints.length === 3) {\n                    this.dummyPoints.unshift(this.dummyPoints[0]);\n                }\n                var p0 = this.dummyPoints[0];\n                var p1 = this.dummyPoints[1];\n                var p2 = this.dummyPoints[2];\n                var p3 = this.dummyPoints[3];\n                controlPoint1 = this.calcCurveCP(p0, p1, p2).controlPoint2;\n                controlPoint2 = this.calcCurveCP(p1, p2, p3).controlPoint1;\n                startPoint = this.dummyPoints[1];\n                endPoint = this.dummyPoints[2];\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                this.pointCounter++;\n                this.dummyPoints.shift();\n            }\n            if (mouseDown) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = { x: x, y: y, time: new Date().getTime() };\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n    };\n    FreehandDrawing.prototype.calcCurveCP = function (p1, p2, p3) {\n        if (!p2) {\n            p2 = p1;\n        }\n        if (!p3) {\n            p3 = p2;\n        }\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    FreehandDrawing.prototype.point = function (x, y, time) {\n        this.fhdObj.pointX = x;\n        this.fhdObj.pointY = y;\n        return { x: this.fhdObj.pointX, y: this.fhdObj.pointY, time: time };\n    };\n    FreehandDrawing.prototype.startDraw = function (context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth) {\n        var tempVelocity;\n        tempVelocity = this.pointVelocity(startPoint);\n        tempVelocity = 0.7 * tempVelocity + (1 - 0.7) * this.fhdObj.lastVelocity;\n        var newWidth = Math.max(maxStrokeWidth / (0.7 + 1), minStrokeWidth);\n        this.drawCurve(this.fhdObj.time, newWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth);\n        this.fhdObj.lastVelocity = tempVelocity;\n        this.fhdObj.time = newWidth;\n    };\n    FreehandDrawing.prototype.pointVelocity = function (startPoint) {\n        return (this.fhdObj.time !== startPoint.time) ? this.distanceTo(startPoint) /\n            (this.fhdObj.time - startPoint.time) : 0;\n    };\n    FreehandDrawing.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.fhdObj.pointX - start.x, 2) + Math.pow(this.fhdObj.pointY - start.y, 2));\n    };\n    FreehandDrawing.prototype.drawCurve = function (startWidth, endWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth) {\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLength(controlPoint1, controlPoint2, startPoint, endPoint);\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * startPoint.x;\n            x += 3 * u2 * t1 * controlPoint1.x;\n            x += 3 * u1 * t2 * controlPoint2.x;\n            x += t3 * endPoint.x;\n            y = u3 * startPoint.y;\n            y += 3 * u2 * t1 * controlPoint1.y;\n            y += 3 * u1 * t2 * controlPoint2.y;\n            y += t3 * endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, maxStrokeWidth);\n            this.drawArc(x, y, width, context);\n        }\n        context.closePath();\n        context.fill();\n    };\n    FreehandDrawing.prototype.bezierLength = function (controlPoint1, controlPoint2, startPoint, endPoint) {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointX1;\n        var pointY1;\n        var pointX2;\n        var pointY2;\n        var pointX3;\n        var pointY3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointX1 = this.bezierPoint(t, startPoint.x, controlPoint1.x, controlPoint2.x, endPoint.x);\n            pointY1 = this.bezierPoint(t, startPoint.y, controlPoint1.y, controlPoint2.y, endPoint.y);\n            if (i > 0) {\n                pointX3 = pointX1 - pointX2;\n                pointY3 = pointY1 - pointY2;\n                length += Math.sqrt(pointX3 * pointX3 + pointY3 * pointY3);\n            }\n            pointX2 = pointX1;\n            pointY2 = pointY1;\n        }\n        return length;\n    };\n    FreehandDrawing.prototype.bezierPoint = function (t, startPoint, cp1, cp2, endPoint) {\n        return startPoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endPoint * t * t * t;\n    };\n    FreehandDrawing.prototype.drawArc = function (x, y, size, context) {\n        var img = this.parent.img;\n        if ((x > img.destLeft && y > img.destTop && x < (img.destLeft + img.destWidth) &&\n            y < (img.destTop + img.destHeight) ||\n            (context !== this.lowerContext && context !== this.upperContext))) {\n            context.moveTo(x, y);\n            context.arc(x, y, size, 0, 2 * Math.PI, false);\n        }\n    };\n    FreehandDrawing.prototype.freehandRedraw = function (context, points) {\n        var parent = this.parent;\n        var temp = context.filter;\n        context.filter = 'none';\n        if (points) {\n            parent.pointColl[parent.freehandCounter] = { points: points, strokeColor: parent.activeObj.strokeSettings.strokeColor,\n                strokeWidth: this.penStrokeWidth, flipState: parent.transform.currFlipState,\n                id: 'pen_' + (parent.freehandCounter + 1), order: parent.objColl.length + parent.freehandCounter + 1 };\n            this.selPointColl[parent.freehandCounter] = extend({}, parent.pointColl[parent.freehandCounter], {}, true);\n            parent.freehandCounter++;\n        }\n        if (parent.freehandCounter > 0) {\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                var controlPoint1 = void 0;\n                var controlPoint2 = void 0;\n                var startPoint = void 0;\n                var endPoint = void 0;\n                var minStrokeWidth = void 0;\n                var maxStrokeWidth = void 0;\n                if (len > 0) {\n                    context.fillStyle = parent.pointColl[n].strokeColor;\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = parent.pointColl[n].strokeWidth;\n                }\n                if (len === 1) {\n                    controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n                    this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                }\n                for (var l = 0; l < len - 3; l++) {\n                    if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                        controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                        controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                        if (l === 0) {\n                            startPoint = parent.points[l];\n                        }\n                        else {\n                            startPoint = parent.points[l + 1];\n                        }\n                        endPoint = parent.points[l + 2];\n                        this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                    }\n                }\n                context.closePath();\n            }\n            if (context === this.lowerContext) {\n                parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        context.filter = temp;\n    };\n    FreehandDrawing.prototype.getSqPtFD = function (idx, obj) {\n        var activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var sPoints = extend([], this.selPointColl[idx].points, []);\n        this.parent.points = extend([], this.parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = sPoints.length;\n        for (var l = 0; l < len; l++) {\n            if (activePoint.startX === 0 && activePoint.startY === 0 && activePoint.endX === 0 && activePoint.endY === 0) {\n                activePoint.startX = sPoints[l].x;\n                activePoint.startY = sPoints[l].y;\n                activePoint.endX = sPoints[l].x;\n                activePoint.endY = sPoints[l].y;\n            }\n            else {\n                activePoint.startX = Math.min(activePoint.startX, sPoints[l].x);\n                activePoint.startY = Math.min(activePoint.startY, sPoints[l].y);\n                activePoint.endX = Math.max(activePoint.endX, sPoints[l].x);\n                activePoint.endY = Math.max(activePoint.endY, sPoints[l].y);\n            }\n        }\n        activePoint.startX -= this.penStrokeWidth;\n        activePoint.startY -= this.penStrokeWidth;\n        activePoint.endX += this.penStrokeWidth;\n        activePoint.endY += this.penStrokeWidth;\n        activePoint.width = activePoint.endX - activePoint.startX;\n        activePoint.height = activePoint.endY - activePoint.startY;\n        if (obj) {\n            obj['activePoint'] = activePoint;\n        }\n        return activePoint;\n    };\n    FreehandDrawing.prototype.applyPenDraw = function () {\n        var parent = this.parent;\n        if (parent.currObjType.shape === 'freehanddraw') {\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.shape = '';\n        }\n        parent.notify('shape', { prop: 'clearActObj' });\n    };\n    FreehandDrawing.prototype.applyFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        if (selectedPoint.strokeColor === '#42a5f5') {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n        }\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        if (selectedPoint) {\n            selectedPoint.isSelected = false;\n        }\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        this.fhdHovIdx = this.fhdSelIdx = null;\n    };\n    FreehandDrawing.prototype.cancelFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.pointCounter = 0;\n        if (selectedPoint) {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n            selectedPoint.strokeWidth = this.tempFHDStyles.strokeWidth;\n            selectedPoint.isSelected = false;\n        }\n        this.fhdHovIdx = this.fhdSelIdx = this.fhdSelID = null;\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor;\n        parent.activeObj.strokeSettings.strokeWidth = this.penStrokeWidth = this.tempFHDStyles.strokeWidth;\n        this.tempFHDStyles = { strokeColor: null, strokeWidth: null, fillColor: null };\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n    };\n    FreehandDrawing.prototype.selectFhd = function (index) {\n        var parent = this.parent;\n        var tempFHDStyles = extend({}, this.tempFHDStyles, {}, true);\n        parent.notify('selection', { prop: 'setFreehandDrawEditing', onPropertyChange: false, value: { bool: true } });\n        if (index || index === 0) {\n            if (this.isFHDIdx(index)) {\n                this.fhdSelIdx = this.fhdHovIdx = index;\n                this.hoverFhd();\n                parent.upperCanvas.style.cursor = parent.cursor = 'pointer';\n            }\n            else {\n                return;\n            }\n        }\n        this.fhdSelIdx = this.fhdHovIdx;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var point = parent.pointColl[this.fhdSelIdx];\n        point.isSelected = true;\n        this.fhdSelID = point.id;\n        if (point.strokeColor !== '#42a5f5') {\n            parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor = point.strokeColor;\n        }\n        parent.activeObj.strokeSettings.strokeWidth = this.tempFHDStyles.strokeWidth =\n            parent.pointColl[this.fhdHovIdx].strokeWidth;\n        var obj = { bool: false };\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var shapeSettings = { id: 'pen_' + (this.fhdSelIdx + 1), type: ShapeType.FreehandDraw,\n                startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity,\n                index: point.order };\n            var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.triggerShapeChanging(shapeChangingArgs);\n        }\n        else {\n            parent.okBtn(null, true);\n        }\n        if (parent.isUndoRedoStack) {\n            this.tempFHDStyles = tempFHDStyles;\n        }\n    };\n    // eslint-disable-next-line  @typescript-eslint/no-unused-vars\n    FreehandDrawing.prototype.deleteFhd = function (index, isId) {\n        var parent = this.parent;\n        if (this.isFHDIdx(index)) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempSelPointColl = extend({}, this.selPointColl, {}, true);\n            parent.pointColl = {};\n            this.selPointColl = {};\n            var count = 0;\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                if (parseInt(tempPointColl[i].id.split('_')[1], 10) - 1 !== index) {\n                    parent.pointColl[count] = tempPointColl[i];\n                    this.selPointColl[count] = tempSelPointColl[i];\n                    count++;\n                }\n            }\n            parent.freehandCounter -= 1;\n            this.fhdHovIdx = this.fhdSelIdx = null;\n            parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    FreehandDrawing.prototype.zoomX = function (x) {\n        return (x * this.parent.img.destWidth) + this.parent.img.destLeft;\n    };\n    FreehandDrawing.prototype.zoomY = function (y) {\n        return (y * this.parent.img.destHeight) + this.parent.img.destTop;\n    };\n    FreehandDrawing.prototype.zoomFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.x = this.zoomX(point.ratioX);\n                point.y = this.zoomY(point.ratioY);\n            }\n        }\n        this.updateFHDCurPts();\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.x = this.zoomX(this.straightenPoint.ratioX);\n            this.straightenPoint.y = this.zoomY(this.straightenPoint.ratioY);\n        }\n        if (parent.transform.straighten !== 0) {\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        if (isNullOrUndefined(isPreventApply)) {\n            this.freehandRedraw(this.lowerContext, null);\n        }\n    };\n    FreehandDrawing.prototype.updateFHDCurPts = function () {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.x = this.zoomX(point.ratioX);\n                    point.y = this.zoomY(point.ratioY);\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.rotateFhdColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.y = destTop + (destHeight * point.ratioX);\n                point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.y = destTop + (destHeight * point.ratioX);\n                    point.x = (destLeft + destWidth) - (destWidth * point.ratioY);\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.flipFHDColl = function (value) {\n        var lowercaseValue = value.toLowerCase();\n        if (lowercaseValue === 'horizontal') {\n            this.pointsHorizontalFlip();\n        }\n        else if (lowercaseValue === 'vertical') {\n            this.pointsVerticalFlip();\n        }\n        else {\n            this.pointsHorizontalFlip();\n            for (var i = 0; i < this.parent.freehandCounter; i++) {\n                this.parent.pointColl[i].shapeFlip = '';\n            }\n            this.pointsVerticalFlip();\n        }\n    };\n    FreehandDrawing.prototype.pointsHorizontalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.x <= destLeft + (destWidth / 2)) {\n                        point.x = (destLeft + destWidth) - (point.x - destLeft);\n                    }\n                    else if (point.x >= destLeft + (destWidth / 2)) {\n                        point.x = destLeft + (destLeft + destWidth - point.x);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.x <= destLeft + (destWidth / 2)) {\n                            point.x = (destLeft + destWidth) - (point.x - destLeft);\n                        }\n                        else if (point.x >= destLeft + (destWidth / 2)) {\n                            point.x = destLeft + (destLeft + destWidth - point.x);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.pointsVerticalFlip = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    var point = parent.points[l];\n                    if (point.y <= destTop + (destHeight / 2)) {\n                        point.y = (destTop + destHeight) - (point.y - destTop);\n                    }\n                    else if (point.y >= destTop + (destHeight / 2)) {\n                        point.y = destTop + (destTop + destHeight - point.y);\n                    }\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        var point = this.selPoints[l];\n                        if (point.y <= destTop + (destHeight / 2)) {\n                            point.y = (destTop + destHeight) - (point.y - destTop);\n                        }\n                        else if (point.y >= destTop + (destHeight / 2)) {\n                            point.y = destTop + (destTop + destHeight - point.y);\n                        }\n                        point.ratioX = (point.x - destLeft) / destWidth;\n                        point.ratioY = (point.y - destTop) / destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.updateFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n            var currObj = parent.objColl[i];\n            if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                parent.notify('shape', { prop: 'straightenShapePoints', value: { obj: currObj, isReverse: true } });\n            }\n            else if (currObj.shape === 'path') {\n                var temp = parent.transform.straighten;\n                parent.transform.straighten = -parent.transform.straighten;\n                parent.notify('shape', { prop: 'straightenPath', onPropertyChange: false, value: { obj: currObj } });\n                parent.transform.straighten = temp;\n            }\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) /\n                    destWidth), startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width, height: destHeight /\n                    currObj.activePoint.height };\n            if (currObj.shape === 'path') {\n                for (var j = 0, jLen = currObj.pointColl.length; j < jLen; j++) {\n                    currObj.pointColl[j].ratioX =\n                        (currObj.pointColl[j].x - destLeft) / destWidth;\n                    currObj.pointColl[j].ratioY =\n                        (currObj.pointColl[j].y - destTop) / destHeight;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (parent.freehandCounter > 0 && parent.transform.straighten !== 0) {\n            var temp = parent.transform.straighten;\n            parent.transform.straighten = -parent.transform.straighten;\n            parent.notify('shape', { prop: 'straightenFHD', onPropertyChange: false });\n            parent.transform.straighten = temp;\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                point.ratioX = (point.x - destLeft) / destWidth;\n                point.ratioY = (point.y - destTop) / destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - destLeft) / destWidth;\n                    point.ratioY = (point.y - destTop) / destHeight;\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            this.straightenPoint.ratioX = (this.straightenPoint.x - destLeft) / destWidth;\n            this.straightenPoint.ratioY = (this.straightenPoint.y - destTop) / destHeight;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n    };\n    FreehandDrawing.prototype.panFHDColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                var point = parent.points[l];\n                if (panRegion === '' || panRegion === 'vertical') {\n                    point.x += xDiff;\n                }\n                else {\n                    point.x -= xDiff;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    point.y += yDiff;\n                }\n                else {\n                    point.y -= yDiff;\n                }\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    if (panRegion === '' || panRegion === 'vertical') {\n                        point.x += xDiff;\n                    }\n                    else {\n                        point.x -= xDiff;\n                    }\n                    if (panRegion === '' || panRegion === 'horizontal') {\n                        point.y += yDiff;\n                    }\n                    else {\n                        point.y -= yDiff;\n                    }\n                }\n            }\n        }\n        if (this.straightenPoint.x && this.straightenPoint.y) {\n            if (panRegion === '' || panRegion === 'vertical') {\n                this.straightenPoint.x += xDiff;\n            }\n            else {\n                this.straightenPoint.x -= xDiff;\n            }\n            if (panRegion === '' || panRegion === 'horizontal') {\n                this.straightenPoint.y += yDiff;\n            }\n            else {\n                this.straightenPoint.y -= yDiff;\n            }\n        }\n        this.freehandRedraw(this.lowerContext, null);\n    };\n    FreehandDrawing.prototype.freeHandDraw = function (value) {\n        var parent = this.parent;\n        if (value) {\n            parent.points = [];\n            this.dummyPoints = [];\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.togglePen = true;\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            parent.upperCanvas.style.display = 'block';\n            if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                var obj = { strokeSettings: {} };\n                parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                    value: { obj: obj } });\n                parent.activeObj.strokeSettings = obj['strokeSettings'];\n            }\n            if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                parent.activeObj.strokeSettings.strokeWidth = 2;\n            }\n            if (parent.isMaskImage) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n        }\n        else {\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            var strokeWidth = this.penStrokeWidth;\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n            parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            this.penStrokeWidth = strokeWidth;\n        }\n    };\n    FreehandDrawing.prototype.isFHDIdx = function (index, obj) {\n        var isIndex = false;\n        for (var i = 0; i < this.parent.freehandCounter; i++) {\n            if (this.parent.pointColl[i].id &&\n                parseInt(this.parent.pointColl[i].id.split('_')[1], 10) - 1 === index) {\n                isIndex = true;\n                break;\n            }\n        }\n        if (obj) {\n            obj['isIndex'] = isIndex;\n        }\n        return isIndex;\n    };\n    FreehandDrawing.prototype.updateCropPtsForSel = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: extend([], this.selPointColl) };\n            if (obj['selPointColl'][n]) {\n                this.selPoints = extend([], obj['selPointColl'][n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    var point = this.selPoints[l];\n                    point.ratioX = (point.x - actPoint.startX) / actPoint.width;\n                    point.ratioY = (point.y - actPoint.startY) / actPoint.height;\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.triggerShapeChanging = function (shapeChangingArgs) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var parent = this.parent;\n        var point = parent.pointColl[this.fhdSelIdx];\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        if (parent.element.getAttribute('data-value') === 'mask-drawing' && !this.isMasking) {\n            this.isMasking = true;\n            parent.upperCanvas.style.cursor = 'crosshair';\n            parent.notify('draw', { prop: 'updateTempObjColl' });\n            parent.notify('draw', { prop: 'updateTempPointColl' });\n            parent.discard();\n            parent.selectMaskImage();\n            return;\n        }\n        parent.editCompleteArgs = shapeChangingArgs;\n        if (shapeChangingArgs.currentShapeSettings.id.indexOf('pen_') === -1 &&\n            (shapeChangingArgs.action === 'draw-end' || shapeChangingArgs.action === 'select')) {\n            var id = 'pen_' + shapeChangingArgs.currentShapeSettings.id;\n            if (this.fhdSelIdx) {\n                parent.pointColl[this.fhdSelIdx].id = id;\n            }\n            else {\n                parent.pointColl[parent.freehandCounter - 1].id = id;\n            }\n        }\n        this.penStrokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n        if (parent.activeObj.strokeSettings.strokeColor !== shapeChangingArgs.currentShapeSettings.strokeColor) {\n            parent.activeObj.strokeSettings.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        if (this.fhdSelID && point && shapeChangingArgs.currentShapeSettings) {\n            point.strokeColor = shapeChangingArgs.currentShapeSettings.strokeColor;\n            point.strokeWidth = shapeChangingArgs.currentShapeSettings.strokeWidth;\n            point.points = shapeChangingArgs.currentShapeSettings.points;\n            point.opacity = shapeChangingArgs.currentShapeSettings.opacity;\n        }\n        if (shapeChangingArgs.action === 'select') {\n            this.freehandRedraw(this.upperContext);\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        }\n    };\n    FreehandDrawing.prototype.setCenterSelPoints = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        parent.notify('shape', { prop: 'straightenShapes', onPropertyChange: false });\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(this.prevStraightenObj) ||\n            (JSON.stringify(this.prevStraightenObj.activePoint) !== JSON.stringify(actPoint))) {\n            this.straightenPoint = { x: actPoint.startX + (actPoint.width / 2),\n                y: actPoint.startY + (actPoint.height / 2),\n                ratioX: (actPoint.startX + (actPoint.width / 2) - destLeft) / destWidth,\n                ratioY: (actPoint.startY + (actPoint.height / 2) - destTop) / destHeight };\n            this.prevStraightenObj = extend({}, parent.activeObj, {}, true);\n            this.straightenPointAngle = parent.transform.straighten;\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    return FreehandDrawing;\n}());\nexport { FreehandDrawing };\n","/* eslint-disable prefer-const */\nimport { Browser, EventHandler, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ArrowheadType, ShapeType, ZoomTrigger } from '../index';\nvar Selection = /** @class */ (function () {\n    function Selection(parent) {\n        this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        this.oldPoint = {};\n        this.isTouch = false;\n        this.isObjSelected = false;\n        this.isFhdPoint = false; // Specifies whether mouse cursor is on freehand drawing point or not\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        this.isShapeInserted = false;\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], order: null }; // for undo redo\n        this.isFirstMove = false; // for pinch zoom\n        this.startTouches = []; // for pinch zoom\n        this.tempTouches = []; // for pinch zoom\n        this.currMousePoint = { x: 0, y: 0 }; // To prevent mouse move event on pinch zoom\n        this.cursorTargetId = '';\n        this.isPreventDragging = false; // Shapes dragging is prevented when crop region is inside shape points\n        this.dragElement = '';\n        this.textRow = 1; // text area row count\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.isFhdEditing = false; // Specifies whether freehand drawing is in editing mode or not\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.touchTime = 0;\n        this.resizedElement = '';\n        this.isImageClarity = true;\n        this.isPinching = false;\n        this.isSliding = false;\n        this.mouseDown = '';\n        this.isSliderActive = false;\n        this.arrowShape = [ArrowheadType.None, ArrowheadType.SolidArrow];\n        this.isTouchDblClick = false;\n        this.isMouseDown = false;\n        this.isMouseUp = false;\n        this.mouseWheel = 0;\n        this.isTransformedShape = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Selection.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Selection.prototype.addEventListener = function () {\n        this.parent.on('selection', this.selection, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        this.parent.off('selection', this.selection);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Selection.prototype.selection = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'setCursor':\n                this.setCursor(args.value['x'], args.value['y']);\n                break;\n            case 'updateActivePoint':\n                this.updateActivePoint(args.value['x'], args.value['y'], args.value['isCropSelection']);\n                break;\n            case 'updateCursorStyles':\n                this.updateCursorStyles(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'setTextSelection':\n                this.setTextSelection(args.value['width'], args.value['height']);\n                break;\n            case 'setActivePoint':\n                this.setActivePoint(args.value['startX'], args.value['startY']);\n                break;\n            case 'clearSelection':\n                this.clearSelection(args.value['resetCrop']);\n                break;\n            case 'calcShapeRatio':\n                this.calcShapeRatio(args.value['x'], args.value['y'], args.value['imgWidth'], args.value['imgHeight']);\n                break;\n            case 'tab':\n                this.performTabAction();\n                break;\n            case 'setDragDirection':\n                this.setDragDirection(args.value['width'], args.value['height']);\n                break;\n            case 'clearUpperCanvas':\n                if (this.isTouch) {\n                    setTimeout(function () {\n                        parent.upperCanvas.getContext('2d').clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }, 550);\n                }\n                break;\n            case 'resetFreehandDrawVariables':\n                this.isFhdEditing = this.isFhdPoint = false;\n                break;\n            case 'isShapeInserted':\n                this.isShapeInserted = args.value['bool'];\n                break;\n            case 'redrawShape':\n                this.redrawShape(args.value['obj']);\n                break;\n            case 'setTextBoxStylesToActObj':\n                this.setTextBoxStylesToActObj();\n                break;\n            case 'mouseDownEventHandler':\n                this.mouseDownEventHandler(args.value['e']);\n                break;\n            case 'mouseMoveEventHandler':\n                this.mouseMoveEventHandler(args.value['e']);\n                break;\n            case 'mouseUpEventHandler':\n                this.mouseUpEventHandler(args.value['e']);\n                break;\n            case 'canvasMouseDownHandler':\n                this.canvasMouseDownHandler(args.value['e']);\n                break;\n            case 'canvasMouseMoveHandler':\n                this.canvasMouseMoveHandler(args.value['e']);\n                break;\n            case 'canvasMouseUpHandler':\n                this.canvasMouseUpHandler(args.value['e']);\n                break;\n            case 'touchStartHandler':\n                this.touchStartHandler(args.value['e']);\n                break;\n            case 'keyDownEventHandler':\n                this.keyDownEventHandler(args.value['e']);\n                break;\n            case 'handleScroll':\n                this.handleScroll(args.value['e']);\n                break;\n            case 'textKeyDown':\n                setTimeout(this.textKeyDown.bind(this), 1, args.value['e']);\n                break;\n            case 'deleteItem':\n                this.deleteItem();\n                break;\n            case 'updatePrevShapeSettings':\n                this.updatePrevShapeSettings(args.value['obj']);\n                break;\n            case 'getZoomType':\n                args.value['obj']['zoomType'] = this.zoomType;\n                break;\n            case 'setZoomType':\n                this.zoomType = args.value['zoomType'];\n                break;\n            case 'setInitialTextEdit':\n                this.isInitialTextEdited = args.value['bool'];\n                break;\n            case 'setDragCanvas':\n                this.dragCanvas = args.value['bool'];\n                break;\n            case 'setFreehandDrawCustomized':\n                this.isFhdCustomized = args.value['isFreehandDrawCustomized'];\n                break;\n            case 'setTouchEndPoint':\n                this.touchEndPoint.x = args.value['x'];\n                this.touchEndPoint.y = args.value['y'];\n                break;\n            case 'getPanDown':\n                args.value['obj']['panDown'] = this.panDown;\n                break;\n            case 'setPanDown':\n                this.panDown = args.value['panDown'];\n                break;\n            case 'getFreehandDrawEditing':\n                args.value['obj']['bool'] = this.isFhdEditing;\n                break;\n            case 'setFreehandDrawEditing':\n                this.isFhdEditing = args.value['bool'];\n                break;\n            case 'getTempActObj':\n                args.value['obj']['tempObj'] = this.tempActiveObj;\n                break;\n            case 'setTempActObj':\n                this.tempActiveObj = args.value['obj'];\n                break;\n            case 'isInside':\n                this.isInside(args.value['x'], args.value['y'], args.value['z1'], args.value['z2'], args.value['z3'], args.value['z4']);\n                break;\n            case 'setDragElement':\n                this.dragElement = args.value['value'];\n                break;\n            case 'setObjSelected':\n                this.isObjSelected = args.value['bool'];\n                break;\n            case 'adjustActObjForLineArrow':\n                this.adjustActObjForLineArrow(args.value['obj']);\n                break;\n            case 'findTarget':\n                this.findTarget(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'getCurrentFlipState':\n                this.getCurrentFlipState();\n                break;\n            case 'setDragWidth':\n                this.setDragWidth(args.value['width']);\n                break;\n            case 'setDragHeight':\n                this.setDragHeight(args.value['setDragHeight']);\n                break;\n            case 'annotate':\n                this.currentDrawingShape = args.value['shape'];\n                if (args.value['shape'] === 'text') {\n                    parent.activeObj.textSettings.fontSize = 11;\n                    parent.activeObj.keyHistory = 'Enter Text';\n                    parent.notify('shape', { prop: 'initializeTextShape', onPropertyChange: false,\n                        value: { text: null, fontFamily: null, fontSize: null, bold: null, italic: null, strokeColor: null } });\n                }\n                else if (args.value['shape'] === 'path') {\n                    parent.activeObj.pointColl = [];\n                }\n                break;\n            case 'getCurrentDrawingShape':\n                args.value['obj']['shape'] = this.currentDrawingShape;\n                break;\n            case 'setCurrentDrawingShape':\n                this.currentDrawingShape = args.value['value'];\n                break;\n            case 'getTransRotationPoint':\n                this.getTransRotationPoint(args.value['obj'], args.value['object']);\n                break;\n            case 'adjustNEPoints':\n                this.adjustNEPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'adjustRotationPoints':\n                this.adjustRotationPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle'], args.value['type'], args.value['elem']);\n                break;\n            case 'getResizeDirection':\n                this.getResizeDirection(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'setResizedElement':\n                this.resizedElement = args.value['value'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'unWireEvent':\n                this.unwireEvent();\n                break;\n            case 'updPtCollForShpRot':\n                this.updPtCollForShpRot(args.value['obj']);\n                break;\n            case 'findImageRatio':\n                this.findImageRatio(args.value['width'], args.value['height'], args.value['obj']);\n                break;\n            case 'getNumTextValue':\n                this.getNumTextValue(args.value['obj']);\n                break;\n            case 'setImageClarity':\n                this.isImageClarity = args.value['bool'];\n                break;\n            case 'upgradeImageQuality':\n                this.upgradeImageQuality();\n                break;\n            case 'triggerShapeChange':\n                this.triggerShapeChange(args.value['shapeResizingArgs'], args.value['shapeMovingArgs'], args.value['type']);\n                break;\n            case 'applyTransformToImg':\n                this.applyTransformToImg(args.value['ctx']);\n                break;\n            case 'findTargetObj':\n                args.value['obj']['bool'] = this.findTargetObj(args.value['x'], args.value['y'], args.value['isCrop']);\n                break;\n            case 'setSliding':\n                this.isSliding = args.value['bool'];\n                break;\n            case 'setSliderActive':\n                this.isSliderActive = args.value['bool'];\n                break;\n            case 'getArrowType':\n                args.value['obj']['type'] = this.getArrowType(args.value['type']);\n                break;\n            case 'setArrowShape':\n                if (args.value['type'] === 'initial') {\n                    this.arrowShape[0] = args.value['shape'];\n                }\n                else {\n                    this.arrowShape[1] = args.value['shape'];\n                }\n                break;\n            case 'updateNWPoints':\n                this.updateNWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateNPoints':\n                this.updateNPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateNEPoints':\n                this.updateNEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateWPoints':\n                this.updateWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateEPoints':\n                this.updateEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSWPoints':\n                this.updateSWPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSPoints':\n                this.updateSPoints(args.value['x'], args.value['y']);\n                break;\n            case 'updateSEPoints':\n                this.updateSEPoints(args.value['x'], args.value['y']);\n                break;\n            case 'drawMaskCircle':\n                this.drawMaskCircle(args.value['x'], args.value['y']);\n                break;\n            case 'isValueUpdated':\n                this.isValueUpdated();\n                break;\n            case 'getDistance':\n                this.getDistance(args.value['x'], args.value['y']);\n                break;\n            case 'redact':\n                this.currentDrawingShape = args.value['shape'];\n                break;\n            case 'updateTransColl':\n                args.value['obj']['coll'] = this.updateTransColl(args.value['object']);\n                break;\n            case 'getTransformedShape':\n                args.value['obj']['bool'] = this.isTransformedShape;\n                break;\n            case 'setTransformedShape':\n                this.isTransformedShape = args.value['bool'];\n                break;\n        }\n    };\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Selection.prototype.reset = function () {\n        this.diffPoint = { x: 0, y: 0 };\n        this.oldPoint = {};\n        this.isTouch = this.isObjSelected = this.isFhdPoint = this.isShapeInserted = false;\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 };\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], order: null };\n        this.isFirstMove = false;\n        this.cursorTargetId = this.dragElement = '';\n        this.isTouchDblClick = false;\n        this.startTouches = [];\n        this.tempTouches = [];\n        this.currMousePoint = { x: 0, y: 0 };\n        this.isPreventDragging = false;\n        this.timer = undefined;\n        this.tempObjColl = undefined;\n        this.mouseWheel = 0;\n        this.textRow = 1;\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 };\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = this.isPinching = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.panDown = null;\n        this.isSliding = false;\n        this.isFhdEditing = false;\n        this.pathAdjustedIndex = null;\n        this.touchTime = 0;\n        this.isImageClarity = true;\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.resizedElement = '';\n        this.mouseDown = '';\n        this.isSliderActive = false;\n        this.arrowShape = [ArrowheadType.None, ArrowheadType.SolidArrow];\n        this.isMouseDown = this.isMouseUp = this.isTransformedShape = false;\n    };\n    Selection.prototype.performTabAction = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var allowUndoRedoPush = this.applyCurrShape(false);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        parent.isKBDNavigation = true;\n    };\n    Selection.prototype.selMouseUpEvent = function () {\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    Selection.prototype.getMouseCursor = function (actObj, x, y, isCropSelection, isApply) {\n        var rotationCirclePoint = this.getTransRotationPoint(actObj);\n        var radius = actObj.bottomCenterCircle.radius;\n        var cursor = 'default';\n        var ratio = isApply ? 0 : ((actObj.topLeftCircle.radius * 2));\n        if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.topLeftCircle.startY + ratio)) {\n            cursor = 'nw-resize';\n        }\n        else if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX - ratio) &&\n            y >= (actObj.topCenterCircle.startY - ratio) &&\n            y <= (actObj.topCenterCircle.startY + ratio)) {\n            cursor = 'n-resize';\n        }\n        else if (x >= (actObj.topRightCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.topRightCircle.startY + ratio)) {\n            cursor = 'ne-resize';\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - ratio) &&\n            x <= (actObj.centerLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY - ratio)) {\n            cursor = 'w-resize';\n        }\n        else if (x >= (actObj.centerRightCircle.startX - ratio) &&\n            x <= (actObj.centerRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY - ratio)) {\n            cursor = 'e-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomLeftCircle.startX + ratio) &&\n            y >= (actObj.bottomLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY + ratio)) {\n            cursor = 'sw-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX - ratio) &&\n            y >= (actObj.bottomCenterCircle.startY - ratio) &&\n            y <= (actObj.bottomCenterCircle.startY + ratio)) {\n            cursor = 's-resize';\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX + ratio) &&\n            y >= (actObj.bottomRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY + ratio)) {\n            cursor = 'se-resize';\n        }\n        else if ((x >= actObj.activePoint.startX &&\n            x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n            y <= actObj.activePoint.endY)) {\n            if (isCropSelection) {\n                cursor = 'grab';\n            }\n            else {\n                cursor = 'move';\n            }\n        }\n        else if (rotationCirclePoint && !isApply &&\n            x >= (rotationCirclePoint.x - (radius + 2)) &&\n            x <= rotationCirclePoint.x + (radius + 2) &&\n            y >= rotationCirclePoint.y - (radius + 2) &&\n            y <= rotationCirclePoint.y + (radius + 2)) {\n            cursor = 'grabbing';\n        }\n        else {\n            cursor = 'default';\n        }\n        return cursor;\n    };\n    Selection.prototype.setCursor = function (x, y) {\n        var parent = this.parent;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || this.isSliding || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if ((!splitWords && parent.currObjType.isCustomCrop) || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (parent.currObjType.isDragging) {\n            if (this.dragElement === '') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.dragElement;\n            }\n            return;\n        }\n        if (parent.togglePen) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            if (parent.isMaskImage) {\n                this.drawMaskCircle(x, y);\n                parent.upperCanvas.style.cursor = 'none';\n            }\n            return;\n        }\n        if (parent.activeObj.shape) {\n            this.setCursorForActObj(splitWords, isCropSelection, x, y);\n        }\n        if (parent.cursor === 'default' || parent.cursor === 'grab') {\n            var highestOrder = this.getHighestOrder();\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempShapeColl = extend([], parent.shapeColl, [], true);\n            var objColl = extend([], parent.objColl, [], true);\n            var isShape = false;\n            while (highestOrder > 0) {\n                isShape = false;\n                for (var i = tempShapeColl.length - 1; i >= 0; i--) {\n                    if (tempShapeColl[i].order === highestOrder) {\n                        isShape = true;\n                        if (tempShapeColl[i].id && tempShapeColl[i].id.indexOf('pen') > -1) {\n                            if (parent.pointColl[0] && (parent.cursor !== 'grab' || !isCropSelection)\n                                && !parent.currObjType.isDragging && !parent.currObjType.isResize) {\n                                var points = extend([], parent.points, [], true);\n                                if (!isCropSelection) {\n                                    this.setCursorForFreehandDrawing(x, y, parent.upperCanvas, tempShapeColl[i].id);\n                                }\n                                parent.points = points;\n                            }\n                        }\n                        else {\n                            parent.objColl = [];\n                            parent.objColl.push(extend({}, tempShapeColl[i], null, true));\n                            var cursor = parent.upperCanvas.style.cursor;\n                            if (parent.objColl.length > 0 && (parent.cursor !== 'grab' || !isCropSelection)) {\n                                this.setCursorFromObj(x, y, parent.objColl, parent.upperCanvas, isCropSelection);\n                            }\n                            if (cursor === 'grab' && parent.cursor === 'default') {\n                                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                            }\n                        }\n                    }\n                    else if (isNullOrUndefined(tempShapeColl[i].order)) {\n                        isShape = true;\n                    }\n                }\n                if (parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                    break;\n                }\n                else if (isShape) {\n                    var isBreak = false;\n                    while (!isBreak && highestOrder > 0) {\n                        for (var a = 0; a < tempShapeColl.length; a++) {\n                            if (tempShapeColl[a].order === highestOrder - 1) {\n                                isBreak = true;\n                                break;\n                            }\n                        }\n                        highestOrder--;\n                        if (!isBreak) {\n                            highestOrder--;\n                        }\n                    }\n                }\n            }\n            parent.objColl = objColl;\n            if (parent.cursor === 'default' || parent.cursor === 'grab') {\n                if (parent.togglePan) {\n                    parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                }\n            }\n        }\n        if (this.currentDrawingShape !== '' && (parent.cursor === 'default' || parent.cursor === 'grab')) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n        }\n    };\n    Selection.prototype.getHighestOrder = function () {\n        var highestOrder = 0;\n        for (var i = 0; i < this.parent.shapeColl.length; i++) {\n            if (this.parent.shapeColl[i].order > highestOrder) {\n                highestOrder = this.parent.shapeColl[i].order;\n            }\n        }\n        return highestOrder;\n    };\n    Selection.prototype.drawMaskCircle = function (x, y) {\n        var parent = this.parent;\n        if (parent.isMaskImage) {\n            var radius = parent.activeObj.strokeSettings.strokeWidth * 2;\n            var canvasDraw = parent.maskCanvas.getContext('2d');\n            canvasDraw.clearRect(0, 0, parent.maskCanvas.width, parent.maskCanvas.height);\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            canvasDraw.strokeStyle = '#fff';\n            canvasDraw.beginPath();\n            canvasDraw.ellipse(x, y, radius / 2, radius / 2, 0, 0, 2 * Math.PI, false);\n            canvasDraw.fill();\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            parent.maskCanvas.style.cursor = 'none';\n        }\n    };\n    Selection.prototype.setCursorForActObj = function (splitWords, isCropSelection, x, y) {\n        var parent = this.parent;\n        if (parent.activeObj.horTopLine !== undefined) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isCropSelection && parent.togglePan) {\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            var cursor = parent.upperCanvas.style.cursor;\n            var actObj = extend({}, parent.activeObj, {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            var degree = void 0;\n            if (actObj.shapeDegree === 0) {\n                degree = parent.transform.degree;\n            }\n            else {\n                degree = parent.transform.degree - actObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, false);\n                var cursorColl = ['n-resize', 's-resize', 'e-resize', 'w-resize'];\n                if ((actObj.shape === 'text') && cursorColl.indexOf(parent.cursor) > -1) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n            }\n            if (cursor === 'default' && parent.cursor === 'default' && isCropSelection) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        else if (parent.togglePan && !parent.togglePen) {\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n        }\n        else {\n            if (parent.currObjType.isCustomCrop || parent.togglePen) {\n                parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            }\n            else {\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Selection.prototype.setCursorForPath = function (actObj, x, y, upperCanvas) {\n        this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n        var parent = this.parent;\n        if (parent.cursor === 'default') {\n            var obj = extend({}, actObj, null, true);\n            var isMove = false;\n            for (var i = 1, len = actObj.pointColl.length; i < len; i++) {\n                if (isMove) {\n                    break;\n                }\n                obj.activePoint.startX = actObj.pointColl[i - 1].x;\n                obj.activePoint.startY = actObj.pointColl[i - 1].y;\n                obj.activePoint.endX = actObj.pointColl[i].x;\n                obj.activePoint.endY = actObj.pointColl[i].y;\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                var radius = actObj.topLeftCircle.radius;\n                for (var j = 0, jLen = obj.pointColl.length; j < jLen; j++) {\n                    var point = obj.pointColl[j];\n                    if (!isNullOrUndefined(point.x - (radius * 2)) &&\n                        !isNullOrUndefined(point.x + (radius * 2)) &&\n                        !isNullOrUndefined(point.y - (radius * 2)) &&\n                        !isNullOrUndefined(point.y + (radius * 2)) &&\n                        x >= (point.x - (radius * 2)) &&\n                        x <= (point.x + (radius * 2)) &&\n                        y >= (point.y - (radius * 2)) &&\n                        y <= (point.y + (radius * 2))) {\n                        upperCanvas.style.cursor = parent.cursor = 'move';\n                        isMove = true;\n                        break;\n                    }\n                    else {\n                        upperCanvas.style.cursor = parent.cursor = 'default';\n                    }\n                }\n            }\n        }\n        return parent.cursor;\n    };\n    Selection.prototype.setCursorForLineArrow = function (actObj, x, y, upperCanvas) {\n        var index;\n        var radius = actObj.topLeftCircle.radius;\n        if (isNullOrUndefined(actObj.pointColl)) {\n            return index;\n        }\n        for (var i = 0, len = actObj.pointColl.length; i < len; i++) {\n            var point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                upperCanvas.style.cursor = this.parent.cursor = 'move';\n                index = i;\n                break;\n            }\n            else {\n                upperCanvas.style.cursor = this.parent.cursor = 'default';\n            }\n        }\n        return index;\n    };\n    Selection.prototype.setCursorForRotatedObject = function (actObj, x, y, upperCanvas) {\n        this.resizedElement = '';\n        var parent = this.parent;\n        var radius = actObj.bottomCenterCircle.radius;\n        var horTP = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)];\n        var horTP1 = actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)];\n        var verLP = actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)];\n        var verRP = actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)];\n        var horBP = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)];\n        var horBP1 = actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)];\n        var rotCP = actObj.rotationCirclePointColl;\n        var horTP0 = actObj.horTopLinePointColl[0];\n        var horBP0 = actObj.horBottomLinePointColl[0];\n        if (x >= (horTP0.x - (radius + 2)) && x <= (horTP0.x + (radius + 2)) && y >= (horTP0.y - (radius + 2)) &&\n            y <= (horTP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n        }\n        else if (x >= (horTP.x - 5) && x <= (horTP.x + 5) && y >= (horTP.y - 5) && y <= (horTP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n        }\n        else if (x >= (horTP1.x - (radius + 2)) && x <= (horTP1.x + (radius + 2)) && y >= (horTP1.y - (radius + 2)) &&\n            y <= (horTP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        else if (x >= (verLP.x - 5) && x <= (verLP.x + 5) && y >= (verLP.y - 5) && y <= (verLP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n        }\n        else if (x >= (verRP.x - 5) && x <= (verRP.x + 5) && y >= (verRP.y - 5) && y <= (verRP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n        }\n        else if (x >= (horBP0.x - (radius + 2)) && x <= (horBP0.x + (radius + 2)) && y >= (horBP0.y - (radius + 2)) &&\n            y <= (horBP0.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        else if (x >= (horBP.x - 5) && x <= (horBP.x + 5) && y >= (horBP.y - 5) && y <= (horBP.y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n        }\n        else if (x >= (horBP1.x - (radius + 2)) && x <= (horBP1.x + (radius + 2)) && y >= (horBP1.y - (radius + 2)) &&\n            y <= (horBP1.y + (radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'se-resize';\n        }\n        else if (rotCP && x >= (rotCP.x - (radius + 2)) && x <= rotCP.x + (radius + 2) && y >= rotCP.y - (radius + 2) &&\n            y <= rotCP.y + (radius + 2)) {\n            upperCanvas.style.cursor = parent.cursor = 'grabbing';\n        }\n        else {\n            upperCanvas.style.cursor = parent.cursor = 'default';\n            var isPointsInsideRectangle = this.getRectanglePoints(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height, actObj.rotatedAngle * (180 / Math.PI), x, y);\n            if (isPointsInsideRectangle) {\n                upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horTopLinePointColl.length; i < len; i++) {\n                var horTP_1 = actObj.horTopLinePointColl[i];\n                if (x >= (horTP_1.x - 5) && x <= (horTP_1.x + 5) && y >= (horTP_1.y - 5) && y <= (horTP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horBottomLinePointColl.length; i < len; i++) {\n                var horBP_1 = actObj.horBottomLinePointColl[i];\n                if (x >= (horBP_1.x - 5) && x <= (horBP_1.x + 5) && y >= (horBP_1.y - 5) && y <= (horBP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verLeftLinePointColl.length; i < len; i++) {\n                var verLP_1 = actObj.verLeftLinePointColl[i];\n                if (x >= (verLP_1.x - 5) && x <= (verLP_1.x + 5) && y >= (verLP_1.y - 5) && y <= (verLP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verRightLinePointColl.length; i < len; i++) {\n                var verRP_1 = actObj.verRightLinePointColl[i];\n                if (x >= (verRP_1.x - 5) && x <= (verRP_1.x + 5) && y >= (verRP_1.y - 5) && y <= (verRP_1.y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n                    break;\n                }\n            }\n        }\n        this.adjustCursorStylesForRotatedState(actObj);\n        return parent.cursor;\n    };\n    Selection.prototype.adjustCursorStylesForRotatedState = function (actObj) {\n        var parent = this.parent;\n        var length = actObj.rotatedAngle * (180 / Math.PI);\n        length = length > 0 ? Math.floor(length) : Math.ceil(length);\n        if ((length >= 92 && length <= 182) || (length >= -178 && length <= -88)) {\n            var cursorMap = { 'nw-resize': 'ne-resize', 'n-resize': 's-resize',\n                'ne-resize': 'nw-resize', 'w-resize': 'e-resize', 'e-resize': 'w-resize',\n                'sw-resize': 'se-resize', 's-resize': 'n-resize', 'se-resize': 'sw-resize'\n            };\n            if (parent.cursor in cursorMap) {\n                parent.cursor = cursorMap[parent.cursor];\n            }\n        }\n        parent.upperCanvas.style.cursor = this.getResizeElement((actObj.rotatedAngle * (180 / Math.PI)), parent.cursor);\n        return parent.cursor;\n    };\n    Selection.prototype.getResizeElement = function (degree, element) {\n        var resizeMappings = [];\n        switch (element) {\n            case 'nw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'nw-resize'], [22.5, 67.5, 'n-resize'], [67.5, 112.5, 'ne-resize'],\n                    [112.5, 157.5, 'e-resize'], [157.5, 202.5, 'se-resize'],\n                    [202.5, 247.5, 's-resize'], [247.5, 292.5, 'sw-resize'],\n                    [292.5, 337.5, 'w-resize']\n                ];\n                break;\n            case 'n-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'n-resize'], [22.5, 67.5, 'ne-resize'], [67.5, 112.5, 'e-resize'],\n                    [112.5, 157.5, 'se-resize'], [157.5, 202.5, 's-resize'], [202.5, 247.5, 'sw-resize'],\n                    [247.5, 292.5, 'w-resize'], [292.5, 337.5, 'nw-resize']\n                ];\n                break;\n            case 'ne-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'ne-resize'], [22.5, 67.5, 'e-resize'],\n                    [67.5, 112.5, 'se-resize'], [112.5, 157.5, 's-resize'], [157.5, 202.5, 'sw-resize'],\n                    [202.5, 247.5, 'w-resize'], [247.5, 292.5, 'nw-resize'], [292.5, 337.5, 'n-resize']\n                ];\n                break;\n            case 'e-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'e-resize'], [22.5, 67.5, 'se-resize'], [67.5, 112.5, 's-resize'],\n                    [112.5, 157.5, 'sw-resize'], [157.5, 202.5, 'w-resize'], [202.5, 247.5, 'nw-resize'],\n                    [247.5, 292.5, 'n-resize'], [292.5, 337.5, 'ne-resize']\n                ];\n                break;\n            case 'se-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'se-resize'], [22.5, 67.5, 's-resize'], [67.5, 112.5, 'sw-resize'],\n                    [112.5, 157.5, 'w-resize'], [157.5, 202.5, 'nw-resize'], [202.5, 247.5, 'n-resize'],\n                    [247.5, 292.5, 'ne-resize'], [292.5, 337.5, 'e-resize']\n                ];\n                break;\n            case 's-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 's-resize'], [22.5, 67.5, 'sw-resize'], [67.5, 112.5, 'w-resize'],\n                    [112.5, 157.5, 'nw-resize'], [157.5, 202.5, 'n-resize'], [202.5, 247.5, 'ne-resize'],\n                    [247.5, 292.5, 'e-resize'], [292.5, 337.5, 'se-resize']\n                ];\n                break;\n            case 'sw-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'sw-resize'], [22.5, 67.5, 'w-resize'], [67.5, 112.5, 'nw-resize'],\n                    [112.5, 157.5, 'n-resize'], [157.5, 202.5, 'ne-resize'], [202.5, 247.5, 'e-resize'],\n                    [247.5, 292.5, 'se-resize'], [292.5, 337.5, 's-resize']\n                ];\n                break;\n            case 'w-resize':\n                resizeMappings = [\n                    [337.5, 22.5, 'w-resize'], [22.5, 67.5, 'nw-resize'], [67.5, 112.5, 'n-resize'],\n                    [112.5, 157.5, 'ne-resize'], [157.5, 202.5, 'e-resize'], [202.5, 247.5, 'se-resize'],\n                    [247.5, 292.5, 's-resize'], [292.5, 337.5, 'sw-resize']\n                ];\n                break;\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_1 = resizeMappings; _i < resizeMappings_1.length; _i++) {\n            var _a = resizeMappings_1[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.setCursorForFreehandDrawing = function (x, y, upperCanvas, id) {\n        var upperContext = upperCanvas.getContext('2d');\n        var parent = this.parent;\n        var textArea = document.querySelector('#' + parent.element.id + '_textArea');\n        var isEntered = false;\n        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n            value: { index: -1 } });\n        var sPoints;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (id && id !== parent.pointColl[n].id) {\n                continue;\n            }\n            var obj = { selPointColl: {} };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: obj } });\n            sPoints = extend([], obj['selPointColl'][n].points, []);\n            parent.points = extend([], parent.pointColl[n].points, []);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var ptc = parent.pointColl[n];\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = sPoints.length;\n            for (var l = 0; l < len; l++) {\n                if (l !== 0) {\n                    var isInside = false;\n                    if (sPoints[l - 1] && sPoints[l]) {\n                        isInside = this.isInside(x, y, sPoints[l - 1].x, sPoints[l - 1].y, sPoints[l].x, sPoints[l].y);\n                    }\n                    if (isInside) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                            value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var indexObj = { freehandSelectedIndex: -1 };\n                            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                            var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                            var strokeWidth = parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: strokeWidth } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                                value: { index: null } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n                else {\n                    var pt = parent.points[l];\n                    if (x > pt.x - ptc.strokeWidth && x < pt.x + ptc.strokeWidth && y > pt.y - ptc.strokeWidth &&\n                        y < pt.y + ptc.strokeWidth) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false, value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false, value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || ptc.isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var indexObj = { freehandSelectedIndex: -1 };\n                            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                            var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                            var strokeWidth = parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: strokeWidth } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n            }\n            if (isEntered) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.setCursorFromObj = function (x, y, obj, upperCanvas, isCropSelection) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.length; i < len; i++) {\n            if (parent.cursor === 'move') {\n                return;\n            }\n            var actObj = extend({}, obj[i], {}, true);\n            if (actObj.activePoint.width === 0 && actObj.activePoint.height === 0) {\n                obj.splice(i, 1);\n                return;\n            }\n            this.cursorTargetId = actObj.currIndex;\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, upperCanvas);\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, true);\n            }\n        }\n    };\n    Selection.prototype.isInside = function (x, y, z1, z2, z3, z4) {\n        var x1 = Math.min(z1, z3);\n        var x2 = Math.max(z1, z3);\n        var y1 = Math.min(z2, z4);\n        var y2 = Math.max(z2, z4);\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.preventResizing = function (tempActiveObj) {\n        var parent = this.parent;\n        if (parent.activeObj.preventShapeDragOut && this.isShapeDragOut()) {\n            var actPoint = parent.activeObj.activePoint;\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n            actPoint.width = tempActiveObj.activePoint.width;\n            actPoint.height = tempActiveObj.activePoint.height;\n            parent.activeObj.rotatedAngle = tempActiveObj.rotatedAngle;\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false,\n                value: { actPoint: actPoint, obj: parent.activeObj, isMouseMove: null, x: null, y: null } });\n        }\n    };\n    Selection.prototype.updateActivePoint = function (x, y, isCropSelection) {\n        var parent = this.parent;\n        var obj = { width: 0, height: 0 };\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY;\n        var _b = parent.activeObj.activePoint, width = _b.width, height = _b.height;\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: obj, isImgShape: null } });\n        var previousShapeSettings = this.updatePrevShapeSettings();\n        var shapeResizingArgs = { cancel: false, action: 'resize', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n        var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n        this.shapeResizingArgs = shapeResizingArgs;\n        this.shapeMovingArgs = shapeMovingArgs;\n        if (parent.activeObj.shape === 'text' && this.dragElement !== '') {\n            parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: parent.activeObj, isTextArea: null } });\n        }\n        if (this.currentDrawingShape !== '' && (this.dragElement === '' || this.dragElement === 'move') && parent.isShapeDrawing) {\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                this.dragElement = 'e-resize';\n            }\n            else {\n                if (x > startX && y > startY) {\n                    this.dragElement = 'se-resize';\n                }\n                else if (x < startX && y > startY) {\n                    this.dragElement = 'sw-resize';\n                }\n                else if (x > startX && y < startY) {\n                    this.dragElement = 'ne-resize';\n                }\n                else if (x < startX && y < startY) {\n                    this.dragElement = 'nw-resize';\n                }\n            }\n        }\n        if (parent.activeObj.shape === 'arrow') {\n            if (Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2) > 0) {\n                parent.activeObj.rotatedAngle = -Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2);\n            }\n            else {\n                parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2));\n            }\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (isCropSelection && parent.transform.straighten !== 0 && this.isMouseOutsideImg(x, y)) {\n            return;\n        }\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        var splitWords;\n        var cropResize;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            cropResize = true;\n        }\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y);\n                this.preventResizing(tempActiveObj);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'grabbing':\n                if (Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))) > 0) {\n                    parent.activeObj.rotatedAngle = -Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2)));\n                }\n                else {\n                    parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - (startX + (width / 2)), y - (startY + (height / 2))));\n                }\n                if (parent.activeObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - parent.activeObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        isHorizontalflip = true;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        isVerticalflip = true;\n                    }\n                }\n                parent.activeObj.rotatedAngle -= (degree * (Math.PI / 180));\n                if (degree === 0 || degree === 360) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 90 || degree === -270) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 180 || degree === -180) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 270 || degree === -90) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                this.preventResizing(tempActiveObj);\n                break;\n            case 'pathdrag':\n                if (!isNullOrUndefined(this.pathAdjustedIndex)) {\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].x = x;\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].y = y;\n                }\n                break;\n            default:\n                if (!isCropSelection && !parent.currObjType.isCustomCrop) {\n                    var activePoint = parent.activeObj.activePoint;\n                    if (this.dragPoint.startX) {\n                        var width_1 = (this.dragPoint.endX - this.previousPoint.x);\n                        var height_1 = (this.dragPoint.endY - this.previousPoint.y);\n                        activePoint.startX += width_1;\n                        activePoint.endX += width_1;\n                        activePoint.startY += height_1;\n                        activePoint.endY += height_1;\n                        startX = activePoint.startX;\n                        startY = activePoint.startY;\n                        if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                            parent.activeObj.rotationCirclePointColl) {\n                            parent.activeObj.rotationCirclePointColl.x += width_1;\n                            parent.activeObj.rotationCirclePointColl.y += height_1;\n                            parent.activeObj.rotationCirclePoint.x += width_1;\n                            parent.activeObj.rotationCirclePoint.y += height_1;\n                        }\n                        if (parent.activeObj.shape === 'path') {\n                            for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                                parent.activeObj.pointColl[i].x += width_1;\n                                parent.activeObj.pointColl[i].y += height_1;\n                            }\n                        }\n                        if ((!this.isPreventDragging && this.isShapeDragOut()) && (parent.activeObj.preventShapeDragOut || parent.activeObj.shape === 'redact' || cropResize)) {\n                            activePoint.startX -= width_1;\n                            activePoint.endX -= width_1;\n                            activePoint.startY -= height_1;\n                            activePoint.endY -= height_1;\n                            if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                                parent.activeObj.rotationCirclePointColl) {\n                                parent.activeObj.rotationCirclePointColl.x -= width_1;\n                                parent.activeObj.rotationCirclePointColl.y -= height_1;\n                                parent.activeObj.rotationCirclePoint.x -= width_1;\n                                parent.activeObj.rotationCirclePoint.y -= height_1;\n                            }\n                            else if (parent.activeObj.shape === 'path') {\n                                for (var l = 0, len = parent.activeObj.pointColl.length; l < len; l++) {\n                                    parent.activeObj.pointColl[l].x -= width_1;\n                                    parent.activeObj.pointColl[l].y -= height_1;\n                                }\n                            }\n                            if (parent.activeObj.rotatedAngle === 0) {\n                                var tempEndX = parent.activeObj.activePoint.endX;\n                                var tempEndY = parent.activeObj.activePoint.endY;\n                                if (parent.activeObj.shape === 'path') {\n                                    parent.activeObj.activePoint = parent.getSquarePointForPath(parent.activeObj);\n                                }\n                                this.setDragWidth(width_1);\n                                this.setDragHeight(height_1);\n                                var currObj = parent.activeObj;\n                                var xDiff = currObj.activePoint.endX - tempEndX;\n                                var yDiff = currObj.activePoint.endY - tempEndY;\n                                if (currObj.shape === 'path') {\n                                    for (var l = 0, len = currObj.pointColl.length; l < len; l++) {\n                                        currObj.pointColl[l].x += xDiff;\n                                        currObj.pointColl[l].y += yDiff;\n                                    }\n                                }\n                            }\n                            else {\n                                parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                            }\n                        }\n                    }\n                    else {\n                        activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                        activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                        x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                        y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                        activePoint.endX = x;\n                        activePoint.endY = y;\n                    }\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'move');\n                }\n                break;\n        }\n    };\n    Selection.prototype.isShapeDragOut = function () {\n        var parent = this.parent;\n        var isShapeDragOut = false;\n        var allowPreventing = false;\n        var shape = parent.activeObj.shape;\n        if (parent.activeObj.preventShapeDragOut) {\n            allowPreventing = true;\n        }\n        else if (parent.activeObj.rotatedAngle === 0 &&\n            (shape !== 'line' && shape !== 'arrow' && shape !== 'path')) {\n            allowPreventing = true;\n        }\n        if (allowPreventing) {\n            var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n            if (shape === 'path') {\n                var path = parent.getSquarePointForPath(parent.activeObj);\n                startX = path.startX;\n                startY = path.startY;\n                endX = path.endX;\n                endY = path.endY;\n            }\n            if (parent.activeObj.rotatedAngle === 0 || shape === 'arrow') {\n                isShapeDragOut = this.isObjOutsideImg(startX, startY, endX, endY, shape);\n            }\n            else {\n                var obj = { isIntersect: null, arr: null };\n                parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n                if (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                    isShapeDragOut = true;\n                }\n                else {\n                    isShapeDragOut = this.isObjOutsideImg(startX, startY, endX, endY, shape);\n                }\n            }\n        }\n        return isShapeDragOut;\n    };\n    Selection.prototype.isObjOutsideImg = function (startX, startY, endX, endY, shape) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (startX < destLeft || startY < destTop || endX > destLeft + destWidth ||\n            endY > destTop + destHeight || ((shape === 'line' || shape === 'arrow') &&\n            (startX > destLeft + destWidth || startY > destTop + destHeight ||\n                endX < destLeft || endY < destTop))) {\n            return true;\n        }\n        return false;\n    };\n    Selection.prototype.triggerShapeChange = function (shapeResizingArgs, shapeMovingArgs, type) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        var currentShapeSettings = this.updatePrevShapeSettings();\n        if (!isNullOrUndefined(this.shapeResizingArgs) && !isNullOrUndefined(this.shapeMovingArgs)) {\n            shapeResizingArgs.currentShapeSettings = this.shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = this.shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        else {\n            shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n            shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        }\n        if (type === 'resize') {\n            this.isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.isCropSelection = true;\n            }\n            if (!this.isCropSelection) {\n                if (this.currentDrawingShape !== '' && parent.upperCanvas.style.cursor === 'crosshair') {\n                    shapeResizingArgs.action = 'drawing';\n                }\n                if (!parent.currObjType.isRedact || parent.activeObj.shape !== 'redact') {\n                    parent.trigger('shapeChanging', shapeResizingArgs);\n                }\n                parent.editCompleteArgs = shapeResizingArgs;\n                this.isPreventShaping = shapeResizingArgs.cancel;\n                parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false, value: { shapeSettings: shapeResizingArgs.currentShapeSettings, allowShapeOverflow: shapeResizingArgs.allowShapeOverflow } });\n            }\n            else {\n                if (this.isMouseDown) {\n                    shapeResizingArgs.action = 'resize-start';\n                }\n                else if (this.isMouseUp) {\n                    shapeResizingArgs.action = 'resize-end';\n                }\n                var selectionResizingArgs = { action: shapeResizingArgs.action,\n                    previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.previousShapeSettings.startX,\n                        startY: shapeResizingArgs.previousShapeSettings.startY,\n                        width: shapeResizingArgs.previousShapeSettings.width,\n                        height: shapeResizingArgs.previousShapeSettings.height },\n                    currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.currentShapeSettings.startX,\n                        startY: shapeResizingArgs.currentShapeSettings.startY,\n                        width: shapeResizingArgs.currentShapeSettings.width,\n                        height: shapeResizingArgs.currentShapeSettings.height } };\n                this.selectionResizingArgs = selectionResizingArgs;\n                parent.trigger('selectionChanging', selectionResizingArgs);\n                parent.editCompleteArgs = selectionResizingArgs;\n                parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                    value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n            }\n        }\n        else if (type === 'mouse-down' || type === 'mouse-up') {\n            if (parent.activeObj.shape !== 'redact') {\n                parent.trigger('shapeChanging', shapeResizingArgs);\n            }\n            parent.editCompleteArgs = shapeResizingArgs;\n            this.isPreventShaping = shapeResizingArgs.cancel;\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeResizingArgs.currentShapeSettings, allowShapeOverflow: shapeResizingArgs.allowShapeOverflow } });\n        }\n        else {\n            if (parent.activeObj.shape !== 'redact') {\n                parent.trigger('shapeChanging', shapeMovingArgs);\n            }\n            parent.editCompleteArgs = shapeMovingArgs;\n            this.isPreventShaping = shapeMovingArgs.cancel;\n            parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: shapeMovingArgs.currentShapeSettings, allowShapeOverflow: shapeMovingArgs.allowShapeOverflow } });\n        }\n        parent.eventType = type;\n    };\n    Selection.prototype.setDragWidth = function (width) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destWidth = _a.destWidth;\n        var tempWidth = width;\n        var shape = parent.activeObj.shape;\n        var preventDragOut = false;\n        if (parent.activeObj.preventShapeDragOut && (shape === 'line' || shape === 'arrow')) {\n            preventDragOut = true;\n        }\n        if (tempWidth >= 0) {\n            for (var i = 0; i < tempWidth; i++) {\n                width = tempWidth - i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if ((actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth && !preventDragOut) ||\n                    (actPoint.startX >= destLeft && actPoint.endX <= destLeft + destWidth &&\n                        actPoint.endX >= destLeft && actPoint.startX <= destLeft + destWidth && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n        else {\n            for (var i = 1; i < Math.abs(tempWidth); i++) {\n                width = tempWidth + i;\n                actPoint.startX += width;\n                actPoint.endX += width;\n                if ((actPoint.startX >= destLeft &&\n                    actPoint.endX <= destLeft + destWidth && !preventDragOut) ||\n                    (actPoint.startX >= destLeft && actPoint.endX <= destLeft + destWidth &&\n                        actPoint.endX >= destLeft && actPoint.startX <= destLeft + destWidth && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startX -= width;\n                    actPoint.endX -= width;\n                }\n            }\n        }\n    };\n    Selection.prototype.setDragHeight = function (height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destTop = _a.destTop, destHeight = _a.destHeight;\n        var tempHeight = height;\n        var shape = parent.activeObj.shape;\n        var preventDragOut = false;\n        if (parent.activeObj.preventShapeDragOut && (shape === 'line' || shape === 'arrow')) {\n            preventDragOut = true;\n        }\n        if (tempHeight >= 0) {\n            for (var i = 1; i < tempHeight; i++) {\n                height = tempHeight - i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if ((actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight && !preventDragOut) ||\n                    (actPoint.startY >= destTop && actPoint.endY <= destTop + destHeight &&\n                        actPoint.endY >= destTop && actPoint.startY <= destTop + destHeight && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < Math.abs(tempHeight); i++) {\n                height = tempHeight + i;\n                actPoint.startY += height;\n                actPoint.endY += height;\n                if ((actPoint.startY >= destTop &&\n                    actPoint.endY <= destTop + destHeight && !preventDragOut) ||\n                    (actPoint.startY >= destTop && actPoint.endY <= destTop + destHeight &&\n                        actPoint.endY >= destTop && actPoint.startY <= destTop + destHeight && preventDragOut)) {\n                    break;\n                }\n                else {\n                    actPoint.startY -= height;\n                    actPoint.endY -= height;\n                }\n            }\n        }\n    };\n    Selection.prototype.limitDrag = function (isStart) {\n        var isLimiting = false;\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var actPoint = parent.activeObj.activePoint;\n        var startX = isStart ? actPoint.startX : actPoint.endX;\n        var startY = isStart ? actPoint.startY : actPoint.endY;\n        var endX = isStart ? actPoint.endX : actPoint.startX;\n        var endY = isStart ? actPoint.endY : actPoint.startY;\n        var wrapperWidth = parent.upperCanvas.width;\n        var wrapperHeight = parent.upperCanvas.height;\n        if (Browser.isDevice) {\n            if (startX < 0 && destLeft < 0) {\n                startX = 0;\n            }\n            if (startY < 0 && destTop < 0) {\n                startY = 0;\n            }\n            if (endX > wrapperWidth && destLeft + destWidth > wrapperWidth) {\n                endX = wrapperWidth;\n            }\n            if (endY > wrapperHeight && destTop + destHeight > wrapperHeight) {\n                endY = wrapperHeight;\n            }\n        }\n        else {\n            if (startX < destLeft) {\n                startX = destLeft;\n            }\n            if (startY < destTop) {\n                startY = destTop;\n            }\n            if (endX > destLeft + destWidth) {\n                endX = destLeft + destWidth;\n            }\n            if (endY > destTop + destHeight) {\n                endY = destTop + destHeight;\n            }\n        }\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            if (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                isLimiting = true;\n            }\n        }\n        if (isStart) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = endX;\n            actPoint.endY = endY;\n        }\n        else {\n            actPoint.startX = endX;\n            actPoint.startY = endY;\n            actPoint.endX = startX;\n            actPoint.endY = startY;\n        }\n        return isLimiting;\n    };\n    Selection.prototype.isMouseOutsideImg = function (x, y) {\n        var obj = { bool: false };\n        this.parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        this.parent.notify('draw', { prop: 'isPointsInsideImg', value: { obj: obj, x: x, y: y } });\n        return obj['bool'];\n    };\n    Selection.prototype.preventDraggingInvertly = function () {\n        var isLimiting = false;\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'image') {\n            return isLimiting;\n        }\n        var splitWords;\n        var cropResize;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            cropResize = true;\n        }\n        if ((!this.isPreventDragging && parent.activeObj.rotatedAngle === 0) && (parent.activeObj.preventShapeDragOut || parent.activeObj.shape === 'redact' || cropResize)) {\n            isLimiting = this.limitDrag(true);\n            var shapeColl = ['line', 'arrow', 'path'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                isLimiting = this.limitDrag(false);\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventTextDraggingInvertly = function () {\n        var parent = this.parent;\n        var isLimiting = false;\n        var actPoint = parent.activeObj.activePoint;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (!this.isPreventDragging) {\n            if (actPoint.startX < destLeft ||\n                actPoint.startY < destTop ||\n                actPoint.endX > destLeft + destWidth ||\n                actPoint.endY > destTop + destHeight) {\n                isLimiting = true;\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventInverseResize = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (actPoint.width < 0) {\n            actPoint.width = 0;\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n        }\n        if (actPoint.height < 0) {\n            actPoint.height = 0;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.getScaleRatio = function (scale) {\n        var parent = this.parent;\n        var point = { x: scale, y: scale };\n        if (parent.activeObj.shape && parent.activeObj.shape !== 'crop-custom' &&\n            parent.activeObj.shape !== 'crop-circle' && parent.activeObj.shape !== 'crop-square') {\n            var ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ?\n                this.findImageRatio(parent.activeObj.activePoint.width, parent.activeObj.activePoint.height).split('-') :\n                parent.activeObj.shape.split('-');\n            if (ratio.length > 1 || parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text') {\n                ratio = parent.activeObj.shape === 'image' || parent.activeObj.shape === 'text' ? ratio[0].split(':') : ratio[1].split(':');\n                var newScale = scale / (parseInt(ratio[1], 10));\n                point.x = newScale * (parseInt(ratio[0], 10));\n                point.y = newScale * (parseInt(ratio[1], 10));\n            }\n        }\n        return point;\n    };\n    Selection.prototype.findImageRatio = function (width, height, obj) {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        var gcd = function (a, b) {\n            if (b === 0) {\n                return a;\n            }\n            return gcd(b, a % b);\n        };\n        var divisor = gcd(width, height);\n        var ratio = width / divisor + \":\" + height / divisor;\n        if (obj) {\n            obj['ratio'] = ratio;\n        }\n        return ratio;\n    };\n    Selection.prototype.revertResizing = function (tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (this.preventDraggingInvertly()) {\n            actPoint.startX = tempActiveObj.activePoint.startX;\n            actPoint.startY = tempActiveObj.activePoint.startY;\n            actPoint.endX = tempActiveObj.activePoint.endX;\n            actPoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.performSEResize = function (x, y, tempActiveObj, actPoint) {\n        var parent = this.parent;\n        this.resizeImg(x, y, 'se-resize', tempActiveObj);\n        if (actPoint.endX < actPoint.startX) {\n            var temp = actPoint.endX;\n            actPoint.endX = actPoint.startX;\n            actPoint.startX = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        if (actPoint.endY < actPoint.startY) {\n            var temp = actPoint.endY;\n            actPoint.endY = actPoint.startY;\n            actPoint.startY = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        this.revertCustomSelection(actPoint, tempActiveObj, 'se-resize');\n        this.revertResizing(tempActiveObj);\n    };\n    Selection.prototype.performNWResize = function (x, y, tempActiveObj, actPoint) {\n        var parent = this.parent;\n        this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n        if (actPoint.startX > actPoint.endX) {\n            var temp = actPoint.startX;\n            actPoint.startX = actPoint.endX;\n            actPoint.endX = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        if (actPoint.startY > actPoint.endY) {\n            var temp = actPoint.startY;\n            actPoint.startY = actPoint.endY;\n            actPoint.endY = temp;\n            this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        this.revertCustomSelection(actPoint, tempActiveObj, 'nw-resize');\n        this.revertResizing(tempActiveObj);\n    };\n    Selection.prototype.isCustomSelection = function () {\n        if (this.parent.activeObj.shape) {\n            var shapeColl = ['custom', 'circle', 'square', '2:3', '3:2', '3:4', '4:3', '4:5', '5:4', '5:7', '7:5', '9:16', '16:9'];\n            return this.parent.activeObj.shape.indexOf('crop-') > -1 && shapeColl.indexOf(this.parent.activeObj.shape.split('-')[1]) === -1;\n        }\n        return false;\n    };\n    Selection.prototype.revertCustomSelection = function (actPoint, tempActiveObj, type) {\n        var parent = this.parent;\n        if (this.isCustomSelection()) {\n            var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n            var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                destLeft + destWidth : parent.lowerCanvas.width;\n            var endY = destTop + destHeight < parent.lowerCanvas.height ?\n                destTop + destHeight : parent.lowerCanvas.height;\n            var left = destLeft > 0 ? destLeft : 0;\n            var top_1 = destTop > 0 ? destTop : 0;\n            var endY1 = destTop > 0 ? destTop : 0;\n            var endX1 = destLeft > 0 ? destLeft : 0;\n            if ((type === 'se-resize' && (actPoint.endX > endX || actPoint.endY > endY)) ||\n                (type === 'nw-resize' && (actPoint.startX < left || actPoint.startY < top_1)) ||\n                (type === 'ne-resize' && (actPoint.endX > endX || actPoint.startY < endY1)) ||\n                (type === 'sw-resize' && (actPoint.startX < endX1 || actPoint.endY > endY))) {\n                this.revertPoints(actPoint, tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.revertPoints = function (actPoint, tempActiveObj) {\n        actPoint.startX = tempActiveObj.activePoint.startX;\n        actPoint.startY = tempActiveObj.activePoint.startY;\n        actPoint.endX = tempActiveObj.activePoint.endX;\n        actPoint.endY = tempActiveObj.activePoint.endY;\n        actPoint.width = tempActiveObj.activePoint.width;\n        actPoint.height = tempActiveObj.activePoint.height;\n    };\n    Selection.prototype.updateNWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'nw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'nw-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop;\n                if (actPoint.startX < x && actPoint.startY < y) {\n                    width = x - actPoint.startX;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.startY += newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_2 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_2) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var left = destLeft > 0 ? destLeft : 0;\n                    var top_3 = destTop > 0 ? destTop : 0;\n                    if (actPoint.startX < left || actPoint.startY < top_3) {\n                        actPoint.startX += newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateNPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = this.resizedElement = 's-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth;\n                if (this.isCustomSelection()) {\n                    this.performNWResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.startY < destTop) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateNEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'ne-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustNEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                if (actPoint.startY > actPoint.endY) {\n                    var temp = actPoint.startY;\n                    actPoint.startY = actPoint.endY;\n                    actPoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'ne-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth;\n                if (actPoint.endX > x && actPoint.startY < y) {\n                    width = actPoint.endX - x;\n                    height = y - actPoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.startY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = actPoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.startY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop > 0 ? destTop : 0;\n                    if (actPoint.endX > endX || actPoint.startY < endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.startY += newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.startX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.startY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'e-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = this.resizedElement = 'e-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performNWResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.startX < destLeft || actPoint.endY >\n                        (destTop + destHeight)) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endX = x;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'w-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = this.resizedElement = 'w-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performSEResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSWPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'sw-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSWPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.startX > actPoint.endX) {\n                    var temp = actPoint.startX;\n                    actPoint.startX = actPoint.endX;\n                    actPoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'sw-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destHeight = _a.destHeight;\n                if (actPoint.startX < x && actPoint.endY > y) {\n                    width = x - actPoint.startX;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX += newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX -= newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = actPoint.startX - x;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.startX -= newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft > 0 ? destLeft : 0;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.startX < endX || actPoint.endY > endY) {\n                        actPoint.startX += newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateSPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(actPoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    actPoint.endY = y;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = this.resizedElement = 'n-resize';\n                }\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (this.isCustomSelection()) {\n                    this.performSEResize(x, y, tempActiveObj, actPoint);\n                }\n                else if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.x;\n                    if (actPoint.endX > (destLeft + destWidth) ||\n                        actPoint.endY > (destTop + destHeight)) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n        }\n    };\n    Selection.prototype.updateSEPoints = function (x, y) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            this.resizeImg(x, y, 'se-resize', tempActiveObj);\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            var newScale = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')\n                || this.isCustomSelection()) {\n                if (parent.activeObj.shape === 'image' || this.isCustomSelection()) {\n                    this.resizeImg(x, y, 'se-resize', tempActiveObj);\n                }\n                else {\n                    this.adjustSEPoints(actPoint, x, y, parent.activeObj.rotatedAngle);\n                }\n                if (actPoint.endX < actPoint.startX) {\n                    var temp = actPoint.endX;\n                    actPoint.endX = actPoint.startX;\n                    actPoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                if (actPoint.endY < actPoint.startY) {\n                    var temp = actPoint.endY;\n                    actPoint.endY = actPoint.startY;\n                    actPoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                this.revertCustomSelection(actPoint, tempActiveObj, 'se-resize');\n                this.revertResizing(tempActiveObj);\n            }\n            else {\n                var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n                if (actPoint.endX > x && actPoint.endY > y) {\n                    width = actPoint.endX - x;\n                    height = actPoint.endY - y;\n                    scale = Math.min(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX -= newScale.x;\n                    actPoint.endY -= newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ?\n                        destLeft + destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ?\n                        destTop + destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX += newScale.x;\n                        actPoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - actPoint.endX;\n                    height = y - actPoint.endY;\n                    scale = Math.max(width, height);\n                    newScale = this.getScaleRatio(scale);\n                    actPoint.endX += newScale.x;\n                    actPoint.endY += newScale.y;\n                    var endX = destLeft + destWidth < parent.lowerCanvas.width ? destLeft +\n                        destWidth : parent.lowerCanvas.width;\n                    var endY = destTop + destHeight < parent.lowerCanvas.height ? destTop +\n                        destHeight : parent.lowerCanvas.height;\n                    if (actPoint.endX > endX || actPoint.endY > endY) {\n                        actPoint.endX -= newScale.x;\n                        actPoint.endY -= newScale.y;\n                    }\n                }\n                actPoint.width = actPoint.endX - actPoint.startX;\n                actPoint.height = actPoint.endY - actPoint.startY;\n                this.revertResizing(tempActiveObj);\n            }\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.resizeImg = function (x, y, elem, tempActiveObj) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var width;\n        var height;\n        var scale;\n        var newScale;\n        if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n            if (this.currentDrawingShape === 'text') {\n                this.setCursor(x, y);\n                if (parent.activeObj.textSettings.fontSize === 0) {\n                    parent.activeObj.textSettings.fontSize = 11;\n                    parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                        value: { obj: parent.activeObj, isTextArea: null } });\n                    parent.activeObj.textSettings.text = parent.activeObj.keyHistory = 'Enter Text';\n                    parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                        value: { isTextBox: null } });\n                    var width_2 = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                        parent.activeObj.textSettings.fontSize * 0.5;\n                    actPoint.endX = actPoint.startX + width_2;\n                    actPoint.endY = actPoint.startY + parent.activeObj.textSettings.fontSize;\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    tempActiveObj = extend({}, parent.activeObj, null, true);\n                    parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                            isMouseMove: null, x: null, y: null } });\n                }\n            }\n            switch (parent.upperCanvas.style.cursor) {\n                case 'se-resize':\n                case 's-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'sw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y > y) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'w-resize':\n                case 'nw-resize':\n                    if (this.previousPoint.x < x || this.previousPoint.y < y) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'n-resize':\n                case 'ne-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y < y) {\n                        width = (this.previousPoint.x - x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n                case 'e-resize':\n                    if (this.previousPoint.x > x || this.previousPoint.y > y) {\n                        width = (this.previousPoint.x - x);\n                        height = (this.previousPoint.y - y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, -Math.abs(newScale.x), -Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    else if (this.previousPoint.x !== 0 && this.previousPoint.y !== 0) {\n                        width = (x - this.previousPoint.x);\n                        height = (y - this.previousPoint.y);\n                        scale = (width + height) / 2;\n                        newScale = this.getScaleRatio(scale);\n                        this.adjustRotationPoints(actPoint, Math.abs(newScale.x), Math.abs(newScale.y), parent.activeObj.rotatedAngle, 'img-resize', elem);\n                    }\n                    break;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            if ((actPoint.width < 10 || actPoint.height < 10) ||\n                (parent.activeObj.shape === 'text' && parent.activeObj.rotatedAngle === 0 && this.preventTextDraggingInvertly())) {\n                parent.activeObj = extend({}, tempActiveObj, null, true);\n            }\n        }\n        this.previousPoint = { x: x, y: y };\n    };\n    Selection.prototype.adjustNWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedC[0] + x) / 2, (rotatedC[1] + y) / 2];\n        var newBottomRight = this.rotatePoints(rotatedC[0], rotatedC[1], newCenter[0], newCenter[1], -angle);\n        var newTopLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newBottomRight[0];\n        rectangle.endY = newBottomRight[1];\n        rectangle.startY = newTopLeft[1];\n        rectangle.startX = newTopLeft[0];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustNEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedD[0] + x) / 2, (rotatedD[1] + y) / 2];\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = newTopRight[0] - newBottomLeft[0];\n        rectangle.height = newBottomLeft[1] - newTopRight[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.startY = rectangle.endY - rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustSWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedB[0] + x) / 2, (rotatedB[1] + y) / 2];\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newTopRight[0];\n        rectangle.startY = newTopRight[1];\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustSEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + x) / 2, (rotatedA[1] + y) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.width = newBottomRight[0] - newTopLeft[0];\n        rectangle.height = newBottomRight[1] - newTopLeft[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.endY = rectangle.startY + rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustRotationPoints = function (rectangle, x, y, angle, type, elem) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        this.getResizeDirection(rectangle, x, y, angle, type, elem);\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + rotatedC[0]) / 2, (rotatedA[1] + rotatedC[1]) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.endX = newTopRight[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.rotatePoints = function (x, y, cx, cy, angle) {\n        return [\n            (x - cx) * Math.cos(angle) - (y - cy) * Math.sin(angle) + cx,\n            (x - cx) * Math.sin(angle) + (y - cy) * Math.cos(angle) + cy\n        ];\n    };\n    Selection.prototype.setResizedValue = function (element, value, x, y) {\n        switch (element) {\n            case 'x':\n                value += x;\n                break;\n            case 'y':\n                value += y;\n                break;\n            case 'abs-x':\n                value += (x > 0 ? -x : Math.abs(x));\n                break;\n            case 'abs-y':\n                value += (y > 0 ? -y : Math.abs(y));\n                break;\n            case 'y-abs-x':\n                value += (y + ((x > 0 ? -x : Math.abs(x)) / 2));\n                break;\n            case 'abs-x-abs-y':\n                value += ((x > 0 ? -x : Math.abs(x)) + ((y > 0 ? -y : Math.abs(y)) / 2));\n                break;\n            case 'abs-y-x':\n                value += ((y > 0 ? -y : Math.abs(y)) + (x / 2));\n                break;\n            case 'x-y':\n                value += (x + (y / 2));\n                break;\n            case 'y-x':\n                value += (y + (x / 2));\n                break;\n            case 'img-resize-x':\n                value += x;\n                break;\n            case 'img-resize-y':\n                value += y;\n                break;\n        }\n        return value;\n    };\n    Selection.prototype.getResizeDirection = function (rectangle, x, y, angle, type, elem) {\n        var rotatedAngle = angle * (180 / Math.PI);\n        var element = this.getResizedElement(rotatedAngle, this.resizedElement);\n        if (this.resizedElement === 'e-resize') {\n            rectangle.width = this.setResizedValue(element, rectangle.width, x, y);\n            rectangle.endX = rectangle.width + rectangle.startX;\n        }\n        else if (this.resizedElement === 'n-resize') {\n            rectangle.startY = this.setResizedValue(element, rectangle.startY, x, y);\n            rectangle.height = rectangle.endY - rectangle.startY;\n        }\n        else if (this.resizedElement === 'w-resize') {\n            rectangle.startX = this.setResizedValue(element, rectangle.startX, x, y);\n            rectangle.width = rectangle.startX + rectangle.endX;\n        }\n        else if (this.resizedElement === 's-resize') {\n            rectangle.height = this.setResizedValue(element, rectangle.height, x, y);\n            rectangle.endY = rectangle.height + rectangle.startY;\n        }\n        else if (type && type === 'img-resize') {\n            rectangle.width = this.setResizedValue('img-resize-x', rectangle.width, x, y);\n            rectangle.height = this.setResizedValue('img-resize-y', rectangle.height, x, y);\n            if (elem === 'se-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'sw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'ne-resize') {\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n            else if (elem === 'nw-resize') {\n                rectangle.startX = rectangle.endX - rectangle.width;\n                rectangle.startY = rectangle.endY - rectangle.height;\n            }\n        }\n        else if (type && type === 'text') {\n            if (elem === 'widthHeight') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n                rectangle.height = this.setResizedValue('y-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n            else if (elem === 'width') {\n                rectangle.width = this.setResizedValue('x-y', rectangle.width, x, y);\n                rectangle.endX = rectangle.width + rectangle.startX;\n            }\n            else if (elem === 'height') {\n                rectangle.height = this.setResizedValue('y-abs-x', rectangle.height, x, y);\n                rectangle.endY = rectangle.height + rectangle.startY;\n            }\n        }\n    };\n    Selection.prototype.getResizedElement = function (degree, element) {\n        var resizeMappings = [];\n        if (element === 'n-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'e-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        else if (element === 's-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'w-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_2 = resizeMappings; _i < resizeMappings_2.length; _i++) {\n            var _a = resizeMappings_2[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.updateCursorStyles = function (x, y, type) {\n        var parent = this.parent;\n        var isResize = false;\n        if (parent.activeObj.keyHistory !== '' && parent.activeObj.shape === undefined && !parent.currObjType.isCustomCrop &&\n            !parent.currObjType.isLine && parent.currObjType.isText) {\n            parent.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        var degree;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (this.isObjSelected) {\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                isResize = this.updateCursorStylesForLineArrow(x, y, actObj);\n            }\n            else if (actObj.shape === 'path') {\n                isResize = this.updateCursorStylesForPath(x, y, actObj);\n            }\n            else if (actObj.rotatedAngle) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.cursor;\n                }\n                else if (parent.cursor === 'move') {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                else if (parent.cursor !== 'default') {\n                    isResize = true;\n                    this.dragElement = parent.cursor;\n                    parent.currObjType.isResize = true;\n                }\n            }\n            else {\n                var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                var radius = actObj.topLeftCircle.radius;\n                if (rotationCirclePoint &&\n                    x >= rotationCirclePoint.x - (radius * 2) &&\n                    x <= rotationCirclePoint.x + (radius * 2) &&\n                    y >= rotationCirclePoint.y - (radius * 2) &&\n                    y <= rotationCirclePoint.y + (radius * 2) && this.dragElement !== 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topLeftCircle.startY + (radius * 2)) && this.dragElement !== 'nw-resize') {\n                    actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.topCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topCenterCircle.startY + (radius * 2)) && this.dragElement !== 'n-resize') {\n                    actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'n-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.topRightCircle.startY + (radius * 2)) && this.dragElement !== 'ne-resize') {\n                    actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY - (radius * 2)) && this.dragElement !== 'w-resize') {\n                    actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'w-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.centerRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY - (radius * 2)) && this.dragElement !== 'e-resize') {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'e-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (radius * 2)) && this.dragElement !== 'sw-resize') {\n                    actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (radius * 2)) && this.dragElement !== 's-resize') {\n                    actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 's-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX + (radius * 2)) &&\n                    y >= (actObj.bottomRightCircle.startY - (radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY + (radius * 2)) && this.dragElement !== 'se-resize') {\n                    actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                if ((actObj.shape === 'text') && (parent.cursor === 'n-resize' ||\n                    parent.cursor === 's-resize' || parent.cursor === 'e-resize' ||\n                    parent.cursor === 'w-resize')) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n            }\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY) || this.dragElement === 'grabbing') {\n                parent.currObjType.isDragging = true;\n            }\n            else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n        }\n        else {\n            parent.currObjType.isDragging = true;\n        }\n        if (actObj.rotatedAngle !== 0 && (this.dragElement === 'e-resize' ||\n            this.dragElement === 'w-resize' || this.dragElement === 'n-resize' ||\n            this.dragElement === 's-resize')) {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n    };\n    Selection.prototype.updateCursorStylesForLineArrow = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        var point;\n        var radius = actObj.topLeftCircle.radius;\n        for (var i = 0; i < 5; i++) {\n            point = actObj.pointColl[i];\n            if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                this.dragElement = 'w-resize';\n                isResize = true;\n                break;\n            }\n        }\n        if (!isResize) {\n            for (var i = 1; i < 6; i++) {\n                point = actObj.pointColl[actObj.pointColl.length - i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    this.dragElement = 'e-resize';\n                    isResize = true;\n                    break;\n                }\n            }\n        }\n        if (!isResize) {\n            for (var i = 0; i < actObj.pointColl.length; i++) {\n                point = actObj.pointColl[i];\n                if (x >= (point.x - (radius * 2)) && x <= (point.x + (radius * 2)) &&\n                    y >= (point.y - (radius * 2)) && y <= (point.y + (radius * 2))) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                    break;\n                }\n                else {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                }\n            }\n        }\n        return isResize;\n    };\n    Selection.prototype.updateCursorStylesForPath = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        this.pathAdjustedIndex = this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n        if (parent.cursor === 'move') {\n            isResize = true;\n            this.dragElement = 'pathDrag';\n        }\n        if (!isResize) {\n            parent.upperCanvas.style.cursor = parent.cursor = 'move';\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        return isResize;\n    };\n    Selection.prototype.setTextSelection = function (width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var degree = parent.transform.degree;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var coll = parent.activeObj.rotateFlipColl;\n        if (this.isTransformedShape && coll) {\n            degree = 0;\n            for (var i = 0; i < coll.length; i++) {\n                if (typeof (coll[i]) === 'number') {\n                    degree += (coll[i]);\n                }\n            }\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n            var flip = parent.activeObj.flipObjColl[i].toLowerCase();\n            switch (degree) {\n                case 0:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint = { startX: actPoint.endX - width, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (height ? height : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                                endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint = { startX: actPoint.startX,\n                                startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)), endY: actPoint.startY +\n                                    (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 90:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        case 'vertical':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - width, endX: (actPoint.endX), endY: actPoint.endY };\n                            break;\n                        default:\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                    }\n                    break;\n                case 180:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startY = actPoint.endY - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + width),\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint.endY = actPoint.startY + height;\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.startY };\n                            break;\n                        default:\n                            actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                                startY: actPoint.endY - (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 270:\n                    switch (flip) {\n                        case 'horizontal':\n                            actPoint.startX = actPoint.endX - height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                        case 'vertical':\n                            actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + height),\n                                endY: actPoint.startY + (width ? width : 0) };\n                            break;\n                        default:\n                            actPoint.endX = actPoint.startX + height;\n                            actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                                endY: actPoint.endY };\n                            break;\n                    }\n                    break;\n            }\n        }\n        if (parent.activeObj.flipObjColl.length === 0) {\n            switch (degree) {\n                case 0:\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.startX + (width ? width : 0)),\n                        endY: actPoint.startY + (height ? height : 0) };\n                    break;\n                case 90:\n                    actPoint.startX = actPoint.endX - height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.startY, endX: (actPoint.endX),\n                        endY: actPoint.startY + (width ? width : 0) };\n                    break;\n                case 180:\n                    actPoint = { endX: actPoint.endX, endY: actPoint.endY, startX: (actPoint.endX - (width ? width : 0)),\n                        startY: actPoint.endY - (height ? height : 0) };\n                    break;\n                case 270:\n                    actPoint.endX = actPoint.startX + height;\n                    actPoint = { startX: actPoint.startX, startY: actPoint.endY - (width ? width : 0), endX: actPoint.endX,\n                        endY: actPoint.endY };\n                    break;\n            }\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        parent.activeObj.activePoint = actPoint;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Selection.prototype.setActivePoint = function (startX, startY) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        if (isNullOrUndefined(activePoint)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : parent.activeObj.textSettings.fontSize;\n            if (parent.activeObj.textSettings.fontSize === undefined) {\n                parent.activeObj.textSettings.fontSize = (Math.abs(parent.baseImgCanvas.width - parent.baseImgCanvas.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = activePoint.endX;\n            this.mouseDownPoint.y = activePoint.endY;\n            if (parent.activeObj.horTopLine !== undefined) {\n                parent.activeObj.activePoint = extend({}, activePoint, {}, true);\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n        else if (startX && startY) {\n            activePoint.startX = this.mouseDownPoint.x = startX;\n            activePoint.startY = this.mouseDownPoint.y = startY;\n            parent.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = parent.activeObj;\n            activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            activePoint.width = activePoint.endX - activePoint.startX;\n            activePoint.height = activePoint.endY - activePoint.startY;\n        }\n    };\n    Selection.prototype.mouseDownEventHandler = function (e) {\n        var parent = this.parent;\n        parent.isKBDNavigation = false;\n        this.mouseDown = e.currentTarget === parent.lowerCanvas || e.currentTarget === parent.upperCanvas ?\n            'canvas' : '';\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n        }\n        else {\n            this.isTouch = false;\n        }\n        if (e.type === 'touchstart' && e.currentTarget === parent.lowerCanvas && !parent.isImageLoaded) {\n            return;\n        }\n        this.isCropSelection = false;\n        this.isPan = true;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            this.isCropSelection = true;\n        }\n        if (this.isCropSelection) {\n            this.dragCanvas = parent.togglePan = true;\n        }\n        if (parent.cursor === 'grabbing') {\n            var obj = { shapeSettingsObj: {} };\n            this.isGrabbing = true;\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotate-start', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotate-start', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n        }\n        var imageEditorClickEventArgs = { point: this.setXYPoints(e) };\n        parent.trigger('click', imageEditorClickEventArgs);\n        this.isMouseDown = true;\n        this.isMouseUp = false;\n        this.clickEvent(imageEditorClickEventArgs, e);\n    };\n    Selection.prototype.getImagePoints = function (x, y) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (x < destLeft) {\n            x = destLeft;\n        }\n        else if (x > destLeft + destWidth) {\n            x = destLeft + destWidth;\n        }\n        if (y < destTop) {\n            y = destTop;\n        }\n        else if (y > destTop + destHeight) {\n            y = destTop + destHeight;\n        }\n        return { x: x, y: y };\n    };\n    Selection.prototype.clickEvent = function (imageEditorClickEventArgs, e) {\n        var parent = this.parent;\n        var activePoint = parent.activeObj.activePoint;\n        var x = imageEditorClickEventArgs.point.x;\n        var y = imageEditorClickEventArgs.point.y;\n        var cursor = parent.activeObj.shape && parent.activeObj.shape === 'text' ?\n            parent.cursor : 'default';\n        var tempCursor = parent.upperCanvas.style.cursor;\n        if (parent.isResize) {\n            this.performEnterAction();\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        else if (JSON.stringify(parent.frameObj) !== JSON.stringify(parent.tempFrameObj)) {\n            parent.okBtn();\n        }\n        else if (this.currentDrawingShape !== '' && (!this.isShapeTouch(e, this.isCropSelection) &&\n            ((this.isTouch) || tempCursor === 'crosshair' || parent.isShapeDrawing))) {\n            if (parent.drawingShape && !parent.isShapeDrawing) {\n                parent.okBtn();\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            }\n            activePoint = parent.activeObj.activePoint;\n            var object_1 = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_1 } });\n            this.initialPrevObj = object_1['currObj'];\n            this.initialPrevObj.objColl = extend([], parent.objColl, [], true);\n            this.initialPrevObj.pointColl = extend([], parent.pointColl, [], true);\n            this.initialPrevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.initialPrevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.setActivePoint(x, y);\n            activePoint = parent.activeObj.activePoint;\n            if (this.currentDrawingShape === 'path') {\n                var point = this.getImagePoints(x, y);\n                parent.activeObj.pointColl.push({ x: point.x, y: point.y });\n                if (activePoint.width !== 0 && activePoint.height !== 0) {\n                    activePoint.width = 0;\n                    activePoint.height = 0;\n                    activePoint.startX = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].x;\n                    activePoint.startY = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].y;\n                }\n            }\n            activePoint.endX = activePoint.startX;\n            activePoint.endY = activePoint.startY;\n            if (this.currentDrawingShape === 'text') {\n                parent.activeObj.textSettings.fontSize = 11;\n                this.previousPoint.x = activePoint.startX;\n                this.previousPoint.y = activePoint.startY;\n                parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                    value: { isTextBox: null } });\n                var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width + parent.activeObj.textSettings.fontSize * 0.5;\n                activePoint.endX = activePoint.startX + width;\n                activePoint.endY = activePoint.startY + parent.activeObj.textSettings.fontSize;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n            }\n            else if (this.currentDrawingShape === 'arrow') {\n                parent.activeObj.start = this.arrowShape[0];\n                parent.activeObj.end = this.arrowShape[1];\n            }\n            parent.currObjType.isDragging = true;\n            var previousShapeSettings = this.updatePrevShapeSettings();\n            var shapeResizingArgs = { cancel: false, action: 'draw-start', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.shapeResizingArgs = shapeResizingArgs;\n            this.shapeMovingArgs = shapeMovingArgs;\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n            parent.activeObj.activePoint = activePoint;\n            parent.isShapeDrawing = true;\n            this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n            return;\n        }\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        if (this.isCropSelection && this.dragCanvas) {\n            this.setCursor(x, y);\n            if (parent.cursor !== 'move' && parent.cursor !== 'crosshair' &&\n                parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                this.isPan = false;\n            }\n        }\n        if (parent.activeObj.shape) {\n            this.isObjSelected = true;\n        }\n        else {\n            this.isObjSelected = false;\n        }\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var isShape = this.isShapeTouch(e, this.isCropSelection);\n        var isFreehandDraw = this.isFreehandDrawTouch(e, this.isCropSelection);\n        var isShapeClick = isShape ? isShape : this.isShapeClick(e, this.isCropSelection);\n        var allowUndoRedoPush = this.applyCurrShape(isShapeClick);\n        var isTextArea = parent.textArea.style.display !== 'none' ? true : false;\n        if (this.isTouch && !isShape && activeObj.shape && !this.isCropSelection) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        if (!isShape && !parent.togglePen && !this.isCropSelection && parent.activeObj.redactType !== 'blur' && parent.activeObj.redactType !== 'pixelate') {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        if (this.dragCanvas && this.isPan && (parent.cursor === 'grab' || this.isTouch)\n            && !isShape && !isFreehandDraw && !parent.togglePen) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_1 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_1;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            if (this.isFhdEditing) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.isFhdCustomized = false;\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            var shape = parent.activeObj.shape;\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image', 'redact'];\n            if (shape && shapeColl.indexOf(shape) > -1) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            var isCropSelection = false;\n            if (parent.activeObj.shape && parent.activeObj.shape.indexOf('crop-') > -1) {\n                isCropSelection = true;\n            }\n            if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !isCropSelection) {\n                if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                    parent.okBtn();\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n            }\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            var isLineArrow = false;\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'line' ||\n                parent.activeObj.shape === 'arrow')) {\n                isLineArrow = true;\n            }\n            var points = this.setXYPoints(e);\n            var x_1 = points.x;\n            var y_1 = points.y;\n            if (this.applyObj(x_1, y_1)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    var cursor_2 = parent.cursor;\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    parent.cursor = cursor_2;\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: x_1, y: y_1, isMouseDown: true } });\n            var obj = { index: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawHoveredIndex', onPropertyChange: false, value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (this.isFhdPoint || (this.isFhdCustomized && !parent.togglePen)) {\n                if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) &&\n                    indexObj['freehandSelectedIndex'] !== obj['index']) {\n                    var tempHoveredIndex = obj['index'];\n                    parent.okBtn();\n                    this.isFhdCustomized = false;\n                    parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                        value: { index: tempHoveredIndex } });\n                    if (obj['index'] > -1) {\n                        var strokeColor = parent.pointColl[obj['index']].strokeColor;\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[obj['index']].strokeWidth } });\n                    }\n                }\n                indexObj['freehandSelectedIndex'] = null;\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                var objColl = extend([], parent.objColl, [], true);\n                if (!isNullOrUndefined(obj['index']) && obj['index'] > -1) {\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { type: 'ok' } });\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: null, strokeWidth: null } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                }\n                else if (indexObj['freehandSelectedIndex']) {\n                    parent.okBtn();\n                    var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth } });\n                }\n                else if (this.findTargetObj(x_1, y_1, false)) {\n                    parent.objColl = objColl;\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n            else {\n                if (this.isFhdEditing) {\n                    parent.apply();\n                    var qbArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n                    if (qbArea) {\n                        qbArea.style.display = 'none';\n                    }\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var point = parent.pointColl[indexObj['freehandSelectedIndex']];\n                    var shapeSettings = { id: 'pen_' + (indexObj['freehandSelectedIndex'] + 1), type: ShapeType.FreehandDraw,\n                        startX: point.points[0].x, startY: point.points[0].y, strokeColor: point.strokeColor,\n                        strokeWidth: point.strokeWidth, points: point.points, opacity: point.opacity,\n                        index: point.order };\n                    var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n                    parent.trigger('shapeChange', shapeChangedArgs);\n                    parent.editCompleteArgs = shapeChangedArgs;\n                }\n                var isPenDraw = parent.togglePen;\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n                if (isPenDraw) {\n                    parent.freeHandDraw(true);\n                }\n                this.isFhdEditing = false;\n                if (isLineArrow) {\n                    this.setCursor(x_1, y_1);\n                }\n                else if (cursor !== 'default') {\n                    parent.upperCanvas.style.cursor = parent.cursor = cursor;\n                }\n                if (parent.cursor === 'crosshair' || (Browser.isDevice && parent.togglePen)) {\n                    if (parent.togglePen) {\n                        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                            var obj_1 = { strokeSettings: {} };\n                            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                            parent.activeObj.strokeSettings = obj_1['strokeSettings'];\n                        }\n                        var obj_2 = { penStrokeWidth: null };\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_2 } });\n                        if (isNullOrUndefined(obj_2['penStrokeWidth'])) {\n                            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n                        }\n                        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n                        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                        parent.notify('freehand-draw', { prop: 'resetSelPoints', onPropertyChange: false });\n                        parent.notify('freehand-draw', { prop: 'freehandDownHandler', onPropertyChange: false,\n                            value: { e: e, canvas: parent.upperCanvas } });\n                    }\n                    else {\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    parent.currObjType.isActiveObj = false;\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                }\n                if (((this.isTouch && tempCursor !== 'crosshair' || parent.cursor !== 'crosshair') &&\n                    e.type.toLowerCase() === 'touchstart') ||\n                    (parent.currObjType.isActiveObj && parent.cursor !== 'default' && !parent.togglePen)) {\n                    parent.notify('draw', { prop: 'updateTempObjColl' });\n                    parent.notify('draw', { prop: 'updateTempPointColl' });\n                    this.findTarget(x_1, y_1, e.type);\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                else if ((parent.currObjType.shape === '' || parent.currObjType.isCustomCrop) && !parent.togglePen && parent.cursor !== 'default') {\n                    this.setActivePoint(x_1, y_1);\n                }\n                if (isTextArea) {\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                }\n            }\n        }\n        this.isShapeInserted = false;\n        this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n    };\n    Selection.prototype.mouseMoveEventHandler = function (e) {\n        var parent = this.parent;\n        var cursor = parent.cursor;\n        var canvasCursor = parent.upperCanvas.style.cursor;\n        e.preventDefault();\n        if (this.isPreventShaping || (parent.isShapeDrawing && parent.currObjType.isDragging && this.isTouch &&\n            parent.activeObj.shape && parent.activeObj.shape === 'path')) {\n            return;\n        }\n        if (parent.cursor === 'grabbing' && this.isGrabbing) {\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotating', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotating', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-down');\n        }\n        if (this.timer && this.timer > 0 && this.dragPoint.startX && this.dragPoint.startY) {\n            var width = Math.abs(this.dragPoint.startX - e.touches[0].clientX);\n            var height = Math.abs(this.dragPoint.startY - e.touches[0].clientY);\n            if (width > 10 || height > 10) {\n                this.timer = 0;\n            }\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        if (e.type === 'touchmove' && e.touches.length === 2) {\n            if (this.isFirstMove) {\n                this.startTouches = this.targetTouches(e.touches);\n                this.tempTouches = [];\n                this.tempTouches.push({ x: (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft) - bbox.left),\n                    y: (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n                this.tempTouches.push({ x: (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left,\n                    y: (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n            }\n            else {\n                var firstFingerX = (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var firstFingerY = (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var secondFingerX = (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var secondFingerY = (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var center = { x: firstFingerX < secondFingerX ? secondFingerX - ((secondFingerX - firstFingerX) / 2) :\n                        firstFingerX - ((firstFingerX - secondFingerX) / 2), y: firstFingerY < secondFingerY ?\n                        secondFingerY - ((secondFingerY - firstFingerY) / 2) : firstFingerY - ((firstFingerY - secondFingerY) / 2) };\n                if (this.currMousePoint.x !== center.x && this.currMousePoint.y !== center.y) {\n                    var type = '';\n                    if (e.type === 'touchmove' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Pinch) === ZoomTrigger.Pinch) {\n                        this.zoomType = 'Pinch';\n                        var scale = this.calculateScale(this.startTouches, this.targetTouches(e.touches));\n                        this.startTouches = this.targetTouches(e.touches);\n                        if (scale > 1) {\n                            type = 'zoomIn';\n                        }\n                        else if (scale < 1) {\n                            type = 'zoomOut';\n                        }\n                    }\n                    if (type !== '') {\n                        parent.isZoomBtnClick = true;\n                        parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                            value: { x: center.x, y: center.y, type: type, isResize: null } });\n                    }\n                    this.tempTouches = [];\n                    this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop) });\n                    this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop) });\n                    this.currMousePoint.x = center.x;\n                    this.currMousePoint.y = center.y;\n                    this.isPinching = true;\n                }\n            }\n            this.isFirstMove = false;\n            return;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        x -= bbox.left;\n        y -= bbox.top;\n        this.canvasMouseMoveHandler(e);\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        }\n        parent.upperCanvas.style.cursor = canvasCursor;\n        parent.cursor = cursor;\n        if (parent.currObjType.isActiveObj && (parent.activeObj.activePoint !== undefined || parent.objColl.length > 0) &&\n            !this.dragCanvas || parent.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                if ((parent.activeObj.activePoint &&\n                    (parent.activeObj.activePoint.width === 0 || (!isNullOrUndefined(parent.activeObj.currIndex) &&\n                        this.cursorTargetId !== parent.activeObj.currIndex)))\n                    && parent.cursor !== 'default' &&\n                    parent.cursor !== 'move' && parent.cursor !== 'crosshair'\n                    && parent.cursor !== 'grab' && parent.cursor !== 'pointer') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n                this.findTarget(x, y, e.type);\n            }\n        }\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        if (parent.currObjType.isDragging) {\n            if (parent.activeObj.shape && parent.activeObj.preventShapeDragOut) {\n                if (x < destLeft || x > destLeft + destWidth || y < destTop || y > destTop + destHeight) {\n                    return;\n                }\n            }\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.updateActivePoint(x, y, isCropSelection);\n            parent.notify('shape', { prop: 'updateTrianglePoints', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (this.isPreventDragging) {\n                if (!this.isShapeDragOut()) {\n                    this.isPreventDragging = false;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: null, saveContext: null, isPreventSelection: null } });\n            }\n            if (isCropSelection) {\n                this.dragCanvas = parent.togglePan = true;\n            }\n        }\n        this.isMouseDown = false;\n        this.isMouseUp = false;\n    };\n    Selection.prototype.mouseUpEventHandler = function (e) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        parent.isKBDNavigation = this.isMouseDown = false;\n        this.isMouseUp = true;\n        if (!Browser.isDevice && ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n            !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (parent.element.querySelector('#' + id + '_headWrapper')\n                && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide')))) {\n            if (!(parent.activeObj.shape && parent.activeObj.shape === 'redact' && parent.isShapeDrawing)) {\n                return;\n            }\n        }\n        if (parent.cursor === 'grabbing' && this.isGrabbing) {\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeResizingArgs = { cancel: false, action: 'rotate-end', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            var shapeMovingArgs = { cancel: false, action: 'rotate-end', previousShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n            this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-up');\n        }\n        this.isGrabbing = false;\n        if (this.isPreventShaping) {\n            this.isPreventShaping = false;\n        }\n        if (this.mouseDown === 'canvas' || this.isSliderActive ||\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            e.target.closest('.e-image-editor') || e.target.closest('.e-ie-ddb-popup')) {\n            if (e.type === 'touchstart') {\n                this.isTouch = false;\n            }\n            else if (e.type === 'touchend') {\n                e.stopImmediatePropagation();\n            }\n            e.preventDefault();\n            if (parent.togglePan) {\n                this.canvasMouseUpHandler(e);\n            }\n            var x = void 0;\n            var y = void 0;\n            if (e.type === 'mouseup') {\n                x = e.clientX;\n                y = e.clientY;\n            }\n            else if (!this.isTouchDblClick) {\n                x = this.touchEndPoint.x;\n                y = this.touchEndPoint.y;\n            }\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var activeObjShape = void 0;\n            var currentDrawingShape = this.currentDrawingShape;\n            var dummyClick = false;\n            if (e.type === 'touchend') {\n                this.startTouches = this.tempTouches = [];\n                this.isFirstMove = false;\n                if (parent.textArea.style.display === 'none') {\n                    this.timer = 0;\n                }\n                if (this.isPinching) {\n                    this.isPinching = false;\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    return;\n                }\n            }\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (this.currentDrawingShape === 'path' && parent.isShapeDrawing) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var elem = e.srcElement;\n                var elemId = elem.parentElement.id;\n                var id_1 = parent.element.id;\n                // eslint-disable-next-line max-len\n                if (e.currentTarget !== parent.upperCanvas && e.currentTarget !== parent.lowerCanvas && parent.activeObj.pointColl.length > 0 &&\n                    (elem.classList.contains('e-upload-icon') || elemId === id_1 + '_zoomIn' ||\n                        elemId === id_1 + '_zoomOut' || elemId === id_1 + '_annotationBtn' ||\n                        elemId === id_1 + '_borderColorBtn' || elemId === id_1 + '_borderWidthBtn')) {\n                    parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: true } });\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                            points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n                }\n                if (parent.currObjType.isDragging && this.isTouch &&\n                    parent.activeObj.shape && parent.activeObj.shape === 'path') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                            points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n                }\n                return;\n            }\n            if (e.currentTarget === parent.upperCanvas && !parent.isResize) {\n                this.pathAdjustedIndex = null;\n                if (this.currentDrawingShape !== '') {\n                    if (this.currentDrawingShape === 'text') {\n                        var prevCropObj_1 = extend({}, parent.cropObj, {}, true);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeInsert', previousObj: this.initialPrevObj, previousObjColl: this.initialPrevObj.objColl,\n                                previousPointColl: this.initialPrevObj.pointColl, previousSelPointColl: this.initialPrevObj.selPointColl,\n                                previousCropObj: prevCropObj_1, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    else {\n                        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: this.initialPrevObj.objColl, operation: 'shapeInsert' } });\n                    }\n                    this.isShapeInserted = true;\n                    this.currentDrawingShape = '';\n                    if ((parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length === 0) ||\n                        ((!parent.activeObj.shape || parent.activeObj.shape !== 'path') && parent.activeObj.activePoint.width === 0 &&\n                            parent.activeObj.activePoint.height === 0)) {\n                        dummyClick = true;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    var previousShapeSettings = this.updatePrevShapeSettings();\n                    var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: previousShapeSettings };\n                    var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: previousShapeSettings };\n                    this.shapeResizingArgs = shapeResizingArgs;\n                    this.shapeMovingArgs = shapeMovingArgs;\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'mouse-up');\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0) {\n                    parent.activeObj.activePoint = parent.getSquarePointForPath(parent.activeObj);\n                }\n                this.adjustActObjForLineArrow();\n                this.updPtCollForShpRot();\n                parent.currObjType.shape = parent.currObjType.shape.toLowerCase();\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                if (!parent.togglePen && !isCropSelection) {\n                    if (this.tempObjColl && parent.activeObj.activePoint.width !== 0) {\n                        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        parent.objColl.push(parent.activeObj);\n                        if (JSON.stringify(parent.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                    previousCropObj: prevCropObj, previousText: null,\n                                    currentText: null, previousFilter: null, isCircleCrop: null } });\n                        }\n                        var tempObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                        parent.objColl.pop();\n                        this.redrawShape(tempObj);\n                        this.tempObjColl = undefined;\n                    }\n                    if (!this.isFhdEditing) {\n                        this.applyCurrActObj(x, y);\n                        parent.currObjType.isResize = false;\n                        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                }\n                else if (isCropSelection && this.isMouseUp && parent.cursor.indexOf('resize') > -1) {\n                    var previousShapeSettings = this.updatePrevShapeSettings();\n                    var shapeResizingArgs = { cancel: false, action: 'resize-end', previousShapeSettings: previousShapeSettings };\n                    this.triggerShapeChange(shapeResizingArgs, shapeResizingArgs, 'resize');\n                }\n                if (parent.activeObj) {\n                    var isCropSelection_1 = false;\n                    var splitWords_1;\n                    if (parent.activeObj.shape !== undefined) {\n                        splitWords_1 = parent.activeObj.shape.split('-');\n                    }\n                    if (splitWords_1 === undefined && (parent.currObjType.isCustomCrop || parent.togglePen)) {\n                        isCropSelection_1 = true;\n                    }\n                    else if (splitWords_1 !== undefined && splitWords_1[0] === 'crop') {\n                        isCropSelection_1 = true;\n                    }\n                    var shape = parent.activeObj.shape;\n                    activeObjShape = shape;\n                    var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path'];\n                    if (shapeColl.indexOf(shape) > -1) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (shape === 'text') {\n                        if (parent.textArea.style.display === 'none') {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                    }\n                    else if (shape === 'redact') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (this.isFhdEditing) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (!isCropSelection_1) {\n                        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    if (!this.isFhdEditing) {\n                        if (parent.activeObj.shape && parent.activeObj.shape === 'text' &&\n                            parent.activeObj.textSettings.fontSize === 11 && Math.floor(parent.activeObj.activePoint.width) === 55 &&\n                            Math.floor(parent.activeObj.activePoint.height) === 11) {\n                            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                            if (parent.drawingShape === 'text' && !parent.activeObj.keyHistory) {\n                                parent.activeObj.keyHistory = 'Enter Text';\n                            }\n                        }\n                        if (!isCropSelection_1) {\n                            this.adjustActObjForLineArrow();\n                            if (parent.isShapeDrawing) {\n                                var temp = this.currentDrawingShape;\n                                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                                this.currentDrawingShape = temp;\n                            }\n                            else {\n                                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                            }\n                        }\n                    }\n                }\n            }\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && e.currentTarget === parent.upperCanvas &&\n                parent.textArea.style.display === 'none') {\n                if (parent.activeObj.shape === 'text') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else if (parent.activeObj.shape === 'redact') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else {\n                    var temp = this.currentDrawingShape;\n                    this.currentDrawingShape = '';\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    this.currentDrawingShape = temp;\n                }\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            if (parent.togglePen && e.currentTarget === parent.upperCanvas && !obj['freehandDrawSelectedId']) {\n                parent.notify('freehand-draw', { prop: 'freehandUpHandler', onPropertyChange: false,\n                    value: { e: e, canvas: parent.upperCanvas, context: this.upperContext } });\n                if (parent.togglePen && !parent.isMaskImage && (isNullOrUndefined(parent.toolbar) ||\n                    (parent.toolbar && parent.toolbar.length > 0) || !isNullOrUndefined(parent.toolbarTemplate))) {\n                    parent.okBtn();\n                    parent.freeHandDraw(true);\n                }\n            }\n            else {\n                parent.currObjType.shape = '';\n            }\n            this.dragElement = '';\n            this.mouseDown = '';\n            this.isSliderActive = false;\n            parent.currObjType.isInitialLine = parent.currObjType.isDragging = false;\n            this.selMouseUpEvent();\n            if (isNullOrUndefined(parent.drawingShape) && activeObjShape && currentDrawingShape !== '') {\n                parent.drawingShape = activeObjShape;\n            }\n            if (parent.drawingShape) {\n                this.currentDrawingShape = parent.drawingShape.toLowerCase();\n                if (dummyClick) {\n                    parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n                    parent.upperCanvas.style.cursor = 'crosshair';\n                }\n            }\n            parent.isShapeDrawing = false;\n            parent.notify('freehand-draw', { prop: 'resetSelPoints', onPropertyChange: false });\n        }\n        this.isMouseUp = false;\n    };\n    Selection.prototype.adjustActObjForLineArrow = function (obj) {\n        var isAdjusted = false;\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && (obj.shape === 'line' || parent.activeObj.shape === 'arrow')) {\n            var temp = void 0;\n            if ((this.dragElement === 'e-resize' && obj.activePoint.endX < obj.activePoint.startX) ||\n                (this.dragElement === 'w-resize' && obj.activePoint.startX > obj.activePoint.endX)) {\n                isAdjusted = true;\n                temp = obj.activePoint.startX;\n                obj.activePoint.startX = obj.activePoint.endX;\n                obj.activePoint.endX = temp;\n                temp = obj.activePoint.startY;\n                obj.activePoint.startY = obj.activePoint.endY;\n                obj.activePoint.endY = temp;\n            }\n            obj.activePoint.width = Math.abs(obj.activePoint.endX - obj.activePoint.startX);\n            obj.activePoint.height = Math.abs(obj.activePoint.endY - obj.activePoint.startY);\n            if (parent.activeObj.shape !== 'path') {\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                for (var i = 0; i < obj.pointColl.length; i++) {\n                    obj.pointColl[i].ratioX = (obj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    obj.pointColl[i].ratioY = (obj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n        return isAdjusted;\n    };\n    Selection.prototype.updPtCollForShpRot = function (obj) {\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && obj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false, value: { obj: obj } });\n            var _a = parent.img, destLeft_1 = _a.destLeft, destTop_1 = _a.destTop, destWidth_1 = _a.destWidth, destHeight_1 = _a.destHeight;\n            var horTopLinePointColl = obj.horTopLinePointColl, horBottomLinePointColl = obj.horBottomLinePointColl, verLeftLinePointColl = obj.verLeftLinePointColl, verRightLinePointColl = obj.verRightLinePointColl;\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            var setRatio = function (point) {\n                point.ratioX = (point.x - destLeft_1) / destWidth_1;\n                point.ratioY = (point.y - destTop_1) / destHeight_1;\n            };\n            horTopLinePointColl.forEach(setRatio);\n            horBottomLinePointColl.forEach(setRatio);\n            verLeftLinePointColl.forEach(setRatio);\n            verRightLinePointColl.forEach(setRatio);\n        }\n    };\n    Selection.prototype.setXYPoints = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        return { x: x, y: y };\n    };\n    Selection.prototype.getCurrentIndex = function () {\n        var index;\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.activeObj.currIndex === parent.objColl[i].currIndex) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    };\n    Selection.prototype.isShapeClick = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.togglePen) {\n            return isShape;\n        }\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' && this.isShapeInserted) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                if (isShape) {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: true } });\n                }\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if ((!isNullOrUndefined(index) &&\n                    JSON.stringify(parent.activeObj.activePoint) === JSON.stringify(parent.objColl[index].activePoint))) {\n                    parent.objColl.splice(index, 1);\n                }\n                else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                    parent.objColl.pop();\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isShapeTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (e.type === 'touchstart' && !parent.togglePen) {\n            if (parent.activeObj && parent.activeObj.shape === 'text') {\n                this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n            }\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape && (activeObj.activePoint.width !== 0 || activeObj.activePoint.height !== 0 ||\n                (activeObj.shape === 'path' && activeObj.pointColl.length > 0))) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isFreehandDrawTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isFreehandDraw = false;\n        if (e.type === 'touchstart' && !isCropSelection && !parent.togglePen) {\n            var isTextArea = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n                ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.isFhdPoint) {\n                isFreehandDraw = true;\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isFreehandDraw;\n    };\n    Selection.prototype.applyObj = function (x, y) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) {\n            return false;\n        }\n        var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'image', 'text'];\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (parent.activeObj.shape && shapeColl.indexOf(parent.activeObj.shape) > -1) {\n            var radius = parent.activeObj.topLeftCircle.radius;\n            if (x >= (startX - (radius * 2)) && x <= (endX + (radius * 2)) && y >= (startY - (radius * 2)) &&\n                y <= (endY + (radius * 2))) {\n                isApply = false;\n            }\n            else if (parent.upperCanvas.style.cursor !== 'default' && parent.upperCanvas.style.cursor !== 'grab' &&\n                parent.upperCanvas.style.cursor !== 'crosshair' && parent.upperCanvas.style.cursor !== 'pointer' &&\n                parent.upperCanvas.style.cursor !== 'move') {\n                isApply = false;\n            }\n            else {\n                isApply = true;\n            }\n        }\n        return isApply;\n    };\n    Selection.prototype.applyCurrShape = function (isShapeClick) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.togglePen) {\n            return isApply;\n        }\n        var obj = extend({}, parent.activeObj, null, true);\n        if (this.isShapeInserted && parent.activeObj.shape === 'text' && isShapeClick) {\n            this.isInitialTextEdited = true;\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            obj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n            parent.objColl.pop();\n            parent.activeObj = extend({}, activeObj, null, true);\n            parent.textArea.value = obj.keyHistory;\n            parent.textArea.style.display = 'block';\n            var strokeColor = obj.strokeSettings && obj.strokeSettings.strokeColor ? obj.strokeSettings.strokeColor.split('(')[0] === 'rgb' ?\n                this.rgbToHex(parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[0]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[1]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[2]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[3])) :\n                obj.strokeSettings.strokeColor : null;\n            if (strokeColor && strokeColor === '#ffffff') {\n                strokeColor = '#fff';\n            }\n            if (this.tempActiveObj.strokeSettings && this.tempActiveObj.strokeSettings.strokeColor &&\n                this.tempActiveObj.strokeSettings.strokeColor === '#ffffff') {\n                this.tempActiveObj.strokeSettings.strokeColor = '#fff';\n            }\n            if (obj.keyHistory !== this.tempActiveObj.keyHistory ||\n                (strokeColor && (strokeColor !== this.tempActiveObj.strokeSettings.strokeColor)) ||\n                (obj.textSettings && obj.textSettings.fontFamily !== this.tempActiveObj.textSettings.fontFamily) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontSize) !== Math.round(this.tempActiveObj.textSettings.fontSize)) ||\n                (obj.textSettings && Math.round(obj.textSettings.fontRatio) !== Math.round(this.tempActiveObj.textSettings.fontRatio)) ||\n                (obj.textSettings && obj.textSettings.bold !== this.tempActiveObj.textSettings.bold) ||\n                (obj.textSettings && obj.textSettings.italic !== this.tempActiveObj.textSettings.italic) ||\n                (obj.textSettings && obj.textSettings.underline !== this.tempActiveObj.textSettings.underline)) {\n                isApply = true;\n            }\n            if (this.isInitialTextEdited && !isApply) {\n                isApply = true;\n                this.isInitialTextEdited = false;\n            }\n        }\n        else {\n            this.tempActiveObj.activePoint.height = Math.abs(this.tempActiveObj.activePoint.height);\n            isApply = JSON.stringify(obj) !== JSON.stringify(this.tempActiveObj);\n        }\n        return isApply;\n    };\n    Selection.prototype.canvasMouseDownHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.offsetX || (e.pageX - parent.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - parent.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panDown = { x: x, y: y };\n        var tempPanMoveObj = { tempPanMove: null };\n        parent.notify('transform', { prop: 'getTempPanMove', onPropertyChange: false,\n            value: { obj: tempPanMoveObj } });\n        if (isNullOrUndefined(tempPanMoveObj['tempPanMove'])) {\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: { x: x, y: y } } });\n        }\n    };\n    Selection.prototype.canvasMouseMoveHandler = function (e) {\n        var parent = this.parent;\n        var frameObject = { bool: null };\n        parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (parent.isResize || frameObject['bool']) {\n            parent.upperCanvas.style.cursor = 'default';\n            return;\n        }\n        if (this.dragCanvas) {\n            parent.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = parent.togglePan = false;\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.offsetX;\n            y = e.offsetY;\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        var panMove = { x: x, y: y };\n        parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n            value: { point: { x: x, y: y } } });\n        if (this.panDown && panMove && parent.togglePan && this.dragCanvas) {\n            if (parent.isCropTab || parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n            }\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: null, yDiff: null } });\n        }\n    };\n    Selection.prototype.canvasMouseUpHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var panMoveObj = { panMove: null };\n        parent.notify('transform', { prop: 'getPanMove', onPropertyChange: false,\n            value: { obj: panMoveObj } });\n        if (parent.togglePan) {\n            if (this.panDown && panMoveObj['panMove'] && parent.togglePan && this.dragCanvas) {\n                this.panDown = null;\n                parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n                    value: { point: null } });\n            }\n        }\n        parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n            value: { point: null } });\n        if (this.currentDrawingShape !== 'path') {\n            parent.currObjType.isDragging = false;\n        }\n    };\n    Selection.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        var parent = this.parent;\n        if (this.touchTime === 0) {\n            this.touchTime = new Date().getTime();\n        }\n        else {\n            if (((new Date().getTime()) - this.touchTime) < 400) {\n                this.isTouchDblClick = true;\n                var temp = parent.isShapeDrawing;\n                parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e, isApply: null } });\n                this.isTouchDblClick = false;\n                this.touchTime = 0;\n                if (temp !== parent.isShapeDrawing && parent.activeObj.shape &&\n                    parent.activeObj.shape === 'path') {\n                    return;\n                }\n            }\n            else {\n                this.touchTime = new Date().getTime();\n            }\n        }\n        if (e.touches.length === 2) {\n            this.isFirstMove = true;\n        }\n        else {\n            this.mouseDownEventHandler(e);\n        }\n        EventHandler.add(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n    };\n    Selection.prototype.unwireEvent = function () {\n        var parent = this.parent;\n        EventHandler.remove(parent.lowerCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler);\n    };\n    Selection.prototype.keyDownEventHandler = function (e) {\n        var parent = this.parent;\n        if (e.ctrlKey && (e.key === '+' || e.key === '-')) {\n            e.preventDefault();\n        }\n        var obj = { fileName: '', fileType: null };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var beforeSave = { fileName: obj['fileName'], fileType: obj['fileType'], cancel: false };\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                parent.trigger('beforeSave', beforeSave);\n                this.beforeSaveEvent(beforeSave, e);\n                break;\n            case (e.ctrlKey && 'z'):\n                if (parent.allowUndoRedo) {\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                }\n                break;\n            case (e.ctrlKey && 'y'):\n                if (parent.allowUndoRedo) {\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                }\n                break;\n            case (e.ctrlKey && '+'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.isZoomBtnClick = true;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: .1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case (e.ctrlKey && '-'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.isZoomBtnClick = true;\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -.1, zoomPoint: null }, isResize: null });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (parent.isCropTab || parent.activeObj.shape) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                        parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                    }\n                    if (parent.isStraightening) {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                }\n                break;\n            case 'Delete':\n                this.deleteItem();\n                break;\n            case 'Escape':\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isFinalCancel: true } });\n                break;\n            case 'Enter':\n                this.performEnterAction(e);\n                break;\n            case 'Tab':\n                this.performTabAction();\n                break;\n            default:\n                if (Browser.isDevice && (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    Selection.prototype.performEnterAction = function (e) {\n        var parent = this.parent;\n        if (parent.isResize) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var target = e.target;\n            var isIcon = target.id.indexOf('aspectratio') ||\n                target.id.indexOf('non-aspectratio') > -1 ? true : false;\n            var isValue = this.isValueUpdated();\n            if (!isValue) {\n                if (isIcon) {\n                    this.focusRatioBtn();\n                }\n                return;\n            }\n            var point = this.getNumTextValue();\n            var aspectRatioElement = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n            var blrAspRatElem = parent.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n            if (point && point.x && point.y) {\n                if (aspectRatioElement || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n            }\n            var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n            var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n            if (isNullOrUndefined(aspectRatioElement)) {\n                if (aspectRatioHeight) {\n                    var elem = getComponent(aspectRatioHeight, 'numerictextbox');\n                    if (aspectRatioHeight && aspectRatioHeight.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioHeight.value = elem.placeholder + 'px';\n                    }\n                }\n                if (aspectRatioWidth) {\n                    var elem = getComponent(aspectRatioWidth, 'numerictextbox');\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        elem.value = parseFloat(elem.placeholder);\n                        aspectRatioWidth.value = elem.placeholder + 'px';\n                    }\n                }\n            }\n            parent.notify('draw', { prop: 'redrawDownScale' });\n            if (isIcon) {\n                this.focusRatioBtn();\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        }\n        else if (e.target.classList.contains('e-upload')) {\n            var upload = parent.element.querySelector('.e-image-upload');\n            if (upload && upload.querySelector('.e-tbar-btn')) {\n                upload.querySelector('.e-tbar-btn').click();\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        }\n        else if (e.target.classList.contains('filter-wrapper')) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            e.target.parentElement.click();\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (e && this.isKeyBoardCrop(e) &&\n                parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] === 'crop')) {\n                parent.crop();\n            }\n        }\n    };\n    Selection.prototype.focusRatioBtn = function () {\n        var id = this.parent.element.id;\n        if (this.parent.isKBDNavigation) {\n            // eslint-disable-next-line @typescript-eslint/tslint/config\n            setTimeout(function () {\n                if (document.getElementById(id + '_aspectratio')) {\n                    document.getElementById(id + '_aspectratio').focus();\n                }\n                else if (document.getElementById(id + '_nonaspectratio')) {\n                    document.getElementById(id + '_nonaspectratio').focus();\n                }\n            }, 50);\n        }\n    };\n    Selection.prototype.isKeyBoardCrop = function (e) {\n        var bool = false;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var target = e.target;\n        if (target.id === this.parent.element.id + '_ok' || target.id === '') {\n            bool = true;\n        }\n        return bool;\n    };\n    Selection.prototype.beforeSaveEvent = function (observableSaveArgs, e) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.notify('export', { prop: 'export', onPropertyChange: false,\n                value: { type: observableSaveArgs.fileType, fileName: observableSaveArgs.fileName } });\n        }\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    };\n    Selection.prototype.handleScroll = function (e) {\n        this.mouseWheel++;\n        var parent = this.parent;\n        var x;\n        var y;\n        var isInsideCanvas = false;\n        if (e.type === 'mousewheel') {\n            // eslint-disable-next-line\n            x = e.clientX;\n            y = e.clientY;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (x > parent.img.destLeft && x < parent.img.destLeft + parent.img.destWidth && y > parent.img.destTop &&\n            y < parent.img.destTop + parent.img.destHeight) {\n            isInsideCanvas = true;\n        }\n        if (this.mouseWheel === 2) {\n            this.mouseWheel = 0;\n            if (e.ctrlKey === true && isInsideCanvas) {\n                e.preventDefault();\n            }\n            return;\n        }\n        e.stopPropagation();\n        if (e.ctrlKey === true && isInsideCanvas) {\n            e.preventDefault();\n            if (!parent.isCropTab && (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] !== 'crop')) {\n                parent.okBtn(null, true);\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n            }\n            var type = '';\n            if (e.type === 'mousewheel' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.MouseWheel) === ZoomTrigger.MouseWheel) {\n                this.zoomType = 'MouseWheel';\n                // eslint-disable-next-line\n                if (e.wheelDelta > 0) {\n                    type = 'zoomIn';\n                }\n                else {\n                    type = 'zoomOut';\n                }\n            }\n            if (type !== '') {\n                parent.isZoomBtnClick = true;\n                parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                    value: { x: x, y: y, type: type, isResize: null } });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                if (parent.isCropTab || parent.activeObj.shape) {\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent.isStraightening) {\n                    parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent.notify('draw', { prop: 'setDestForStraighten' });\n                }\n            }\n        }\n    };\n    Selection.prototype.textKeyDown = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            return;\n        }\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        parent.textArea.style.height = 'auto';\n        parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n        parent.notify('shape', { prop: 'setTextBoxWidth', onPropertyChange: false, value: { e: e } });\n        if (Browser.isDevice) {\n            parent.textArea.style.width = parseFloat(parent.textArea.style.width) + parent.textArea.style.fontSize + 'px';\n        }\n        var rows = parent.textArea.value.split('\\n');\n        this.textRow = rows.length;\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        this.isInitialTextEdited = false;\n    };\n    Selection.prototype.clearSelection = function (resetCrop) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (resetCrop) {\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                parent.togglePen = false;\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.dragElement = '';\n                this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                parent.currObjType.shape = '';\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.currObjType.isActiveObj = true;\n                parent.currObjType.isCustomCrop = false;\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Selection.prototype.setDragDirection = function (width, height) {\n        var arcRadius = (7.5);\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (parent.img.destWidth > parent.img.destHeight) {\n            actPoint.startX = this.dragPoint.startX = ((width / 2) - (height / 2)) + arcRadius;\n            actPoint.startY = this.dragPoint.startY = ((height / 2) - (height / 2)) + arcRadius;\n            actPoint.endX = ((width / 2) + (height / 2)) - arcRadius;\n            actPoint.endY = ((height / 2) + (height / 2)) - arcRadius;\n        }\n        else {\n            actPoint.startY = this.dragPoint.startX = ((height / 2) - (width) / 2) + arcRadius;\n            actPoint.endY = ((height / 2) + (width) / 2) - arcRadius;\n            actPoint.startX = this.dragPoint.startX = arcRadius;\n            actPoint.endX = width - arcRadius;\n        }\n    };\n    Selection.prototype.calcShapeRatio = function (x, y, imgWidth, imgHeight) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var arcRadius = (7.5);\n        var presetRatio = x / y;\n        var originalWidth = imgWidth;\n        var originalHeight = imgHeight;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        actPoint.width = width;\n        actPoint.height = height;\n        actPoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        actPoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        actPoint.endX = actPoint.startX + actPoint.width;\n        actPoint.endY = actPoint.startY + actPoint.height;\n        if (actPoint.startX < destLeft && destLeft + destWidth > parent.lowerCanvas.clientWidth) {\n            actPoint.startX = destLeft;\n            actPoint.endX = actPoint.startX + width - arcRadius;\n        }\n        if (actPoint.startY < destTop && destTop + destHeight > parent.lowerCanvas.clientHeight) {\n            actPoint.startY = destTop;\n            actPoint.endY = actPoint.startY + height - arcRadius;\n        }\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n    };\n    Selection.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    Selection.prototype.findTarget = function (x, y, type) {\n        var parent = this.parent;\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, isCrop);\n            this.updateCursorStyles(x, y, type);\n        }\n        else {\n            var _a = parent.activeObj, topLeftCircle = _a.topLeftCircle, topCenterCircle = _a.topCenterCircle, topRightCircle = _a.topRightCircle, centerLeftCircle = _a.centerLeftCircle, centerRightCircle = _a.centerRightCircle, bottomLeftCircle = _a.bottomLeftCircle, bottomCenterCircle = _a.bottomCenterCircle, bottomRightCircle = _a.bottomRightCircle;\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    topLeftCircle.startX = x;\n                    topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    topCenterCircle.startX = x;\n                    topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    topRightCircle.startX = x;\n                    topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    centerLeftCircle.startX = x;\n                    centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    centerRightCircle.startX = x;\n                    centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    bottomLeftCircle.startX = x;\n                    bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    bottomCenterCircle.startX = x;\n                    bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    bottomRightCircle.startX = x;\n                    bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.findTargetObj = function (x, y, isCrop) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length !== 0 && !parent.currObjType.isCustomCrop && !isCrop) {\n            var prevIndex = 0;\n            var i = void 0;\n            for (var index = 0; index < parent.objColl.length; index++) {\n                var cursor = parent.upperCanvas.style.cursor;\n                this.setCursor(x, y);\n                var actObj = extend({}, parent.objColl[index], {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                    for (var j = 0; j < actObj.pointColl.length; j++) {\n                        if (x >= actObj.pointColl[j].x - (radius * 2) &&\n                            x <= actObj.pointColl[j].x + (radius * 2) &&\n                            y >= actObj.pointColl[j].y - (radius * 2) &&\n                            y <= actObj.pointColl[j].y + (radius * 2)) {\n                            if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                                JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                                i = index;\n                                break;\n                            }\n                            else {\n                                if (this.isTouch || parent.cursor === 'move' ||\n                                    parent.cursor === 'grab' || this.isShapeInserted) {\n                                    if (prevIndex === 0 || prevIndex < actObj.order) {\n                                        prevIndex = actObj.order;\n                                        i = index;\n                                    }\n                                }\n                                else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                    i = index;\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n                else if (actObj.shape === 'path') {\n                    var cursor_3 = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                    if (cursor_3 !== 'default' && cursor_3 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (prevIndex === 0 || prevIndex < actObj.order) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else if (actObj.rotatedAngle !== 0) {\n                    var cursor_4 = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                    if (cursor_4 !== 'default' && cursor_4 !== 'grab') {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (prevIndex === 0 || (prevIndex < actObj.order && (actObj.shape !== 'redact' || parent.drawingShape === 'redact'))) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n                else {\n                    var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                    if ((x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2))) ||\n                        (rotationCirclePoint &&\n                            x >= (rotationCirclePoint.x - (radius * 2)) &&\n                            x <= (rotationCirclePoint.x + (radius * 2)) &&\n                            y >= (rotationCirclePoint.y - (radius * 2)) &&\n                            y <= (rotationCirclePoint.y + (radius * 2)))) {\n                        if (this.tempActiveObj && this.tempActiveObj.activePoint &&\n                            JSON.stringify(this.tempActiveObj.activePoint) === JSON.stringify(actObj.activePoint)) {\n                            i = index;\n                            break;\n                        }\n                        else {\n                            if (this.isTouch || cursor === 'move' || cursor === 'grabbing' || this.isShapeInserted\n                                || parent.cursor === 'move' || parent.cursor === 'grabbing') {\n                                if (prevIndex === 0 || (prevIndex < actObj.order && (actObj.shape !== 'redact' || parent.drawingShape === 'redact'))) {\n                                    prevIndex = actObj.order;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                        }\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                isShape = false;\n            }\n            else {\n                this.tempObjColl = extend([], parent.objColl, [], true);\n                parent.currObjType.isCustomCrop = false;\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var temp = extend({}, parent.objColl[i], {}, true);\n                parent.objColl.splice(i, 1);\n                if (parent.transform.degree === 0) {\n                    var temp_1 = this.lowerContext.filter;\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                    this.lowerContext.filter = 'none';\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                    parent.activeObj = extend({}, temp_1, {}, true);\n                    this.lowerContext.filter = temp_1;\n                    this.getCurrentFlipState();\n                }\n                else {\n                    var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n                    var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                        height: parent.img.destHeight };\n                    parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.img.destLeft = destPoints.startX;\n                    parent.img.destTop = destPoints.startY;\n                    parent.img.destWidth = destPoints.width;\n                    parent.img.destHeight = destPoints.height;\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = extend({}, temp, {}, true);\n                this.setActivePoint();\n                parent.activeObj = extend({}, temp, {}, true);\n                var tempStrokeSettings = extend({}, parent.activeObj.strokeSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempStrokeSettings', onPropertyChange: false,\n                    value: { tempStrokeSettings: tempStrokeSettings } });\n                var tempTextSettings = extend({}, parent.activeObj.textSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempTextSettings', onPropertyChange: false, value: { tempTextSettings: tempTextSettings } });\n                var shapeSettings = this.updatePrevShapeSettings();\n                var shapeChangingArgs = { cancel: false, action: 'select', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings, allowShapeOverflow: this.allowOutofBound() };\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n                    shapeChangingArgs.currentShapeSettings.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                    shapeChangingArgs.currentShapeSettings.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                this.isCropSelection = false;\n                var splitWords = void 0;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    this.isCropSelection = true;\n                }\n                if (!this.isCropSelection && parent.activeObj.shape !== 'redact') {\n                    parent.trigger('shapeChanging', shapeChangingArgs);\n                    this.shapeEvent(shapeChangingArgs);\n                    parent.editCompleteArgs = shapeChangingArgs;\n                }\n                else {\n                    if (this.isMouseDown) {\n                        shapeChangingArgs.action = 'resize-start';\n                    }\n                    else if (this.isMouseUp) {\n                        shapeChangingArgs.action = 'resize-end';\n                    }\n                    var selectionChangingArgs = { action: shapeChangingArgs.action,\n                        previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.previousShapeSettings.startX,\n                            startY: shapeChangingArgs.previousShapeSettings.startY,\n                            width: shapeChangingArgs.previousShapeSettings.width,\n                            height: shapeChangingArgs.previousShapeSettings.height },\n                        currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs.currentShapeSettings.startX,\n                            startY: shapeChangingArgs.currentShapeSettings.startY,\n                            width: shapeChangingArgs.currentShapeSettings.width,\n                            height: shapeChangingArgs.currentShapeSettings.height } };\n                    parent.trigger('selectionChanging', selectionChangingArgs);\n                    parent.editCompleteArgs = selectionChangingArgs;\n                    shapeChangingArgs.currentShapeSettings.startX = selectionChangingArgs.currentSelectionSettings.startX;\n                    shapeChangingArgs.currentShapeSettings.startY = selectionChangingArgs.currentSelectionSettings.startY;\n                    shapeChangingArgs.currentShapeSettings.width = selectionChangingArgs.currentSelectionSettings.width;\n                    shapeChangingArgs.currentShapeSettings.height = selectionChangingArgs.currentSelectionSettings.height;\n                    this.shapeEvent(shapeChangingArgs);\n                }\n                isShape = true;\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.shapeEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n            value: { shapeSettings: shapeChangingArgs.currentShapeSettings, allowShapeOverflow: shapeChangingArgs.allowShapeOverflow } });\n        if (parent.activeObj.activePoint) {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(obj['prevActObj'])) {\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n                    value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n            }\n            if (parent.activeObj.shape === 'image' && !this.isImageClarity) {\n                this.upgradeImageQuality();\n                this.isImageClarity = true;\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            if (!this.isShapeInserted) {\n                this.isPreventDragging = this.isShapeDragOut();\n            }\n        }\n    };\n    Selection.prototype.upgradeImageQuality = function () {\n        var parent = this.parent;\n        if (!parent.activeObj.imageCanvas) {\n            return;\n        }\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var ctx = parent.activeObj.imageCanvas.getContext('2d');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false, value: { width: parent.activeObj.imageElement.width,\n                height: parent.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        parent.notify('shape', { prop: 'updateObj', onPropertyChange: false, value: { dimObj: dimObj, x: null, y: null } });\n        ctx.clearRect(0, 0, parent.activeObj.imageCanvas.width, parent.activeObj.imageCanvas.height);\n        this.applyTransformToImg(ctx);\n        parent.activeObj = activeObj;\n    };\n    Selection.prototype.applyTransformToImg = function (ctx) {\n        var parent = this.parent;\n        if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n        }\n        else if (parent.activeObj.isHorImageFlip) {\n            parent.activeObj.isHorImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: true, isVFlip: false } });\n        }\n        else if (parent.activeObj.isVerImageFlip) {\n            parent.activeObj.isVerImageFlip = false;\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                value: { ctx: ctx, isImgAnnotation: true, isHFlip: false, isVFlip: false } });\n        }\n    };\n    // eslint-disable-next-line\n    Selection.prototype.targetTouches = function (touches) {\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        var p1 = { x: touches[0].pageX - bbox.left, y: touches[0].pageY - bbox.top };\n        var p2 = { x: touches[1].pageX - bbox.left, y: touches[1].pageY - bbox.top };\n        var points = [p1, p2];\n        return points;\n    };\n    Selection.prototype.calculateScale = function (startTouches, endTouches) {\n        var startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        var endDistance = this.getDistance(endTouches[0], endTouches[1]);\n        return endDistance / startDistance;\n    };\n    Selection.prototype.getDistance = function (a, b) {\n        var x = 0;\n        var y = 0;\n        if (a && b) {\n            x = a.x - b.x;\n            y = a.y - b.y;\n        }\n        return Math.sqrt(x * x + y * y);\n    };\n    Selection.prototype.redrawShape = function (obj, isMouseUp) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(parent.objColl[i])) {\n                parent.objColl.splice(i, 1);\n                if (obj.shape && parent.textArea.style.display === 'none') {\n                    var actObj = extend({}, obj, {}, true);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    if (parent.rotateFlipColl.length > 0 && (parent.panPoint.totalPannedClientPoint.x !== 0 ||\n                        parent.panPoint.totalPannedClientPoint.y !== 0)) {\n                        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    }\n                    obj = parent.activeObj = actObj;\n                }\n                break;\n            }\n        }\n        if ((obj.shape === 'path' && obj.pointColl.length === 0) ||\n            (obj.shape !== 'path' && (obj.activePoint.width === 0 && obj.activePoint.height === 0))) {\n            return;\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (this.isPreventDragging) {\n            if (parent.activeObj.activePoint.startX > parent.img.destLeft) {\n                this.isPreventDragging = false;\n            }\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n        else {\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                if (parent.activeObj.shape === 'redact') {\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n    };\n    Selection.prototype.setTimer = function (e) {\n        var parent = this.parent;\n        if (this.timer > 10) {\n            clearTimeout(this.timer);\n            this.timer = 0;\n            parent.notify('shape', { prop: 'findTextTarget', onPropertyChange: false, value: { e: e } });\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n    };\n    Selection.prototype.applyCurrActObj = function (x, y) {\n        var parent = this.parent;\n        var isInside = false;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var radius = actObj.topLeftCircle ? actObj.topLeftCircle.radius : 0;\n        if ((x >= Math.floor(startX) && x <= Math.ceil(endX) && y >= Math.floor(startY) && y <= Math.ceil(endY))) {\n            isInside = true;\n        }\n        else if (radius !== 0 && (x >= Math.floor(startX) - radius && x <= Math.ceil(endX) + radius &&\n            y >= Math.floor(startY) - radius && y <= Math.ceil(endY) + radius)) {\n            isInside = true;\n            this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [] };\n        }\n        else if ((actObj.shape === 'text' || actObj.shape === 'image') && this.dragElement !== '') {\n            isInside = true;\n        }\n        else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n            var smallPoint = { x: startX < endX ? startX : endX, y: startY < endY ? startY : endY };\n            var largePoint = { x: startX > endX ? startX : endX, y: startY > endY ? startY : endY };\n            if ((x >= (Math.floor(smallPoint.x) - 5) && x <= (Math.ceil(largePoint.x) + 5) &&\n                y >= (Math.floor(smallPoint.y) - 5) && y <= (Math.ceil(largePoint.y) + 5)) ||\n                parent.activeObj.preventShapeDragOut) {\n                isInside = true;\n            }\n        }\n        else if (actObj.shape === 'path') {\n            var cursor = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            if (cursor === 'move') {\n                isInside = true;\n            }\n        }\n        else if (this.dragElement === 'grabbing') {\n            isInside = true;\n        }\n        else if (actObj.rotatedAngle !== 0) {\n            var cursor = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            if ((cursor !== 'default' && cursor !== 'grab') || this.dragElement === 'n-resize' || this.dragElement === 'e-resize' ||\n                this.dragElement === 's-resize' || this.dragElement === 'w-resize') {\n                isInside = true;\n            }\n        }\n        else if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            isInside = true;\n        }\n        if (!isInside) {\n            if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n                parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n                parent.activeObj.currIndex = shapeIDObj['id'];\n            }\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            if (parent.activeObj.horTopLine !== undefined && parent.activeObj.horTopLine.startX !== 0 && parent.activeObj.horTopLine.endX\n                !== 0 && !parent.currObjType.isCustomCrop && parent.currObjType.shape !== '') {\n                if (parent.objColl.length > 0 &&\n                    JSON.stringify(parent.objColl[parent.objColl.length - 1].activePoint) !==\n                        JSON.stringify(parent.activeObj.activePoint)) {\n                    parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                }\n            }\n            var shapeColl = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n            if (shapeColl.indexOf(parent.activeObj.shape) > -1) {\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' +\n                    'invert(0%)';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                this.lowerContext.filter = tempFilter;\n                if (parent.activeObj.shape) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: null, obj: null, canvas: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if (parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.getCurrentFlipState = function () {\n        var parent = this.parent;\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n        }\n        else {\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.setTextBoxStylesToActObj = function () {\n        var parent = this.parent;\n        parent.activeObj.textSettings.fontFamily = parent.textArea.style.fontFamily;\n        parent.activeObj.strokeSettings.strokeColor = parent.textArea.style.color !== '' &&\n            parent.textArea.style.color.split('(')[1] && parent.textArea.style.color.split('(')[1].split(',')[0] &&\n            parent.textArea.style.color.split('(')[1].split(',')[1] && parent.textArea.style.color.split('(')[1].split(',')[2]\n            && parent.textArea.style.color.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.color.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[3])) :\n            parent.textArea.style.color;\n        parent.activeObj.strokeSettings.fillColor = parent.textArea.style.backgroundColor !== '' &&\n            parent.textArea.style.backgroundColor.split('(')[1] && parent.textArea.style.backgroundColor.split('(')[1].split(',')[0] &&\n            parent.textArea.style.backgroundColor.split('(')[1].split(',')[1] && parent.textArea.style.backgroundColor.split('(')[1].split(',')[2]\n            && parent.textArea.style.backgroundColor.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.backgroundColor.split('(')[1].split(',')[3])) :\n            parent.textArea.style.backgroundColor;\n        parent.activeObj.strokeSettings.outlineColor = parent.textArea.style.textShadow !== '' &&\n            parent.textArea.style.textShadow.split('(')[1] && parent.textArea.style.textShadow.split('(')[1].split(',')[0] &&\n            parent.textArea.style.textShadow.split('(')[1].split(',')[1] && parent.textArea.style.textShadow.split('(')[1].split(',')[2]\n            && parent.textArea.style.textShadow.split('(')[1].split(',')[3] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[2]), parseFloat(parent.textArea.style.textShadow.split('(')[1].split(',')[3])) :\n            (parent.textArea.style.textShadow.match(/^(\\s*[\\w#]+)\\s/) ?\n                parent.textArea.style.textShadow.match(/^(\\s*[\\w#]+)\\s/)[1].trim() :\n                parent.textArea.style.textShadow);\n        if (parent.textArea.style.fontWeight === 'bold') {\n            parent.activeObj.textSettings.bold = true;\n        }\n        else {\n            parent.activeObj.textSettings.bold = false;\n        }\n        if (parent.textArea.style.fontStyle === 'italic') {\n            parent.activeObj.textSettings.italic = true;\n        }\n        else {\n            parent.activeObj.textSettings.italic = false;\n        }\n        parent.activeObj.textSettings.fontSize = (parseFloat(parent.textArea.style.fontSize));\n    };\n    Selection.prototype.rgbToHex = function (r, g, b, a) {\n        r = Math.max(0, Math.min(255, Math.round(r)));\n        g = Math.max(0, Math.min(255, Math.round(g)));\n        b = Math.max(0, Math.min(255, Math.round(b)));\n        a = Math.max(0, Math.min(1, a));\n        var hexR = this.padLeft(r.toString(16), 2, '0');\n        var hexG = this.padLeft(g.toString(16), 2, '0');\n        var hexB = this.padLeft(b.toString(16), 2, '0');\n        var hexA = this.padLeft(Math.round(a * 255).toString(16), 2, '0');\n        var hex;\n        if (isNaN(Number(hexA))) {\n            hex = \"#\" + hexR + hexG + hexB;\n        }\n        else {\n            hex = \"#\" + hexR + hexG + hexB + hexA;\n        }\n        return hex;\n    };\n    Selection.prototype.padLeft = function (value, length, padChar) {\n        while (value.length < length) {\n            value = padChar + value;\n        }\n        return value;\n    };\n    Selection.prototype.deleteItem = function () {\n        var parent = this.parent;\n        var shapeChangingArgs = { cancel: false };\n        var previousShapeSettings = {};\n        if (this.isFhdEditing) {\n            this.updateFreehandDrawColorChange();\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('freehand-draw', { prop: 'deleteFhd', value: { id: obj['freehandDrawSelectedId'] } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'deleteFreehandDrawing', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            parent.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId' });\n        }\n        else if (parent.textArea.style.display === 'none') {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (obj['prevActObj']) {\n                obj['prevActObj']['activePoint']['width'] = Math.abs(obj['prevActObj']['activePoint']['width']);\n                obj['prevActObj']['activePoint']['height'] = Math.abs(obj['prevActObj']['activePoint']['height']);\n            }\n            if (obj['prevActObj'] && JSON.stringify(obj['prevActObj']) !== JSON.stringify(parent.activeObj)) {\n                var index = parent.activeObj.currIndex;\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isFinalCancel: true } });\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === index) {\n                        parent.objColl.splice(i, 1);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                        break;\n                    }\n                }\n            }\n            var object = { isNewPath: null };\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: object } });\n            if (object['isNewPath']) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else if (parent.activeObj.shape) {\n                parent.objColl.push(parent.activeObj);\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object_2 = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_2 } });\n                var prevObj = object_2['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.objColl.pop();\n                previousShapeSettings = this.updatePrevShapeSettings();\n                shapeChangingArgs = { cancel: false, action: 'delete', previousShapeSettings: previousShapeSettings, currentShapeSettings: null };\n                parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n                parent.clearSelection();\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.editCompleteArgs = shapeChangingArgs;\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                if (!isNullOrUndefined(prevObj.objColl[prevObj.objColl.length - 1].currIndex)) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'deleteObj', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            if (parent.drawingShape) {\n                this.currentDrawingShape = parent.drawingShape.toLowerCase();\n                parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n                parent.upperCanvas.style.cursor = 'crosshair';\n            }\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    Selection.prototype.updateFreehandDrawColorChange = function () {\n        var parent = this.parent;\n        var indexObj = { freehandSelectedIndex: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && !isNullOrUndefined(parent.pointColl[indexObj['freehandSelectedIndex']])\n            && parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor === '#42a5f5') {\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor = obj['tempFreeHandDrawEditingStyles'].strokeColor;\n        }\n    };\n    Selection.prototype.updatePrevShapeSettings = function (obj) {\n        var parent = this.parent;\n        var fontStyle = [];\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n            parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n            parent.activeObj.currIndex = shapeIDObj['id'];\n        }\n        if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n            if (parent.activeObj.textSettings.bold) {\n                fontStyle.push('bold');\n            }\n            if (parent.activeObj.textSettings.italic) {\n                fontStyle.push('italic');\n            }\n            if (parent.activeObj.textSettings.underline) {\n                fontStyle.push('underline');\n            }\n        }\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var _b = parent.activeObj, keyHistory = _b.keyHistory, currIndex = _b.currIndex, shape = _b.shape, textSettings = _b.textSettings, strokeSettings = _b.strokeSettings, rotatedAngle = _b.rotatedAngle, imageElement = _b.imageElement, opacity = _b.opacity;\n        var shapeSettingsObj = {\n            id: !isNullOrUndefined(currIndex) ? currIndex : null,\n            type: parent.toPascalCase(shape),\n            startX: startX, startY: startY, width: width, height: height,\n            strokeColor: strokeSettings ? (shape === 'text' ? strokeSettings.outlineColor : strokeSettings.strokeColor) : null,\n            strokeWidth: strokeSettings ? (shape === 'text' ? strokeSettings.outlineWidth : strokeSettings.strokeWidth) : null,\n            fillColor: strokeSettings ? strokeSettings.fillColor : null,\n            radius: shape === 'ellipse' ? width / 2 : null,\n            length: shape === 'line' || shape === 'arrow' ? width : null,\n            text: shape === 'text' ? (keyHistory ? keyHistory : (textSettings.text ? textSettings.text : null)) : null,\n            fontSize: shape === 'text' ? (textSettings ? textSettings.fontSize : null) : null,\n            fontFamily: shape === 'text' ? (textSettings ? textSettings.fontFamily : null) : null,\n            fontStyle: shape === 'text' ? fontStyle : null,\n            color: shape === 'text' ? (strokeSettings ? strokeSettings.strokeColor : null) : null,\n            degree: shape === 'ellipse' || shape === 'rectangle' || shape === 'image' || shape === 'text' ? rotatedAngle * (180 / Math.PI) : null,\n            imageData: shape === 'image' ? imageElement.src : null,\n            opacity: shape === 'image' ? opacity : null,\n            radiusX: shape === 'ellipse' ? width / 2 : null,\n            radiusY: shape === 'ellipse' ? height / 2 : null,\n            endX: shape === 'line' || shape === 'arrow' ? endX : null,\n            endY: shape === 'line' || shape === 'arrow' ? endY : null,\n            arrowHead: shape === 'arrow' ? this.getArrowType(parent.activeObj.start) : null,\n            arrowTail: shape === 'arrow' ? this.getArrowType(parent.activeObj.end) : null,\n            points: shape === 'path' ? parent.activeObj.pointColl : null,\n            index: parent.activeObj.order,\n            transformCollection: shape === 'text' ? this.updateTransColl(parent.activeObj) : null\n        };\n        if (obj) {\n            obj['shapeSettingsObj'] = shapeSettingsObj;\n        }\n        return shapeSettingsObj;\n    };\n    Selection.prototype.updateTransColl = function (object) {\n        var parent = this.parent;\n        var coll;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var tempColl = object.rotateFlipColl;\n        if (tempColl && tempColl.length > 0) {\n            var value = void 0;\n            coll = [];\n            for (var i = 0; i < tempColl.length; i++) {\n                value = tempColl[i];\n                if (typeof (value) === 'number') {\n                    coll.push({ degree: value });\n                }\n                else {\n                    coll.push({ flip: parent.toPascalCase(value) });\n                }\n            }\n        }\n        return coll;\n    };\n    Selection.prototype.getArrowType = function (type) {\n        var typeToArrowType = { 'none': 'None', 'arrow': 'Arrow', 'arrowSolid': 'SolidArrow',\n            'circle': 'Circle', 'circleSolid': 'SolidCircle', 'square': 'Square', 'squareSolid': 'SolidSquare', 'bar': 'Bar' };\n        return typeToArrowType[\"\" + type];\n    };\n    Selection.prototype.getRectanglePoints = function (rectX, rectY, rectWidth, rectHeight, rectAngle, pointX, pointY) {\n        var centerX = rectX + rectWidth / 2;\n        var centerY = rectY + rectHeight / 2;\n        var angleRad = rectAngle * (Math.PI / 180);\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var localX = pointX - centerX;\n        var localY = pointY - centerY;\n        var rotatedX = localX * cosAngle + localY * sinAngle;\n        var rotatedY = -localX * sinAngle + localY * cosAngle;\n        var halfWidth = rectWidth / 2;\n        var halfHeight = rectHeight / 2;\n        if (rotatedX >= -halfWidth && rotatedX <= halfWidth && rotatedY >= -halfHeight &&\n            rotatedY <= halfHeight) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.getTransRotationPoint = function (obj, object) {\n        var rotationCirclePoint;\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        degree = (obj.shapeDegree === 0) ? this.parent.transform.degree : this.parent.transform.degree - obj.shapeDegree;\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (obj.flipObjColl) {\n            for (var i = 0, iLen = obj.flipObjColl.length; i < iLen; i++) {\n                if (obj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (obj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        if (degree === 0 || degree === 360) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 90 || degree === -270) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        else if (degree === 180 || degree === -180) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX, y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX, y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 270 || degree === -90) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX - obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX + obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        if (object) {\n            object['rotationCirclePoint'] = rotationCirclePoint;\n        }\n        return rotationCirclePoint;\n    };\n    Selection.prototype.getNumTextValue = function (obj) {\n        var parent = this.parent;\n        var elem = parent.element;\n        var height;\n        var width;\n        var widthElement;\n        var heightElement;\n        widthElement = elem.querySelector('#' + elem.id + '_resizeWidth');\n        heightElement = elem.querySelector('#' + elem.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            var heightString = heightElement.value.replace(/,/g, '');\n            var widthString = widthElement.value.replace(/,/g, '');\n            if (heightString === '') {\n                heightString = heightElement.placeholder.replace(/,/g, '');\n            }\n            if (widthString === '') {\n                widthString = widthElement.placeholder.replace(/,/g, '');\n            }\n            height = parseFloat(heightString);\n            width = parseFloat(widthString);\n        }\n        if (obj) {\n            obj['width'] = width;\n            obj['height'] = height;\n        }\n        return { x: width, y: height };\n    };\n    Selection.prototype.isValueUpdated = function () {\n        var isValue = true;\n        var widthElement;\n        var heightElement;\n        widthElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeWidth');\n        heightElement = this.parent.element.querySelector('#' + this.parent.element.id + '_resizeHeight');\n        if (widthElement && heightElement) {\n            if (heightElement.value.replace(/,/g, '') === '' && widthElement.value.replace(/,/g, '') === '') {\n                isValue = false;\n            }\n        }\n        return isValue;\n    };\n    Selection.prototype.allowOutofBound = function () {\n        var shapes = ['ellipse', 'rectangle', 'text', 'image', 'redact'];\n        // eslint-disable-next-line max-len\n        var allowOutofBound = (shapes.indexOf(this.parent.activeObj.shape) !== -1 && this.parent.activeObj.rotatedAngle === 0) ? false : true;\n        return allowOutofBound;\n    };\n    return Selection;\n}());\nexport { Selection };\n","/* eslint-disable no-constant-condition */\nimport { EventHandler, extend, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType, RedactType } from '../index';\nvar Shape = /** @class */ (function () {\n    function Shape(parent) {\n        this.textSettings = { text: 'Enter Text', fontFamily: '', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.keyHistory = ''; // text history\n        this.preventFrameAnnotation = false;\n        this.redactType = 'blur';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Shape.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Shape.prototype.addEventListener = function () {\n        this.parent.on('shape', this.shape, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Shape.prototype.removeEventListener = function () {\n        this.parent.off('shape', this.shape);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Shape.prototype.shape = function (args) {\n        var parent = this.parent;\n        this.initShapePvtProps();\n        var uploader;\n        switch (args.prop) {\n            case 'drawEllipse':\n                this.drawEllipse(args.value['x'], args.value['y'], args.value['radiusX'], args.value['radiusY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected']);\n                break;\n            case 'drawLine':\n                this.drawLine(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawArrow':\n                this.drawArrow(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['arrowStart'], args.value['arrowEnd'], args.value['isSelected']);\n                break;\n            case 'drawPath':\n                this.drawPath(args.value['pointColl'], args.value['strokeWidth'], args.value['strokeColor'], args.value['isSelected']);\n                break;\n            case 'drawRectangle':\n                this.drawRectangle(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['degree'], args.value['isSelected'], args.value['radius']);\n                break;\n            case 'drawText':\n                this.drawText(args.value['x'], args.value['y'], args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['color'], args.value['isSelected'], args.value['degree'], args.value['fillColor'], args.value['outlineColor'], args.value['outlineWidth'], args.value['transformCollection']);\n                break;\n            case 'redrawActObj':\n                this.redrawActObj(args.value['x'], args.value['y'], args.value['isMouseDown']);\n                break;\n            case 'apply':\n                this.apply(args.value['shape'], args.value['obj'], args.value['canvas']);\n                break;\n            case 'updateShapeChangeEventArgs':\n                this.updateShapeChangeEventArgs(args.value['shapeSettings'], args.value['allowShapeOverflow']);\n                break;\n            case 'updSelChangeEventArgs':\n                this.updSelChangeEventArgs(args.value['selectionSettings']);\n                break;\n            case 'iterateObjColl':\n                this.iterateObjColl();\n                break;\n            case 'updImgRatioForActObj':\n                this.updImgRatioForActObj();\n                break;\n            case 'redrawObj':\n                this.redrawObj(args.value['degree']);\n                break;\n            case 'redraw-text':\n                this.redrawText();\n                break;\n            case 'draw-shape':\n                this.drawShape(args.value['obj'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['start'], args.value['width'], args.value['height']);\n                break;\n            case 'renderTextArea':\n                this.renderTextArea(args.value['x'], args.value['y'], args.value['actObj']);\n                break;\n            case 'setTextBoxWidth':\n                this.setTextBoxWidth(args.value['e']);\n                break;\n            case 'findTextTarget':\n                this.findTextTarget(args.value['e']);\n                break;\n            case 'updateFontStyles':\n                this.updateFontStyles(args.value['isTextBox']);\n                break;\n            case 'applyFontStyle':\n                this.applyFontStyle(args.value['item']);\n                break;\n            case 'updateFontRatio':\n                this.updateFontRatio(args.value['obj'], args.value['isTextArea']);\n                break;\n            case 'updateFontSize':\n                this.updateFontSize(args.value['obj']);\n                break;\n            case 'pushActItemIntoObj':\n                this.pushActItemIntoObj();\n                break;\n            case 'clearActObj':\n                this.clearActObj();\n                break;\n            case 'refreshActiveObj':\n                this.refreshActiveObj();\n                break;\n            case 'applyActObj':\n                this.applyActObj(args.value['isMouseDown']);\n                break;\n            case 'wireEvent':\n                EventHandler.add(parent.upperCanvas, 'dblclick', this.findTextTarget, this);\n                EventHandler.add(parent.textArea, 'mousedown', this.findTextTarget, this);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                if (uploader) {\n                    EventHandler.add(uploader, 'change', this.fileChanged, this);\n                }\n                break;\n            case 'unWireEvent':\n                EventHandler.remove(parent.upperCanvas, 'dblclick', this.findTextTarget);\n                EventHandler.remove(parent.textArea, 'mousedown', this.findTextTarget);\n                uploader = document.getElementById(parent.element.id + '_fileUpload');\n                if (uploader) {\n                    EventHandler.remove(uploader, 'change', this.fileChanged);\n                }\n                break;\n            case 'getShapeSetting':\n                this.getShapeSetting(args.value['id'], args.value['obj']);\n                break;\n            case 'getShapeSettings':\n                this.getShapeSettings(args.value['obj']);\n                break;\n            case 'getRedactSettings':\n                this.getRedactSettings(args.value['obj']);\n                break;\n            case 'isPointsInRange':\n                this.isPointsInRange(args.value['x'], args.value['y'], args.value['obj']);\n                break;\n            case 'alignRotateFlipColl':\n                this.alignRotateFlipColl(args.value['collection'], args.value['isRotateFlipCollection'], args.value['obj']);\n                break;\n            case 'selectShape':\n                this.selectShape(args.value['id'], args.value['obj']);\n                break;\n            case 'deleteShape':\n                this.deleteShape(args.value['id']);\n                break;\n            case 'getMaxText':\n                this.getMaxText(args.value['isTextBox'], args.value['text'], args.value['obj']);\n                break;\n            case 'setPointCollForLineArrow':\n                args.value['obj'].pointColl = this.getLinePoints(args.value['obj'].activePoint.startX, args.value['obj'].activePoint.startY, args.value['obj'].activePoint.endX, args.value['obj'].activePoint.endY);\n                break;\n            case 'setPointCollForShapeRotation':\n                this.setPointCollForShapeRotation(args.value['obj']);\n                break;\n            case 'setTextSettings':\n                if (args.value['textSettings']) {\n                    this.textSettings = args.value['textSettings'];\n                }\n                else if (args.value['fontFamily']) {\n                    this.textSettings.fontFamily = args.value['fontFamily'];\n                }\n                else if (args.value['fontSize']) {\n                    this.textSettings.fontSize = args.value['fontSize'];\n                }\n                else if (args.value['radius']) {\n                    this.strokeSettings.radius = args.value['radius'];\n                }\n                break;\n            case 'setStrokeSettings':\n                if (args.value['strokeSettings']) {\n                    this.strokeSettings = args.value['strokeSettings'];\n                }\n                else if (args.value['strokeColor']) {\n                    this.strokeSettings.strokeColor = args.value['strokeColor'];\n                }\n                else if (args.value['fillColor']) {\n                    this.strokeSettings.fillColor = args.value['fillColor'];\n                }\n                else if (args.value['strokeWidth']) {\n                    this.strokeSettings.strokeWidth = args.value['strokeWidth'];\n                }\n                else if (args.value['outlineColor']) {\n                    this.strokeSettings.outlineColor = args.value['outlineColor'];\n                }\n                else if (args.value['radius']) {\n                    this.strokeSettings.radius = args.value['radius'];\n                }\n                else if (args.value['outlineWidth']) {\n                    this.strokeSettings.outlineWidth = args.value['outlineWidth'];\n                }\n                break;\n            case 'getStrokeSettings':\n                args.value['obj']['strokeSettings'] = this.strokeSettings;\n                break;\n            case 'setKeyHistory':\n                this.keyHistory = args.value['keyHistory'];\n                break;\n            case 'getKeyHistory':\n                args.value['obj']['keyHistory'] = this.keyHistory;\n                break;\n            case 'setTextBoxPos':\n                this.setTextBoxPos(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'setTextBoxPoints':\n                this.setTextBoxPoints(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'alignTextAreaIntoCanvas':\n                this.alignTextAreaIntoCanvas();\n                break;\n            case 'initializeTextShape':\n                this.initializeTextShape(args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['strokeColor'], args.value['fillColor'], args.value['outlineColor'], args.value['outlineWidth']);\n                break;\n            case 'stopPathDrawing':\n                this.stopPathDrawing(args.value['e'], args.value['isApply']);\n                break;\n            case 'updateArrowRatio':\n                this.updateArrowRatio(args.value['obj']);\n                break;\n            case 'getSquarePointForRotatedShape':\n                this.getSquarePointForRotatedShape(args.value['obj'], args.value['object']);\n                break;\n            case 'drawImage':\n                this.drawImage(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['src'], args.value['degree'], args.value['isAspectRatio'], args.value['opacity'], args.value['isSelected']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'updateObj':\n                this.updateObj(args.value['dimObj'], args.value['x'], args.value['y']);\n                break;\n            case 'straightenShapes':\n                this.straightenShapes();\n                break;\n            case 'straightenShapePoints':\n                this.straightenShapePoints(args.value['obj'], args.value['isReverse']);\n                break;\n            case 'straightenPath':\n                this.straightenPath(args.value['obj']);\n                break;\n            case 'straightenFHD':\n                this.straightenFHD();\n                break;\n            case 'getTextBoxPosition':\n                this.getTextBoxPosition(args.value['obj'], args.value['object']);\n                break;\n            case 'setFlipState':\n                this.setFlipState(args.value['x'], args.value['y'], args.value['obj'], args.value['object']);\n                break;\n            case 'getNewShapeId':\n                args.value['obj']['id'] = this.getNewShapeId();\n                break;\n            case 'z-order':\n                this.updateZOrder(args.value['obj'], args.value['value']);\n                break;\n            case 'getSmallestIndex':\n                args.value['obj']['index'] = this.getSmallestIndex();\n                break;\n            case 'isIndexInObjColl':\n                args.value['obj']['bool'] = this.isIndexInObjColl(args.value['index']);\n                break;\n            case 'drawAnnotations':\n                this.drawAnnotations(args.value['ctx'], args.value['shape'], args.value['pen'], args.value['isPreventApply'], args.value['x'], args.value['y'], args.value['panRegion']);\n                break;\n            case 'updateShapeColl':\n                this.updateShapeColl();\n                break;\n            case 'getNewOrder':\n                args.value['obj']['order'] = this.getNewOrder();\n                break;\n            case 'getHighestOrder':\n                args.value['obj']['order'] = this.getHighestOrder();\n                break;\n            case 'getLowestOrder':\n                args.value['obj']['order'] = this.getLowestOrder();\n                break;\n            case 'drawRedact':\n                this.drawRedact(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['type'], args.value['value']);\n                break;\n            case 'setRedactType':\n                this.redactType = args.value['redactType'];\n                break;\n        }\n    };\n    Shape.prototype.getModuleName = function () {\n        return 'shape';\n    };\n    Shape.prototype.initShapePvtProps = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.shapeImg)) {\n            this.shapeImg = parent.createElement('img', {\n                id: parent.element.id + '_shapeImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n            });\n        }\n        if (this.textSettings.fontFamily === '') {\n            this.textSettings.fontFamily = parent.fontFamily.default;\n        }\n    };\n    Shape.prototype.reset = function () {\n        this.textSettings =\n            { text: 'Enter Text', fontFamily: this.parent.fontFamily.default, fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null, radius: null, outlineColor: '', outlineWidth: null };\n        this.preventFrameAnnotation = false;\n    };\n    Shape.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        this.initializeShape('ellipse');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('ellipse', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY, null, null, null, degree, null, isSelected);\n    };\n    Shape.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        this.initializeShape('line');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('line', strokeWidth, strokeColor, null, start, width, height, null, null, null, null, null, isSelected);\n    };\n    Shape.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        this.initializeShape('path');\n        if (pointColl) {\n            this.drawShape('path', strokeWidth, strokeColor, null, null, null, null, pointColl, null, null, null, null, isSelected);\n        }\n    };\n    Shape.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        this.initializeShape('arrow');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('arrow', strokeWidth, strokeColor, null, start, width, height, null, arrowStart, arrowEnd, null, null, isSelected);\n    };\n    Shape.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected, radius) {\n        this.initializeShape('rectangle');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height, null, null, null, degree, null, isSelected, radius);\n    };\n    // eslint-disable-next-line @typescript-eslint/tslint/config\n    Shape.prototype.drawRedact = function (x, y, width, height, type, value) {\n        this.initializeShape('redact');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('redact', null, null, null, start, width, height, null, null, null, null, null, null, null, type, value);\n    };\n    Shape.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected, degree, fillColor, outlineColor, outlineWidth, transformCollection) {\n        this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y, isSelected, degree, fillColor, outlineColor, outlineWidth, transformCollection);\n    };\n    Shape.prototype.initializeShape = function (type) {\n        var parent = this.parent;\n        this.redrawActObj();\n        parent.activeObj.shape = type;\n        parent.currObjType.isCustomCrop = false;\n    };\n    Shape.prototype.updateWidthHeight = function (obj) {\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        return obj;\n    };\n    Shape.prototype.setDimension = function (width, height) {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape;\n        if ((width && height) || ((shape === 'line' || shape === 'arrow') && (width || height))) {\n            parent.activeObj.activePoint.width = width;\n            parent.activeObj.activePoint.height = height;\n            if (parent.currObjType.shape.toLowerCase() === 'ellipse') {\n                parent.activeObj.activePoint.width = 2 * width;\n                parent.activeObj.activePoint.height = 2 * height;\n            }\n        }\n    };\n    Shape.prototype.getArrowType = function (type) {\n        var arrowType = type;\n        if (type) {\n            var typeToArrowType = { 'None': 'none', 'Arrow': 'arrow', 'SolidArrow': 'arrowSolid',\n                'Circle': 'circle', 'SolidCircle': 'circleSolid', 'Square': 'square', 'SolidSquare': 'squareSolid', 'Bar': 'bar' };\n            arrowType = typeToArrowType[\"\" + type];\n        }\n        return arrowType;\n    };\n    Shape.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height, pointColl, arrowStart, arrowEnd, degree, opacity, isSelected, radius, redactType, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            this.redrawActObj();\n            var objColl = extend([], parent.objColl, [], true);\n            parent.togglePen = false;\n            this.keyHistory = '';\n            parent.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            parent.currObjType.shape = type = type.toLowerCase();\n            if (type !== 'freehanddraw' && type !== '') {\n                parent.activeObj.shape = type;\n                var strokeSettings = parent.activeObj.strokeSettings;\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                if (isNullOrUndefined(strokeSettings)) {\n                    strokeSettings = this.strokeSettings;\n                }\n                if (type === 'path' && pointColl) {\n                    parent.activeObj.pointColl = pointColl;\n                }\n                if (opacity !== null && opacity !== undefined) {\n                    parent.activeObj.opacity = opacity;\n                }\n                strokeSettings.strokeWidth = strokeWidth ? strokeWidth : strokeSettings.strokeWidth;\n                var shape = parent.activeObj.shape;\n                if ((shape === 'rectangle' || shape === 'ellipse') && strokeWidth === 0) {\n                    strokeSettings.strokeWidth = 0;\n                }\n                strokeSettings.strokeColor = strokeColor ? strokeColor : strokeSettings.strokeColor;\n                strokeSettings.fillColor = fillColor || fillColor === '' ? fillColor : strokeSettings.fillColor;\n                strokeSettings.radius = radius ? radius : strokeSettings.radius;\n                var tempWidth = parent.img.destWidth > 100 ? 100 : parent.img.destWidth / 2;\n                var tempHeight = parent.img.destHeight > 100 ? 100 : parent.img.destHeight / 2;\n                parent.activeObj.activePoint.width = tempWidth;\n                parent.activeObj.activePoint.height = tempHeight;\n                if (type === 'line' || type === 'arrow') {\n                    parent.activeObj.lineDraw = 'horizontal';\n                    parent.activeObj.activePoint.height = 0;\n                    if (type === 'arrow') {\n                        parent.activeObj.activePoint.width += 50;\n                        parent.activeObj.start = this.getArrowType(arrowStart);\n                        parent.activeObj.end = this.getArrowType(arrowEnd);\n                    }\n                }\n                else if (type === 'rectangle') {\n                    parent.activeObj.activePoint.width += parent.activeObj.activePoint.width / 2;\n                }\n                else if (type === 'redact') {\n                    if (redactType) {\n                        parent.activeObj.redactType = redactType.toLowerCase();\n                        if (redactType === RedactType.Blur) {\n                            if (value) {\n                                parent.activeObj.redactBlur = value;\n                            }\n                        }\n                        else {\n                            if (value) {\n                                parent.activeObj.redactPixelate = value;\n                            }\n                        }\n                        parent.activeObj.redactImage = parent.createElement('canvas');\n                    }\n                }\n                this.setDimension(width, height);\n                if (start) {\n                    parent.activeObj.activePoint.startX = start.x;\n                    parent.activeObj.activePoint.startY = start.y;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX +\n                        parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY +\n                        parent.activeObj.activePoint.height;\n                }\n                else {\n                    this.setCenterPoints();\n                }\n                this.setPointCollForLineAndArrow();\n                if (type === 'arrow') {\n                    parent.activeObj.triangleDirection = 'right';\n                }\n                parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n                this.initShapeProps();\n                var obj = { shapeSettingsObj: {} };\n                parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n                var shapeSettings = obj['shapeSettingsObj'];\n                var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.editCompleteArgs = shapeChangingArgs;\n                this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n                this.setDimension(width, height);\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                if (degree) {\n                    parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                    parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                }\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n                parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n                if (type === 'redact') {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                else {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                if (parent.isPublicMethod && !isSelected) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n                }\n                parent.isPublicMethod = false;\n            }\n        }\n    };\n    Shape.prototype.initShapeProps = function () {\n        var parent = this.parent;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n        parent.activeObj.order = this.getNewOrder();\n    };\n    Shape.prototype.setPointCollForLineAndArrow = function () {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        if (shape === 'line' || shape === 'arrow') {\n            parent.activeObj.pointColl = this.getLinePoints(startX, startY, endX, endY);\n            if (parent.activeObj.pointColl) {\n                for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                    parent.activeObj.pointColl[i].ratioX = (parent.activeObj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    parent.activeObj.pointColl[i].ratioY = (parent.activeObj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n    };\n    Shape.prototype.prevObjColl = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevObj = object['currObj'];\n        this.prevObj.objColl = extend([], parent.objColl, [], true);\n        this.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        this.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n    };\n    Shape.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y, isSelected, degree, fillColor, outlineColor, outlineWidth, transformCollection) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                parent.currObjType.shape = '';\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.togglePen = false;\n            this.redrawActObj();\n            this.prevObjColl();\n            this.refreshActiveObj();\n            parent.activeObj.shape = parent.currObjType.shape = 'text';\n            parent.currObjType.isCustomCrop = false;\n            this.initializeTextShape(text, fontFamily, fontSize, bold, italic, strokeColor, fillColor, outlineColor, outlineWidth);\n            parent.currObjType.isText = parent.currObjType.isInitialText = true;\n            if (isNullOrUndefined(parent.activeObj.textSettings.fontSize)) {\n                parent.getFontSizes();\n                parent.activeObj.textSettings.fontSize = parseInt(parent.fontSizeColl[(parseInt('3', 10) - 1)].text, 10);\n            }\n            if (parent.img.destWidth < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destWidth / 20));\n            }\n            else if (parent.img.destHeight < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destHeight / 20));\n            }\n            parent.activeObj.shapeDegree = parent.transform.degree;\n            parent.activeObj.shapeFlip = parent.transform.currFlipState;\n            parent.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            parent.activeObj.order = this.getNewOrder();\n            var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n            var height = parent.activeObj.textSettings.fontSize;\n            if (text) {\n                parent.activeObj.keyHistory = text;\n                var maxText = this.getMaxText();\n                maxText = maxText ? maxText : parent.activeObj.textSettings.text;\n                width = this.upperContext.measureText(maxText).width + parent.activeObj.textSettings.fontSize * 0.5;\n                var rows = text.split('\\n');\n                if (rows.length > 1) {\n                    height = rows.length * parent.activeObj.textSettings.fontSize;\n                    height += (fontSize * 0.25);\n                }\n            }\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                parent.activeObj.activePoint.startX = x;\n                parent.activeObj.activePoint.startY = y;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            if (transformCollection) {\n                parent.notify('selection', { prop: 'setTransformedShape', onPropertyChange: false, value: { bool: true } });\n                this.setTransformColl(transformCollection);\n                var actObj = parent.activeObj;\n                actObj.shapeDegree = 0;\n                actObj.shapeFlip = '';\n                var tempDegree = 0;\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var coll = actObj.rotateFlipColl;\n                for (var i = 0; i < coll.length; i++) {\n                    if (typeof (coll[i]) === 'number') {\n                        tempDegree += coll[i];\n                    }\n                }\n                if (tempDegree % 90 === 0 && Math.abs(tempDegree) % 180 === 90) {\n                    actObj.activePoint.endX = actObj.activePoint.startX + height;\n                    actObj.activePoint.endY = actObj.activePoint.startY + width;\n                    actObj.activePoint.width = actObj.activePoint.endX - actObj.activePoint.startX;\n                    actObj.activePoint.height = actObj.activePoint.endY - actObj.activePoint.startY;\n                }\n            }\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            parent.trigger('shapeChanging', shapeChangingArgs);\n            parent.editCompleteArgs = shapeChangingArgs;\n            this.drawShapeTextEvent(shapeChangingArgs);\n            if (degree) {\n                parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            if (text && text.indexOf('\\n') > -1 && parent.isPublicMethod) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                var fontSizeInd = String(parent.fontSizeColl.findIndex(function (item) { return item.text === String(parent.activeObj.textSettings.fontSize); }) + 1);\n                parent.noPushUndo = true;\n                parent.updateFontSize('5');\n                if (parseInt(fontSizeInd, 10) > 0) {\n                    parent.updateFontSize(fontSizeInd);\n                }\n                parent.noPushUndo = false;\n            }\n            if (parent.isPublicMethod && !isSelected) {\n                parent.notify('undo-redo', { prop: 'updateUndoRedo', value: { operation: 'shapeInsert' }, onPropertyChange: false });\n            }\n            parent.isPublicMethod = false;\n        }\n    };\n    Shape.prototype.drawShapeImageEvent = function (shapeChangingArgs, isSelect) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl, previousCropObj: prevCropObj,\n                previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        if (isSelect) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        else {\n            parent.okBtn(null, true);\n        }\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n    };\n    Shape.prototype.setTransformColl = function (transformCollection) {\n        var parent = this.parent;\n        parent.activeObj.rotateFlipColl = [];\n        if (transformCollection) {\n            for (var i = 0; i < transformCollection.length; i++) {\n                if (transformCollection[i].degree) {\n                    parent.activeObj.rotateFlipColl.push(transformCollection[i].degree);\n                }\n                else {\n                    parent.activeObj.rotateFlipColl.push(transformCollection[i].flip.toLowerCase());\n                }\n            }\n        }\n    };\n    Shape.prototype.drawShapeTextEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n        this.addLetter(parent.activeObj.textSettings.text);\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        this.updateFontRatio(parent.activeObj);\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeInsert', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n    };\n    Shape.prototype.initializeTextShape = function (text, fontFamily, fontSize, bold, italic, strokeColor, fillColor, outlineColor, outlineWidth) {\n        var parent = this.parent;\n        this.keyHistory = '';\n        parent.upperCanvas.style.display = 'block';\n        parent.activeObj.strokeSettings.strokeColor = strokeColor || parent.activeObj.strokeSettings.strokeColor;\n        parent.activeObj.strokeSettings.fillColor = fillColor || parent.activeObj.strokeSettings.fillColor;\n        parent.activeObj.textSettings.text = text || parent.activeObj.textSettings.text;\n        parent.activeObj.textSettings.fontFamily = fontFamily || parent.activeObj.textSettings.fontFamily;\n        parent.activeObj.textSettings.fontSize = fontSize || parent.activeObj.textSettings.fontSize;\n        parent.activeObj.textSettings.bold = bold || parent.activeObj.textSettings.bold;\n        parent.activeObj.textSettings.italic = italic || parent.activeObj.textSettings.italic;\n        parent.activeObj.strokeSettings.outlineColor = outlineColor || parent.activeObj.strokeSettings.outlineColor;\n        parent.activeObj.strokeSettings.outlineWidth = outlineWidth || parent.activeObj.strokeSettings.outlineWidth;\n    };\n    Shape.prototype.drawImage = function (x, y, width, height, src, degree, isAspectRatio, opacity, isSelected) {\n        this.initializeShape('image');\n        this.onLoadImgShape(x, y, width, height, src, null, degree, isAspectRatio, opacity, isSelected);\n    };\n    Shape.prototype.redrawActObj = function (x, y, isMouseDown) {\n        var splitWords;\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n            if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n                this.updateFontRatio(parent.activeObj, true);\n                if (x && y) {\n                    if ((x !== parent.activeObj.activePoint.startX) && (y !== parent.activeObj.activePoint.startY)) {\n                        this.updateTextFromTextArea();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea();\n                    parent.textArea.style.transform = '';\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                this.refreshActiveObj();\n            }\n            else {\n                this.applyActObj(isMouseDown);\n            }\n        }\n    };\n    Shape.prototype.apply = function (shape, obj, canvas) {\n        var parent = this.parent;\n        if (!parent.disabled) {\n            if (parent.togglePen && !parent.currObjType.isCustomCrop) {\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.togglePen = false;\n                if (parent.isCircleCrop || (parent.currSelectionPoint &&\n                    parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.img.destWidth = destWidth;\n                parent.img.destHeight = destHeight;\n                this.lowerContext.filter = temp;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                if (isNullOrUndefined(parent.activeObj.shape) && isNullOrUndefined(shape)) {\n                    parent.currObjType.shape = '';\n                }\n                else {\n                    parent.currObjType.shape = shape || parent.currObjType.shape;\n                }\n                if (parent.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj, isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                    }\n                    else {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj } });\n                    }\n                    parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                    if (!shape && parent.currObjType.shape !== '' && !parent.currObjType.isCustomCrop) {\n                        parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n            }\n        }\n    };\n    Shape.prototype.setCenterPoints = function (text, width, height) {\n        var parent = this.parent;\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = parent.activeObj.activePoint.width;\n            renderHeight = parent.activeObj.activePoint.height;\n        }\n        parent.activeObj.activePoint.startX = (parent.lowerCanvas.width / 2) - renderWidth / 2;\n        parent.activeObj.activePoint.startY = (parent.lowerCanvas.height / 2) - renderHeight / 2;\n        parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + renderWidth / 2;\n        parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) + renderHeight / 2;\n    };\n    Shape.prototype.updSelChangeEventArgs = function (selectionSettings) {\n        var parent = this.parent;\n        parent.activeObj.activePoint = { startX: selectionSettings.startX, startY: selectionSettings.startY,\n            endX: parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width,\n            endY: parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height,\n            width: selectionSettings.width, height: selectionSettings.height };\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n    };\n    Shape.prototype.updateShapeChangeEventArgs = function (shapeSettings, allowShapeOverflow) {\n        var parent = this.parent;\n        var shapeId;\n        if (shapeSettings.id && shapeSettings.id.indexOf('shape_') === -1 &&\n            shapeSettings.id.indexOf('pen_') === -1) {\n            if (parent.activeObj.currIndex) {\n                parent.activeObj.currIndex = 'shape_' + shapeSettings.id;\n            }\n            else {\n                parent.pointColl[shapeId].id = 'pen_' + shapeSettings.id;\n            }\n        }\n        if (shapeSettings.id && shapeSettings.id.split('_')[0] && shapeSettings.id.split('_')[0] === 'pen') {\n            shapeId = parseInt(shapeSettings.id.split('_')[1], 10) - 1;\n            parent.pointColl[shapeId].points = shapeSettings.points;\n            parent.pointColl[shapeId].strokeColor = shapeSettings.strokeColor;\n            parent.pointColl[shapeId].strokeWidth = shapeSettings.strokeWidth;\n            parent.pointColl[shapeId].opacity = shapeSettings.opacity;\n            parent.pointColl[shapeId].order = shapeSettings.index;\n        }\n        else {\n            parent.activeObj.activePoint.startX = shapeSettings.startX;\n            parent.activeObj.activePoint.startY = shapeSettings.startY;\n            if (shapeSettings.width && shapeSettings.height) {\n                parent.activeObj.activePoint.width = shapeSettings.width;\n                parent.activeObj.activePoint.height = shapeSettings.height;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n            }\n            if (parent.activeObj.shape !== 'text') {\n                parent.activeObj.strokeSettings.strokeColor = shapeSettings.strokeColor;\n                parent.activeObj.strokeSettings.strokeWidth = shapeSettings.strokeWidth;\n            }\n            parent.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n            parent.activeObj.opacity = shapeSettings.opacity;\n            parent.activeObj.order = shapeSettings.index;\n            parent.activeObj.preventShapeDragOut = !allowShapeOverflow;\n            if (isNullOrUndefined(shapeSettings.degree)) {\n                shapeSettings.degree = 0;\n            }\n            switch (parent.activeObj.shape) {\n                case 'ellipse':\n                    parent.activeObj.activePoint.width = shapeSettings.radiusX * 2;\n                    parent.activeObj.activePoint.height = shapeSettings.radiusY * 2;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    break;\n                case 'line':\n                case 'arrow':\n                    parent.activeObj.activePoint.width = shapeSettings.length;\n                    parent.activeObj.activePoint.endX = shapeSettings.endX;\n                    parent.activeObj.activePoint.endY = shapeSettings.endY;\n                    parent.activeObj.activePoint.width = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n                    if (parent.activeObj.shape === 'arrow') {\n                        parent.activeObj.start = this.getArrowType(shapeSettings.arrowHead);\n                        parent.activeObj.end = this.getArrowType(shapeSettings.arrowTail);\n                    }\n                    break;\n                case 'text':\n                    parent.activeObj.keyHistory = parent.activeObj.textSettings.text = shapeSettings.text;\n                    parent.activeObj.textSettings.fontSize = shapeSettings.fontSize;\n                    parent.activeObj.strokeSettings.strokeColor = shapeSettings.color;\n                    parent.activeObj.strokeSettings.outlineColor = shapeSettings.strokeColor;\n                    parent.activeObj.strokeSettings.outlineWidth = shapeSettings.strokeWidth;\n                    parent.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n                    parent.activeObj.textSettings.fontFamily = shapeSettings.fontFamily;\n                    this.setTransformColl(shapeSettings.transformCollection);\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    this.updateFontRatio(parent.activeObj);\n                    break;\n                case 'rectangle':\n                case 'image':\n                    if (shapeSettings.degree) {\n                        parent.activeObj.rotatedAngle = shapeSettings.degree * (Math.PI / 180);\n                    }\n                    // Prevented setting image src as it cannot be set in canvas\n                    break;\n                case 'path':\n                    parent.activeObj.pointColl = shapeSettings.points;\n                    break;\n            }\n            if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                parent.activeObj.textSettings.underline = false;\n                for (var i = 0; i < shapeSettings.fontStyle.length; i++) {\n                    switch (shapeSettings.fontStyle[i]) {\n                        case 'bold':\n                            parent.activeObj.textSettings.bold = true;\n                            break;\n                        case 'italic':\n                            parent.activeObj.textSettings.italic = true;\n                            break;\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.addLetter = function (letter) {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none' && (parent.currObjType.isText || parent.activeObj.shape === 'text')) {\n            var fontSize = parent.activeObj.textSettings.fontSize;\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory).width + fontSize * 0.5;\n            var height = fontSize;\n            this.upperContext.fillText(this.keyHistory, parent.activeObj.activePoint.startX, parent.activeObj.activePoint.startY + fontSize);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isText = true;\n            parent.notify('selection', { prop: 'setActivePoint', onPropertyChange: false,\n                value: { startX: width, startY: height } });\n        }\n    };\n    Shape.prototype.redrawText = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.textSettings, fontSize = _a.fontSize, fontFamily = _a.fontFamily, bold = _a.bold, italic = _a.italic;\n        var fontStyle = '';\n        if (bold) {\n            fontStyle += 'bold ';\n        }\n        if (italic) {\n            fontStyle += 'italic ';\n        }\n        this.upperContext.font = fontStyle + fontSize + 'px ' + fontFamily;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var text = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + fontSize * 0.5;\n        var height = rows.length * fontSize;\n        if (rows.length > 1) {\n            height += (fontSize * 0.50);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.activeObj } });\n    };\n    Shape.prototype.updateTextFromTextArea = function () {\n        var parent = this.parent;\n        var allowUndoRedo = false;\n        var fontSize = parent.activeObj.textSettings.fontSize;\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (parent.activeObj.keyHistory !== parent.textArea.value) {\n            allowUndoRedo = true;\n        }\n        parent.activeObj.keyHistory = parent.textArea.value;\n        parent.textArea.style.display = 'none';\n        parent.textArea.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(parent.activeObj.keyHistory).width + fontSize * 0.5;\n        var height = fontSize;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            height += (fontSize * 0.1 * rows.length);\n            var widthColl = [];\n            for (var i = 0, len = rows.length; i < len; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width + fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var width_1 = parent.activeObj.activePoint.width - tempActiveObj.activePoint.width;\n            var height_1 = parent.activeObj.activePoint.height - tempActiveObj.activePoint.height;\n            var value = '';\n            if (width_1 > 0 && height_1 > 0) {\n                value = 'widthHeight';\n            }\n            else if (width_1 !== 0) {\n                value = 'width';\n            }\n            else if (height_1 !== 0) {\n                value = 'height';\n            }\n            parent.activeObj.activePoint = extend({}, tempActiveObj.activePoint, {}, true);\n            parent.notify('selection', { prop: 'adjustRotationPoints', onPropertyChange: false, value: { rectangle: parent.activeObj.activePoint,\n                    x: width_1, y: height_1, angle: parent.activeObj.rotatedAngle, type: 'text', elem: value } });\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.updImgRatioForActObj();\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        if (allowUndoRedo) {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'text', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: parent.activeObj.keyHistory,\n                    currentText: parent.textArea.value, previousFilter: null, isCircleCrop: null } });\n        }\n        else {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n        }\n    };\n    Shape.prototype.iterateObjColl = function () {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            var index = this.getSmallestIndex();\n            var objColl = extend([], parent.objColl, [], true);\n            while (objColl.length > 0) {\n                var found = false;\n                for (var i = 0; i < objColl.length; i++) {\n                    var currentObj = objColl[i];\n                    if (isNullOrUndefined(currentObj.order)) {\n                        objColl.splice(i, 1);\n                        i--;\n                        continue;\n                    }\n                    if (currentObj.order === index) {\n                        this.apply(currentObj.shape, currentObj);\n                        if (currentObj.shape === 'redact' && JSON.stringify(currentObj.activePoint) === JSON.stringify(parent.activeObj.activePoint) &&\n                            currentObj.redactImage !== parent.activeObj.redactImage) {\n                            currentObj.redactImage = parent.activeObj.redactImage;\n                            if (parent.objColl[i] && JSON.stringify(parent.objColl[i].activePoint) ===\n                                JSON.stringify(currentObj.activePoint)) {\n                                parent.objColl[i].redactImage = parent.activeObj.redactImage;\n                            }\n                        }\n                        this.refreshActiveObj();\n                        index++;\n                        if (!this.isIndexInObjColl(index)) {\n                            index++;\n                        }\n                        objColl.splice(i, 1);\n                        found = true;\n                        break; // Exit the loop to start from the beginning\n                    }\n                }\n                if (!found) {\n                    break; // If no matching order was found, exit the loop\n                }\n            }\n        }\n    };\n    Shape.prototype.getSmallestIndex = function () {\n        var parent = this.parent;\n        var smallestIndex;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currentObj = parent.objColl[i];\n            if (isNullOrUndefined(currentObj.order)) {\n                continue;\n            }\n            if (isNullOrUndefined(smallestIndex) || currentObj.order < smallestIndex) {\n                smallestIndex = currentObj.order;\n            }\n        }\n        return smallestIndex;\n    };\n    Shape.prototype.isIndexInObjColl = function (index) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currentObj = parent.objColl[i];\n            if (isNullOrUndefined(currentObj.order)) {\n                continue;\n            }\n            if (currentObj.order === index) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Shape.prototype.updImgRatioForActObj = function () {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var activePoint = parent.activeObj.activePoint;\n        parent.activeObj.imageRatio = { startX: ((activePoint.startX - destLeft) /\n                destWidth), startY: ((activePoint.startY - destTop) / destHeight),\n            endX: ((activePoint.endX - destLeft) / destWidth),\n            endY: ((activePoint.endY - destTop) / destHeight),\n            width: destWidth / activePoint.width, height: destHeight / activePoint.height };\n        if (parent.activeObj.rotationCirclePointColl) {\n            parent.activeObj.rotationCirclePointColl.ratioX = (parent.activeObj.rotationCirclePointColl.x -\n                destLeft) / destWidth;\n            parent.activeObj.rotationCirclePointColl.ratioY = (parent.activeObj.rotationCirclePointColl.y -\n                destTop) / destHeight;\n        }\n        if (parent.activeObj.shape === 'path') {\n            this.updatePathRatio(parent.activeObj);\n        }\n        else if (parent.activeObj.shape === 'arrow') {\n            this.updateArrowRatio(parent.activeObj);\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.zoomObjColl = function (preventApply) {\n        var parent = this.parent;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        this.straightenShapes();\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                if (currObj.imageRatio) {\n                    currObj.activePoint.startX = (currObj.imageRatio.startX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.activePoint.startY = (currObj.imageRatio.startY * parent.img.destHeight) + parent.img.destTop;\n                    currObj.activePoint.endX = (currObj.imageRatio.endX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.activePoint.endY = (currObj.imageRatio.endY * parent.img.destHeight) + parent.img.destTop;\n                }\n                currObj = this.updateWidthHeight(currObj);\n                if (currObj.shape === 'text') {\n                    this.updateFontSize(currObj);\n                }\n                else if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                    currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                    for (var n = 0, len_1 = currObj.pointColl.length; n < len_1; n++) {\n                        currObj.pointColl[n].ratioX =\n                            (currObj.pointColl[n].x - parent.img.destLeft) / parent.img.destWidth;\n                        currObj.pointColl[n].ratioY =\n                            (currObj.pointColl[n].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                    if (currObj.shape === 'arrow') {\n                        this.updateArrowSize(currObj);\n                    }\n                    if (parent.transform.straighten !== 0 && (currObj.shape === 'line' || currObj.shape === 'arrow')) {\n                        this.straightenShapePoints(currObj);\n                    }\n                }\n                else if (currObj.shape === 'path') {\n                    for (var l = 0, len_2 = currObj.pointColl.length; l < len_2; l++) {\n                        currObj.pointColl[l].x = (currObj.pointColl[l].ratioX * parent.img.destWidth) +\n                            parent.img.destLeft;\n                        currObj.pointColl[l].y = (currObj.pointColl[l].ratioY * parent.img.destHeight) +\n                            parent.img.destTop;\n                    }\n                    this.updatePathRatio(currObj);\n                    if (parent.transform.straighten !== 0) {\n                        this.straightenPath(currObj);\n                    }\n                }\n                parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                        obj: currObj } });\n                if (currObj.shape !== 'line' && currObj.shape !== 'arrow' && currObj.shape !== 'path' && currObj.rotatedAngle !== 0) {\n                    this.setPointCollForShapeRotation(currObj);\n                    currObj.rotationCirclePoint.x =\n                        (currObj.rotationCirclePoint.ratioX * parent.img.destWidth) + parent.img.destLeft;\n                    currObj.rotationCirclePoint.y =\n                        (currObj.rotationCirclePoint.ratioY * parent.img.destHeight) + parent.img.destTop;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x =\n                            (currObj.rotationCirclePointColl.ratioX * parent.img.destWidth) + parent.img.destLeft;\n                        currObj.rotationCirclePointColl.y =\n                            (currObj.rotationCirclePointColl.ratioY * parent.img.destHeight) + parent.img.destTop;\n                    }\n                }\n            }\n            if (isNullOrUndefined(preventApply)) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.iterateObjColl();\n                this.lowerContext.filter = temp;\n            }\n        }\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n    };\n    Shape.prototype.straightenPath = function (obj) {\n        var point;\n        for (var j = 0, len = obj.pointColl.length; j < len; j++) {\n            point = this.straightenPoints(obj.pointColl[j].x, obj.pointColl[j].y);\n            obj.pointColl[j].x = point.x;\n            obj.pointColl[j].y = point.y;\n        }\n    };\n    Shape.prototype.straightenFHD = function () {\n        var parent = this.parent;\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            parent.points = extend([], parent.pointColl[i].points, []);\n            var len = parent.points.length;\n            var point = void 0;\n            for (var l = 0; l < len; l++) {\n                point = this.straightenPoints(parent.points[l].x, parent.points[l].y);\n                parent.points[l].x = point.x;\n                parent.points[l].y = point.y;\n            }\n        }\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        for (var i = 0, fLen = parent.freehandCounter; i < fLen; i++) {\n            if (selPointCollObj['selPointColl'][i] && selPointCollObj['selPointColl'][i].points) {\n                var len = selPointCollObj['selPointColl'][i].points.length;\n                var point = void 0;\n                for (var l = 0; l < len; l++) {\n                    point = this.straightenPoints(selPointCollObj['selPointColl'][i].points[l].x, selPointCollObj['selPointColl'][i].points[l].y);\n                    selPointCollObj['selPointColl'][i].points[l].x = point.x;\n                    selPointCollObj['selPointColl'][i].points[l].y = point.y;\n                }\n            }\n        }\n        var straightenObj = { straightenPoint: null };\n        parent.notify('freehand-draw', { prop: 'getStraightenPoint', onPropertyChange: false, value: { obj: straightenObj } });\n        if (straightenObj['straightenPoint']['x'] && straightenObj['straightenPoint']['y']) {\n            var obj = { angle: 0 };\n            parent.notify('freehand-draw', { prop: 'getStraightenPointAngle', onPropertyChange: false, value: { obj: obj } });\n            var angle = (((parent.transform.straighten === 360 ? 0 : parent.transform.straighten) - obj['angle']) * (Math.PI / 180));\n            var point = this.straightenPoints(straightenObj['straightenPoint']['x'], straightenObj['straightenPoint']['y'], angle);\n            if (angle === 0) {\n                point.x = straightenObj['straightenPoint']['x'];\n                point.y = straightenObj['straightenPoint']['y'];\n            }\n            parent.notify('freehand-draw', { prop: 'setStraightenPoint', onPropertyChange: false, value: { x: point.x, y: point.y } });\n        }\n    };\n    Shape.prototype.straightenPoints = function (x, y, angle) {\n        var parent = this.parent;\n        var center = { x: parent.img.destLeft + (parent.img.destWidth / 2), y: parent.img.destTop + (parent.img.destHeight / 2) };\n        angle = angle ? angle : ((parent.transform.straighten) * (Math.PI / 180));\n        var point = { x: Math.cos(angle) * (x - center.x) - Math.sin(angle) * (y - center.y) + center.x,\n            y: Math.sin(angle) * (x - center.x) + Math.cos(angle) * (y - center.y) + center.y };\n        return point;\n    };\n    Shape.prototype.straightenShapes = function () {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool'] || parent.transform.straighten === 0) {\n            return;\n        }\n        parent.notify('draw', { prop: 'updateImgCanvasPoints' });\n        var object = { points: null };\n        parent.notify('draw', { prop: 'getImageCanvasPoints', value: { obj: object } });\n        var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n        var angle = -((parent.transform.straighten) * (Math.PI / 180));\n        var p1 = { x: Math.cos(angle) * (object['points'][0]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][0]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][0]['x'] - center.x) + Math.cos(angle) *\n                (object['points'][0]['y'] - center.y) + center.y };\n        var p2 = { x: Math.cos(angle) * (object['points'][1]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][1]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][1]['x'] - center.x) + Math.cos(angle) * (object['points'][1]['y']\n                - center.y) + center.y };\n        var p3 = { x: Math.cos(angle) * (object['points'][2]['x'] - center.x) - Math.sin(angle) *\n                (object['points'][2]['y'] - center.y) + center.x,\n            y: Math.sin(angle) * (object['points'][2]['x'] - center.x) + Math.cos(angle) * (object['points'][2]['y']\n                - center.y) + center.y };\n        parent.img.destWidth = p2.x - p1.x;\n        parent.img.destHeight = p3.y - p2.y;\n        parent.img.destLeft = p1.x;\n        parent.img.destTop = p1.y;\n    };\n    Shape.prototype.straightenShapePoints = function (obj, isReverse) {\n        var parent = this.parent;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!straightenObj['bool']) {\n            return;\n        }\n        if (obj.shape === 'line' || obj.shape === 'arrow') {\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            var center = { x: destLeft + (destWidth / 2), y: destTop + (destHeight / 2) };\n            var angle = (isReverse ? -parent.transform.straighten : parent.transform.straighten) * (Math.PI / 180);\n            var start = { x: Math.cos(angle) * (obj.activePoint.startX - center.x) - Math.sin(angle) *\n                    (obj.activePoint.startY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.startX - center.x) + Math.cos(angle)\n                    * (obj.activePoint.startY - center.y) + center.y };\n            var end = { x: Math.cos(angle) * (obj.activePoint.endX - center.x) -\n                    Math.sin(angle) * (obj.activePoint.endY - center.y) + center.x, y: Math.sin(angle) * (obj.activePoint.endX - center.x) +\n                    Math.cos(angle) * (obj.activePoint.endY - center.y) + center.y };\n            obj.activePoint.startX = start.x;\n            obj.activePoint.startY = start.y;\n            obj.activePoint.endX = end.x;\n            obj.activePoint.endY = end.y;\n            obj.activePoint.width = obj.activePoint.endX > obj.activePoint.startX ? obj.activePoint.endX -\n                obj.activePoint.startX : obj.activePoint.startX - obj.activePoint.endX;\n            obj.activePoint.height = obj.activePoint.endY > obj.activePoint.startY ? obj.activePoint.endY -\n                obj.activePoint.startY : obj.activePoint.startY - obj.activePoint.endY;\n            parent.notify('selection', { prop: 'adjustActObjForLineArrow', onPropertyChange: false, value: { obj: obj } });\n        }\n    };\n    Shape.prototype.redrawObj = function (degree) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n                degree === 'horizontalVertical' || degree === 'verticalHorizontal') {\n                this.updateCurrentActiveObjPoint(degree.toLowerCase());\n            }\n            else if (typeof (degree) === 'number') {\n                this.updateCurrentActiveObjPoint(degree);\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var splitWords = parent.objColl[i].shape.split('-');\n                    if (splitWords[0] !== 'crop') {\n                        this.apply(parent.objColl[i].shape, parent.objColl[i]);\n                        isShape = true;\n                    }\n                }\n                if (isShape) {\n                    parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n                }\n                this.lowerContext.filter = tempFilter;\n            }\n        }\n    };\n    Shape.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var parent = this.parent;\n        var currActObjIndex;\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        for (var index = 0, len = parent.objColl.length; index < len; index++) {\n            var currObj = parent.objColl[index];\n            if (parent.activeObj.shape === currObj.shape &&\n                parent.activeObj.activePoint.startX === currObj.activePoint.startX &&\n                parent.activeObj.activePoint.startY === currObj.activePoint.startY &&\n                parent.activeObj.activePoint.endX === currObj.activePoint.endX &&\n                parent.activeObj.activePoint.endY === currObj.activePoint.endY &&\n                parent.activeObj.currIndex === currObj.currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n            degree === 'horizontalvertical' || degree === 'verticalhorizontal') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX - destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft + destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'horizontal');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = currObj.rotatedAngle + (Math.PI - currObj.rotatedAngle) * 2;\n                            if (currObj.rotationCirclePointColl.x <= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                                    (currObj.rotationCirclePointColl.x - destLeft);\n                            }\n                            else if (currObj.rotationCirclePointColl.x >= destLeft + (destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = destLeft +\n                                    (destLeft + destWidth - currObj.rotationCirclePointColl.x);\n                            }\n                            currObj.rotationCirclePointColl.ratioX =\n                                (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) - (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY - currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop + destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY + currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' ||\n                            currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'vertical');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = -currObj.rotatedAngle;\n                            if (currObj.rotationCirclePointColl.y <= destTop + (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = (destTop + destHeight) - (currObj.rotationCirclePointColl.y - destTop);\n                            }\n                            else if (currObj.rotationCirclePointColl.y >= destTop +\n                                (destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = destTop + (destTop + destHeight - currObj.rotationCirclePointColl.y);\n                            }\n                            currObj.rotationCirclePointColl.ratioY =\n                                (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'verticalhorizontal' || degree === 'horizontalvertical') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.endX = (destLeft + destWidth) - (currObj.activePoint.startX -\n                                destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= destLeft + (destWidth / 2)) {\n                            currObj.activePoint.startX = destLeft + (destLeft +\n                                destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.activePoint.startY <= destTop + (destHeight / 2)) {\n                            currObj.activePoint.endY = (destTop + destHeight) -\n                                (currObj.activePoint.startY - destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY -\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = destTop + (destTop +\n                                destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY +\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, degree);\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                            startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                            endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                            endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                            width: destWidth / currObj.activePoint.width,\n                            height: destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                parent.activeObj = extend({}, parent.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90) {\n            this.rotateObjColl();\n        }\n        else if (degree === -90) {\n            for (var i = 0; i < 3; i++) {\n                this.rotateObjColl();\n            }\n        }\n        else if (typeof (degree) === 'number') {\n            if (degree > 0) {\n                this.rotateObjColl();\n            }\n            else {\n                for (var i = 0; i < 3; i++) {\n                    this.rotateObjColl();\n                }\n            }\n        }\n    };\n    Shape.prototype.rotateObjColl = function () {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            var shape = currObj.shape;\n            currObj.activePoint.startY = destTop + (destHeight * currObj.imageRatio.startX);\n            currObj.activePoint.endY = destTop + (destHeight * currObj.imageRatio.endX);\n            currObj.activePoint.startX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.endY);\n            currObj.activePoint.endX = (destLeft + destWidth) - (destWidth * currObj.imageRatio.startY);\n            currObj = this.updateWidthHeight(parent.objColl[i]);\n            this.updateFontSize(currObj);\n            if (shape === 'line' || shape === 'arrow' || shape === 'path') {\n                this.rotateLineArrowObj(currObj);\n                if (shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n            }\n            else if (currObj.rotatedAngle !== 0) {\n                currObj.rotationCirclePointColl.y = destTop + (destHeight * currObj.rotationCirclePointColl.ratioX);\n                currObj.rotationCirclePointColl.x = (destLeft + destWidth) -\n                    (destWidth * currObj.rotationCirclePointColl.ratioY);\n                currObj.rotationCirclePointColl.ratioX = (currObj.rotationCirclePointColl.x - destLeft) / destWidth;\n                currObj.rotationCirclePointColl.ratioY = (currObj.rotationCirclePointColl.y - destTop) / destHeight;\n            }\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.objColl[i].activePoint, obj: parent.objColl[i] } });\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - destLeft) / destWidth),\n                startY: ((currObj.activePoint.startY - destTop) / destHeight),\n                endX: ((currObj.activePoint.endX - destLeft) / destWidth),\n                endY: ((currObj.activePoint.endY - destTop) / destHeight),\n                width: destWidth / currObj.activePoint.width,\n                height: destHeight / currObj.activePoint.height };\n        }\n    };\n    Shape.prototype.rotateLineArrowObj = function (obj) {\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.pointColl.length > 0) {\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].y = destTop + (destHeight * obj.pointColl[n].ratioX);\n                obj.pointColl[n].x = (destLeft + destWidth) - (destWidth *\n                    obj.pointColl[n].ratioY);\n            }\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].ratioX = (obj.pointColl[n].x - destLeft) / destWidth;\n                obj.pointColl[n].ratioY = (obj.pointColl[n].y - destTop) / destHeight;\n            }\n            var prevPoint = void 0;\n            if (isNullOrUndefined(obj.pointColl[obj.pointColl.length - 2])) {\n                prevPoint = { x: 0, y: 0 };\n            }\n            else {\n                prevPoint = { x: obj.pointColl[obj.pointColl.length - 2].x, y: obj.pointColl[obj.pointColl.length - 2].y };\n            }\n            var diffX = obj.pointColl[obj.pointColl.length - 1].x - prevPoint.x;\n            var diffY = obj.pointColl[obj.pointColl.length - 1].y - prevPoint.y;\n            obj.activePoint.startX = obj.pointColl[0].x;\n            obj.activePoint.startY = obj.pointColl[0].y;\n            obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x + (diffX / 2);\n            obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y + (diffY / 2);\n            obj = this.updateWidthHeight(obj);\n        }\n    };\n    Shape.prototype.flipLineArrowObj = function (obj, value) {\n        value = value.toLowerCase();\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        if (value === 'horizontal') {\n            this.lineArrowHorizontalFlip(obj);\n        }\n        else if (value === 'vertical') {\n            this.lineArrowVerticalFlip(obj);\n        }\n        else {\n            this.lineArrowHorizontalFlip(obj);\n            obj.shapeFlip = '';\n            this.lineArrowVerticalFlip(obj);\n        }\n        obj.activePoint.startX = obj.pointColl[0].x;\n        obj.activePoint.startY = obj.pointColl[0].y;\n        obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x;\n        obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y;\n        if (obj.activePoint.startX > obj.activePoint.endX) {\n            var temp = obj.activePoint.startX;\n            obj.activePoint.startX = obj.activePoint.endX;\n            obj.activePoint.endX = temp;\n            temp = obj.activePoint.startY;\n            obj.activePoint.startY = obj.activePoint.endY;\n            obj.activePoint.endY = temp;\n        }\n    };\n    Shape.prototype.lineArrowHorizontalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.x <= destLeft + (destWidth / 2)) {\n                    currPoint.x = (destLeft + destWidth) - (currPoint.x - destLeft);\n                }\n                else if (currPoint.x >= destLeft + (destWidth / 2)) {\n                    currPoint.x = destLeft + (destLeft + destWidth - currPoint.x);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            if (obj.shape === 'arrow') {\n                var value = obj.start;\n                obj.start = obj.end;\n                obj.end = value;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.lineArrowVerticalFlip = function (obj) {\n        var parent = this.parent;\n        var _a = parent.img, destWidth = _a.destWidth, destHeight = _a.destHeight, destLeft = _a.destLeft, destTop = _a.destTop;\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.y <= destTop + (destHeight / 2)) {\n                    currPoint.y = (destTop + destHeight) - (currPoint.y - destTop);\n                }\n                else if (currPoint.y >= destTop + (destHeight / 2)) {\n                    currPoint.y = destTop + (destTop + destHeight - currPoint.y);\n                }\n                currPoint.ratioX = (currPoint.x - destLeft) / destWidth;\n                currPoint.ratioY = (currPoint.y - destTop) / destHeight;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.getRotDegOfShape = function (obj, value) {\n        var parent = this.parent;\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.parent.transform.degree;\n        }\n        else {\n            degree = this.parent.transform.degree - obj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        var transformObj = { bool: false };\n        parent.notify('selection', { prop: 'getTransformedShape', onPropertyChange: false, value: { obj: transformObj } });\n        if (transformObj['bool'] && !value && parent.activeObj.rotateFlipColl) {\n            degree = 0;\n            for (var i = 0; i < parent.activeObj.rotateFlipColl.length; i++) {\n                if (typeof (parent.activeObj.rotateFlipColl[i]) === 'number') {\n                    degree += (parent.activeObj.rotateFlipColl[i]);\n                }\n            }\n        }\n        return degree;\n    };\n    Shape.prototype.renderTextArea = function (x, y, actObj) {\n        var parent = this.parent;\n        var shapeObj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: shapeObj } });\n        var shapeSettings = shapeObj['shapeSettingsObj'];\n        var shapeChangingArgs = { cancel: false, action: 'text-edit', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings, shapeChangingArgs.allowShapeOverflow);\n        var degree = this.getRotDegOfShape(parent.activeObj);\n        this.transformTextArea();\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var zOrderElem = parent.element.querySelector('#' + parent.element.id + '_zOrderBtn');\n        var dupElem = parent.element.querySelector('#' + parent.element.id + '_duplicate');\n        var removeElem = parent.element.querySelector('#' + parent.element.id + '_remove');\n        var editTextElem = parent.element.querySelector('#' + parent.element.id + '_editText');\n        var shadowColor = actObj.strokeSettings.outlineColor;\n        var outlineWidth = actObj.strokeSettings.outlineWidth;\n        var shadows = [];\n        if (zOrderElem) {\n            zOrderElem.classList.add('e-overlay');\n        }\n        if (dupElem) {\n            dupElem.classList.add('e-overlay');\n        }\n        if (removeElem) {\n            removeElem.classList.add('e-overlay');\n        }\n        if (editTextElem) {\n            editTextElem.classList.add('e-overlay');\n        }\n        if (actObj.strokeSettings.fillColor !== '') {\n            parent.textArea.style.backgroundColor = actObj.strokeSettings.fillColor;\n        }\n        else {\n            parent.textArea.style.backgroundColor = 'transparent';\n        }\n        parent.textArea.style.display = 'block';\n        parent.textArea.style.left = x + 'px';\n        parent.textArea.style.top = y + 'px';\n        parent.textArea.style.fontFamily = actObj.textSettings.fontFamily;\n        parent.textArea.style.fontSize = actObj.textSettings.fontSize + 'px';\n        parent.textArea.style.color = actObj.strokeSettings.strokeColor;\n        var fontSize = actObj.textSettings.fontSize;\n        var baseWidth = Math.max(1, outlineWidth / 2);\n        var adjustedOutlineWidth = baseWidth * (Math.floor((fontSize - 1) / 16) * 0.5 + 0.5);\n        if (/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(actObj.strokeSettings.outlineColor)) {\n            for (var x_1 = -adjustedOutlineWidth; x_1 <= adjustedOutlineWidth; x_1++) {\n                for (var y_1 = -adjustedOutlineWidth; y_1 <= adjustedOutlineWidth; y_1++) {\n                    if (x_1 !== 0 || y_1 !== 0) {\n                        shadows.push(x_1 / 2 + \"px \" + y_1 / 2 + \"px 0 \" + shadowColor);\n                    }\n                }\n            }\n            parent.textArea.style.textShadow = shadows.join(', ');\n        }\n        else {\n            parent.textArea.style.textShadow = null;\n        }\n        parent.textArea.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n        parent.textArea.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n        parent.textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        parent.textArea.value = actObj.keyHistory;\n        parent.textArea.style.overflow = 'hidden';\n        parent.textArea.style.width = 'auto';\n        parent.textArea.style.height = 'auto';\n        parent.textArea.focus();\n        var _a = actObj.activePoint, width = _a.width, height = _a.height;\n        if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n            parent.textArea.style.width = height + (height * 0.25) + 'px';\n            parent.textArea.style.height = width + (width * 0.25) + 'px';\n        }\n        else {\n            parent.textArea.style.width = width + (width * 0.25) + 'px';\n            parent.textArea.style.height = height + (height * 0.25) + 'px';\n        }\n        this.setTextBoxWidth();\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (obj['flipColl'].length <= 1) {\n            this.setTextBoxHeight();\n        }\n        if (parseFloat(parent.textArea.style.maxHeight) < parent.activeObj.textSettings.fontSize) {\n            parent.textArea.style.maxHeight = parent.activeObj.textSettings.fontSize + 'px';\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destTop +\n                parent.img.destHeight) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        else {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destLeft +\n                parent.img.destWidth) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        // Limit text area\n        if (actObj.rotatedAngle !== 0) {\n            var tempLeft = parseFloat(parent.textArea.style.left);\n            var tempTop = parseFloat(parent.textArea.style.top);\n            if (actObj.flipObjColl.length > 0) {\n                var panObj = { panRegion: '' };\n                var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n                var center_1 = { x: 0, y: 0 };\n                parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                    value: { panObj: panObj } });\n                if (panObj['panRegion'] !== '') {\n                    if (panObj['panRegion'] === 'horizontal') {\n                        center_1.x = clientWidth - (clientWidth / 2);\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                    }\n                    else if (panObj['panRegion'] === 'vertical') {\n                        center_1.y = clientHeight - (clientHeight / 2);\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                    else {\n                        center_1 = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                        tempLeft = (center_1.x - tempLeft) + center_1.x;\n                        tempTop = (center_1.y - tempTop) + center_1.y;\n                    }\n                }\n            }\n            var left = tempLeft + parseFloat(parent.textArea.style.width);\n            var top_1 = tempTop + parseFloat(parent.textArea.style.height);\n            var width1 = parseFloat(parent.textArea.style.width);\n            var height1 = parseFloat(parent.textArea.style.height);\n            var center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n            var cosAngle = Math.cos(actObj.rotatedAngle);\n            var sinAngle = Math.sin(actObj.rotatedAngle);\n            var p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n            if (p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                // eslint-disable-next-line max-len\n                p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) {\n                // eslint-disable-next-line no-self-assign\n                parent.textArea.style.width = parent.textArea.style.width;\n            }\n            else {\n                var count = 0;\n                var width2 = parseFloat(parent.textArea.style.width);\n                while (true) {\n                    count++;\n                    width1 -= 1;\n                    left = tempLeft + width1;\n                    center = { x: left - (width1 / 2), y: top_1 - (height1 / 2) };\n                    p1 = { x: cosAngle * (left - center.x) - sinAngle * (top_1 - center.y) + center.x,\n                        y: sinAngle * (left - center.x) + cosAngle * (top_1 - center.y) + center.y };\n                    if ((p1.x > parent.img.destLeft && p1.x < parent.img.destLeft + parent.img.destWidth &&\n                        // eslint-disable-next-line max-len\n                        p1.y > parent.img.destTop && p1.y + parseFloat(parent.textArea.style.fontSize) < parent.img.destTop + parent.img.destHeight) ||\n                        count === width2) {\n                        parent.textArea.style.width = width1 + 'px';\n                        break;\n                    }\n                }\n            }\n        }\n        parent.notify('selection', { prop: 'clearUpperCanvas', onPropertyChange: false });\n    };\n    Shape.prototype.setTextBoxWidth = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.rotatedAngle !== 0) {\n            parent.textArea.style.whiteSpace = 'nowrap';\n            parent.textArea.style.textOverflow = 'ellipsis';\n            parent.textArea.style.display = 'inline-block';\n            return;\n        }\n        else {\n            parent.textArea.style.whiteSpace = '';\n            parent.textArea.style.textOverflow = '';\n            if (parent.textArea.style.display === 'inline-block') {\n                parent.textArea.style.display = 'block';\n            }\n        }\n        var text = this.getMaxText(true);\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textAreaWidth = (this.upperContext.measureText(text).width + (parseFloat(parent.textArea.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.shapeFlip !== parent.transform.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = parent.transform.currFlipState;\n        }\n        if ((e && parseFloat(parent.textArea.style.width) < (textAreaWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(parent.textArea.style.left) - parent.img.destLeft) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                    parent.img.destLeft)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(parent.textArea.style.top) - parent.img.destTop) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destHeight - (parseFloat(parent.textArea.style.top) -\n                    parent.img.destTop)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 180) {\n                var textAreaLeft = parseFloat(parent.textArea.style.left);\n                var destLeft = parent.img.destLeft;\n                if (flip.toLowerCase() === 'horizontal') {\n                    var remainingWidth = parent.img.destWidth - (textAreaLeft - destLeft);\n                    if (remainingWidth > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToLeft = textAreaLeft - destLeft;\n                    if (distanceToLeft - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                var textAreaTop = parseFloat(parent.textArea.style.top);\n                var destTop = parent.img.destTop;\n                if (flip.toLowerCase() === 'vertical') {\n                    var remainingHeight = parent.img.destHeight - (textAreaTop - destTop);\n                    if (remainingHeight > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToTop = textAreaTop - destTop;\n                    if (distanceToTop - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.setTextBoxHeight = function () {\n        var parent = this.parent;\n        var textAreaTop;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.textFlip === parent.transform.currFlipState) {\n            flip = '';\n        }\n        else if (actObj.textFlip === '') {\n            flip = parent.transform.currFlipState;\n        }\n        else {\n            flip = actObj.textFlip;\n        }\n        switch (degree) {\n            case 0:\n                if (flip.toLowerCase() === 'vertical') {\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - (parent.img.destHeight -\n                        parseFloat(parent.textArea.style.top))) + 'px';\n                }\n                else {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                break;\n            case 90:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                        parent.img.destLeft)) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                break;\n            case 180:\n                if (flip.toLowerCase() === 'vertical') {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.top) - parent.img.destTop) + 'px';\n                }\n                break;\n            case 270:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = parent.img.destWidth - (parseFloat(parent.textArea.style.left)\n                        - parent.img.destLeft) + 'px';\n                }\n                break;\n        }\n    };\n    Shape.prototype.updatePathRatio = function (obj) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.pointColl.length; i < len; i++) {\n            var currPoint = obj.pointColl[i];\n            currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n            currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n    };\n    Shape.prototype.stopPathDrawing = function (e, isApply) {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'path') {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                parent.currObjType.isDragging = false;\n                if (e && e.type !== 'touchstart' && isNullOrUndefined(isApply)) {\n                    parent.activeObj.pointColl.pop();\n                }\n                this.updatePathRatio(parent.activeObj);\n                if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                }\n                parent.objColl.push(parent.activeObj);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                parent.objColl.pop();\n                if (e) {\n                    parent.notify('selection', { prop: 'mouseUpEventHandler', value: { e: e } });\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    if (parent.objColl.length > 0) {\n                        var obj1 = parent.activeObj.activePoint;\n                        var obj2 = parent.objColl[parent.objColl.length - 1].activePoint;\n                        if (Math.floor(obj1.startX) === Math.floor(obj2.startX) &&\n                            Math.floor(obj1.startY) === Math.floor(obj2.startY) &&\n                            Math.floor(obj1.endX) === Math.floor(obj2.endX) &&\n                            Math.floor(obj1.endY) === Math.floor(obj2.endY)) {\n                            this.refreshActiveObj();\n                        }\n                    }\n                }\n                parent.notify('draw', { prop: 'setNewPath', value: { bool: true } });\n                if (parent.objColl[parent.objColl.length - 1]) {\n                    var shape = parent.drawingShape;\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                    parent.noRedact = true;\n                    parent.selectShape(parent.objColl[parent.objColl.length - 1].currIndex);\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: 'path' } });\n                    parent.drawingShape = shape;\n                }\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                var obj_1 = { shapeSettingsObj: {} };\n                parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj_1 } });\n                var shapeSettings = obj_1['shapeSettingsObj'];\n                var shapeResizingArgs = { cancel: false, action: 'draw-end', previousShapeSettings: shapeSettings };\n                var shapeMovingArgs = { cancel: false, action: 'move', previousShapeSettings: shapeSettings };\n                parent.notify('selection', { prop: 'triggerShapeChange', onPropertyChange: false,\n                    value: { shapeResizingArgs: shapeResizingArgs, shapeMovingArgs: shapeMovingArgs, type: 'mouse-up' } });\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        }\n    };\n    Shape.prototype.findTextTarget = function (e) {\n        var parent = this.parent;\n        if (!e) {\n            return;\n        }\n        if (parent.activeObj.shape !== 'text') {\n            if (parent.activeObj.shape === 'path') {\n                this.stopPathDrawing(e, null);\n                return;\n            }\n            else if (e.type === 'dblclick') {\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n                var activeObj = extend({}, parent.activeObj, {}, true);\n                var objColl = extend([], parent.objColl, [], true);\n                var obj = { bool: null };\n                parent.notify('selection', { prop: 'findTargetObj', onPropertyChange: false,\n                    value: { x: e.clientX, y: e.clientY, isCrop: false, obj: obj } });\n                parent.objColl = objColl;\n                if (!obj['bool'] || parent.activeObj.shape !== 'text') {\n                    parent.activeObj = extend({}, activeObj, {}, true);\n                    return;\n                }\n            }\n            else {\n                return;\n            }\n        }\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            x = e.touches[0].clientX;\n            y = e.touches[0].clientY;\n            parent.notify('selection', { prop: 'setTouchEndPoint', onPropertyChange: false,\n                value: { x: e.touches[0].clientX, y: e.touches[0].clientY } });\n        }\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: false } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n            var bbox = parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var flip = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.textFlip === '') {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            else {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else if (parent.transform.currFlipState === '') {\n                    flip = parent.activeObj.textFlip;\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            var temp = void 0;\n            if (parent.textArea.style.display === 'none') {\n                temp = extend({}, parent.activeObj, {}, true);\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        parent.objColl.splice(i, 1);\n                    }\n                }\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = temp;\n                this.updateFontStyles();\n                var actObj = extend({}, parent.activeObj, {}, true);\n                var radius = actObj.topLeftCircle.radius;\n                var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n                var center = { x: startX + (width / 2), y: startY +\n                        (height / 2) };\n                var cosAngle = Math.cos(actObj.rotatedAngle);\n                var sinAngle = Math.sin(actObj.rotatedAngle);\n                var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n                var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n                    y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n                var obj = { position: null, x: x, y: y, x1: p1.x, y1: p1.y, x2: p2.x, y2: p2.y,\n                    x3: p3.x, y3: p3.y, x4: p4.x, y4: p4.y };\n                parent.notify('draw', { prop: 'checkPointPosition', onPropertyChange: false, value: { obj: obj } });\n                if ((actObj.rotatedAngle !== 0 && (obj['position'] === 'inside' || obj['position'] === 'on')) ||\n                    (actObj.rotatedAngle === 0 && x >= (actObj.activePoint.startX - (radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (radius * 2)))) {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (actObj.flipObjColl.length === 4) {\n                        actObj.flipObjColl = [];\n                        flip = '';\n                        actObj.shapeFlip = '';\n                    }\n                    if (flip === '' && actObj.flipObjColl.length > 1) {\n                        flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                    }\n                    if (actObj.flipObjColl.length <= 1) {\n                        var points = this.setTextBoxPos(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    else {\n                        var points = this.setTextBoxPoints(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    if (parent.activeObj.rotatedAngle !== 0) {\n                        var point = this.getTextBoxPosition(parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                        point = this.setFlipState(x, y, parent.activeObj);\n                        x = point.x;\n                        y = point.y;\n                    }\n                    this.renderTextArea(x, y, actObj);\n                }\n                else {\n                    this.applyActObj();\n                }\n            }\n        }\n        else if ((parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')\n            && this.selectedText() !== '' && e.type === 'mousedown') {\n            var temp = parent.textArea.value;\n            parent.textArea.value += 'a';\n            parent.textArea.value = temp;\n        }\n        else if (parent.textArea.style.display === 'none') {\n            parent.textArea.style.display = 'block';\n        }\n    };\n    Shape.prototype.getTextBoxPosition = function (obj, object) {\n        var point = { x: 0, y: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || degree === 360) {\n            point = { x: p1.x, y: p1.y };\n        }\n        else if (degree === 90 || degree === -270) {\n            point = { x: p2.x, y: p2.y };\n        }\n        else if (degree === 180 || degree === -180) {\n            point = { x: p4.x, y: p4.y };\n        }\n        else if (degree === 270 || degree === -90) {\n            point = { x: p3.x, y: p3.y };\n        }\n        if (object) {\n            object['x'] = point.x;\n            object['y'] = point.y;\n        }\n        return point;\n    };\n    Shape.prototype.setFlipState = function (x, y, obj, object) {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.lowerCanvas, clientWidth = _a.clientWidth, clientHeight = _a.clientHeight;\n        var center = { x: 0, y: 0 };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                center.x = clientWidth - (clientWidth / 2);\n                x = (center.x - x) + center.x;\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                center.y = clientHeight - (clientHeight / 2);\n                y = (center.y - y) + center.y;\n            }\n            else {\n                center = { x: clientWidth - (clientWidth / 2), y: clientHeight - (clientHeight / 2) };\n                x = (center.x - x) + center.x;\n                y = (center.y - y) + center.y;\n            }\n        }\n        if (object) {\n            object['x'] = x;\n            object['y'] = y;\n        }\n        return { x: x, y: y };\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.fileChanged = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = e.target.files[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var fileData = filesData;\n        var fileExtension = fileData.name && fileData.name.split('.').pop().toLowerCase();\n        if (fileExtension && ['jpg', 'jpeg', 'png', 'svg', 'webp'].indexOf(fileExtension) === -1) {\n            this.refreshActiveObj();\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/tslint/config, @typescript-eslint/no-explicit-any\n        var URL = window.URL;\n        var url = URL.createObjectURL(e.target.files[0]);\n        this.onLoadImgShape(null, null, null, null, url.toString(), true);\n        document.getElementById(this.parent.element.id + '_fileUpload').value = '';\n    };\n    Shape.prototype.onLoadImgShape = function (x, y, width, height, url, isSelect, degree, isAspectRatio, opacity, isSelected) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        if (typeof (url) === 'string') {\n            this.shapeImg.src = url;\n        }\n        else {\n            parent.inMemoryCanvas.width = url.width;\n            parent.inMemoryCanvas.height = url.height;\n            parent.inMemoryCanvas.getContext('2d').putImageData(url, 0, 0);\n            this.shapeImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n        this.prevObjColl();\n        parent.activeObj.shape = 'image';\n        this.initShapeProps();\n        this.shapeImg.onload = function () {\n            proxy.upperContext.drawImage(proxy.shapeImg, 0, 0, proxy.shapeImg.width, proxy.shapeImg.height);\n            proxy.updateImgCanvas(isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected);\n        };\n    };\n    Shape.prototype.updateImgCanvas = function (isSelect, x, y, width, height, degree, isAspectRatio, opacity, isSelected) {\n        var parent = this.parent;\n        parent.activeObj.imageElement = this.shapeImg;\n        parent.activeObj.imageCanvas = parent.createElement('canvas');\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: null } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_2 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_2 } });\n                dimObj = this.resizeImage(width, obj_2['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: parent.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: dimObj, isImgShape: true } });\n        if (width && height) {\n            if (isAspectRatio) {\n                var obj_3 = { ratio: null };\n                parent.notify('selection', { prop: 'findImageRatio', onPropertyChange: false,\n                    value: { width: this.shapeImg.width, height: this.shapeImg.height, obj: obj_3 } });\n                dimObj = this.resizeImage(width, obj_3['ratio']);\n            }\n            else {\n                dimObj = { width: width, height: height };\n            }\n        }\n        if (opacity !== null && opacity !== undefined) {\n            parent.activeObj.opacity = opacity;\n        }\n        this.updateObj(dimObj, x, y);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.shapeImg = null;\n        if (degree) {\n            parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n        }\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n            currentShapeSettings: shapeSettings };\n        parent.trigger('shapeChanging', shapeChangingArgs);\n        parent.editCompleteArgs = shapeChangingArgs;\n        isSelect = isSelect ? isSelect : isSelected;\n        this.drawShapeImageEvent(shapeChangingArgs, isSelect);\n        if (parent.isPublicMethod && !isSelected) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n        }\n        else if (!parent.isPublicMethod) {\n            parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n        }\n        parent.isPublicMethod = false;\n    };\n    Shape.prototype.updateObj = function (dimObj, x, y) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.width = dimObj['width'];\n        parent.activeObj.activePoint.height = dimObj['height'];\n        parent.activeObj.activePoint.startX = x ? x : (parent.lowerCanvas.width / 2) - (dimObj['width'] / 2);\n        parent.activeObj.activePoint.startY = y ? y : (parent.lowerCanvas.height / 2) - (dimObj['height'] / 2);\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + dimObj['width'];\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + dimObj['height'];\n    };\n    Shape.prototype.resizeImage = function (newWidth, aspectRatio) {\n        var aspectRatioArray = aspectRatio.split(':');\n        var aspectRatioWidth = parseInt(aspectRatioArray[0], 10);\n        var aspectRatioHeight = parseInt(aspectRatioArray[1], 10);\n        var newHeight = Math.round((newWidth * aspectRatioHeight) / aspectRatioWidth);\n        return { width: newWidth, height: newHeight };\n    };\n    Shape.prototype.setTextBoxPos = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                break;\n            case 90:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                break;\n            case 180:\n                if (flip === 'horizontal') {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = endX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                break;\n            case 270:\n                if (flip === 'horizontal') {\n                    point.x = endX;\n                    point.y = endY;\n                }\n                else if (flip === 'vertical') {\n                    point.x = startX;\n                    point.y = startY;\n                }\n                else {\n                    point.x = startX;\n                    point.y = endY;\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        var _a = actObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        flip = flip.toLowerCase();\n        switch (degree) {\n            case 0:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 90:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                break;\n            case 180:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = startX;\n                        point.y = endY;\n                    }\n                }\n                break;\n            case 270:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip === 'horizontal') {\n                        point.x = startX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                }\n                else {\n                    if (flip === 'horizontal') {\n                        point.x = endX;\n                        point.y = startY;\n                    }\n                    else if (flip === 'vertical') {\n                        point.x = endX;\n                        point.y = endY;\n                    }\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.selectedText = function () {\n        var parent = this.parent;\n        var start = parent.textArea.selectionStart;\n        var finish = parent.textArea.selectionEnd;\n        return parent.textArea.value.substring(start, finish);\n    };\n    Shape.prototype.panObjColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var currObj = parent.objColl[i];\n                if (panRegion === '') {\n                    currObj.activePoint.startX += xDiff;\n                    currObj.activePoint.endX += xDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.x += xDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0, len_3 = currObj.pointColl.length; l < len_3; l++) {\n                            currObj.pointColl[l].x += xDiff;\n                        }\n                    }\n                    currObj.activePoint.startY += yDiff;\n                    currObj.activePoint.endY += yDiff;\n                    if (currObj.rotationCirclePointColl) {\n                        currObj.rotationCirclePointColl.y += yDiff;\n                    }\n                    if (currObj.shape === 'path') {\n                        for (var l = 0; l < currObj.pointColl.length; l++) {\n                            currObj.pointColl[l].y += yDiff;\n                        }\n                    }\n                }\n                currObj = this.updateWidthHeight(currObj);\n                parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                        obj: currObj } });\n                if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                    currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                    for (var j = 0, len_4 = currObj.pointColl.length; j < len_4; j++) {\n                        currObj.pointColl[j].ratioX =\n                            (currObj.pointColl[j].x - parent.img.destLeft) / parent.img.destWidth;\n                        currObj.pointColl[j].ratioY =\n                            (currObj.pointColl[j].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                }\n                this.refreshActiveObj();\n            }\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            this.iterateObjColl();\n            this.lowerContext.filter = temp;\n            this.refreshActiveObj();\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n        }\n    };\n    Shape.prototype.updateFontStyles = function (isTextBox) {\n        var parent = this.parent;\n        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (parent.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (parent.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(parent.textArea.style.fontSize) : parent.activeObj.textSettings.fontSize;\n        var fontFamily = (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ?\n            parent.textArea.style.fontFamily : parent.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    Shape.prototype.applyFontStyle = function (item) {\n        var parent = this.parent;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        this.pushActItemIntoObj();\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl.pop();\n        if (parent.textArea.style.display === 'none') {\n            this.updateFontRatio(parent.activeObj);\n        }\n        else {\n            this.updateFontRatio(parent.activeObj, true);\n        }\n        switch (item) {\n            case 'default':\n                this.updateFontStyle(item, objColl, 'normal', 'normal');\n                break;\n            case 'bold':\n                this.updateFontStyle(item, objColl, 'bold', 'normal');\n                break;\n            case 'italic':\n                this.updateFontStyle(item, objColl, 'normal', 'italic');\n                break;\n            case 'bolditalic':\n                this.updateFontStyle(item, objColl, 'bold', 'italic');\n                break;\n        }\n        var shapeChangedArgs = { action: 'font-style', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontStyle = [item];\n        parent.trigger('shapeChange', shapeChangedArgs);\n        parent.editCompleteArgs = shapeChangedArgs;\n    };\n    Shape.prototype.updateFontStyle = function (item, objColl, fontWeight, fontStyle) {\n        var parent = this.parent;\n        var style = parent.textArea.style;\n        if (style.display === 'block' || style.display === 'inline-block') {\n            if (style.fontWeight === 'normal' && fontWeight === 'bold') {\n                style.fontWeight = 'bold';\n            }\n            else if (style.fontWeight === 'bold' && fontWeight === 'bold') {\n                style.fontWeight = 'normal';\n            }\n            if (style.fontStyle === 'normal' && fontStyle === 'italic') {\n                style.fontStyle = 'italic';\n            }\n            else if (style.fontStyle === 'italic' && fontStyle === 'italic') {\n                style.fontStyle = 'normal';\n            }\n            var value = (style.fontWeight === 'normal' && style.fontStyle === 'normal' ? 'default' :\n                (style.fontWeight === 'bold' && style.fontStyle === 'normal' ? 'bold' :\n                    (style.fontWeight === 'normal' && style.fontStyle === 'italic' ? 'italic' : 'bolditalic')));\n            var width = this.getTextAreaWidth(value);\n            style.width = width + 'px';\n            this.updateObjColl(item, objColl);\n        }\n        else {\n            this.textSettings.bold = parent.activeObj.textSettings.bold = fontWeight === 'normal' ? false : true;\n            this.textSettings.italic = parent.activeObj.textSettings.italic = fontStyle === 'normal' ? false : true;\n            if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                this.redrawText();\n            }\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n    };\n    Shape.prototype.updateArrowRatio = function (obj) {\n        var parent = this.parent;\n        var object = { arrowDimension: null };\n        parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_1 = dimensions; _i < dimensions_1.length; _i++) {\n            dimension = dimensions_1[_i];\n            var ratioX = length / object['arrowDimension'][dimension]['width'];\n            var ratioY = length / object['arrowDimension'][dimension]['height'];\n            object['arrowDimension'][dimension]['ratioX'] = ratioX;\n            object['arrowDimension'][dimension]['ratioY'] = ratioY;\n        }\n    };\n    Shape.prototype.updateArrowSize = function (obj) {\n        var object = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_2 = dimensions; _i < dimensions_2.length; _i++) {\n            dimension = dimensions_2[_i];\n            var ratioX = object['arrowDimension'][dimension]['ratioX'];\n            var ratioY = object['arrowDimension'][dimension]['ratioY'];\n            object['arrowDimension'][dimension]['width'] = length / ratioX;\n            object['arrowDimension'][dimension]['height'] = length / ratioY;\n        }\n    };\n    Shape.prototype.updateFontRatio = function (obj, isTextArea) {\n        var parent = this.parent;\n        var text = this.getMaxText(isTextArea);\n        var width = this.upperContext.measureText(text).width +\n            parent.activeObj.textSettings.fontSize * 0.5;\n        var height = parent.activeObj.textSettings.fontSize;\n        var degree = this.getRotDegOfShape(obj);\n        if (isNullOrUndefined(isTextArea)) {\n            if (degree === 0 || Math.abs(degree) === 180) {\n                obj.textSettings.fontRatio = width / obj.textSettings.fontSize;\n            }\n            else {\n                obj.textSettings.fontRatio = height / obj.textSettings.fontSize;\n            }\n        }\n        else if (isTextArea) {\n            var transformObj = { bool: false };\n            parent.notify('selection', { prop: 'getTransformedShape', onPropertyChange: false, value: { obj: transformObj } });\n            if (!transformObj['bool'] || degree === 0 || Math.abs(degree) === 180) {\n                obj.textSettings.fontRatio = width / parseFloat(parent.textArea.style.fontSize);\n            }\n            else {\n                obj.textSettings.fontRatio = height / parseFloat(parent.textArea.style.fontSize);\n            }\n        }\n    };\n    Shape.prototype.updateFontSize = function (obj) {\n        var degree = this.getRotDegOfShape(obj, true);\n        if (degree === 0 || Math.abs(degree) === 180) {\n            obj.textSettings.fontSize = (obj.activePoint.width / obj.textSettings.fontRatio);\n        }\n        else {\n            obj.textSettings.fontSize = (obj.activePoint.height / obj.textSettings.fontRatio);\n        }\n    };\n    Shape.prototype.updateObjColl = function (item, objColl) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = objColl;\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        parent.objColl.push(parent.activeObj);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.objColl.pop();\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n    };\n    Shape.prototype.pushActItemIntoObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                parent.objColl.push(parent.activeObj);\n            }\n        }\n        else {\n            var temp = extend({}, parent.activeObj, {}, true);\n            parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n            parent.objColl.push(parent.activeObj);\n            parent.activeObj = temp;\n        }\n    };\n    Shape.prototype.clearActObj = function () {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none') {\n            this.refreshActiveObj();\n            this.applyActObj();\n            this.refreshActiveObj();\n            parent.currObjType.isCustomCrop = false;\n        }\n    };\n    Shape.prototype.refreshActiveObj = function () {\n        var parent = this.parent;\n        parent.activeObj = {};\n        parent.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        parent.activeObj.triangle = [];\n        parent.activeObj.triangleRatio = [];\n        parent.activeObj.order = null;\n        parent.activeObj.flipObjColl = [];\n        parent.activeObj.strokeSettings = this.strokeSettings;\n        parent.activeObj.textSettings = this.textSettings;\n        parent.activeObj.rotatedAngle = 0;\n        parent.activeObj.opacity = 1;\n        parent.activeObj.redactType = this.redactType;\n        parent.activeObj.redactBlur = parent.tempRedactBlur;\n        parent.activeObj.redactPixelate = parent.tempRedactPixel;\n    };\n    Shape.prototype.applyActObj = function (isMouseDown) {\n        var parent = this.parent;\n        var isActObj = false;\n        if (parent.activeObj.shape !== undefined && parent.activeObj.shape === 'text' && parent.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (parent.activeObj.shape && !isCropSelection && parent.activeObj.shape !== 'shape') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.activeObj.currIndex = this.getNewShapeId();\n                    }\n                    if (isNullOrUndefined(parent.activeObj.order)) {\n                        parent.activeObj.order = this.getNewOrder();\n                    }\n                    this.updImgRatioForActObj();\n                    var splitWords_1 = parent.activeObj.currIndex.split('_');\n                    var tempObjColl = parent.objColl.splice(0, parseInt(splitWords_1[1], 10) - 1);\n                    tempObjColl.push(extend({}, parent.activeObj, {}, true));\n                    for (var i = 0; i < parent.objColl.length; i++) {\n                        tempObjColl.push(parent.objColl[i]);\n                    }\n                    parent.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                    parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                    parent.currObjType.shape = '';\n                    this.refreshActiveObj();\n                    if (parent.isCircleCrop) {\n                        parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                            value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    if (isNullOrUndefined(isMouseDown)) {\n                        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.getNewShapeId = function () {\n        var parent = this.parent;\n        var value = parent.objColl.length + 1;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            if (parent.objColl[i].currIndex === 'shape_' + value) {\n                value++;\n                i = -1;\n            }\n        }\n        return 'shape_' + value;\n    };\n    Shape.prototype.getNewOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = parent.shapeColl.length + 1;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order === value) {\n                value++;\n                i = -1;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.getHighestOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = 0;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order > value) {\n                value = parent.shapeColl[i].order;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.getLowestOrder = function () {\n        var parent = this.parent;\n        this.updateShapeColl();\n        var value = 1;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            if (parent.shapeColl[i].order < value) {\n                value = parent.shapeColl[i].order;\n            }\n        }\n        return value;\n    };\n    Shape.prototype.alignTextAreaIntoCanvas = function () {\n        var parent = this.parent;\n        var letters = parent.textArea.value;\n        parent.textArea.value = '';\n        for (var i = 0, len = letters.length; i < len; i++) {\n            parent.textArea.value += letters[i];\n            parent.textArea.style.height = 'auto';\n            parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n            this.setTextBoxWidth();\n        }\n    };\n    Shape.prototype.transformTextArea = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'text') {\n            parent.textArea.style.transformOrigin = '0 0';\n            var rotatedDegree = parent.activeObj.rotatedAngle * (180 / Math.PI);\n            var scale = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.flipObjColl.length > 0) {\n                for (var i = 0; i < parent.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    degree += rotatedDegree;\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                degree += rotatedDegree;\n                parent.textArea.style.transform = 'rotate(' + degree + 'deg)';\n            }\n        }\n    };\n    Shape.prototype.getTextAreaWidth = function (item) {\n        var parent = this.parent;\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        var isTextArea = parent.textArea.style.display === 'none' ? false : true;\n        this.updateFontStyles(isTextArea);\n        var width;\n        if (!isTextArea) {\n            width = this.upperContext.measureText(parent.activeObj.keyHistory).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        else {\n            width = this.upperContext.measureText(parent.textArea.value).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    Shape.prototype.getRedactObjDetails = function (obj) {\n        var parent = this.parent;\n        var redactDetails = {};\n        redactDetails.id = obj.currIndex;\n        redactDetails.type = parent.toPascalCase(obj.redactType);\n        redactDetails.startX = obj.activePoint.startX;\n        redactDetails.startY = obj.activePoint.startY;\n        redactDetails.width = obj.activePoint.width;\n        redactDetails.height = obj.activePoint.height;\n        switch (obj.redactType) {\n            case 'blur':\n                redactDetails.blurIntensity = obj.redactBlur;\n                break;\n            case 'pixelate':\n                redactDetails.pixelSize = obj.redactPixelate;\n                break;\n        }\n        return redactDetails;\n    };\n    Shape.prototype.getObjDetails = function (obj) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = parent.toPascalCase(obj.shape);\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        shapeDetails.index = obj.order;\n        var transformObj = { coll: null };\n        switch (obj.shape) {\n            case 'rectangle':\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'ellipse':\n                shapeDetails.radius = obj.activePoint.width / 2;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.radiusX = obj.activePoint.width / 2;\n                shapeDetails.radiusY = obj.activePoint.height / 2;\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                break;\n            case 'line':\n            case 'arrow':\n                shapeDetails.length = obj.activePoint.width;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.endX = obj.activePoint.endX;\n                shapeDetails.endY = obj.activePoint.endY;\n                if (obj.shape === 'arrow') {\n                    var arrowObj = { type: null };\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.start, obj: arrowObj } });\n                    shapeDetails.arrowHead = arrowObj['type'];\n                    parent.notify('selection', { prop: 'getArrowType', onPropertyChange: false, value: { type: obj.end, obj: arrowObj } });\n                    shapeDetails.arrowTail = arrowObj['type'];\n                }\n                break;\n            case 'text':\n                shapeDetails.text = obj.keyHistory;\n                shapeDetails.fontSize = obj.textSettings.fontSize;\n                shapeDetails.fontFamily = obj.textSettings.fontFamily;\n                shapeDetails.color = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeColor = obj.strokeSettings.outlineColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.outlineWidth;\n                shapeDetails.fontStyle = [];\n                if (obj.textSettings.bold) {\n                    shapeDetails.fontStyle.push('bold');\n                }\n                if (obj.textSettings.italic) {\n                    shapeDetails.fontStyle.push('italic');\n                }\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                parent.notify('selection', { prop: 'updateTransColl', onPropertyChange: false, value: { obj: transformObj, object: obj } });\n                shapeDetails.transformCollection = transformObj['coll'];\n                break;\n            case 'path':\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                shapeDetails.points = obj.pointColl;\n                break;\n            case 'image':\n                shapeDetails.imageData = obj.imageCanvas.toDataURL();\n                shapeDetails.degree = obj.rotatedAngle * (180 / Math.PI);\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.opacity = obj.opacity;\n                break;\n        }\n        return shapeDetails;\n    };\n    Shape.prototype.getFreehandDrawDetails = function (index) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = parent.pointColl[index].id;\n        shapeDetails.type = ShapeType.FreehandDraw;\n        shapeDetails.points = extend([], parent.pointColl[index].points);\n        shapeDetails.strokeColor = parent.pointColl[index].strokeColor;\n        shapeDetails.strokeWidth = parent.pointColl[index].strokeWidth;\n        shapeDetails.index = parent.pointColl[index].order;\n        return shapeDetails;\n    };\n    Shape.prototype.getShapeSetting = function (id, obj) {\n        var parent = this.parent;\n        var shapeDetails;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            if (id.split('_')[0] === 'shape') {\n                var obj_4;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_4 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                shapeDetails = this.getObjDetails(obj_4);\n            }\n            else if (id.split('_')[0] === 'pen') {\n                shapeDetails = this.getFreehandDrawDetails(parseInt(id.split('_')[1], 10) - 1);\n            }\n        }\n        obj['shapeDetails'] = shapeDetails;\n    };\n    Shape.prototype.getShapeSettings = function (obj) {\n        var parent = this.parent;\n        var shapeDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var shapeDetails = this.getObjDetails(parent.objColl[i]);\n                shapeDetailsColl.push(shapeDetails);\n            }\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                var shapeDetails = this.getFreehandDrawDetails(i);\n                shapeDetailsColl.push(shapeDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = shapeDetailsColl;\n    };\n    Shape.prototype.getRedactSettings = function (obj) {\n        var parent = this.parent;\n        var RedactDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.textArea.style.display !== 'none') {\n                parent.okBtn(null, true);\n            }\n            else {\n                this.applyActObj(true);\n            }\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var redactDetails = this.getRedactObjDetails(parent.objColl[i]);\n                RedactDetailsColl.push(redactDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = RedactDetailsColl;\n    };\n    Shape.prototype.isPointsInRange = function (x, y, obj) {\n        var inRange = false;\n        var parent = this.parent;\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y) && x >= parent.img.destLeft && y >= parent.img.destTop &&\n            x <= parent.img.destLeft + parent.img.destWidth && y <= parent.img.destTop + parent.img.destHeight) {\n            inRange = true;\n        }\n        obj['inRange'] = inRange;\n    };\n    Shape.prototype.alignRotateFlipColl = function (collection, isRotateFlipCollection, obj) {\n        collection = this.popForDefaultTransformedState(collection);\n        collection = this.popForDefaultFlipState(collection);\n        collection = this.popForDefaultRotateState(collection);\n        if (collection.length === 0 && isRotateFlipCollection) {\n            this.parent.transform.degree = 0;\n            this.parent.transform.currFlipState = '';\n        }\n        obj['collection'] = collection;\n        return collection;\n    };\n    Shape.prototype.popForDefaultTransformedState = function (collection) {\n        var rotateRight = 0;\n        var rotateleft = 0;\n        var horizontal = 0;\n        var vertical = 0;\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i] === 90 || collection[i] === 'rotateRight') {\n                rotateRight++;\n                rotateleft = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateRight === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === -90 || collection[i] === 'rotateLeft') {\n                rotateleft++;\n                rotateRight = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateleft === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalflip') {\n                horizontal++;\n                rotateleft = 0;\n                rotateRight = 0;\n                vertical = 0;\n                if (horizontal === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'vertical' || collection[i] === 'Vertical'\n                || collection[i] === 'verticalflip') {\n                vertical++;\n                horizontal = 0;\n                rotateleft = 0;\n                rotateRight = 0;\n                if (vertical === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultFlipState = function (collection) {\n        for (var i = 0, iLen = collection.length - 3; i < iLen; i++) {\n            var isHorizontal = collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalFlip';\n            var isVertical = collection[i] === 'vertical' || collection[i] === 'Vertical' ||\n                collection[i] === 'verticalFlip';\n            var isNextHorizontal = collection[i + 1] === 'horizontal' || collection[i + 1] === 'Horizontal' ||\n                collection[i + 1] === 'horizontalFlip';\n            var isNextVertical = collection[i + 1] === 'vertical' || collection[i + 1] === 'Vertical' ||\n                collection[i + 1] === 'verticalFlip';\n            var isNextToNextHorizontal = collection[i + 2] === 'horizontal' || collection[i + 2] === 'Horizontal' ||\n                collection[i + 2] === 'horizontalFlip';\n            var isNextToNextVertical = collection[i + 2] === 'vertical' || collection[i + 2] === 'Vertical' ||\n                collection[i + 2] === 'verticalFlip';\n            var isNextToNextToNextHorizontal = collection[i + 3] === 'horizontal' || collection[i + 3] === 'Horizontal' ||\n                collection[i + 3] === 'horizontalFlip';\n            if ((isHorizontal && isNextVertical && isNextToNextHorizontal && isNextToNextVertical) ||\n                (isVertical && isNextHorizontal && isNextToNextVertical && isNextToNextToNextHorizontal)) {\n                collection.splice(i, 4);\n                i -= 4;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultRotateState = function (collection) {\n        for (var i = 0; i < collection.length - 1; i++) {\n            var curr = collection[i];\n            var next = collection[i + 1];\n            if ((curr === 90 || curr === 'rotateRight') && (next === -90 || next === 'rotateLeft')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n            else if ((curr === -90 || curr === 'rotateLeft') && (next === 90 || next === 'rotateRight')) {\n                collection.splice(i, 2);\n                i -= 2;\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.selectShape = function (id, obj) {\n        var parent = this.parent;\n        var isSelected = false;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj_5;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_5 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                if (isNullOrUndefined(obj_5)) {\n                    isSelected = false;\n                }\n                else {\n                    isSelected = true;\n                    parent.activeObj = obj_5;\n                    var object = { canvasFilter: null };\n                    parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n                    this.lowerContext.filter = object['canvasFilter'];\n                    parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj } });\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'pen') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'redact') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                var object = { bool: false };\n                parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: object } });\n                if (object['bool']) {\n                    parent.okBtn(null, true);\n                }\n                var obj_6 = { isIndex: false };\n                parent.notify('freehand-draw', { prop: 'isFHDIdx', value: { index: parseInt(id.split('_')[1], 10) - 1, obj: obj_6 } });\n                if (obj_6['isIndex']) {\n                    isSelected = true;\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { id: id } });\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n                else {\n                    isSelected = false;\n                }\n            }\n        }\n        obj['isSelected'] = isSelected;\n    };\n    Shape.prototype.deleteShape = function (id) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.activeObj.currIndex && parent.activeObj.currIndex === id) {\n                parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n            }\n            else {\n                this.applyActObj();\n                if (id.split('_')[0] === 'shape') {\n                    for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                        if (parent.objColl[i].currIndex === id) {\n                            parent.objColl.splice(i, 1);\n                            break;\n                        }\n                    }\n                }\n                else if (id.split('_')[0] === 'pen') {\n                    parent.notify('freehand-draw', { prop: 'handle-freehand-draw', value: { id: id } });\n                }\n            }\n            var object = { canvasFilter: null };\n            parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n            this.lowerContext.filter = object['canvasFilter'];\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    Shape.prototype.getMaxText = function (isTextBox, text, obj) {\n        if (isNullOrUndefined(text)) {\n            text = isTextBox ? this.parent.textArea.value : this.parent.activeObj.keyHistory;\n            if (!text) {\n                return text;\n            }\n        }\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        if (obj) {\n            obj['maxText'] = maxText;\n        }\n        return maxText;\n    };\n    Shape.prototype.getLinePoints = function (x1, y1, x2, y2) {\n        var points = [];\n        var i;\n        var j;\n        if (x1 === x2) {\n            if (y1 < y2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, true);\n            var b = this.getIntercept(i, m);\n            for (var y = i[1]; y <= j[1]; y++) {\n                var x = m * y + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        else {\n            if (x1 < x2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, false);\n            var b = this.getIntercept(i, m);\n            for (var x = i[0]; x <= j[0]; x++) {\n                var y = m * x + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        if (Math.floor(x1) === Math.floor(x2) || (points.length < 10 && (y2 - y1 > 10 || y1 - y2 > 10))) {\n            points = [];\n            var lesserY = Math.min(y1, y2);\n            for (var i_1 = 0; i_1 < Math.abs(Math.floor(y2) - Math.floor(y1)); i_1++) {\n                points.push({ x: x1, y: lesserY + i_1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        else if (Math.floor(y1) === Math.floor(y2) || (points.length < 10 && (x2 - x1 > 10 || x1 - x2 > 10))) {\n            points = [];\n            var lesserX = Math.min(x1, x2);\n            for (var i_2 = 0; i_2 < Math.abs(Math.floor(x2) - Math.floor(x1)); i_2++) {\n                points.push({ x: lesserX + i_2, y: y1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        return points;\n    };\n    Shape.prototype.getSlope = function (a, b, isSameAxis) {\n        var slope;\n        if (isSameAxis) {\n            if (a[1] === b[1]) {\n                return null;\n            }\n            slope = (b[0] - a[0]) / (b[1] - a[1]);\n        }\n        else {\n            if (a[0] === b[0]) {\n                return null;\n            }\n            slope = (b[1] - a[1]) / (b[0] - a[0]);\n        }\n        return slope;\n    };\n    Shape.prototype.getIntercept = function (point, getSlope) {\n        if (getSlope === null) {\n            return point[0];\n        }\n        return point[1] - getSlope * point[0];\n    };\n    Shape.prototype.setPointCollForShapeRotation = function (obj) {\n        var parent = this.parent;\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY +\n                (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horBottomLinePointColl = this.getLinePoints(p3.x, p3.y, p4.x, p4.y);\n        obj.verLeftLinePointColl = this.getLinePoints(p1.x, p1.y, p3.x, p3.y);\n        obj.verRightLinePointColl = this.getLinePoints(p2.x, p2.y, p4.x, p4.y);\n        obj.verLeftLinePointColl.reverse();\n        obj.verRightLinePointColl.reverse();\n        for (var i = 0; i < obj.horTopLinePointColl.length; i++) {\n            obj.horTopLinePointColl[i].ratioX = (obj.horTopLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horTopLinePointColl[i].ratioY = (obj.horTopLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.horBottomLinePointColl.length; i++) {\n            obj.horBottomLinePointColl[i].ratioX = (obj.horBottomLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horBottomLinePointColl[i].ratioY = (obj.horBottomLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verLeftLinePointColl.length; i++) {\n            obj.verLeftLinePointColl[i].ratioX = (obj.verLeftLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verLeftLinePointColl[i].ratioY = (obj.verLeftLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verRightLinePointColl.length; i++) {\n            obj.verRightLinePointColl[i].ratioX = (obj.verRightLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verRightLinePointColl[i].ratioY = (obj.verRightLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        if (parent.upperCanvas.style.cursor !== 'move') {\n            var object = { rotationCirclePoint: null };\n            parent.notify('selection', { prop: 'getTransRotationPoint', value: { obj: obj, object: object } });\n            var rotationCirclePoint = object['rotationCirclePoint'];\n            if (rotationCirclePoint) {\n                obj.rotationCirclePointColl = { x: cosAngle * (rotationCirclePoint.x - center.x) -\n                        sinAngle * (rotationCirclePoint.y - center.y) + center.x,\n                    y: sinAngle * (rotationCirclePoint.x - center.x) + cosAngle\n                        * (rotationCirclePoint.y - center.y) + center.y };\n                obj.rotationCirclePointColl.ratioX = (obj.rotationCirclePointColl.x - parent.img.destLeft) /\n                    parent.img.destWidth;\n                obj.rotationCirclePointColl.ratioY = (obj.rotationCirclePointColl.y - parent.img.destTop) /\n                    parent.img.destHeight;\n            }\n        }\n    };\n    Shape.prototype.getSquarePointForRotatedShape = function (obj, object) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var _a = obj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY, width = _a.width, height = _a.height;\n        var center = { x: startX + (width / 2), y: startY + (height / 2) };\n        var cosAngle = Math.cos(obj.rotatedAngle);\n        var sinAngle = Math.sin(obj.rotatedAngle);\n        var p1 = { x: cosAngle * (startX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p2 = { x: cosAngle * (endX - center.x) - sinAngle * (startY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (startY - center.y) + center.y };\n        var p3 = { x: cosAngle * (startX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (startX - center.x) + cosAngle * (endY - center.y) + center.y };\n        var p4 = { x: cosAngle * (endX - center.x) - sinAngle * (endY - center.y) + center.x,\n            y: sinAngle * (endX - center.x) + cosAngle * (endY - center.y) + center.y };\n        point.startX = p1.x;\n        point.startY = p1.y;\n        point.endX = p1.x;\n        point.endY = p1.y;\n        if (point.startX > p2.x) {\n            point.startX = p2.x;\n        }\n        if (point.startX > p3.x) {\n            point.startX = p3.x;\n        }\n        if (point.startX > p4.x) {\n            point.startX = p4.x;\n        }\n        if (point.startY > p2.y) {\n            point.startY = p2.y;\n        }\n        if (point.startY > p3.y) {\n            point.startY = p3.y;\n        }\n        if (point.startY > p4.y) {\n            point.startY = p4.y;\n        }\n        if (point.endX < p2.x) {\n            point.endX = p2.x;\n        }\n        if (point.endX < p3.x) {\n            point.endX = p3.x;\n        }\n        if (point.endX < p4.x) {\n            point.endX = p4.x;\n        }\n        if (point.endY < p2.y) {\n            point.endY = p2.y;\n        }\n        if (point.endY < p3.y) {\n            point.endY = p3.y;\n        }\n        if (point.endY < p4.y) {\n            point.endY = p4.y;\n        }\n        point.width = point.endX - point.startX;\n        point.height = point.endY - point.startY;\n        if (object) {\n            object['activePoint'] = point;\n        }\n        return point;\n    };\n    Shape.prototype.updateZOrder = function (obj, value) {\n        var parent = this.parent;\n        value = value.toLowerCase();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var object = obj;\n        if (isNullOrUndefined(object.order)) {\n            return;\n        }\n        var index;\n        var prevIndex;\n        var highestOrder = this.getHighestOrder();\n        this.updateShapeColl();\n        if (parent.shapeColl.length === 0) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var coll;\n        for (var i = 0; i < parent.shapeColl.length; i++) {\n            coll = parent.shapeColl[i];\n            if (object.id && object.id.indexOf('pen') > -1) {\n                if (coll.id && coll.id === object.id) {\n                    parent.shapeColl.splice(i, 1);\n                }\n            }\n            else if (coll.shape && coll.shape.indexOf('crop-') > -1) {\n                parent.shapeColl.splice(i, 1);\n            }\n        }\n        switch (value) {\n            case 'sendtoback':\n                prevIndex = object.order;\n                index = object.order;\n                object.order = 1;\n                break;\n            case 'sendbackward':\n                object.order -= 1;\n                index = object.order;\n                break;\n            case 'bringtofront':\n                prevIndex = object.order;\n                index = highestOrder;\n                object.order = index;\n                break;\n            case 'bringforward':\n                object.order += 1;\n                index = object.order;\n                break;\n        }\n        this.reArrangeObjColl(index, value, prevIndex);\n        if (object.id && object.id.indexOf('pen') > -1) {\n            this.reUpdateShapeColl(object);\n        }\n    };\n    Shape.prototype.reArrangeObjColl = function (index, value, prevIndex) {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var obj;\n        switch (value) {\n            case 'sendtoback':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order < prevIndex && obj.order <= index) {\n                        obj.order += 1;\n                        this.reUpdateShapeColl(obj);\n                    }\n                }\n                break;\n            case 'sendbackward':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order === index) {\n                        obj.order += 1;\n                        this.reUpdateShapeColl(obj);\n                        break;\n                    }\n                }\n                break;\n            case 'bringtofront':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order > prevIndex && obj.order <= index) {\n                        obj.order -= 1;\n                        this.reUpdateShapeColl(obj);\n                    }\n                }\n                break;\n            case 'bringforward':\n                for (var i = 0, len = parent.shapeColl.length; i < len; i++) {\n                    obj = parent.shapeColl[i];\n                    if (obj.order === index) {\n                        obj.order -= 1;\n                        this.reUpdateShapeColl(obj);\n                        break;\n                    }\n                }\n                break;\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.reorderRedact = function (tempObjColl) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var nonRedact = tempObjColl.filter(function (item) { return item.shape !== 'redact'; });\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var redact = tempObjColl.filter(function (item) { return item.shape === 'redact'; });\n        return redact.concat(nonRedact);\n    };\n    Shape.prototype.updateShapeColl = function () {\n        var parent = this.parent;\n        var isOrdered = false;\n        var tempOrder = 1;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        tempObjColl = this.reorderRedact(tempObjColl);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        if (parent.shapeColl.length > 0 &&\n            parent.shapeColl.length === parent.objColl.length + parent.pointColl.length) {\n            for (var i = 0; i < parent.shapeColl.length; i++) {\n                if (parent.shapeColl[i].order === tempOrder) {\n                    isOrdered = true;\n                    tempOrder++;\n                }\n                else {\n                    isOrdered = false;\n                    break;\n                }\n            }\n            if (isOrdered) {\n                for (var i = 0; i < parent.shapeColl.length; i++) {\n                    if (parent.shapeColl[i].currIndex &&\n                        parent.shapeColl[i].currIndex.indexOf('shape') > -1) {\n                        for (var j = 0; j < tempObjColl.length; j++) {\n                            if (parent.shapeColl[i].currIndex === tempObjColl[j].currIndex) {\n                                parent.shapeColl[i] = extend({}, tempObjColl[j], {}, true);\n                                tempObjColl.splice(j, 1);\n                                break;\n                            }\n                        }\n                    }\n                    else if (parent.shapeColl[i].id && parent.shapeColl[i].id.indexOf('pen') > -1) {\n                        for (var j = 0; j < tempPointColl.length; j++) {\n                            if (parent.shapeColl[i].id === tempPointColl[j].id) {\n                                parent.shapeColl[i] = extend([], tempPointColl[j], [], true);\n                                tempPointColl.splice(j, 1);\n                                break;\n                            }\n                        }\n                    }\n                }\n                return;\n            }\n        }\n        tempObjColl = extend([], parent.objColl, [], true);\n        tempPointColl = extend([], parent.pointColl, [], true);\n        parent.shapeColl = [];\n        var order = 1;\n        var isBreak;\n        var isCrop = false;\n        while (tempObjColl.length !== 0 || tempPointColl.length !== 0) {\n            isBreak = isCrop = false;\n            for (var i = 0; i < tempObjColl.length; i++) {\n                if (tempObjColl[i].order === order ||\n                    (!tempObjColl[i].order && tempObjColl[i].shape &&\n                        tempObjColl[i].shape.indexOf('crop-') > -1)) {\n                    parent.shapeColl.push(extend({}, tempObjColl[i], {}, true));\n                    if (tempObjColl[i].shape && tempObjColl[i].shape.indexOf('crop-') > -1) {\n                        isCrop = true;\n                    }\n                    tempObjColl.splice(i, 1);\n                    isBreak = true;\n                    break;\n                }\n            }\n            if (!isBreak) {\n                for (var i = 0; i < tempPointColl.length; i++) {\n                    if (tempPointColl[i].order === order) {\n                        parent.shapeColl.push(extend([], tempPointColl[i], [], true));\n                        tempPointColl.splice(i, 1);\n                        isBreak = true;\n                        break;\n                    }\n                }\n            }\n            if (!isCrop) {\n                order++;\n            }\n        }\n    };\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    Shape.prototype.reUpdateShapeColl = function (obj) {\n        var parent = this.parent;\n        if (obj.id && obj.id.indexOf('pen') > -1) {\n            if (parent.freehandCounter > 0) {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (parent.pointColl[i].id === obj.id) {\n                        parent.pointColl[i].order = obj.order;\n                    }\n                }\n            }\n        }\n        else if (obj.currIndex && obj.currIndex.indexOf('shape') > -1) {\n            for (var i = 0; i < parent.objColl.length; i++) {\n                if (parent.objColl[i].currIndex === obj.currIndex) {\n                    parent.objColl[i].order = obj.order;\n                }\n            }\n        }\n    };\n    Shape.prototype.drawAnnotations = function (ctx, shape, pen, isPreventApply, x, y, panRegion) {\n        var parent = this.parent;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        var tempSelPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: tempSelPointCollObj } });\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.updateShapeColl();\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var tempShapeColl = extend([], parent.shapeColl, [], true);\n        tempShapeColl = this.reorderRedact(tempShapeColl);\n        var isPrevented = false;\n        if (!this.preventFrameAnnotation) {\n            this.preventFrameAnnotation = isPrevented = true;\n        }\n        for (var i = 0; i < tempShapeColl.length; i++) {\n            var isPenId = tempShapeColl[i].id;\n            if ((tempShapeColl[i].order) ||\n                (!tempShapeColl[i].order && tempShapeColl[i].shape && tempShapeColl[i].shape.indexOf('crop-') > -1) ||\n                (!tempShapeColl[i].order && tempShapeColl[i].shape === 'path' && parent.drawingShape === 'path')) {\n                if (tempShapeColl[i].currIndex && tempShapeColl[i].currIndex.indexOf('shape') > -1) {\n                    parent.objColl = [];\n                    parent.objColl.push(extend({}, tempShapeColl[i], {}, true));\n                    if (shape === 'iterate') {\n                        var temp = this.lowerContext.filter;\n                        this.lowerContext.filter = 'none';\n                        this.iterateObjColl();\n                        this.lowerContext.filter = temp;\n                    }\n                    else if (shape === 'zoom' || shape === 'pan') {\n                        var tempObjCollIndex = -1;\n                        for (var i_3 = 0; i_3 < tempObjColl.length; i_3++) {\n                            if (JSON.stringify(tempObjColl[i_3]) === JSON.stringify(parent.objColl[0])) {\n                                tempObjCollIndex = i_3;\n                                break;\n                            }\n                        }\n                        if (shape === 'zoom') {\n                            this.zoomObjColl(isPreventApply);\n                        }\n                        else {\n                            this.panObjColl(x, y, panRegion);\n                        }\n                        if (tempObjCollIndex > -1) {\n                            tempObjColl[tempObjCollIndex] = extend({}, parent.objColl[0], {}, true);\n                        }\n                    }\n                }\n                else if (tempShapeColl[i].id && tempShapeColl[i].id.indexOf('pen') > -1) {\n                    parent.pointColl = [];\n                    parent.freehandCounter = 0;\n                    parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n                    parent.pointColl.push(extend({}, tempShapeColl[i], {}, true));\n                    parent.notify('freehand-draw', { prop: 'pushSelPointColl', onPropertyChange: false,\n                        value: { obj: { selPointColl: selPointCollObj['selPointColl'][i] } } });\n                    parent.freehandCounter = parent.pointColl.length;\n                    if (pen === 'iterate') {\n                        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                            value: { context: ctx, points: null } });\n                    }\n                    else if (pen === 'zoom' || pen === 'pan') {\n                        if (pen === 'zoom') {\n                            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false,\n                                value: { isPreventApply: isPreventApply } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                                value: { xDiff: x, yDiff: y, panRegion: panRegion } });\n                        }\n                        for (var i_4 = 0; i_4 < tempPointColl.length; i_4++) {\n                            if (tempPointColl[i_4].id === parent.pointColl[0].id) {\n                                tempPointColl[i_4] = extend({}, parent.pointColl[0], {}, true);\n                                break;\n                            }\n                        }\n                        for (var i_5 = 0, len = tempSelPointCollObj['selPointColl'].length; i_5 < len; i_5++) {\n                            if (tempSelPointCollObj['selPointColl'][i_5].id === selPointCollObj['selPointColl'][i_5].id) {\n                                tempSelPointCollObj['selPointColl'][i_5] = extend({}, selPointCollObj['selPointColl'][i_5], {}, true);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            else if ((!tempShapeColl[i].shape && !isPenId) ||\n                (!tempShapeColl[i].currIndex && !isPenId)) {\n                tempShapeColl.splice(i, 1);\n            }\n        }\n        if (pen && pen === 'zoom') {\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n        }\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: tempSelPointCollObj['selPointColl'] } } });\n        if (isPrevented && this.preventFrameAnnotation) {\n            parent.notify('draw', { prop: 'applyFrame', value: { ctx: this.lowerContext, frame: parent.frameObj.type, preventImg: true } });\n            this.preventFrameAnnotation = false;\n        }\n        parent.activeObj = activeObj;\n    };\n    return Shape;\n}());\nexport { Shape };\n","/* eslint-disable prefer-const */\nimport { Browser, extend, getComponent, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Direction } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Transform = /** @class */ (function () {\n    function Transform(parent) {\n        this.isReverseFlip = false; // True when rotate method is called from iteration\n        this.disablePan = false; // auto enable / disable pan while zooming\n        this.isReverseRotate = false; // True when rotate method is called from iteration\n        this.flipColl = []; // To store flip order\n        this.prevZoomValue = 1;\n        this.cropDimension = { width: 0, height: 0 };\n        this.isPreventSelect = false;\n        this.preventDownScale = false;\n        this.resizedImgAngle = null;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Transform.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Transform.prototype.addEventListener = function () {\n        this.parent.on('transform', this.transform, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Transform.prototype.removeEventListener = function () {\n        this.parent.off('transform', this.transform);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Transform.prototype.transform = function (args) {\n        this.initTransformPvtVar();\n        switch (args.prop) {\n            case 'flipImage':\n                this.flipImage(args.value['direction']);\n                break;\n            case 'setDestPointsForFlipState':\n                this.setDestPointsForFlipState();\n                break;\n            case 'zoomAction':\n                this.zoomAction(args.value['zoomFactor'], args.value['zoomPoint'], args.value['isResize']);\n                break;\n            case 'disableZoomOutBtn':\n                this.disableZoomOutBtn(args.value['isZoomOut']);\n                break;\n            case 'rotatedFlip':\n                this.rotatedFlip();\n                break;\n            case 'drawPannedImage':\n                this.drawPannedImage(args.value['xDiff'], args.value['yDiff']);\n                break;\n            case 'drawPannImage':\n                this.drawPannImage(args.value['point']);\n                break;\n            case 'performTransformation':\n                this.performTransformation(args.value['text']);\n                break;\n            case 'updateTransform':\n                this.updateTransform(args.value['text']);\n                break;\n            case 'rotatePan':\n                this.rotatePan(args.value['isCropSelection'], args.value['isDefaultZoom']);\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'pan':\n                this.pan(args.value['value'], args.value['x'], args.value['y']);\n                break;\n            case 'zoom':\n                this.zoom(args.value['zoomFactor'], args.value['zoomPoint']);\n                break;\n            case 'setCurrPanRegion':\n                this.setCurrPanRegion(args.value['region'], args.value['type'], args.value['obj']);\n                break;\n            case 'rotate':\n                this.rotate(args.value['degree'], args.value['obj']);\n                break;\n            case 'flip':\n                this.flip(args.value['direction']);\n                break;\n            case 'update':\n                this.update();\n                break;\n            case 'calcMaxDimension':\n                this.calcMaxDimension(args.value['width'], args.value['height'], args.value['obj'], args.value['isImgShape']);\n                break;\n            case 'getPanMove':\n                args.value['obj']['panMove'] = this.panMove;\n                break;\n            case 'setPanMove':\n                this.panMove = args.value['point'];\n                break;\n            case 'getTempPanMove':\n                args.value['obj']['tempPanMove'] = this.tempPanMove;\n                break;\n            case 'setTempPanMove':\n                this.tempPanMove = args.value['point'];\n                break;\n            case 'setReverseFlip':\n                this.isReverseFlip = args.value['isReverseFlip'];\n                break;\n            case 'setDisablePan':\n                this.disablePan = args.value['bool'];\n                break;\n            case 'setCurrDestinationPoint':\n                this.currDestPoint = args.value['point'];\n                this.currDestPoint.startX -= this.parent.cropObj.totalPannedPoint.x;\n                this.currDestPoint.startY -= this.parent.cropObj.totalPannedPoint.y;\n                break;\n            case 'setReverseRotate':\n                this.isReverseRotate = args.value['bool'];\n                break;\n            case 'getFlipColl':\n                args.value['obj']['flipColl'] = this.flipColl;\n                break;\n            case 'setFlipColl':\n                this.flipColl = args.value['flipColl'];\n                break;\n            case 'getPreviousZoomValue':\n                args.value['obj']['previousZoomValue'] = this.prevZoomValue;\n                break;\n            case 'setPreviousZoomValue':\n                this.prevZoomValue = args.value['previousZoomValue'];\n                break;\n            case 'getCropDimension':\n                args.value['obj']['cropDimension'] = this.cropDimension;\n                break;\n            case 'setCropDimension':\n                this.cropDimension.width = args.value['width'];\n                this.cropDimension.height = args.value['height'];\n                break;\n            case 'getPreventSelect':\n                args.value['obj']['bool'] = this.isPreventSelect;\n                break;\n            case 'setPreventSelect':\n                this.isPreventSelect = args.value['bool'];\n                break;\n            case 'resizeImage':\n                this.resizeImage(args.value['width'], args.value['height']);\n                break;\n            case 'resizeCrop':\n                this.resizeCrop(args.value['width'], args.value['height']);\n                break;\n            case 'updateResize':\n                this.updateResize();\n                break;\n            case 'resize':\n                this.resize(args.value['width'], args.value['height'], args.value['isAspectRatio']);\n                break;\n            case 'straightenImage':\n                this.straightenImage(args.value['degree']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'cropZoom':\n                args.value['obj']['maxDimension'] = this.cropZoom(args.value['value'], args.value['selectionObj']);\n                break;\n            case 'setResizedImgAngle':\n                this.resizedImgAngle = args.value['angle'];\n                break;\n        }\n    };\n    Transform.prototype.getModuleName = function () {\n        return 'transform';\n    };\n    Transform.prototype.initTransformPvtVar = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    Transform.prototype.reset = function () {\n        this.zoomBtnHold = null;\n        this.tempPanMove = null;\n        this.panMove = null;\n        this.disablePan = false;\n        this.currDestPoint = null;\n        this.isReverseRotate = false;\n        this.flipColl = [];\n        this.resizedImgAngle = null;\n        this.transCurrObj = null;\n        this.prevZoomValue = 1;\n        this.isPreventSelect = this.preventDownScale = false;\n    };\n    Transform.prototype.rotateImage = function (degree) {\n        var parent = this.parent;\n        var transitionArgs = { cancel: false, previousDegree: parent.transform.degree,\n            currentDegree: Math.abs(parent.transform.degree + degree) === 360 ? 0 : parent.transform.degree + degree };\n        if (!this.isPreventSelect) {\n            parent.trigger('rotating', transitionArgs);\n            parent.editCompleteArgs = transitionArgs;\n        }\n        this.rotateEvent(transitionArgs, degree);\n    };\n    Transform.prototype.rotateEvent = function (transitionArgs, degree) {\n        var parent = this.parent;\n        if (!transitionArgs.cancel) {\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transCurrObj)) {\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, null, true);\n                prevObj.pointColl = extend({}, parent.pointColl, null, true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            }\n            parent.afterCropActions.push(degree === 90 ? 'rotateRight' : 'rotateLeft');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (parent.activeObj.activePoint && parent.activeObj.shape) {\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.drawRotatedImage(degree);\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            if (activeObjShape) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n            parent.isUndoRedo = false;\n            var obj = { collection: parent.rotateFlipColl };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n            parent.rotateFlipColl = obj['collection'];\n            if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n                parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n                this.isPreventSelect = true;\n                parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                    value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                this.isPreventSelect = false;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                this.prevZoomValue = parent.zoomSettings.zoomFactor;\n            }\n        }\n        else {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n    };\n    Transform.prototype.drawRotatedImage = function (degree) {\n        var parent = this.parent;\n        if (degree === 0) {\n            parent.transform.degree = 0;\n        }\n        else {\n            parent.transform.degree += degree;\n        }\n        if (Math.abs(parent.transform.degree) === 360) {\n            parent.transform.degree = 0;\n        }\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        this.rotateDegree(degree);\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.rotateFlipColl.push(degree);\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (degree > 0) {\n            parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n        }\n        else {\n            for (var i = 0; i < 3; i++) {\n                parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.updateCurrSelectionPoint(degree);\n    };\n    Transform.prototype.rotateDegree = function (degree) {\n        var parent = this.parent;\n        this.lowerContext.save();\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * -degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        this.lowerContext.restore();\n    };\n    Transform.prototype.updateCurrSelectionPoint = function (degree) {\n        var parent = this.parent;\n        if (parent.currSelectionPoint && this.currDestPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            var objColl = extend([], parent.objColl, [], true);\n            var srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                height: parent.img.srcHeight };\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = [];\n            parent.objColl.push(extend({}, parent.currSelectionPoint, {}, true));\n            parent.img = { srcLeft: 0, srcTop: 0, srcWidth: parent.baseImgCanvas.width, srcHeight: parent.baseImgCanvas.height,\n                destLeft: this.currDestPoint.startX, destTop: this.currDestPoint.startY, destWidth: this.currDestPoint.width,\n                destHeight: this.currDestPoint.height };\n            if (typeof (degree) === 'number') {\n                parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n            parent.currSelectionPoint = extend({}, parent.objColl[0], {}, true);\n            this.currDestPoint = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = objColl;\n            parent.activeObj = activeObj;\n            parent.img = { srcLeft: srcPoints.startX, srcTop: srcPoints.startY, srcWidth: srcPoints.width, srcHeight: srcPoints.height,\n                destLeft: destPoints.startX, destTop: destPoints.startY, destWidth: destPoints.width, destHeight: destPoints.height };\n        }\n    };\n    Transform.prototype.flipImage = function (direction) {\n        var parent = this.parent;\n        var transitionArgs = { direction: direction, cancel: false,\n            previousDirection: parent.toPascalCase(parent.transform.currFlipState || direction) };\n        if (!this.isPreventSelect) {\n            parent.trigger('flipping', transitionArgs);\n            parent.editCompleteArgs = transitionArgs;\n        }\n        this.flipEvent(transitionArgs, direction);\n    };\n    Transform.prototype.flipEvent = function (transitionArgs, direction) {\n        var parent = this.parent;\n        if (transitionArgs.cancel) {\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: parent.prevEventObjPoint } });\n            parent.activeObj = parent.prevEventSelectionPoint;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            return;\n        }\n        var prevObj;\n        if (isNullOrUndefined(this.transCurrObj)) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, null, true);\n            prevObj.pointColl = extend({}, parent.pointColl, null, true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        }\n        parent.afterCropActions.push(direction.toLowerCase() === 'horizontal' ? 'horizontalflip' : 'verticalflip');\n        var splitWords = [];\n        var activeObjShape;\n        if (parent.activeObj.activePoint) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        var lowercaseDirection = direction.toLowerCase();\n        this.updateFlipState(lowercaseDirection);\n        var flipState = parent.transform.currFlipState.toLowerCase();\n        parent.transform.currFlipState = (lowercaseDirection === 'horizontal' && flipState === 'horizontal') ||\n            (lowercaseDirection === 'vertical' && flipState === 'vertical') ? '' : lowercaseDirection;\n        var selObj = { isSelected: null };\n        parent.notify('draw', { prop: 'getRotatedFlipCropSelection', onPropertyChange: false, value: { bool: selObj } });\n        if (selObj['isSelected']) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        this.updateFlipState(direction.toLowerCase());\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            this.updateFlipColl(direction.toLocaleLowerCase());\n            parent.rotateFlipColl.push(direction.toLowerCase());\n        }\n        if (parent.rotateFlipColl.length === 1) {\n            var panObj = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj } });\n            if (panObj['panRegion'] === '') {\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            else {\n                this.setDestPointsForFlipState();\n            }\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var flipObjColl = parent.objColl[i].flipObjColl;\n            if (flipObjColl.length === 0) {\n                flipObjColl.push(direction);\n            }\n            else if (flipObjColl[flipObjColl.length - 1] === direction) {\n                flipObjColl.pop();\n            }\n            else {\n                flipObjColl.push(direction);\n            }\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: direction.toLowerCase() } });\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        var dir = direction.toLowerCase();\n        if (dir === 'horizontal' || dir === 'vertical') {\n            parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n                value: { value: dir } });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        else {\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        this.lowerContext.filter = tempFilter;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.updateCurrSelectionPoint(dir);\n        parent.isUndoRedo = false;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (activeObjShape) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n        var obj = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n        parent.rotateFlipColl = obj['collection'];\n        if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n            parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n            this.isPreventSelect = true;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n            this.isPreventSelect = false;\n            parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n            this.prevZoomValue = parent.zoomSettings.zoomFactor;\n        }\n    };\n    Transform.prototype.updateFlipState = function (direction) {\n        var degree = this.parent.transform.degree;\n        if (direction === 'horizontal') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.verticalFlip();\n            }\n            else {\n                this.horizontalFlip();\n            }\n        }\n        else if (direction === 'vertical') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.horizontalFlip();\n            }\n            else {\n                this.verticalFlip();\n            }\n        }\n    };\n    Transform.prototype.horizontalFlip = function () {\n        this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n        this.lowerContext.scale(-1, 1);\n        this.upperContext.translate(this.upperContext.canvas.width, 0);\n        this.upperContext.scale(-1, 1);\n    };\n    Transform.prototype.verticalFlip = function () {\n        this.lowerContext.translate(0, this.lowerContext.canvas.height);\n        this.lowerContext.scale(1, -1);\n        this.upperContext.translate(0, this.upperContext.canvas.height);\n        this.upperContext.scale(1, -1);\n    };\n    Transform.prototype.updateFlipColl = function (direction) {\n        if (this.isPreventSelect) {\n            return;\n        }\n        if (this.flipColl.length === 0 || this.flipColl[this.flipColl.length - 1] !== direction) {\n            this.flipColl.push(direction);\n        }\n        else {\n            this.flipColl.pop();\n        }\n        if (this.flipColl.length >= 4) {\n            var lastFourItems = this.flipColl.slice(-4);\n            if ((lastFourItems[0] === 'horizontal' && lastFourItems[1] === 'vertical' &&\n                lastFourItems[2] === 'horizontal' && lastFourItems[3] === 'vertical') ||\n                (lastFourItems[0] === 'vertical' && lastFourItems[1] === 'horizontal' &&\n                    lastFourItems[2] === 'vertical' && lastFourItems[3] === 'horizontal')) {\n                this.flipColl.splice(-4);\n            }\n        }\n    };\n    Transform.prototype.setDestPointsForFlipState = function () {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        var _a = parent.img, destLeft = _a.destLeft, destTop = _a.destTop, destWidth = _a.destWidth, destHeight = _a.destHeight;\n        var _b = parent.lowerCanvas, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n            else {\n                parent.img.destLeft = clientWidth - (destWidth + destLeft);\n                parent.img.destTop = clientHeight - (destHeight + destTop);\n            }\n        }\n    };\n    Transform.prototype.zoomAction = function (zoomFactor, zoomPoint, isResize, isPreventApply) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (isNullOrUndefined(isResize) && (parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor && zoomFactor > 0 ||\n                (parent.zoomSettings.zoomFactor > parent.zoomSettings.minZoomFactor && zoomFactor < 0 && this.disableZoomOutBtn(true)) ||\n                (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor && zoomFactor < 0))) {\n                parent.notify('toolbar', { prop: 'zoom-up-handler', onPropertyChange: false });\n                return;\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            var tempZoomFactor = zoomFactor;\n            zoomFactor = tempZoomFactor > 0 ? 0.1 : -0.1;\n            for (var i = 0; i < Math.round(Math.abs(tempZoomFactor / 0.1)); i++) {\n                if (this.prevZoomValue === 1) {\n                    this.prevZoomValue += zoomFactor > 0 ? zoomFactor * 10 : (zoomFactor * 10) / 10;\n                }\n                else if (this.prevZoomValue > 1) {\n                    this.prevZoomValue += (zoomFactor * 10);\n                }\n                else if (this.prevZoomValue < 1) {\n                    this.prevZoomValue += (zoomFactor * 10) / 10;\n                    var powerOften = Math.pow(10, 1);\n                    this.prevZoomValue = (Math.round(this.prevZoomValue * powerOften) / powerOften);\n                }\n            }\n            zoomFactor = tempZoomFactor;\n            parent.setProperties({ zoomSettings: { zoomFactor: this.prevZoomValue } }, true);\n            var splitWords = void 0;\n            this.tempActiveObj = null;\n            this.isShape = false;\n            if (parent.activeObj.shape !== undefined) {\n                if (parent.activeObj.shape === 'shape') {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n                else {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n                parent.isCropTab = true;\n            }\n            else if (parent.activeObj.shape && splitWords[0] !== 'crop' &&\n                (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) ||\n                (parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0)) {\n                this.isShape = true;\n            }\n            var obj = { zoomType: null };\n            parent.notify('selection', { prop: 'getZoomType', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(zoomPoint)) {\n                if (parent.isCropTab && this.tempActiveObj) {\n                    zoomPoint = { x: parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2),\n                        y: parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2) };\n                }\n                else {\n                    zoomPoint = { x: parent.lowerCanvas.clientWidth / 2, y: parent.lowerCanvas.clientHeight / 2 };\n                }\n                if (obj['zoomType'] === 'MouseWheel' || obj['zoomType'] === 'Pinch') {\n                    zoomPoint = { x: parent.zoomSettings.zoomPoint.x, y: parent.zoomSettings.zoomPoint.y };\n                }\n            }\n            var previousZoomFactor = parent.zoomSettings.zoomFactor - (zoomFactor * 10);\n            var zoomEventArgs = { zoomPoint: zoomPoint, cancel: false, previousZoomFactor: previousZoomFactor,\n                currentZoomFactor: parent.zoomSettings.zoomFactor, zoomTrigger: obj['zoomType'] };\n            if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n                parent.trigger('zooming', zoomEventArgs);\n                parent.editCompleteArgs = zoomEventArgs;\n            }\n            this.zoomEvent(zoomEventArgs, zoomFactor, isPreventApply);\n        }\n    };\n    Transform.prototype.zoomEvent = function (zoomEventArgs, zoomFact, isPreventApply) {\n        var parent = this.parent;\n        var shapeId;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        if (zoomEventArgs.cancel) {\n            parent.isZoomBtnClick = false;\n            return;\n        }\n        if (this.parent.activeObj.redactType !== 'blur' && this.parent.activeObj.redactType !== 'pixelate') {\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        if (!parent.isCropTab && parent.activeObj.shape) {\n            shapeId = parent.activeObj.currIndex;\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var object = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = object['canvasFilter'];\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var objColl = extend([], parent.objColl, [], true);\n        if (!parent.isCropTab) {\n            if (parent.transform.degree !== 0) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false, value: { x: null, y: null, isMouseDown: null } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                var temp = parent.allowDownScale;\n                parent.allowDownScale = false;\n                this.rotatePan(true, true);\n                parent.allowDownScale = temp;\n            }\n            else if (parent.transform.currFlipState !== '') {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n        }\n        if (parent.transform.degree === 0) {\n            this.drawZoomImgToCanvas(zoomFact, this.tempActiveObj);\n            var panObj_1 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_1 } });\n            if (panObj_1['panRegion'] !== '') {\n                parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: parent.panPoint.totalPannedPoint, isAdd: true } });\n                objColl = extend([], parent.objColl, [], true);\n                parent.objColl = [];\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                this.setDestPointsForFlipState();\n                this.rotatedFlip();\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.objColl = objColl;\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n                if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                    parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n                }\n            }\n            if (zoomFactor <= minZoomFactor && !parent.isCropTab) {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n        }\n        else {\n            if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false, value: { isPreventApply: isPreventApply } });\n            }\n            parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n            parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.rotateZoom(zoomFact);\n            var panObj_2 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj_2 } });\n            if (panObj_2['panRegion'] !== '') {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n                this.lowerContext.filter = temp;\n            }\n        }\n        var powerOften = Math.pow(10, 1);\n        if (zoomFactor <= minZoomFactor ||\n            (Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 2) {\n            clearInterval(this.zoomBtnHold);\n            this.zoomBtnHold = 0;\n        }\n        var panObj = { panRegion: '' };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false, value: { panObj: panObj } });\n        if (panObj['panRegion'] === '') {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: isPreventApply } });\n            this.lowerContext.filter = temp;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            if (zoomFactor <= minZoomFactor) {\n                parent.currSelectionPoint = null;\n            }\n        }\n        parent.isUndoRedo = false;\n        var zoomOut;\n        zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n        if (zoomOut && zoomFactor <= minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var drawingShape = parent.drawingShape;\n        this.autoEnablePan();\n        parent.drawingShape = drawingShape;\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n        }\n        if (parent.activeObj.shape === 'crop-custom') {\n            parent.currObjType.isCustomCrop = true;\n        }\n        if (this.isShape) {\n            if (shapeId) {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === shapeId) {\n                        parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                        parent.objColl.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            else {\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        parent.notify('selection', { prop: 'setZoomType', onPropertyChange: false, value: { zoomType: 'Toolbar' } });\n        // eslint-disable-next-line max-len\n        zoomEventArgs = { zoomPoint: zoomEventArgs.zoomPoint, previousZoomFactor: zoomEventArgs.previousZoomFactor, currentZoomFactor: zoomEventArgs.currentZoomFactor, zoomTrigger: zoomEventArgs.zoomTrigger };\n        if (!parent.isCropToolbar && parent.isZoomBtnClick) {\n            parent.isZoomBtnClick = false;\n        }\n        if (parent.drawingShape) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            parent.enableShapeDrawing(parent.toPascalCase(parent.drawingShape), true);\n            parent.activeObj = activeObj;\n            if (activeObj.activePoint.width > 0 || activeObj.activePoint.height > 0 ||\n                (activeObj.pointColl && activeObj.pointColl.length > 0)) {\n                if (activeObj.shape === 'redact') {\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n                var zOrderElem = parent.element.querySelector('#' + parent.element.id + '_zOrderBtn');\n                var dupElem = parent.element.querySelector('#' + parent.element.id + '_duplicate');\n                var removeElem = parent.element.querySelector('#' + parent.element.id + '_remove');\n                var editTextElem = parent.element.querySelector('#' + parent.element.id + '_editText');\n                if (zOrderElem) {\n                    zOrderElem.classList.remove('e-overlay');\n                }\n                if (dupElem) {\n                    dupElem.classList.remove('e-overlay');\n                }\n                if (removeElem) {\n                    removeElem.classList.remove('e-overlay');\n                }\n                if (editTextElem) {\n                    editTextElem.classList.remove('e-overlay');\n                }\n            }\n        }\n        else if (parent.activeObj.shape && parent.activeObj.shape === 'redact') {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                    isApplyBtn: false, isCropping: false } });\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n    };\n    Transform.prototype.disableZoomOutBtn = function (isZoomOut) {\n        var parent = this.parent;\n        var _a = parent.zoomSettings, zoomFactor = _a.zoomFactor, minZoomFactor = _a.minZoomFactor;\n        var isDisabled = false;\n        var zoomOut;\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor -= 0.1;\n        }\n        zoomOut = parent.element.querySelector('#' + parent.element.id + '_zoomOut');\n        var destPoints = { destLeft: parent.img.destLeft, destTop: parent.img.destTop,\n            destWidth: parent.img.destWidth, destHeight: parent.img.destHeight };\n        if (parent.activeObj.shape) {\n            var maxDimension = this.setZoomDimension(-0.1, parent.activeObj);\n            if (!isNullOrUndefined(zoomOut)) {\n                var actPoint = parent.activeObj.activePoint;\n                if (parent.transform.straighten === 0) {\n                    if (parent.img.destLeft > actPoint.startX || parent.img.destTop >\n                        actPoint.startY || parent.img.destLeft + parent.img.destWidth <\n                        actPoint.endX || parent.img.destTop + parent.img.destHeight < actPoint.endY\n                        || zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n                else {\n                    parent.img.destWidth = maxDimension.width;\n                    parent.img.destHeight = maxDimension.height;\n                    var obj = { isIntersect: null };\n                    parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n                    if (obj['isIntersect'] ||\n                        zoomFactor === minZoomFactor) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                        isDisabled = true;\n                    }\n                    else {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                        isDisabled = false;\n                    }\n                }\n            }\n        }\n        else {\n            this.setZoomDimension(-0.1, null);\n        }\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor += 0.1;\n        }\n        parent.img.destLeft = destPoints['destLeft'];\n        parent.img.destTop = destPoints['destTop'];\n        parent.img.destWidth = destPoints['destWidth'];\n        parent.img.destHeight = destPoints['destHeight'];\n        return isDisabled;\n    };\n    Transform.prototype.drawZoomImgToCanvas = function (value, selectionObj) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        parent.transform[parent.isCropTab ? 'cropZoomFactor' : 'defaultZoomFactor'] = parent.transform.zoomFactor;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.isCropTab) {\n            maxDimension = this.cropZoom(value, selectionObj);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n        }\n        parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n        maxDimension.width = this.cropDimension.width;\n        maxDimension.height = this.cropDimension.height;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.rotatedFlip = function () {\n        var parent = this.parent;\n        this.isReverseFlip = true;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var tempFlipColl = this.flipColl;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        this.flipColl = [];\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, context: null, isPreventCircleCrop: null } });\n        if (tempCurrFlipState === '' && parent.transform.currFlipState !== '') {\n            tempCurrFlipState = parent.transform.currFlipState;\n        }\n        parent.transform.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        parent.objColl = extend([], tempObjColl, [], true);\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        if (tempActiveObj.activePoint.width !== 0) {\n            parent.activeObj = extend({}, tempActiveObj, {}, true);\n        }\n        this.isReverseFlip = false;\n    };\n    Transform.prototype.rotateZoom = function (value) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        var zmFactor = Math.round(parent.transform.zoomFactor * powerOften) / powerOften;\n        if ((zmFactor === 0.1 && value === -0.1) || zmFactor === 0 && value === -0.025) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        if (parent.isCropTab) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n        }\n        else {\n            parent.transform.defaultZoomFactor = parent.transform.zoomFactor;\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var temp = this.lowerContext.filter;\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.objColl = tempObjColl;\n        parent.activeObj = tempActiveObj;\n        var maxDimension = { width: this.cropDimension.width, height: this.cropDimension.height };\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.autoEnablePan = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor <= 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n            parent.pan(false);\n            this.disablePan = false;\n        }\n        else {\n            parent.pan(!this.disablePan);\n        }\n    };\n    Transform.prototype.cropZoom = function (value, selectionObj) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft = destLeft - ((maxDimension.width - parent.img.destWidth) / 2);\n        parent.img.destTop = destTop - ((maxDimension.height - parent.img.destHeight) / 2);\n        destLeft = parent.img.destLeft;\n        destTop = parent.img.destTop;\n        if (selectionObj && parent.transform.straighten === 0) {\n            if (parent.img.destLeft > selectionObj.activePoint.startX) {\n                parent.img.destLeft = selectionObj.activePoint.startX;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop > selectionObj.activePoint.startY) {\n                parent.img.destTop = selectionObj.activePoint.startY;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n            if (parent.img.destLeft + maxDimension.width < selectionObj.activePoint.endX) {\n                parent.img.destLeft = selectionObj.activePoint.endX - maxDimension.width;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop + maxDimension.height < selectionObj.activePoint.endY) {\n                parent.img.destTop = selectionObj.activePoint.endY - maxDimension.height;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.setZoomDimension = function (value, selectionObj) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        var maxDimension = { width: 0, height: 0 };\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft += ((parent.img.destWidth - maxDimension.width) / 2);\n        parent.img.destTop += ((parent.img.destHeight - maxDimension.height) / 2);\n        // While zoom out limit image to draw inside the selection range\n        if (value < 0 && selectionObj) {\n            var startX = selectionObj.activePoint.startX;\n            var startY = selectionObj.activePoint.startY;\n            var width = selectionObj.activePoint.width;\n            var height = selectionObj.activePoint.height;\n            var maxDestLeft = parent.img.destLeft + maxDimension.width;\n            var maxDestTop = parent.img.destTop + maxDimension.height;\n            if (parent.img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (parent.img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (maxDestLeft < startX + width) {\n                parent.img.destLeft = startX + width - maxDimension.width;\n            }\n            if (maxDestTop < startY + height) {\n                parent.img.destTop = startY + height - maxDimension.height;\n            }\n        }\n        else if (value < 0 && isNullOrUndefined(selectionObj)) {\n            if (parent.img.destLeft > 0) {\n                parent.img.destLeft = 0;\n            }\n            if (parent.img.destTop > 0) {\n                parent.img.destTop = 0;\n            }\n            if (parent.img.destLeft + maxDimension.width < parent.lowerCanvas.clientWidth) {\n                parent.img.destLeft = parent.lowerCanvas.clientWidth - parent.img.destWidth;\n            }\n            if (parent.img.destTop + maxDimension.height < parent.lowerCanvas.clientHeight) {\n                parent.img.destTop = parent.lowerCanvas.clientHeight - parent.img.destHeight;\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.drawPannedImage = function (xDiff, yDiff) {\n        var parent = this.parent;\n        var obj = { panDown: null };\n        parent.notify('selection', { prop: 'getPanDown', onPropertyChange: false, value: { obj: obj } });\n        var panEventArgs = { startPoint: obj['panDown'], endPoint: this.panMove, cancel: false };\n        parent.trigger('panning', panEventArgs);\n        if (panEventArgs.cancel) {\n            return;\n        }\n        this.panEvent(xDiff, yDiff);\n    };\n    Transform.prototype.panEvent = function (xDiff, yDiff, isPanMethod) {\n        var parent = this.parent;\n        var isObjCreated = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'shape') {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (isNullOrUndefined(parent.activeObj.shape)) {\n            isObjCreated = true;\n            var actPoint = parent.activeObj.activePoint = { startX: parent.img.destLeft, startY: parent.img.destTop,\n                endX: parent.img.destLeft + parent.img.destWidth, endY: parent.img.destTop + parent.img.destHeight };\n            var startX = actPoint.startX;\n            var startY = actPoint.startY;\n            var endX = actPoint.endX;\n            var endY = actPoint.endY;\n            if (startX < 0) {\n                actPoint.startX = 0;\n            }\n            if (startY < 0) {\n                actPoint.startY = 0;\n            }\n            if (endX > parent.lowerCanvas.width) {\n                actPoint.endX = parent.lowerCanvas.width;\n            }\n            if (endY > parent.lowerCanvas.height) {\n                actPoint.endY = parent.lowerCanvas.height;\n            }\n            actPoint.width = actPoint.endX - actPoint.startX;\n            actPoint.height = actPoint.endY - actPoint.startY;\n            parent.activeObj.shape = 'crop-custom';\n            var obj = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false, value: { obj: obj } });\n            parent.activeObj.strokeSettings = obj['strokeSettings'];\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: actPoint, obj: parent.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            parent.isCropTab = true;\n        }\n        if (parent.transform.degree === 0) {\n            var point = void 0;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    point = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    point = this.updatePanPoints();\n                }\n            }\n            else {\n                point = { x: xDiff, y: yDiff };\n            }\n            parent.panPoint.totalPannedPoint.x += point.x;\n            parent.panPoint.totalPannedPoint.y += point.y;\n            var tempSelectionObj = extend({}, parent.activeObj, {}, true);\n            var temp = this.lowerContext.filter;\n            this.drawPannImage(point, isObjCreated);\n            this.lowerContext.filter = temp;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            parent.activeObj = extend({}, tempSelectionObj, {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n        else {\n            var tempFlipState = parent.transform.currFlipState;\n            parent.isCropTab = true;\n            if ((isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) || isPanMethod) {\n                if (isPanMethod) {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints(xDiff, yDiff);\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = this.updatePanPoints();\n                }\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: xDiff, y: yDiff };\n            }\n            parent.transform.currFlipState = tempFlipState;\n            this.rotatePan(null, null, isObjCreated);\n            parent.isCropTab = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n        }\n        if (isObjCreated) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.isCropTab = false;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n    };\n    Transform.prototype.drawPannImage = function (point, isObjCreated) {\n        var parent = this.parent;\n        var filter = this.lowerContext.filter;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        this.setDestPointsForFlipState();\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: point.x,\n                y: point.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n    };\n    Transform.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.defaultZoomFactor !== 0) {\n            var isUndoRedo = parent.isUndoRedo;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            this.transCurrObj = object['currObj'];\n            this.transCurrObj.objColl = extend([], parent.objColl, null, true);\n            this.transCurrObj.pointColl = extend({}, parent.pointColl, null, true);\n            this.transCurrObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.transCurrObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.isUndoRedo = parent.isCropToolbar = true;\n            var zmFactor = parent.transform.defaultZoomFactor;\n            if (zmFactor > 0) {\n                this.zoomAction(-zmFactor);\n            }\n            else {\n                this.zoomAction(Math.abs(zmFactor));\n            }\n            parent.isCropToolbar = false;\n            parent.isUndoRedo = isUndoRedo;\n        }\n    };\n    Transform.prototype.performTransformation = function (text) {\n        var parent = this.parent;\n        this.resetZoom();\n        this.updateTransform(text);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].flipObjColl.length > 0) {\n                var flipObjColl = { collection: parent.objColl[i].flipObjColl };\n                parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: flipObjColl['collection'], isRotateFlipCollection: null, obj: flipObjColl } });\n                parent.objColl[i].flipObjColl = flipObjColl['collection'];\n                if (parent.objColl[i].flipObjColl.length === 0) {\n                    parent.objColl[i].shapeFlip = '';\n                }\n            }\n        }\n    };\n    Transform.prototype.updateTransform = function (text) {\n        switch (text.toLowerCase()) {\n            case 'rotateleft':\n                this.rotateImage(-90);\n                break;\n            case 'rotateright':\n                this.rotateImage(90);\n                break;\n            case 'horizontalflip':\n                this.flipImage(Direction.Horizontal);\n                break;\n            case 'verticalflip':\n                this.flipImage(Direction.Vertical);\n                break;\n        }\n    };\n    Transform.prototype.rotatePan = function (isCropSelection, isDefaultZoom, isObjCreated) {\n        var parent = this.parent;\n        this.isReverseRotate = true;\n        var tempDegree = parent.transform.degree;\n        var rotatePanActiveObj;\n        var object = { selPointColl: null };\n        if (parent.activeObj.activePoint && parent.activeObj.shape) {\n            rotatePanActiveObj = extend({}, parent.activeObj, {}, true);\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: object } });\n        var cropSelPointColl = object['selPointColl'];\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false, value: { obj: { selPointColl: [] } } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        var initialDestLeft = parent.img.destLeft;\n        var initialDestTop = parent.img.destTop;\n        var intPan = parent.panPoint.totalPannedInternalPoint;\n        if (parent.isCropTab) {\n            parent.img.destLeft += intPan.x;\n            parent.img.destTop += intPan.y;\n        }\n        parent.notify('crop', { prop: 'updateRotatePan', onPropertyChange: false });\n        if (parent.isCropTab) {\n            parent.panPoint.totalPannedInternalPoint.x = parent.img.destLeft - initialDestLeft;\n            parent.panPoint.totalPannedInternalPoint.y = parent.img.destTop - initialDestTop;\n        }\n        var temp = this.lowerContext.filter;\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, isRotatePan: true } });\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n        parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n        parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n        parent.panPoint.totalPannedClientPoint.x = parent.img.destLeft - destLeft;\n        parent.panPoint.totalPannedClientPoint.y = parent.img.destTop - destTop;\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: cropSelPointColl } } });\n        parent.transform.degree = tempDegree;\n        this.lowerContext.filter = 'none';\n        if (isCropSelection) {\n            if (isDefaultZoom) {\n                parent.panPoint.totalPannedClientPoint.x = -parent.panPoint.totalPannedClientPoint.x;\n                parent.panPoint.totalPannedClientPoint.y = -parent.panPoint.totalPannedClientPoint.y;\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n                parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n                parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n                parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n            }\n            else {\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n            }\n        }\n        if (isObjCreated) {\n            parent.isCropTab = false;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'pan', pen: 'pan', x: parent.panPoint.currentPannedPoint.x,\n                y: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        if (isObjCreated) {\n            parent.isCropTab = true;\n        }\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.activeObj = extend({}, rotatePanActiveObj, {}, true);\n        if (parent.activeObj.activePoint) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n        }\n        this.isReverseRotate = false;\n    };\n    Transform.prototype.limitPan = function () {\n        var parent = this.parent;\n        var _a = parent.activeObj.activePoint, startX = _a.startX, startY = _a.startY, endX = _a.endX, endY = _a.endY;\n        var img = parent.img;\n        if (parent.activeObj.activePoint) {\n            if (img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (img.destLeft + img.destWidth < endX) {\n                parent.img.destLeft = endX - img.destWidth;\n            }\n            if (img.destTop + img.destHeight < endY) {\n                parent.img.destTop = endY - img.destHeight;\n            }\n        }\n    };\n    Transform.prototype.pan = function (value, x, y) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (value) {\n                parent.togglePan = true;\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n                if (x || y) {\n                    x = x ? x : 0;\n                    y = y ? y : 0;\n                    if (isNullOrUndefined(this.panMove)) {\n                        this.panMove = { x: x, y: y };\n                    }\n                    if (isNullOrUndefined(this.tempPanMove)) {\n                        this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n                    }\n                    this.panEvent(x, y, true);\n                    this.tempPanMove = null;\n                }\n            }\n            else {\n                parent.togglePan = parent.currObjType.isCustomCrop = false;\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Transform.prototype.zoom = function (zoomFactor, zoomPoint) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var value = this.getCurrentZoomFactor(zoomFactor);\n            if (isNullOrUndefined(zoomPoint)) {\n                this.zoomAction(value, zoomPoint);\n            }\n            else {\n                var type = value > 0 ? 'zoomIn' : 'zoomOut';\n                var absValue = Math.abs(value) * 10;\n                for (var i = 0; i < absValue; i++) {\n                    parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                        value: { x: zoomPoint.x, y: zoomPoint.y, type: type, isResize: null } });\n                }\n            }\n            var actionArgs = { action: value > 0 ? 'zoom-in' : 'zoom-out',\n                actionEventArgs: parent.editCompleteArgs };\n            parent.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    Transform.prototype.getCurrentZoomFactor = function (zoomFactor) {\n        return zoomFactor >= 1 ? (this.prevZoomValue < 1 ? (zoomFactor - this.prevZoomValue) : (zoomFactor - this.prevZoomValue) * 0.1) :\n            (zoomFactor - this.prevZoomValue);\n    };\n    Transform.prototype.setCurrPanRegion = function (region, type, obj) {\n        var panRegion = region;\n        if (region === '') {\n            panRegion = type === 'horizontal' ? 'horizontal' : type === 'vertical' ? 'vertical' : region;\n        }\n        else if (region === 'horizontal') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'vertical' : type === -90 ? 'horizontal' : region;\n        }\n        else if (region === 'vertical') {\n            panRegion = type === 'horizontal' ? 'horizontalVertical' : type === 'vertical' ? 'verticalHorizontal' : type === 90 ?\n                'horizontal' : type === -90 ? 'vertical' : region;\n        }\n        else {\n            panRegion = type === 'horizontal' ? 'vertical' : type === 'vertical' ? 'horizontal' : region;\n        }\n        obj['panRegion'] = panRegion;\n    };\n    Transform.prototype.rotate = function (degree, obj) {\n        var parent = this.parent;\n        var isRotate = false;\n        if (!parent.disabled && parent.isImageLoaded && (degree % 90 === 0)) {\n            this.rotateImage(degree);\n        }\n        obj['isRotate'] = isRotate;\n    };\n    Transform.prototype.flip = function (direction) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.flipImage(direction);\n        }\n    };\n    Transform.prototype.update = function () {\n        var parent = this.parent;\n        var toolbarHeight = 0;\n        var isActiveObj = false;\n        var freehandObj = { bool: false };\n        var straightenObj = { bool: parent.isStraightening };\n        var cxtTbarHeight = 0;\n        var ctToolbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbar');\n        var ctWrapper = parent.element.querySelector('.e-contextual-toolbar-wrapper');\n        var hdWrapper = parent.element.querySelector('#' + parent.element.id + '_headWrapper');\n        if (parent.isImageLoaded) {\n            var isCropSelection = false;\n            var splitWords = void 0;\n            if (Browser.isDevice) {\n                if (parent.activeObj.shape) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n            }\n            var frameObj = { bool: null };\n            parent.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObj } });\n            if (!straightenObj['bool'] && ((ctToolbar && !ctToolbar.parentElement.classList.contains('e-hide')) ||\n                (hdWrapper && !hdWrapper.parentElement.classList.contains('e-hide')))) {\n                ctWrapper.classList.add('e-hide');\n                if (!isCropSelection) {\n                    parent.okBtn(null, true);\n                }\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            var actPoint = extend({}, parent.activeObj.activePoint, {}, true);\n            if (parent.activeObj.shape && (actPoint.width !== 0 || actPoint.height !== 0)) {\n                isActiveObj = true;\n                if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: null } });\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        parent.updateDropInfoContent(parent.element.querySelector('.e-ie-drop-info'));\n        var tempFilter = this.lowerContext.filter;\n        var canvasWrapper = parent.element.querySelector('#' + parent.element.id + '_canvasWrapper');\n        if (canvasWrapper) {\n            canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n        }\n        parent.lowerCanvas.width = parent.upperCanvas.width = parent.maskCanvas.width = parent.element.offsetWidth - 2;\n        if (parent.toolbarTemplate) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + parent.element.id + '_toolbar')) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbar').clientHeight;\n            if (toolbarHeight === 0 && parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                var obj = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n                toolbarHeight = obj['toolbarHeight'];\n            }\n        }\n        var ctxTbarArea = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n        if (Browser.isDevice && straightenObj['bool'] && ctxTbarArea) {\n            cxtTbarHeight = ctxTbarArea.clientHeight;\n        }\n        parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: toolbarHeight } });\n        if (Browser.isDevice) {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - ((2 * toolbarHeight) + cxtTbarHeight) - 4 + 'px';\n            }\n        }\n        else {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - toolbarHeight - 2 + 'px';\n            }\n        }\n        parent.lowerCanvas.height = parent.upperCanvas.height = parseFloat(canvasWrapper.style.height);\n        this.lowerContext.filter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.canvasFilter = this.lowerContext.filter;\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        if (parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.lowerContext.filter = tempFilter;\n            parent.initialAdjustmentValue = tempFilter;\n            parent.canvasFilter = this.lowerContext.filter;\n            if (parent.isImageLoaded) {\n                showSpinner(parent.element);\n                parent.element.style.opacity = '0.5';\n            }\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (canvasWrapper) {\n                canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n                canvasWrapper.style.height = parent.element.offsetHeight + 'px';\n                var obj_1 = { toolbarHeight: 0 };\n                parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj_1 } });\n                if (Browser.isDevice) {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * obj_1['toolbarHeight']) - cxtTbarHeight) - 4 + 'px';\n                }\n                else {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - obj_1['toolbarHeight']) - 2 + 'px';\n                }\n            }\n            parent.lowerCanvas.width = parent.upperCanvas.width = parent.maskCanvas.width =\n                parseFloat(canvasWrapper.style.width);\n            parent.lowerCanvas.height = parent.upperCanvas.height = parent.maskCanvas.height =\n                parseFloat(canvasWrapper.style.height);\n            this.lowerContext.filter = tempFilter;\n            var obj = { width: 0, height: 0 };\n            this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight, obj);\n            var maxDimension = obj;\n            if (straightenObj['bool'] && parent.transform.cropZoomFactor !== 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.cropZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.cropZoomFactor);\n            }\n            else if (parent.transform.defaultZoomFactor > 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.defaultZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.defaultZoomFactor);\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height + 1) / 2;\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '') {\n                if (parent.transform.defaultZoomFactor > 0) {\n                    parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n                }\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n            }\n            else {\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n                var temp = this.lowerContext.filter;\n                parent.notify('draw', { prop: 'drawImage', onPropertyChange: false });\n                this.lowerContext.filter = temp;\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            }\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            var obj1 = { defToolbarItems: null };\n            parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj1 } });\n            if (obj1['defToolbarItems'] && obj1['defToolbarItems'].length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                if (toolbar_1) {\n                    toolbar_1.refreshOverflow();\n                }\n                if (ctWrapper && !straightenObj['bool']) {\n                    ctWrapper.classList.add('e-hide');\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (isActiveObj) {\n                var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                parent.objColl.pop();\n                if (activeObj.activePoint.width !== 0 && activeObj.activePoint.height !== 0) {\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.objColl.push(activeObj);\n                    parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                        value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                    activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                    parent.objColl.pop();\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                    if (straightenObj['bool']) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: activeObj } });\n                    }\n                    if (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse' || parent.activeObj.shape === 'text' ||\n                        parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path' ||\n                        parent.activeObj.shape === 'image') {\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    }\n                }\n            }\n            if (freehandObj['bool']) {\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n            }\n            if (parent.isResize) {\n                parent.aspectWidth = Math.ceil(parent.img.destWidth);\n                parent.aspectHeight = Math.ceil(parent.img.destHeight);\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            if ((parent.transform.degree !== 0 || parent.transform.currFlipState !== '') && parent.transform.defaultZoomFactor > 0) {\n                var totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, null, true);\n                var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, null, true);\n                var totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, null, true);\n                this.zoomAction(.1);\n                this.zoomAction(-.1);\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += totalPannedPoint.x;\n                    parent.img.destTop += totalPannedPoint.y;\n                    parent.panPoint.totalPannedPoint = totalPannedPoint;\n                    parent.notify('draw', { prop: 'updateFlipPan', value: { tempSelectionObj: null } });\n                }\n                else {\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.panPoint.totalPannedClientPoint = totalPannedClientPoint;\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                    parent.isCropTab = true;\n                    this.rotatePan();\n                    parent.isCropTab = false;\n                }\n            }\n            else if (parent.transform.degree !== 0 && parent.transform.cropZoomFactor > 0) {\n                parent.transform.zoomFactor = 0;\n                parent.transform.cropZoomFactor = null;\n                parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n            }\n        }\n    };\n    Transform.prototype.calcMaxDimension = function (width, height, obj, isImgShape) {\n        var object = { toolbarHeight: 0 };\n        var parent = this.parent;\n        parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: object } });\n        var canvasMaxWidth = isImgShape ? parent.element.clientWidth / 3 :\n            parent.element.clientWidth;\n        var canvasMaxHeight = isImgShape ? (parent.element.clientHeight - object['toolbarHeight']) / 3 :\n            parent.element.clientHeight - (object['toolbarHeight']); // 1px border\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - (object['toolbarHeight']) : canvasMaxHeight; // 1px border\n        if (Browser.isDevice && parent.isStraightening) {\n            var cxtTbar = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n            canvasMaxHeight -= cxtTbar ? cxtTbar.clientHeight : 0;\n        }\n        if (!isImgShape && parent.element.clientHeight === 0) {\n            canvasMaxHeight = 0;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            if (canvasMaxWidth > 30) {\n                canvasMaxWidth -= 30;\n            }\n            if (canvasMaxHeight > 30) {\n                canvasMaxHeight -= 30;\n            }\n        }\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        if (isNullOrUndefined(isImgShape)) {\n            var cropObj = { bool: null };\n            parent.notify('crop', { prop: 'getPreventScaling', onPropertyChange: false,\n                value: { obj: cropObj } });\n            if (cropObj['bool'] && parent.cropObj.activeObj.activePoint &&\n                parent.cropObj.activeObj.activePoint.width !== 0 && parent.cropObj.activeObj.activePoint.height !== 0) {\n                cssMaxWidth = parent.cropObj.activeObj.activePoint.width;\n                cssMaxHeight = parent.cropObj.activeObj.activePoint.height;\n            }\n        }\n        if (obj) {\n            obj['width'] = cssMaxWidth;\n            obj['height'] = cssMaxHeight;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    Transform.prototype.updatePanPoints = function (x, y) {\n        var parent = this.parent;\n        var tempActObj = extend({}, parent.activeObj, {}, true);\n        var tempDestLeft = parent.img.destLeft;\n        var tempDestTop = parent.img.destTop;\n        if (isNullOrUndefined(this.tempPanMove)) {\n            this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n        }\n        var xDiff = this.panMove.x - this.tempPanMove.x;\n        var yDiff = this.panMove.y - this.tempPanMove.y;\n        if (x || y) {\n            xDiff = x;\n            yDiff = y;\n        }\n        parent.img.destLeft += xDiff;\n        parent.img.destTop += yDiff;\n        this.limitPan();\n        var obj = { bool: null };\n        var object = { isIntersect: null };\n        parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n        parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        var count = 0;\n        while (parent.transform.straighten !== 0 && (object['isIntersect'] || obj['bool'])) {\n            count++;\n            parent.img.destLeft = tempDestLeft;\n            parent.img.destTop = tempDestTop;\n            if (xDiff !== 0 && xDiff > 0) {\n                xDiff -= 1;\n            }\n            else if (xDiff !== 0 && xDiff < 0) {\n                xDiff += 1;\n            }\n            if (yDiff !== 0 && yDiff > 0) {\n                yDiff -= 1;\n            }\n            else if (yDiff !== 0 && yDiff < 0) {\n                yDiff += 1;\n            }\n            if ((xDiff === 0 && yDiff === 0) || count === 200) {\n                break;\n            }\n            parent.img.destLeft += xDiff;\n            parent.img.destTop += yDiff;\n            this.limitPan();\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: object } });\n            parent.notify('draw', { prop: 'isSelOutsideImg', onPropertyChange: false, value: { obj: obj } });\n        }\n        parent.activeObj = tempActObj;\n        return { x: parent.img.destLeft - tempDestLeft, y: parent.img.destTop - tempDestTop };\n    };\n    Transform.prototype.resizeImage = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var temp1 = true;\n        parent.allowDownScale = false;\n        parent.img.srcLeft = 0;\n        parent.img.srcTop = 0;\n        parent.isAspectRatio = true;\n        var minimum = [];\n        parent.img.srcWidth = parent.baseImgCanvas.width;\n        parent.img.srcHeight = parent.baseImgCanvas.height;\n        if (parent.resizeSrc && parent.resizeSrc.width !== 0 && parent.resizeSrc.height !== 0) {\n            parent.img.srcLeft = parent.resizeSrc.startX;\n            parent.img.srcTop = parent.resizeSrc.startY;\n            parent.img.srcWidth = parent.resizeSrc.width;\n            parent.img.srcHeight = parent.resizeSrc.height;\n        }\n        while ((width < parent.img.destWidth || height < parent.img.destHeight) && temp1) {\n            this.zoomAction(-.1, null, true, true);\n            if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    this.zoomAction(0.0125, null, true, true);\n                    temp1 = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        while ((width > parent.img.destWidth || height > parent.img.destHeight) && temp1 && temp) {\n            this.zoomAction(.1, null, true, true);\n            if (width < parent.img.destWidth || height < parent.img.destHeight) {\n                while (width < parent.img.destWidth) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                    minimum.push(parent.img.destWidth);\n                }\n            }\n        }\n        var nearestNumber = minimum[0];\n        var smallestDifference = Math.abs(parent.img.destWidth - nearestNumber);\n        for (var _i = 0, minimum_1 = minimum; _i < minimum_1.length; _i++) {\n            var num = minimum_1[_i];\n            var difference = Math.abs(width - num);\n            if (difference < smallestDifference) {\n                nearestNumber = num;\n                smallestDifference = difference;\n            }\n        }\n        if (nearestNumber < width && temp) {\n            this.zoomAction(-.0125, null, true, true);\n            temp = false;\n        }\n        if (nearestNumber > width && !temp) {\n            this.zoomAction(.0125, null, true, true);\n            temp = false;\n        }\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = true;\n        this.zoomAction(-.0125, null, true);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = extend({}, this.prevResizeCurrObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                previousObj: prevObj, previousObjColl: prevObj.objColl, previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null, currentText: null,\n                previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n    };\n    Transform.prototype.resizeCrop = function (width, height) {\n        var parent = this.parent;\n        var temp = true;\n        var obj1 = { prevObj: parent.prevObj };\n        parent.cropObj = extend({}, parent.prevCropObj, {}, true);\n        parent.allowDownScale = false;\n        parent.notify('toolbar', { prop: 'getPrevObj', onPropertyChange: false, value: { obj: obj1 } });\n        var activeObj = extend({}, obj1['prevObj']['activeObj'], {}, true);\n        obj1['prevObj']['activeObj'] = extend({}, parent.activeObj, {}, true);\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj1['prevObj'] } });\n        parent.objColl = extend([], obj1['prevObj']['objColl'], [], true);\n        parent.pointColl = extend([], obj1['prevObj']['pointColl'], [], true);\n        parent.transform.straighten = 0;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        if (parent.transform.straighten === 0 && !this.isPreventSelect) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        }\n        var tempwidth = width;\n        var tempheight = height;\n        var tempZoom = false;\n        if (height >= width && height <= Math.ceil(parent.img.destHeight)) {\n            while ((height <= Math.ceil(parent.img.destHeight)) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height <= width && width < parent.img.destWidth) {\n            while ((width < parent.img.destWidth) && temp) {\n                this.zoomAction(-.1, null, true, true);\n                if (width > parent.img.destWidth || height > parent.img.destHeight) {\n                    while (width > parent.img.destWidth || height > parent.img.destHeight) {\n                        this.zoomAction(.0125, null, true, true);\n                        temp = false;\n                    }\n                }\n            }\n        }\n        else if (height >= width && height >= parent.img.destHeight) {\n            while ((height >= parent.img.destHeight) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n        }\n        else if (width >= height && width >= parent.img.destWidth) {\n            while ((width >= parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        else if (height > parent.img.destHeight && width > parent.img.destWidth) {\n            while ((height > parent.img.destHeight) && (width > parent.img.destWidth) && temp) {\n                this.zoomAction(.1, null, true, true);\n            }\n            if (width < parent.img.destWidth && height < parent.img.destHeight) {\n                while (width < parent.img.destWidth && height < parent.img.destHeight) {\n                    this.zoomAction(-.0125, null, true, true);\n                    temp = false;\n                }\n                this.zoomAction(.0125, null, true, true);\n            }\n        }\n        this.resizeImg(activeObj, width, height);\n        width = tempwidth;\n        height = tempheight;\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height > parent.img.destHeight || width > parent.img.destWidth)) {\n                this.zoomAction(.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        if ((height !== parent.img.destHeight || width !== parent.img.destWidth)) {\n            while ((height < parent.img.destHeight || width < parent.img.destWidth)) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = true;\n            }\n            if (tempZoom) {\n                this.zoomAction(-.0125, null, true, true);\n                tempZoom = false;\n            }\n        }\n        obj1['prevObj']['activeObj'] = extend({}, activeObj, {}, true);\n        this.zoomAction(.0125, null, true);\n        parent.allowDownScale = this.preventDownScale ? false : true;\n        parent.isCropTab = false;\n        this.zoomAction(-.0125, null, true);\n        parent.aspectWidth = width;\n        parent.aspectHeight = height;\n    };\n    Transform.prototype.resizeImg = function (activeObj, width, height) {\n        var parent = this.parent;\n        var widthRatio = width / parent.img.destWidth;\n        var heightRatio = height / parent.img.destHeight;\n        if (activeObj.shape) {\n            parent.currSelectionPoint = activeObj;\n            parent.notify('crop', { prop: 'setInitCrop', onPropertyChange: false, value: { bool: true } });\n        }\n        else if (parent.img.srcWidth === parent.baseImgCanvas.width && parent.img.srcHeight === parent.baseImgCanvas.height) {\n            parent.currSelectionPoint = null;\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: parent.img.destLeft, startY: parent.img.destTop,\n                    width: parent.img.destWidth, height: parent.img.destHeight } });\n        }\n        else {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        width = parent.activeObj.activePoint.width * widthRatio;\n        height = parent.activeObj.activePoint.height * heightRatio;\n        var sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n        var sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        var count = 0;\n        while (Browser.isDevice && count < 500 && (sx < 0 || sy < 0 || (sx + width) > parent.img.destWidth\n            || (sy + height) > parent.img.destHeight)) {\n            count++;\n            width -= 1;\n            height -= 1;\n            sx = (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)) - (width / 2);\n            sy = (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)) - (height / 2);\n        }\n        parent.transform.defaultZoomFactor = 0;\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: 'custom', startX: sx, startY: sy, width: width, height: height } });\n        parent.notify('draw', { prop: 'setResizeSelect', value: { bool: false } });\n        if (parent.transform.straighten !== 0) {\n            var obj = { isIntersect: null, arr: null };\n            parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n            parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            while (obj['arr'][0] || obj['arr'][1] || obj['arr'][2] || obj['arr'][3]) {\n                this.zoomAction(.0125, null, true);\n                parent.notify('draw', { prop: 'updateImgCanvasPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'isLinesIntersect', onPropertyChange: false, value: { obj: obj } });\n            }\n        }\n        parent.isCropToolbar = true;\n        parent.crop();\n        parent.isCropToolbar = false;\n    };\n    Transform.prototype.updateResize = function () {\n        var parent = this.parent;\n        parent.prevCropObj = extend({}, parent.cropObj, {}, true);\n        var currObject = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: currObject } });\n        parent.prevObj = currObject['currObj'];\n        if (parent.currSelectionPoint && parent.prevCropObj.activeObj.shape) {\n            parent.prevObj.activeObj = extend({}, parent.prevCropObj.activeObj, {}, true);\n        }\n        parent.prevObj.objColl = extend([], parent.objColl, [], true);\n        parent.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        parent.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        parent.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n            height: parent.img.srcHeight };\n    };\n    Transform.prototype.resize = function (width, height, isAspectRatio) {\n        var parent = this.parent;\n        var aspectHeight;\n        parent.isResize = true;\n        if (isNullOrUndefined(parent.prevCropObj) && isNullOrUndefined(parent.prevObj)) {\n            parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        }\n        var aspectIcon = parent.element.querySelector('#' + parent.element.id + '_aspectratio');\n        var nonAspectIcon = parent.element.querySelector('#' + parent.element.id + '_nonaspectratio');\n        if (aspectIcon && nonAspectIcon) {\n            parent.notify('toolbar', { prop: 'initResizeToolbar' });\n            if (Browser.isDevice) {\n                parent.notify('toolbar', { prop: 'init-main-toolbar', value: { isApplyBtn: false, isDevice: true, isOkBtn: true, isResize: true } });\n            }\n        }\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        if (aspectRatioHeight) {\n            aspectHeight = aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder : aspectRatioHeight.value;\n        }\n        else {\n            aspectHeight = height + 'px';\n        }\n        var resizeEventArgs = { cancel: false, previousWidth: Math.ceil(parent.img.destWidth),\n            previousHeight: Math.ceil(parent.img.destHeight), width: Math.ceil(width), height: height && height !== 0 ? Math.ceil(height) :\n                (isAspectRatio ? Math.ceil(parseFloat(aspectHeight)) : Math.ceil(parent.img.destHeight)),\n            isAspectRatio: isAspectRatio ? isAspectRatio : false };\n        parent.trigger('resizing', resizeEventArgs);\n        parent.editCompleteArgs = resizeEventArgs;\n        if (!resizeEventArgs.cancel) {\n            this.resizeEventHandler(resizeEventArgs);\n        }\n        else if (parent.aspectHeight && parent.aspectWidth) {\n            parent.aspectHeight = resizeEventArgs.previousHeight;\n            parent.aspectWidth = resizeEventArgs.previousWidth;\n        }\n    };\n    Transform.prototype.resizeEventHandler = function (args) {\n        var parent = this.parent;\n        var isRotate;\n        var aspectRatioWidth = parent.element.querySelector('#' + parent.element.id + '_resizeWidth');\n        var aspectRatioHeight = parent.element.querySelector('#' + parent.element.id + '_resizeHeight');\n        if (args.isAspectRatio) {\n            if (this.resizedImgAngle == null || this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: 0 } });\n                var originalWidth = parent.img.destWidth;\n                var originalHeight = parent.img.destHeight;\n                var aspectRatioWidthValue = void 0;\n                if (aspectRatioHeight) {\n                    aspectRatioWidthValue = parseFloat(aspectRatioWidth.value === '' ? aspectRatioWidth.placeholder : aspectRatioWidth.value);\n                    var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n                    // eslint-disable-next-line max-len\n                    var height = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                    getComponent(aspectRatioHeight, 'numerictextbox').value = height;\n                    aspectRatioHeight.value = height.toString() + ' px';\n                    parent.aspectHeight = height;\n                    if (aspectRatioWidth && aspectRatioWidth.value === '') {\n                        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value === '' ? aspectRatioHeight.placeholder :\n                            aspectRatioHeight.value);\n                        value = aspectRatioHeightValue / (originalHeight / originalWidth);\n                        // eslint-disable-next-line max-len\n                        var width = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n                        getComponent(aspectRatioWidth, 'numerictextbox').value = width;\n                        aspectRatioWidth.value = width.toString() + ' px';\n                        parent.aspectWidth = width;\n                    }\n                }\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeImage', value: { width: args.width, height: null } });\n            }\n        }\n        else {\n            if (this.resizedImgAngle !== null && this.resizedImgAngle !== parent.transform.degree) {\n                this.resizedImgAngle = parent.transform.degree;\n                isRotate = true;\n            }\n            if (isRotate) {\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: true } });\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                parent.okBtn(null, true);\n                parent.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                    height: parent.img.srcHeight };\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                parent.notify('transform', { prop: 'setPreventDownScale', value: { bool: false } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'resizeCrop', value: { width: args.width, height: args.height } });\n            }\n        }\n        this.resizedImgAngle = parent.transform.degree;\n    };\n    Transform.prototype.straightenImage = function (degree) {\n        var parent = this.parent;\n        if (parent.toolbar && parent.toolbar.length === 0) {\n            parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n        }\n        parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: null } });\n        parent.setStraighten(degree);\n        parent.okBtn();\n    };\n    return Transform;\n}());\nexport { Transform };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on('undo-redo', this.undoRedo, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        this.parent.off('undo-redo', this.undoRedo);\n        this.parent.off('destroyed', this.destroy);\n    };\n    UndoRedo.prototype.initializeUrPvtProp = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    UndoRedo.prototype.undoRedo = function (args) {\n        this.initializeUrPvtProp();\n        switch (args.prop) {\n            case 'updateUndoRedoColl':\n                this.updateUrc(args.value['operation'], args.value['previousObj'], args.value['previousObjColl'], args.value['previousPointColl'], args.value['previousSelPointColl'], args.value['previousCropObj'], args.value['previousText'], args.value['currentText'], args.value['previousFilter'], args.value['isCircleCrop']);\n                break;\n            case 'refreshUrc':\n                this.refreshUrc(args.value['bool']);\n                break;\n            case 'updateCurrUrc':\n                this.updateCurrUrc(args.value['type'], args.value['isCancel']);\n                break;\n            case 'call-undo':\n                this.callUndo();\n                break;\n            case 'call-redo':\n                this.callRedo();\n                break;\n            case 'undo':\n                this.undo();\n                break;\n            case 'redo':\n                this.redo();\n                break;\n            case 'updateUrObj':\n                this.updateUrObj(args.value['objColl'], args.value['operation']);\n                break;\n            case 'updateUndoRedo':\n                this.updateUndoRedo(args.value ? args.value['operation'] : null);\n                break;\n            case 'getAppliedUndoRedoColl':\n                args.value['obj']['appliedUndoRedoColl'] = this.appliedUndoRedoColl;\n                break;\n            case 'getUndoRedoStep':\n                args.value['obj']['undoRedoStep'] = this.undoRedoStep;\n                break;\n            case 'setUndoRedoStep':\n                this.undoRedoStep = args.value['step'];\n                break;\n            case 'undoDefault':\n                this.undoDefault(args.value['obj']);\n                break;\n            case 'setPreventUR':\n                this.isPreventing = args.value['bool'];\n                break;\n            case 'updateUndoRedoStack':\n                if (args.value && args.value['isPenDraw']) {\n                    this.updateUndoRedoStack(args.value['isPenDraw']);\n                }\n                else {\n                    this.updateUndoRedoStack();\n                }\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undo-redo';\n    };\n    UndoRedo.prototype.reset = function () {\n        this.tempCurrSelPoint = null;\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempActObj = null;\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.isPreventing = false;\n    };\n    UndoRedo.prototype.refreshUrc = function (refreshToolbar) {\n        var parent = this.parent;\n        if (parent.isImageUpdated) {\n            return;\n        }\n        refreshToolbar = refreshToolbar ? refreshToolbar : false;\n        if (refreshToolbar) {\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: true } });\n            this.tempUndoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n            this.tempUndoRedoStep = this.undoRedoStep;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        this.undoRedoColl = this.undoRedoColl.slice(0, this.undoRedoStep);\n        this.appliedUndoRedoColl = this.appliedUndoRedoColl.slice(0, this.undoRedoStep);\n        parent.isUndoRedo = parent.currObjType.isUndoAction = false;\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n    };\n    UndoRedo.prototype.updateCurrUrc = function (type, isCancel) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing || parent.noPushUndo) {\n            return;\n        }\n        parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        if (type === 'ok') {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: false } });\n            var collection = this.tempUndoRedoColl.length > 0 ?\n                extend([], this.tempUndoRedoColl, [], true) :\n                extend([], this.undoRedoColl, [], true);\n            var prevObj = this.undoRedoColl[this.undoRedoColl.length - 1];\n            var appliedURColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n            var prevTransform = prevObj ? extend({}, prevObj.previousObj, {}, true)\n                : null;\n            if (isNullOrUndefined(appliedURColl)) {\n                if (this.undoRedoColl[0]) {\n                    prevObj.previousCropObj = collection[0].previousCropObj;\n                    prevObj.previousObj = collection[0].previousObj;\n                    prevObj.previousObjColl = collection[0].previousObjColl;\n                    prevObj.previousPointColl = collection[0].previousPointColl;\n                    prevObj.previousText = collection[0].previousText;\n                }\n            }\n            else if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                prevObj.previousCropObj = appliedURColl.currentCropObj;\n                prevObj.previousObj = appliedURColl.currentObj;\n                prevObj.previousObjColl = appliedURColl.currentObjColl;\n                prevObj.previousPointColl = appliedURColl.currentPointColl;\n                prevObj.previousText = appliedURColl.currentText;\n                if (prevObj.operation === 'frame' && prevObj.previousObj && prevTransform) {\n                    prevObj.previousObj.defaultZoom = prevTransform.defaultZoom;\n                    prevObj.previousObj.zoomFactor = prevTransform.zoomFactor;\n                    prevObj.previousObj.cropZoom = prevTransform.cropZoom;\n                }\n            }\n            if (prevObj) {\n                if (prevObj.operation !== 'imageHFlip' && prevObj.operation !== 'imageVFlip') {\n                    var obj = this.getZeroZoomObjPointValue(prevObj.currentObjColl, prevObj.currentPointColl);\n                    prevObj.currentObjColl = obj['obj'];\n                    prevObj.currentPointColl = obj['point'];\n                    var adjObj = { adjustmentLevel: null };\n                    parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n                    prevObj.currentObj.adjustmentLevel = extend({}, adjObj['adjustmentLevel'], {}, true);\n                    parent.notify('filter', { prop: 'setTempAdjVal' });\n                    prevObj.currentObj.currentFilter = parent.currentFilter;\n                }\n                this.appliedUndoRedoColl.push(prevObj);\n                if (!isCancel) {\n                    this.triggerActionCompletedEvent(prevObj.operation);\n                }\n            }\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        else if (this.tempUndoRedoColl.length > 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        var lastObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n        var lastPrevObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 2];\n        if (this.appliedUndoRedoColl.length > 16) {\n            this.appliedUndoRedoColl.splice(0, 1);\n        }\n        else if (!isCancel && lastObj && lastPrevObj) {\n            if ((((lastObj.operation === 'shapeTransform' && lastPrevObj.operation === 'shapeTransform') ||\n                (lastObj.operation === 'shapeInsert' && lastPrevObj.operation === 'shapeInsert')) &&\n                JSON.stringify(lastObj.currentObjColl) === JSON.stringify(lastPrevObj.currentObjColl)) ||\n                (lastObj.operation === 'freehand-draw' && lastPrevObj.operation === 'freehand-draw' &&\n                    JSON.stringify(lastObj.currentPointColl) === JSON.stringify(lastPrevObj.currentPointColl)) ||\n                (lastObj.operation === 'freehanddrawCustomized' && lastPrevObj.operation === 'freehanddrawCustomized' &&\n                    JSON.stringify(lastObj.currentPointColl) === JSON.stringify(lastPrevObj.currentPointColl))) {\n                this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length - 1, 1);\n            }\n            else if (this.undoRedoStep !== this.appliedUndoRedoColl.length - 1) {\n                lastObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1];\n                lastPrevObj = this.appliedUndoRedoColl[this.undoRedoStep];\n                if (lastObj && lastPrevObj && lastObj.operation === 'shapeTransform' &&\n                    lastPrevObj.operation === 'shapeTransform' &&\n                    JSON.stringify(lastObj.currentObjColl) === JSON.stringify(lastPrevObj.previousObjColl)) {\n                    this.appliedUndoRedoColl.splice(this.appliedUndoRedoColl.length - 1, 1);\n                    this.undoRedoColl = [];\n                    this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n                    return;\n                }\n            }\n        }\n        this.undoRedoColl = [];\n        this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        if (type === 'ok') {\n            this.undoRedoStep = this.undoRedoColl.length;\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.togglePan = true;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n    };\n    UndoRedo.prototype.triggerActionCompletedEvent = function (action) {\n        var parent = this.parent;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var actionMap = { 'brightness': 'fine-tune', 'contrast': 'fine-tune', 'hue': 'fine-tune',\n            'saturation': 'fine-tune', 'opacity': 'fine-tune', 'blur': 'fine-tune', 'exposure': 'fine-tune',\n            'default': 'filter', 'chrome': 'filter', 'cold': 'filter', 'warm': 'filter',\n            'grayscale': 'filter', 'sepia': 'filter', 'invert': 'filter',\n            'deleteObj': 'shape-delete', 'deleteFreehandDrawing': 'freehand-draw-delete',\n            'shapeInsert': 'shape-insert', 'shapeTransform': 'shape-customize',\n            'freehanddrawCustomized': 'freehand-draw-customize'\n        };\n        var actionResult = actionMap[action] || action;\n        var actionArgs = { action: actionResult, actionEventArgs: parent.editCompleteArgs };\n        parent.triggerEditCompleteEvent(actionArgs);\n    };\n    UndoRedo.prototype.getUndoRedoAction = function (action) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var actionMap = { 'brightness': 'fine-tune', 'contrast': 'fine-tune', 'hue': 'fine-tune',\n            'saturation': 'fine-tune', 'opacity': 'fine-tune', 'blur': 'fine-tune', 'exposure': 'fine-tune',\n            'default': 'filter', 'chrome': 'filter', 'cold': 'filter', 'warm': 'filter',\n            'grayscale': 'filter', 'sepia': 'filter', 'invert': 'filter',\n            'deleteObj': 'shape-delete', 'deleteFreehandDrawing': 'freehand-drawing-delete',\n            'shapeInsert': 'shape-insert', 'shapeTransform': 'shape-customize', 'imageRotate': 'shape-customize',\n            'freehanddraw': 'freehand-draw', 'freehanddrawCustomized': 'freehand-draw-customize',\n            'textAreaCustomization': 'text-area-customization', 'imageHFlip': 'shape-customize',\n            'imageVFlip': 'shape-customize', 'bgColor': 'background-color', 'updateImage': 'image-update'\n        };\n        return actionMap[action] || action;\n    };\n    UndoRedo.prototype.cancelCropSelection = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.currObjType.isCustomCrop || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n        }\n        if (this.tempUndoRedoColl.length !== 0 || this.tempUndoRedoStep !== 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        }\n    };\n    UndoRedo.prototype.refreshToolbarActions = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.applyCurrentChanges = function () {\n        var parent = this.parent;\n        parent.currObjType.isFiltered = false;\n        if (parent.transform.zoomFactor === 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (parent.togglePen) {\n            parent.togglePen = false;\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        if (this.appliedUndoRedoColl.length > 0) {\n            this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        }\n    };\n    UndoRedo.prototype.callUndo = function () {\n        this.applyCurrentChanges();\n        this.undo();\n    };\n    UndoRedo.prototype.callRedo = function () {\n        this.applyCurrentChanges();\n        this.redo();\n    };\n    UndoRedo.prototype.undo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep > 0) {\n                this.refreshToolbarActions();\n                if (parent.activeObj.activePoint && parent.activeObj.activePoint.width !== 0) {\n                    this.tempActObj = parent.activeObj;\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.undoRedoStep--;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                var activeObj = void 0;\n                parent.cropObj = extend({}, obj.previousCropObj, {}, true);\n                parent.afterCropActions = obj.previousObj.afterCropActions;\n                this.lowerContext.filter = obj.previousObj.filter;\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.previousObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.previousObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                var editCompleteArgs = { action: this.getUndoRedoAction(obj.operation) };\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.previousObjColl, obj.previousPointColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.previousPointColl, obj.previousSelPointColl);\n                        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                            value: { value: parent.pointColl.length } });\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.previousObjColl, obj.previousPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.previousObjColl, obj.previousPointColl, obj.previousSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.previousObjColl, obj.previousPointColl);\n                        this.updateTextAreaCustomization(activeObj, obj.previousObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.previousObjColl, true);\n                        break;\n                    case 'frame':\n                        parent.transform.zoomFactor = parent.transform.defaultZoomFactor = obj.previousObj.defaultZoom;\n                        parent.setProperties({ zoomSettings: { zoomFactor: obj.previousObj.zoomFactor } }, true);\n                        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                            value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                        extend(parent.frameObj, obj.previousObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.previousObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.previousObjColl);\n                        break;\n                    case 'bgColor':\n                        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.previousObj.bgColor } });\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                        break;\n                    case 'updateImage':\n                        parent.isImageUpdated = true;\n                        parent.baseImg.src = obj.previousObj.imageSource;\n                        setTimeout(function () {\n                            if (parent.cropObj.straighten !== 0) {\n                                parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                                parent.noPushUndo = true;\n                                parent.crop();\n                                parent.noPushUndo = false;\n                            }\n                            else {\n                                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                            }\n                            parent.isImageUpdated = false;\n                        });\n                        break;\n                    default:\n                        this.undoDefault(obj, true);\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation, filter: obj.filter } });\n                        break;\n                }\n                if (obj.operation === 'crop') {\n                    if (obj.previousObj.currSelectionPoint) {\n                        parent.currSelectionPoint = extend({}, obj.previousObj.currSelectionPoint, {}, true);\n                        if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                            parent.currSelectionPoint = null;\n                        }\n                    }\n                    parent.updateCropTransformItems();\n                    parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                        value: { type: 'custom', startX: null, startY: null, width: null, height: null } });\n                    if (parent.isCircleCrop) {\n                        parent.isCircleCrop = false;\n                        this.tempCurrSelPoint = extend({}, parent.currSelectionPoint, {}, true);\n                        parent.currSelectionPoint = null;\n                    }\n                    var tempCircleCrop = parent.cancelCropSelection.isCircleCrop;\n                    parent.cancelCropSelection.isCircleCrop = false;\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null, isUndoRedo: true } });\n                    parent.cancelCropSelection.isCircleCrop = tempCircleCrop;\n                    parent.currObjType.isActiveObj = false;\n                    if (parent.transform.straighten !== 0) {\n                        parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    }\n                }\n                else if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                if ((this.undoRedoColl[this.undoRedoStep - 1]\n                    && this.undoRedoColl[this.undoRedoStep - 1].isCircleCrop)) {\n                    parent.isCircleCrop = true;\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                this.endUndoRedo(obj.operation, true);\n                var action = { action: 'undo', actionEventArgs: editCompleteArgs };\n                parent.triggerEditCompleteEvent(action);\n            }\n        }\n    };\n    UndoRedo.prototype.redo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        parent.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: false } });\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep < this.appliedUndoRedoColl.length) {\n                this.refreshToolbarActions();\n                this.undoRedoStep++;\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep - 1];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' &&\n                    (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block')) {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                parent.cropObj = extend({}, obj.currentCropObj, {}, true);\n                parent.afterCropActions = obj.currentObj.afterCropActions;\n                this.lowerContext.filter = obj.currentObj.filter;\n                if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false, value: { adjustmentLevel: obj.currentObj.adjustmentLevel } });\n                parent.notify('filter', { prop: 'setTempAdjVal' });\n                parent.currentFilter = obj.currentObj.currentFilter;\n                parent.notify('filter', { prop: 'setTempFilVal' });\n                parent.canvasFilter = this.lowerContext.filter;\n                parent.initialAdjustmentValue = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'setBevelFilter', onPropertyChange: false, value: { bevelFilter: this.lowerContext.filter } });\n                var activeObj = void 0;\n                var editCompleteArgs = { action: this.getUndoRedoAction(obj.operation) };\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                    case 'brightness':\n                    case 'contrast':\n                    case 'hue':\n                    case 'saturation':\n                    case 'opacity':\n                    case 'blur':\n                    case 'exposure':\n                    case 'default':\n                    case 'chrome':\n                    case 'cold':\n                    case 'warm':\n                    case 'grayscale':\n                    case 'blackandwhite':\n                    case 'sepia':\n                    case 'invert':\n                    case 'sharpen':\n                    case 'imageRotate':\n                    case 'shapeInsert':\n                        this.shapeTransform(obj.currentObjColl, obj.currentPointColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.currentPointColl, obj.currentSelPointColl);\n                        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                            value: { value: parent.pointColl.length } });\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.currentObjColl, obj.currentPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.currentObjColl, obj.currentPointColl, obj.currentSelPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.shapeTransform(obj.currentObjColl, obj.currentPointColl);\n                        this.updateTextAreaCustomization(activeObj, obj.currentObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.currentObjColl, false);\n                        break;\n                    case 'frame':\n                        extend(parent.frameObj, obj.currentObj.frameObj);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: true } });\n                        break;\n                    case 'imageHFlip':\n                        this.imageFlip('horizontal', obj.currentObjColl);\n                        break;\n                    case 'imageVFlip':\n                        this.imageFlip('vertical', obj.currentObjColl);\n                        break;\n                    case 'bgColor':\n                        parent.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: obj.currentObj.bgColor } });\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                        break;\n                    case 'updateImage':\n                        parent.isImageUpdated = true;\n                        parent.baseImg.src = obj.currentObj.imageSource;\n                        setTimeout(function () {\n                            if (parent.cropObj.straighten !== 0) {\n                                parent.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                                parent.noPushUndo = true;\n                                parent.crop();\n                                parent.noPushUndo = false;\n                            }\n                            else {\n                                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                            }\n                            parent.isImageUpdated = false;\n                        });\n                        break;\n                    default:\n                        parent.objColl = [];\n                        parent.pointColl = [];\n                        parent.freehandCounter = 0;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: [] } } });\n                        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.currentObj, isUndoRedo: true } });\n                        parent.img.destLeft = obj.currentObj.destPoints.startX;\n                        parent.img.destTop = obj.currentObj.destPoints.startY;\n                        activeObj = extend({}, parent.activeObj, {}, true);\n                        parent.objColl = extend([], obj.currentObjColl, [], true);\n                        parent.pointColl = extend([], obj.currentPointColl, [], true);\n                        parent.freehandCounter = parent.pointColl.length;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: extend([], obj.currentSelPointColl, [], true) } } });\n                        parent.transform.straighten = 0;\n                        this.lowerContext.filter = 'none';\n                        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n                        this.lowerContext.filter = obj.currentObj.filter;\n                        parent.prevStraightenedDegree = parent.transform.straighten;\n                        parent.activeObj = activeObj;\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        }\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation } });\n                        break;\n                }\n                if (obj.operation === 'crop' && obj.isCircleCrop) {\n                    parent.isCircleCrop = true;\n                    parent.currSelectionPoint = extend({}, this.tempCurrSelPoint, {}, true);\n                    this.tempCurrSelPoint = null;\n                }\n                if (obj.operation === 'crop' && !obj.isCircleCrop) {\n                    parent.isCircleCrop = false;\n                }\n                if (obj.operation === 'crop' && obj.currentObj.currSelectionPoint) {\n                    parent.currSelectionPoint = extend({}, obj.currentObj.currSelectionPoint, {}, true);\n                    parent.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: parent.currSelectionPoint } });\n                }\n                if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                    parent.currSelectionPoint = null;\n                }\n                if (obj.operation === 'resize' && parent.cropObj && parent.cropObj.activeObj) {\n                    parent.currSelectionPoint = extend({}, parent.cropObj.activeObj, {}, true);\n                }\n                this.endUndoRedo(obj.operation, false);\n                var action = { action: 'redo', actionEventArgs: editCompleteArgs };\n                parent.triggerEditCompleteEvent(action);\n            }\n        }\n    };\n    UndoRedo.prototype.imageFlip = function (type, objColl) {\n        var parent = this.parent;\n        this.shapeTransform(objColl, null);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var _a = parent.activeObj, shape = _a.shape, isHorImageFlip = _a.isHorImageFlip, isVerImageFlip = _a.isVerImageFlip;\n        parent.objColl.pop();\n        if (shape && shape === 'image') {\n            if (type === 'horizontal') {\n                if (isNullOrUndefined(isHorImageFlip) && isVerImageFlip) {\n                    parent.activeObj.isHorImageFlip = true;\n                    parent.activeObj.isVerImageFlip = null;\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isHorImageFlip) || !isHorImageFlip) {\n                        parent.activeObj.isHorImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isHorImageFlip = null;\n                    }\n                    parent.horizontalFlip(this.upperContext, true);\n                }\n            }\n            else if (type === 'vertical') {\n                if (isNullOrUndefined(isVerImageFlip) && isHorImageFlip) {\n                    parent.activeObj.isVerImageFlip = true;\n                    parent.activeObj.isHorImageFlip = null;\n                    parent.verticalFlip(this.upperContext, true);\n                }\n                else {\n                    if (isNullOrUndefined(isVerImageFlip) || !isVerImageFlip) {\n                        parent.activeObj.isVerImageFlip = true;\n                    }\n                    else {\n                        parent.activeObj.isVerImageFlip = null;\n                    }\n                    parent.verticalFlip(this.upperContext, true);\n                }\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        else {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n    };\n    UndoRedo.prototype.shapeTransform = function (objColl, pointColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        if (pointColl) {\n            parent.pointColl = extend([], pointColl, [], true);\n            parent.freehandCounter = parent.pointColl.length;\n        }\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDraw = function (pointColl, selPointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: selPointColl } } });\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDrawCustomized = function (objColl, pointColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.pointColl = pointColl;\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateDelete = function (operation, objColl, pointColl, selPointColl) {\n        var parent = this.parent;\n        if (operation === 'deleteFreehandDrawing') {\n            parent.pointColl = pointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: selPointColl } } });\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        else if (operation === 'deleteObj') {\n            parent.objColl = objColl;\n            parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextAreaCustomization = function (activeObj, objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            if (this.tempActObj) {\n                if (this.tempActObj.currIndex === objColl[i].currIndex) {\n                    activeObj = extend({}, objColl[i], {}, true);\n                    parent.objColl.splice(i, 1);\n                    break;\n                }\n            }\n            else {\n                activeObj = extend({}, objColl[objColl.length - 1], {}, true);\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        if (activeObj) {\n            this.updateTextBox(activeObj);\n        }\n        if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n        }\n    };\n    UndoRedo.prototype.updateText = function (objColl, allowActiveObj) {\n        var parent = this.parent;\n        if (this.tempActObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        if (objColl.length === 0 && parent.objColl.length === 1) {\n            this.tempActObj = extend({}, parent.objColl[0], {}, true);\n        }\n        else {\n            for (var i = 0, iLen = parent.objColl.length; i < iLen; i++) {\n                if (parent.objColl[i] && isNullOrUndefined(objColl[i])) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n                if (objColl[i].currIndex !== parent.objColl[i].currIndex) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        if (allowActiveObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: true } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextBox = function (obj) {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        var textArea = parent.textArea;\n        textArea.style.display = 'block';\n        textArea.style.fontFamily = obj.textSettings.fontFamily;\n        textArea.style.fontSize = obj.textSettings.fontSize + 'px';\n        textArea.style.color = obj.strokeSettings.strokeColor;\n        textArea.style.fontWeight = obj.textSettings.bold ? 'bold' : 'normal';\n        textArea.style.fontStyle = obj.textSettings.italic ? 'italic' : 'normal';\n        textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        textArea.value = obj.keyHistory;\n        parent.activeObj = extend({}, obj, {}, true);\n        parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n            value: { isTextBox: null } });\n        parent.textArea.style.width = parent.activeObj.activePoint.width + 'px';\n    };\n    UndoRedo.prototype.undoDefault = function (obj, isUndoRedo) {\n        this.lowerContext.filter = obj.previousObj.filter;\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: [] } } });\n        var isCircleCrop = !isUndoRedo ? obj.isCircleCrop : false;\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.previousObj, isUndoRedo: isUndoRedo, isCircleCrop: isCircleCrop } });\n        parent.prevStraightenedDegree = parent.transform.straighten;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.img.destLeft = obj.previousObj.destPoints.startX;\n        parent.img.destTop = obj.previousObj.destPoints.startY;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = extend([], obj.previousObjColl, [], true);\n        parent.pointColl = extend([], obj.previousPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: extend([], obj.previousSelPointColl, [], true) } } });\n        parent.transform.straighten = 0;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        this.lowerContext.filter = obj.previousObj.filter;\n        parent.activeObj = activeObj;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n    };\n    UndoRedo.prototype.endUndoRedo = function (operation, isUndo) {\n        var parent = this.parent;\n        var frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        if (((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) &&\n            JSON.stringify(parent.frameObj) !== JSON.stringify(frameObj)) {\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop && ((isUndo && operation !== 'crop') || !isUndo)) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: false } });\n        if (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] === 'crop') {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: true, isZooming: null, cType: null } });\n        }\n        else {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n        parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        if (parent.transform.degree !== 0) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: 0, yDiff: 0 } });\n        }\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.currObjType.isCustomCrop = false;\n    };\n    UndoRedo.prototype.updateUrc = function (operation, previousObj, previousObjColl, previousPointColl, previousSelPointColl, previousCropObj, previousText, currentText, previousFilter, isCircleCrop) {\n        var parent = this.parent;\n        if (parent.isResize || this.isPreventing) {\n            return;\n        }\n        var obj = { isInitialLoaded: false };\n        if (parent.currObjType.isUndoAction) {\n            this.refreshUrc(true);\n        }\n        parent.notify('draw', { prop: 'isInitialLoaded', onPropertyChange: false, value: { object: obj } });\n        if (!obj['isInitialLoaded'] && parent.allowUndoRedo) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var currentObj = object['currObj'];\n            currentObj.objColl = extend([], parent.objColl, [], true);\n            currentObj.pointColl = extend([], parent.pointColl, [], true);\n            currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (operation === 'crop') {\n                currentObj.currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            }\n            else if (operation === 'frame') {\n                previousObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                currentObj.destPoints = { startX: parent.frameDestPoints.destLeft, startY: parent.frameDestPoints.destTop,\n                    width: parent.frameDestPoints.destWidth, height: parent.frameDestPoints.destHeight };\n                if (!isNullOrUndefined(parent.tempFrameZoomLevel)) {\n                    previousObj.defaultZoom = currentObj.defaultZoom = parent.tempFrameZoomLevel;\n                }\n            }\n            else if ((operation === 'imageHFlip' || operation === 'imageVFlip') && this.appliedUndoRedoColl.length > 0) {\n                var index = previousObjColl[previousObjColl.length - 1].currIndex;\n                previousObjColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentObjColl;\n                if (index) {\n                    for (var i = 0, len = previousObjColl.length; i < len; i++) {\n                        if (previousObjColl[i].currIndex === index) {\n                            var actObj = extend({}, previousObjColl[i], {}, true);\n                            previousObjColl.splice(i, 1);\n                            previousObjColl.push(actObj);\n                            break;\n                        }\n                    }\n                }\n            }\n            this.undoRedoColl.push({ operation: operation, previousObj: previousObj, currentObj: currentObj,\n                previousObjColl: previousObjColl, currentObjColl: currentObj.objColl,\n                previousPointColl: previousPointColl, currentPointColl: currentObj.pointColl,\n                previousSelPointColl: previousSelPointColl, currentSelPointColl: currentObj.selPointColl,\n                previousCropObj: previousCropObj, currentCropObj: extend({}, parent.cropObj, {}, true),\n                previousText: previousText, currentText: currentText, filter: previousFilter, isCircleCrop: isCircleCrop });\n            parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        }\n    };\n    UndoRedo.prototype.updateUrObj = function (objColl, operation) {\n        var parent = this.parent;\n        if (parent.allowUndoRedo) {\n            if (parent.currObjType.isUndoAction && !parent.isShapeDrawing) {\n                this.refreshUrc(true);\n            }\n            if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            parent.objColl.push(parent.activeObj);\n            var cropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var obj = object['currObj'];\n            obj.objColl = extend([], parent.objColl, [], true);\n            obj.pointColl = extend([], parent.pointColl, [], true);\n            obj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            obj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var oper = operation ? operation : 'shapeTransform';\n            this.undoRedoColl.push({ operation: oper, previousObj: obj, currentObj: obj,\n                previousObjColl: objColl, currentObjColl: obj.objColl,\n                previousPointColl: obj.pointColl, currentPointColl: obj.pointColl,\n                previousSelPointColl: obj.selPointColl, currentSelPointColl: obj.selPointColl,\n                previousCropObj: cropObj, currentCropObj: cropObj });\n            parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        }\n    };\n    UndoRedo.prototype.updateUndoRedo = function (operation) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        parent.objColl.push(parent.activeObj);\n        var oper = operation ? operation : 'shapeTransform';\n        this.updateUrc(oper, prevObj, prevObj.objColl, prevObj.pointColl, prevObj.selPointColl, prevCropObj);\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n    };\n    UndoRedo.prototype.getZeroZoomObjPointValue = function (obj, point) {\n        var parent = this.parent;\n        this.updateObjColl();\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var cropDimensionObj = { cropDimension: null };\n        parent.notify('transform', { prop: 'getCropDimension', onPropertyChange: false, value: { obj: cropDimensionObj } });\n        var getZeroZoomObjColl = extend([], parent.objColl, [], true);\n        var getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n        var arrowObj = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: arrowObj } });\n        var tempArrowObj = extend({}, arrowObj['arrowDimension'], {}, true);\n        if (parent.transform.zoomFactor > 0 && (obj.length > 0 || point.length > 0)) {\n            if (obj.length > 0) {\n                for (var i = 0; i < obj.length; i++) {\n                    if (obj[i].currIndex) {\n                        continue;\n                    }\n                    else {\n                        obj[i].currIndex = 'shape_' + (i + 1);\n                    }\n                }\n            }\n            parent.objColl = obj;\n            parent.pointColl = point;\n            var isUndoRedo = parent.isUndoRedo;\n            var isCropTab = parent.isCropTab;\n            if (parent.transform.zoomFactor !== 0) {\n                parent.isUndoRedo = true;\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: true } });\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                var zoomSettings = extend({}, parent.zoomSettings, null, true);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null, isResize: null } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: Math.abs(parent.transform.zoomFactor), zoomPoint: null, isResize: null } });\n                }\n                parent.zoomSettings = zoomSettings;\n                parent.isCropTab = isCropTab;\n                parent.isUndoRedo = isUndoRedo;\n                getZeroZoomObjColl = extend([], parent.objColl, [], true);\n                getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] } });\n                var maxDimension = { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] };\n                maxDimension.width += (maxDimension.width * currentObj.defaultZoom);\n                maxDimension.height += (maxDimension.height * currentObj.defaultZoom);\n                parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n                parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: currentObj } });\n                parent.img.destLeft = currentObj.destPoints.startX;\n                parent.img.destTop = currentObj.destPoints.startY;\n                parent.panPoint.totalPannedPoint = currentObj.totalPannedPoint;\n                parent.panPoint.totalPannedClientPoint = currentObj.totalPannedClientPoint;\n                parent.panPoint.totalPannedInternalPoint = currentObj.totalPannedInternalPoint;\n                parent.objColl = extend([], currentObj.objColl, [], true);\n                parent.pointColl = extend([], currentObj.pointColl, [], true);\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('draw', { prop: 'setArrowDimension', onPropertyChange: false, value: { arrowDimension: tempArrowObj } });\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: extend([], currentObj.selPointColl, [], true) } } });\n                this.lowerContext.filter = 'none';\n                parent.transform.straighten = 0;\n                this.applyImgTranform();\n                parent.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                    value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'updateFHDCurPts', onPropertyChange: false });\n                this.lowerContext.filter = currentObj.filter;\n                if (parent.transform.degree !== 0) {\n                    parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                        value: { xDiff: 0, yDiff: 0 } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n        }\n        return { obj: getZeroZoomObjColl, point: getZeroZoomPointColl };\n    };\n    UndoRedo.prototype.updateObjColl = function () {\n        var parent = this.parent;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            var obj = parent.objColl[i];\n            var isUpdated = false;\n            if (obj.shape === 'line' || obj.shape === 'arrow') {\n                if (obj.activePoint.width < 0) {\n                    obj.activePoint.width = Math.abs(obj.activePoint.width);\n                    isUpdated = true;\n                }\n                if (obj.activePoint.height < 0) {\n                    obj.activePoint.height = Math.abs(obj.activePoint.height);\n                    isUpdated = true;\n                }\n                if (isUpdated) {\n                    var activeObj = extend({}, parent.activeObj, {}, true);\n                    parent.activeObj = obj;\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    obj = parent.activeObj;\n                    parent.activeObj = activeObj;\n                }\n            }\n        }\n    };\n    UndoRedo.prototype.applyImgTranform = function () {\n        var parent = this.parent;\n        var obj = extend({}, parent.activeObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].shape === 'image') {\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var ctx = parent.objColl[i].imageCanvas.getContext('2d');\n                parent.notify('selection', { prop: 'applyTransformToImg', onPropertyChange: false, value: { ctx: ctx } });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('selection', { prop: 'setImageClarity', onPropertyChange: false, value: { bool: true } });\n            }\n        }\n        parent.activeObj = obj;\n    };\n    UndoRedo.prototype.updateUndoRedoStack = function (isPenDraw) {\n        var parent = this.parent;\n        if ((parent.activeObj.currIndex && parent.activeObj.activePoint.width !== 0 ||\n            parent.activeObj.activePoint.height !== 0 || (parent.activeObj.pointColl &&\n            parent.activeObj.pointColl.length > 0)) || isPenDraw) {\n            var isTextArea = parent.textArea.style.display === 'none' ? false : true;\n            var temp = parent.noPushUndo;\n            parent.noPushUndo = false;\n            parent.isUndoRedoStack = true;\n            if (isPenDraw) {\n                var tempTogglePen = parent.togglePen;\n                var obj = { freehandDrawSelectedId: null };\n                parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n                parent.okBtn();\n                parent.noPushUndo = temp;\n                if (obj['freehandDrawSelectedId']) {\n                    parent.noRedact = true;\n                    parent.selectShape(obj['freehandDrawSelectedId']);\n                }\n                else {\n                    parent.freeHandDraw(true);\n                }\n                parent.togglePen = tempTogglePen;\n            }\n            else if (parent.activeObj.currIndex) {\n                var shapeId = parent.activeObj.currIndex;\n                parent.okBtn();\n                parent.noPushUndo = temp;\n                parent.noRedact = true;\n                parent.selectShape(shapeId);\n                if (parent.drawingShape) {\n                    parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: parent.drawingShape.toLowerCase() } });\n                }\n                if (isTextArea) {\n                    parent.enableTextEditing();\n                }\n            }\n            parent.isUndoRedoStack = false;\n        }\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n/* eslint-disable max-len */\nimport { Component, NotifyPropertyChanges, Property, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, isNullOrUndefined, getUniqueID, setValue } from '@syncfusion/ej2-base';\nimport { Dialog, createSpinner } from '@syncfusion/ej2-popups';\nimport { Complex, Browser, ChildProperty, compile as templateCompiler, compile } from '@syncfusion/ej2-base';\nimport { ToolbarModule, Crop, Draw, Filter, FreehandDrawing, Selection, Shape, Transform, UndoRedo, Export, FrameLineStyle, ShapeType } from './../index';\nimport { ZoomTrigger, ImageFinetuneOption } from './../index';\nimport { Uploader } from '@syncfusion/ej2-inputs';\n/**\n * Defines the settings for restricting uploaded images.\n */\nvar UploadSettings = /** @class */ (function (_super) {\n    __extends(UploadSettings, _super);\n    function UploadSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], UploadSettings.prototype, \"allowedExtensions\", void 0);\n    __decorate([\n        Property(null)\n    ], UploadSettings.prototype, \"minFileSize\", void 0);\n    __decorate([\n        Property(null)\n    ], UploadSettings.prototype, \"maxFileSize\", void 0);\n    return UploadSettings;\n}(ChildProperty));\nexport { UploadSettings };\n/**\n * This interface is used to specify settings for finetuning operations on images, including brightness, contrast, hue, saturation, exposure, opacity, and blur. It includes properties for setting minimum and maximum values for each of these options, as well as a default value.\n */\nvar FinetuneSettings = /** @class */ (function (_super) {\n    __extends(FinetuneSettings, _super);\n    function FinetuneSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"brightness\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"contrast\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"hue\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"saturation\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"exposure\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"blur\", void 0);\n    return FinetuneSettings;\n}(ChildProperty));\nexport { FinetuneSettings };\n/**\n * An interface used to define the settings such as minimum, maximum, and default zoom factors, and the type of zooming which are available in the image editor control.\n */\nvar ZoomSettings = /** @class */ (function (_super) {\n    __extends(ZoomSettings, _super);\n    function ZoomSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomTrigger\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"minZoomFactor\", void 0);\n    __decorate([\n        Property(10)\n    ], ZoomSettings.prototype, \"maxZoomFactor\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomPoint\", void 0);\n    return ZoomSettings;\n}(ChildProperty));\nexport { ZoomSettings };\n/**\n * This interface is used to specify settings for selection operations on images, including visibility, stroke color and fill color.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], SelectionSettings.prototype, \"showCircle\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"strokeColor\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"fillColor\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n/**\n * Predefine the font families that populate in font family dropdown list from the toolbar.\n */\nvar FontFamily = /** @class */ (function (_super) {\n    __extends(FontFamily, _super);\n    function FontFamily() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property('Arial')\n    ], FontFamily.prototype, \"default\", void 0);\n    __decorate([\n        Property(null)\n    ], FontFamily.prototype, \"items\", void 0);\n    return FontFamily;\n}(ChildProperty));\nexport { FontFamily };\n/**\n * The Image Editor is a graphical user interface for editing images.\n *\n * {% codeBlock src='image-editor/default/index.md' %}{% endcodeBlock %}\n *\n * @remarks\n * The Image Editor component provides various image editing features such as zooming, cropping, rotating, inserting text and shapes (rectangles, ellipses, and lines), drawing freehand on top of an image, undo/redo, and more.\n *\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options) || this;\n        /**\n         *\n         * Image Editor Private Properties\n         */\n        /** @hidden */\n        _this.isImageLoaded = false;\n        /** @hidden */\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], rotatedAngle: 0, opacity: 1, order: null };\n        // current object's ui interaction properties\n        /** @hidden */\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false, isInitialLine: false,\n            isCustomCrop: false, isZoomed: false, isUndoZoom: false, isUndoAction: false, isFiltered: false, isSave: false, isResize: false, isRedact: false };\n        /** @hidden */\n        _this.objColl = [];\n        /** @hidden */\n        // eslint-disable-next-line\n        _this.pointColl = {};\n        /** @hidden */\n        _this.freehandCounter = 0;\n        /** @hidden */\n        _this.points = [];\n        /** @hidden */\n        _this.togglePen = false;\n        /** @hidden */\n        _this.togglePan = false;\n        /** @hidden */\n        _this.img = { destLeft: 0, destTop: 0, destWidth: 0, destHeight: 0, srcLeft: 0, srcTop: 0, srcWidth: 0, srcHeight: 0 };\n        /** @hidden */\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        _this.rotateFlipColl = [];\n        // All prop values saved while cropping (to restore the image to its original state)\n        /** @hidden */\n        _this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n            degree: 0, currFlipState: '', straighten: 0, destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n            zoomFactor: 0, previousZoomValue: 0, aspectWidth: null, aspectHeight: null, frame: 'none', straightenZoom: 0,\n            adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        // Stored transformations performed after cropping\n        /** @hidden */\n        _this.afterCropActions = [];\n        /** @hidden */\n        _this.transform = { degree: 0, currFlipState: '', zoomFactor: 0, cropZoomFactor: null, defaultZoomFactor: 0, straighten: 0 };\n        /** @hidden */\n        _this.panPoint = { currentPannedPoint: { x: 0, y: 0 }, totalPannedPoint: { x: 0, y: 0 }, totalPannedInternalPoint: { x: 0, y: 0 },\n            totalPannedClientPoint: { x: 0, y: 0 } };\n        /** @hidden */\n        _this.isUndoRedo = false;\n        /** @hidden */\n        _this.isCropTab = false;\n        /** @hidden */\n        _this.isCircleCrop = false;\n        /** @hidden */\n        _this.fontSizeColl = [];\n        /** @hidden */\n        _this.initialAdjustmentValue = '';\n        /** @hidden */\n        _this.currentFilter = '';\n        /** @hidden */\n        _this.canvasFilter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        /** @hidden */\n        _this.toolbarHeight = 0;\n        /** @hidden */\n        _this.isPublicMethod = false;\n        /** @hidden */\n        _this.isCropToolbar = false;\n        /** @hidden */\n        _this.cursor = 'default';\n        /** @hidden */\n        _this.resizeSrc = { startX: _this.img.srcLeft, startY: _this.img.srcTop, width: _this.img.srcWidth, height: _this.img.srcHeight };\n        /** @hidden */\n        _this.isResize = false;\n        /** @hidden */\n        _this.isAspectRatio = false;\n        /** @hidden */\n        _this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        /** @hidden */\n        _this.allowDownScale = true;\n        /** @hidden */\n        _this.gradientColor = '';\n        /** @hidden */\n        _this.size = 20;\n        /** @hidden */\n        _this.inset = 0;\n        /** @hidden */\n        _this.offset = 0;\n        /** @hidden */\n        _this.borderRadius = 0;\n        /** @hidden */\n        _this.lineCount = 0;\n        /** @hidden */\n        _this.prevStraightenedDegree = 0;\n        /** @hidden */\n        _this.tempStraighten = 0;\n        /** @hidden */\n        _this.isStraightening = false;\n        /** @hidden */\n        _this.isFinetuning = false;\n        /** @hidden */\n        _this.isZoomBtnClick = false;\n        /** @hidden */\n        _this.isFinetuneBtnClick = false;\n        /** @hidden */\n        _this.isFilterCanvasClick = false;\n        /** @hidden */\n        _this.isFrameBtnClick = false;\n        /** @hidden */\n        _this.isChangesSaved = false;\n        /** @hidden */\n        _this.isShapeDrawing = false;\n        /** @hidden */\n        _this.noPushUndo = false;\n        /** @hidden */\n        _this.isUndoRedoStack = false;\n        /** @hidden */\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _this.shapeColl = [];\n        /** @hidden */\n        _this.isKBDNavigation = false;\n        /** @hidden */\n        _this.isMaskImage = false;\n        /** @hidden */\n        _this.tempObjColl = [];\n        /** @hidden */\n        _this.tempPointColl = [];\n        /** @hidden */\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        _this.tempShapeColl = [];\n        /** @hidden */\n        _this.isImageUpdated = false;\n        /** @hidden */\n        _this.noRedact = false;\n        /** @hidden */\n        _this.tempRedactBlur = 50;\n        /** @hidden */\n        _this.tempRedactPixel = 40;\n        _this.tempToolbarHeight = 0;\n        _this.tempToolbar = [];\n        ImageEditor_1.Inject(Crop, Draw, Selection, Transform, Export, ToolbarModule);\n        ImageEditor_1.Inject(UndoRedo);\n        ImageEditor_1.Inject(Filter);\n        ImageEditor_1.Inject(Shape);\n        ImageEditor_1.Inject(FreehandDrawing);\n        if (element) {\n            _this.appendTo(element);\n        }\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    /**\n     * To provide the array of modules needed for component rendering.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for component rendering.\n     * @hidden\n     */\n    ImageEditor.prototype.requiredModules = function () {\n        var modules = [];\n        modules.push({ member: 'crop', args: [this] });\n        modules.push({ member: 'draw', args: [this] });\n        modules.push({ member: 'selection', args: [this] });\n        modules.push({ member: 'transform', args: [this] });\n        modules.push({ member: 'export', args: [this] });\n        modules.push({ member: 'toolbar-module', args: [this] });\n        modules.push({ member: 'undo-redo', args: [this] });\n        modules.push({ member: 'filter', args: [this] });\n        modules.push({ member: 'shape', args: [this] });\n        modules.push({ member: 'freehand-draw', args: [this] });\n        return modules;\n    };\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        this.isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.initializeThemeColl();\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if (this.isAngular) {\n            var originalElement = this.element;\n            var clonedElement = originalElement.cloneNode(true);\n            originalElement.parentNode.replaceChild(clonedElement, originalElement);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            this.element = clonedElement;\n            setValue('ej2_instances', [this], this.element);\n        }\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param {ImageEditorModel} newProperties - Specifies new properties\n     * @param {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        var indexObj;\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    this.update();\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    this.update();\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        if (this.theme && this.theme !== '') {\n                            this.theme = this.toPascalCase(this.theme);\n                        }\n                        else {\n                            this.theme = 'Bootstrap5';\n                        }\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'finetuneSettings':\n                    if (newProperties.finetuneSettings) {\n                        this.finetuneSettings = newProperties.finetuneSettings;\n                        this.notify('filter', { prop: 'update-finetunes' });\n                    }\n                    break;\n                case 'locale':\n                    if (newProperties.locale) {\n                        this.notify('toolbar', { prop: 'setLocale', onPropertyChange: false, value: { locale: newProperties.locale } });\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'allowUndoRedo':\n                    if (newProperties.allowUndoRedo) {\n                        this.allowUndoRedo = true;\n                    }\n                    else {\n                        this.allowUndoRedo = false;\n                    }\n                    this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    break;\n                case 'showQuickAccessToolbar':\n                    if (newProperties.showQuickAccessToolbar) {\n                        this.showQuickAccessToolbar = true;\n                        this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n                        indexObj = { freehandSelectedIndex: null };\n                        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                        if (this.activeObj.shape) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                        }\n                        else if (indexObj['freehandSelectedIndex']) {\n                            this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                        }\n                    }\n                    else {\n                        this.showQuickAccessToolbar = false;\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    break;\n                case 'zoomSettings':\n                    if (newProperties.zoomSettings) {\n                        this.zoomSettings.zoomTrigger = newProperties.zoomSettings.zoomTrigger;\n                    }\n                    if (isNullOrUndefined(this.zoomSettings.zoomTrigger)) {\n                        this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar |\n                            ZoomTrigger.Commands);\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if ((newProperties.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'selectionSettings':\n                    if (newProperties.selectionSettings) {\n                        this.selectionSettings = newProperties.selectionSettings;\n                        if (this.activeObj.shape) {\n                            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n                        }\n                    }\n                    break;\n                case 'toolbar':\n                    if (newProperties.toolbar) {\n                        this.toolbar = newProperties.toolbar;\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'toolbarTemplate':\n                    if (newProperties.toolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                        this.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                        this.element.appendChild(this.createElement('div', {\n                            id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n                        }));\n                        this.toolbarTemplateFn();\n                    }\n                    break;\n                case 'quickAccessToolbarTemplate':\n                    if (newProperties.quickAccessToolbarTemplate) {\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                        this.quickAccessToolbarTemplateFn();\n                    }\n                    break;\n                case 'uploadSettings':\n                    if (newProperties.uploadSettings) {\n                        this.uploadSettings = newProperties.uploadSettings;\n                        if (!this.uploadSettings.allowedExtensions) {\n                            this.uploadSettings.allowedExtensions = '.jpg, .jpeg, .png, .svg, .webp';\n                            this.notify('draw', { prop: 'setNullExtension', value: { extension: true } });\n                        }\n                        else {\n                            this.notify('draw', { prop: 'setNullExtension', value: { extension: false } });\n                        }\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else {\n                        this.notify('draw', { prop: 'setNullExtension', value: { extension: true } });\n                    }\n                    this.updateDropInfoContent(this.element.querySelector('.e-ie-drop-info'));\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        var saveDialog = this.element.querySelector('#' + this.element.id + '_saveDialog');\n        if (saveDialog && saveDialog.style.display === 'block') {\n            getComponent(document.getElementById(this.element.id + '_saveDialog'), 'dialog').destroy();\n        }\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        this.unwireEvent();\n        this.notify('toolbar', { prop: 'destroySubComponents', onPropertyChange: false });\n        this.notify('destroyed', null);\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n    };\n    ImageEditor.prototype.initialize = function () {\n        if (this.toolbarTemplate) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            this.toolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        }\n        if (!this.uploadSettings.allowedExtensions) {\n            this.setProperties({ uploadSettings: { allowedExtensions: '.jpg, .jpeg, .png, .svg, .webp' } }, true);\n        }\n        else {\n            this.notify('draw', { prop: 'setNullExtension', value: { extension: false } });\n        }\n        this.createCanvas();\n        if (this.element.offsetWidth > 359 && this.element.querySelector('.e-ie-min-drop-content') && this.element.querySelector('.e-ie-drop-content')) {\n            this.element.querySelector('.e-ie-min-drop-content').style.display = 'none';\n            this.element.querySelector('.e-ie-drop-content').style.display = 'block';\n        }\n        this.createDropUploader();\n        if (this.showQuickAccessToolbar) {\n            var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n            canvasWrapper.appendChild(this.createElement('div', {\n                id: this.element.id + '_quickAccessToolbarArea', className: 'e-quick-access-toolbar-area'\n            }));\n            var quickAccessToolbar = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            quickAccessToolbar.style.position = 'absolute';\n            quickAccessToolbar.style.display = 'none';\n            if (this.activeObj) {\n                quickAccessToolbar.style.left = this.activeObj.activePoint.startX + 'px';\n                quickAccessToolbar.style.top = this.activeObj.activePoint.startY + 'px';\n            }\n            quickAccessToolbar.style.width = '100%';\n        }\n        if (this.quickAccessToolbarTemplate) {\n            this.quickAccessToolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n        }\n        this.wireEvent();\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        this.canvasFilter = this.lowerContext.filter;\n        this.notify('toolbar', { prop: 'setInitialAdjustmentValue', onPropertyChange: false, value: { value: this.lowerContext.filter } });\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n        this.initializeZoomSettings();\n        if (this.imgSrc) {\n            this.open(this.imgSrc);\n        }\n    };\n    ImageEditor.prototype.createDropUploader = function () {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var uploadObj = new Uploader({\n            dropArea: this.element.getElementsByClassName('e-canvas-wrapper')[0],\n            allowedExtensions: this.uploadSettings.allowedExtensions,\n            multiple: false,\n            selected: function (args) {\n                if (args.event.type === 'change' || args.event.type === 'drop') {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var type = args.filesData[0].type;\n                    var errType = 'unsupported';\n                    var extension = _this.getExtensionArray();\n                    var isAllowedFileType = (extension.indexOf(type) > -1 ||\n                        (type === 'jpeg' && (proxy.uploadSettings.allowedExtensions.indexOf('jpg') > -1 ||\n                            proxy.uploadSettings.allowedExtensions.indexOf('jpeg') > -1)));\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var size = args.filesData[0].size;\n                    var isInvalidSize = (proxy.uploadSettings.minFileSize && size < proxy.uploadSettings.minFileSize) ||\n                        (proxy.uploadSettings.maxFileSize && size > proxy.uploadSettings.maxFileSize);\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    if ((args.event.type === 'change' || (args.event.type === 'drop' && args.event.dataTransfer.files.length === 1)) && isAllowedFileType &&\n                        !isInvalidSize) {\n                        _this.notify('draw', { prop: 'fileSelect', value: { inputElement: _this.element.querySelector('#' + _this.element.id + '_dropfileUpload'), args: args } });\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        if (args.event.type === 'drop' && args.event.dataTransfer.files.length > 1) {\n                            errType = 'multi-select-image';\n                        }\n                        _this.showDialogPopup(errType, !isAllowedFileType);\n                    }\n                }\n            }\n        });\n        uploadObj.appendTo('#' + this.element.id + '_dropfileUpload');\n    };\n    ImageEditor.prototype.dlgCloseBtnClick = function () {\n        getComponent(document.getElementById(this.element.id + '_dialog'), 'dialog').destroy();\n    };\n    /**\n     * Show dialog popup for unsupported files.\n     *\n     * @param { string } type - Specifies the type of error.\n     * @param { boolean } fileTypeError - Specifies the error is due to file type.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.showDialogPopup = function (type, fileTypeError) {\n        var content = '';\n        this.element.querySelector('#' + this.element.id + '_dialog').style.display = 'block';\n        var headerObj;\n        var okObj = { key: 'DlgOK' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: okObj } });\n        if (type === 'multi-select-image') {\n            headerObj = { key: 'ImageErrorDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'ImageErrorDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            content = '<span>' + contentObj['value'] + '</span>';\n        }\n        else {\n            headerObj = { key: 'AlertDialogHeader' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: headerObj } });\n            var contentObj = { key: 'AlertDialogContent' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: contentObj } });\n            var supportObj = { key: 'SupportText' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n            var extension = this.getExtensionString();\n            var fileSizeObj = { key: 'MinMaxSizeAlert' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n            var andObj = { key: 'And' };\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: andObj } });\n            var size = void 0;\n            if (this.uploadSettings.minFileSize && this.uploadSettings.maxFileSize) {\n                size = ' ' + fileSizeObj['value'] + ' <b> ' + this.formatSizeUnits(this.uploadSettings.minFileSize) + ' </b> ' + andObj['value'] + ' <b> ' + this.formatSizeUnits(this.uploadSettings.maxFileSize) + ' </b> ';\n            }\n            else if (this.uploadSettings.minFileSize) {\n                fileSizeObj['key'] = 'MinSizeAlert';\n                this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n                size = ' ' + fileSizeObj['value'] + ' <b> ' + this.formatSizeUnits(this.uploadSettings.minFileSize) + ' </b> ';\n            }\n            else if (this.uploadSettings.maxFileSize) {\n                fileSizeObj['key'] = 'MaxSizeAlert';\n                this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n                size = ' ' + fileSizeObj['value'] + ' <b> ' + this.formatSizeUnits(this.uploadSettings.maxFileSize) + ' </b> ';\n            }\n            if (fileTypeError) {\n                content = '<span>' + contentObj['value'] + ' ' + supportObj['value'] + '<b>' + extension + '</b>' + '</span>';\n            }\n            else if (size) {\n                content = '<span>' + contentObj['value'] + ' ' + supportObj['value'] + size + '</span>';\n            }\n        }\n        var dialog = new Dialog({\n            header: headerObj['value'],\n            closeOnEscape: true,\n            content: content,\n            target: document.getElementById('target'),\n            width: Browser.isDevice ? '285px' : '400px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: okObj['value'] }\n                }\n            ]\n        });\n        dialog.appendTo('#' + this.element.id + '_dialog');\n    };\n    /**\n     * Returns bytes in string format.\n     *\n     * @param { number } bytes - Specifies the bytes.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.formatSizeUnits = function (bytes) {\n        var byte = '';\n        if (bytes >= 1073741824) {\n            byte = (bytes / 1073741824).toFixed(2) + ' GB';\n        }\n        else if (bytes >= 1048576) {\n            byte = (bytes / 1048576).toFixed(2) + ' MB';\n        }\n        else if (bytes >= 1024) {\n            byte = (bytes / 1024).toFixed(2) + ' KB';\n        }\n        else if (bytes > 1) {\n            byte = bytes + ' bytes';\n        }\n        else if (bytes === 1) {\n            byte = bytes + ' byte';\n        }\n        else {\n            byte = '0 bytes';\n        }\n        return byte;\n    };\n    /**\n     * Returns allowed file type extensions in string[].\n     *\n     * @hidden\n     * @returns {string[]}.\n     */\n    ImageEditor.prototype.getExtensionArray = function () {\n        var validExtensions = ['jpeg', 'jpg', 'png', 'svg', 'webp'];\n        var split = this.uploadSettings.allowedExtensions.split(',');\n        var extension = [];\n        for (var _i = 0, split_1 = split; _i < split_1.length; _i++) {\n            var ext = split_1[_i];\n            var trimmedExt = ext.trim();\n            for (var _a = 0, validExtensions_1 = validExtensions; _a < validExtensions_1.length; _a++) {\n                var valid = validExtensions_1[_a];\n                if (trimmedExt.indexOf(valid) !== -1) {\n                    extension.push(valid);\n                    break;\n                }\n            }\n        }\n        return extension;\n    };\n    /**\n     * Returns allowed file type extensions in string.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.getExtensionString = function () {\n        var andObj = { key: 'And' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: andObj } });\n        var extension = this.getExtensionArray();\n        var words = '';\n        for (var i = 0; i < extension.length; i++) {\n            if (i === extension.length - 1 && extension.length > 1 &&\n                !((extension[i] === 'jpeg' || extension[i] === 'jpg') &&\n                    (words.indexOf('JPG') > -1))) {\n                words += ' ' + andObj['value'];\n            }\n            switch (extension[i]) {\n                case 'jpeg':\n                case 'jpg':\n                    if (words.indexOf('JPG') === -1) {\n                        words += ' JPG,';\n                    }\n                    break;\n                case 'png':\n                    words += ' PNG,';\n                    break;\n                case 'svg':\n                    words += ' SVG,';\n                    break;\n                case 'webp':\n                    words += ' WebP,';\n                    break;\n            }\n            if (i === extension.length - 1) {\n                words = words.slice(0, -1);\n            }\n        }\n        return words;\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        EventHandler.add(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'wireEvent', onPropertyChange: false });\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(this.upperCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        EventHandler.remove(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        window.removeEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.removeEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'unWireEvent', onPropertyChange: false });\n        this.notify('selection', { prop: 'unWireEvent', onPropertyChange: false });\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        this.element.style.boxSizing = 'border-box';\n        var obj = { toolbarHeight: 0 };\n        this.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n        var height = obj['toolbarHeight'];\n        if (this.toolbar && this.toolbar.length > 0 && this.toolbar.indexOf('Open') === -1) {\n            height = 0;\n        }\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height - 2) + 'px; width:' +\n                    (this.element.offsetWidth - 2)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        var dragObj = { key: 'DragText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dragObj } });\n        var dropObj = { key: 'DropText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: dropObj } });\n        var browseObj = { key: 'BrowseText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: browseObj } });\n        var dropAreaElement = this.createElement('div', { id: this.element.id + '_dropArea', className: 'e-ie-drop-area', attrs: { style: 'position: relative;' } });\n        var dropIconElement = this.createElement('span', { className: 'e-ie-drop-icon e-icons e-image', attrs: { style: 'position: absolute;' } });\n        var dropContentElement = this.createElement('span', { className: 'e-ie-drop-content', attrs: { style: 'position: absolute; display: none;' } });\n        dropContentElement.textContent = dragObj['value'] + ' ';\n        var minDropContentElem = this.createElement('span', { className: 'e-ie-min-drop-content', attrs: { style: 'position: absolute;' } });\n        minDropContentElem.textContent = dropObj['value'] + ' ';\n        var dropAnchorElement = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        dropAnchorElement.textContent = browseObj['value'];\n        var minDropAnchorElem = this.createElement('a', { id: this.element.id + '_dropBrowse', className: 'e-ie-drop-browse' });\n        minDropAnchorElem.textContent = browseObj['value'];\n        dropContentElement.appendChild(dropAnchorElement);\n        minDropContentElem.appendChild(minDropAnchorElem);\n        dropAnchorElement.href = '';\n        minDropAnchorElem.href = '';\n        var dropInfoElement = this.createElement('span', { className: 'e-ie-drop-info', attrs: { position: 'absolute' } });\n        this.updateDropInfoContent(dropInfoElement);\n        var dropUploader = dropAreaElement.appendChild(this.createElement('input', {\n            id: this.element.id + '_dropfileUpload', className: 'e-fileUpload e-image-upload'\n        }));\n        dropUploader.setAttribute('type', 'file');\n        dropUploader.setAttribute('accept', 'image/*');\n        dropAreaElement.appendChild(dropIconElement);\n        dropAreaElement.appendChild(dropContentElement);\n        dropAreaElement.appendChild(minDropContentElem);\n        dropAreaElement.appendChild(dropInfoElement);\n        canvasWrapper.appendChild(dropAreaElement);\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.maskCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_maskCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.baseImgCanvas = this.createElement('canvas', {\n            id: this.element.id + '_baseImgCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textArea = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textArea', className: 'e-textarea', attrs: { name: 'textArea' }\n        }));\n        var dialog = this.element.appendChild(this.createElement('div', {\n            id: this.element.id + '_dialog', className: 'e-dialog'\n        }));\n        dialog.style.display = 'none';\n        var uploader = this.element.appendChild(this.createElement('input', {\n            id: this.element.id + '_fileUpload', className: 'e-fileUpload'\n        }));\n        uploader.setAttribute('type', 'file');\n        uploader.setAttribute('accept', 'image/*');\n        uploader.style.display = 'none';\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.style.lineHeight = 'normal';\n        this.lowerCanvas.style.width = this.upperCanvas.style.width = this.maskCanvas.style.width =\n            this.inMemoryCanvas.style.width = '100%';\n        this.lowerCanvas.style.height = this.upperCanvas.style.height = this.maskCanvas.style.height =\n            this.inMemoryCanvas.style.height = '100%';\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.maskCanvas.style.position =\n            this.textArea.style.position = 'absolute';\n        this.textArea.style.backgroundColor = 'transparent';\n        this.textArea.style.display = 'none';\n        this.maskCanvas.style.display = this.textArea.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = this.cursor = 'default';\n        this.upperCanvas.style.display = 'block';\n        this.upperContext = this.upperCanvas.getContext('2d');\n        dropAnchorElement.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n        minDropAnchorElem.addEventListener('click', function (e) {\n            e.preventDefault();\n            dropUploader.click();\n            return false;\n        });\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        this.notify('selection', { prop: 'touchStartHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseMoveEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'mouseUpEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        this.notify('selection', { prop: 'keyDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        if ((this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block')\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            && e.target.id === this.element.id + '_textArea') {\n            this.notify('selection', { prop: 'textKeyDown', value: { e: e } });\n        }\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseDownHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseMoveHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        if (e.target.className === 'e-ie-drop-browse') {\n            return;\n        }\n        this.notify('selection', { prop: 'canvasMouseUpHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.handleScroll = function (e) {\n        this.notify('selection', { prop: 'handleScroll', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        this.update();\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice && this.element.classList.contains('e-image-editor')) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.notifyResetForAllModules = function () {\n        var modules = this.requiredModules();\n        for (var i = 0; i < modules.length; i++) {\n            var module = modules[i].member;\n            this.notify(module === 'toolbar-module' ? 'toolbar' : module, { prop: 'reset', onPropertyChange: false });\n        }\n    };\n    ImageEditor.prototype.allowShape = function (x, y) {\n        this.isPublicMethod = true;\n        this.applyShapes();\n        var obj = { inRange: false };\n        this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n            value: { x: x, y: y, obj: obj } });\n        return obj['inRange'];\n    };\n    /**\n     * Clears the current selection performed in the image editor.\n     *\n     * @param { boolean } resetCrop - Specifies to reset last cropped image.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function (resetCrop) {\n        this.notify('selection', { prop: 'clearSelection', onPropertyChange: false, value: { resetCrop: resetCrop } });\n    };\n    /**\n     * Crops an image based on the selection done in the image editor.\n     *\n     * {% codeBlock src='image-editor/crop/index.md' %}{% endcodeBlock %}\n     *\n     * @remarks\n     * The selection can be done through programmatically using the 'select' method or through UI interactions.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.crop = function () {\n        var obj = { isCrop: false };\n        this.notify('crop', { prop: 'crop', onPropertyChange: false, value: { obj: obj } });\n        return obj['isCrop'];\n    };\n    /**\n     * Flips an image by horizontally or vertically in the image editor.\n     *\n     * {% codeBlock src='image-editor/zoom/index.md' %}{% endcodeBlock %}\n     *\n     * @param { Direction } direction - Specifies the direction to flip the image.\n     * A horizontal direction for horizontal flipping and vertical direction for vertical flipping.\n     *\n     * @remarks\n     * It flips the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        this.notify('transform', { prop: 'flip', value: { direction: direction } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        var actionArgs = { action: 'flip', actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n    };\n    /**\n     * Returns an image as ImageData to load it in to a canvas.\n     *\n     * @param {boolean} [includeAnnotations=true] - Optional. Specifies whether the returned image data should include annotations. The default value is true, meaning annotations are included.\n     *\n     * @remarks\n     * The data returned from this method is directly drawn in a canvas using 'putImageData' method.\n     * And then the user can get the base64 string from the canvas using toDataURL method.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function (includeAnnotations) {\n        includeAnnotations = isNullOrUndefined(includeAnnotations) ? true : includeAnnotations;\n        var imageData;\n        if (includeAnnotations) {\n            var obj = { canvas: null };\n            this.applyShapes();\n            this.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n            imageData = obj['canvas'].getContext('2d').getImageData(0, 0, obj['canvas'].width, obj['canvas'].height);\n        }\n        else if (this.isMaskImage && this.element.getAttribute('data-value') === 'mask-drawing') {\n            imageData = this.getData(true);\n            this.updateColl('reset');\n        }\n        else {\n            imageData = this.getData();\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        return imageData;\n    };\n    /**\n     *  Opens an image as URL or ImageData for editing in an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the image or image data.\n     * @param {boolean} [resetChanges=true] - Optional. Determines whether to reset existing changes when opening the image. The default value is true, which resets all existing changes.\n     * @param {ImageSettings} imageSettings - Optional. Specifies the image setting that contains background color to apply when opening a transparent image. The default value of background color is an empty string (''), meaning no background color is applied by default when a transparent image is opened.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data, resetChanges, imageSettings) {\n        resetChanges = isNullOrUndefined(resetChanges) ? true : resetChanges;\n        if (resetChanges) {\n            if (isNullOrUndefined(data)) {\n                return;\n            }\n            var dropArea = document.getElementById(this.element.id + '_dropArea');\n            if (dropArea) {\n                dropArea.style.display = 'none';\n            }\n            this.notify('draw', { prop: 'open', value: { data: data } });\n        }\n        else {\n            this.updateImage(data, imageSettings ? imageSettings.backgroundColor : null);\n        }\n    };\n    /**\n     * Reset all the changesdone in an image editor and revert to original image.\n     *\n     * @remarks\n     * The undo redo collection also cleared while resetting the image editor.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        this.updateColl('reset');\n        var obj = { isErrorImage: false };\n        this.notify('draw', { prop: 'getErrorImage', value: { obj: obj } });\n        if (!this.disabled && !obj['isErrorImage']) {\n            this.clearContext(this.inMemoryContext);\n            this.clearContext(this.lowerContext);\n            this.clearContext(this.upperContext);\n            this.notify('shape', { prop: 'setRedactType', onPropertyChange: false, value: { redactType: 'blur' } });\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                this.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n            }\n            var isImageLoaded = this.isImageLoaded;\n            this.currObjType.isUndoAction = this.isUndoRedo = this.togglePan = this.togglePen = this.isImageLoaded = this.isFinetuning = false;\n            this.isCircleCrop = this.isCropTab = false;\n            this.objColl = [];\n            this.transform.degree = 0;\n            this.upperCanvas.style.display = 'block';\n            this.transform.currFlipState = '';\n            this.allowDownScale = true;\n            this.upperCanvas.style.cursor = this.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.frameDestPoints = null;\n            this.textArea.value = this.textArea.textContent = '';\n            this.textArea.style.display = 'none';\n            this.lowerContext.filter = this.canvasFilter = this.getDefaultFilter();\n            this.img.destLeft = this.img.destTop = this.img.srcLeft = this.img.srcTop = 0;\n            this.img.destWidth = this.img.destHeight = this.img.srcWidth = this.img.srcHeight = null;\n            this.currSelectionPoint = null;\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.rotateFlipColl = [];\n            this.points = [];\n            this.pointColl = {};\n            this.freehandCounter = 0;\n            this.notify('draw', { prop: 'resetPanPoints' });\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = '';\n            this.fontSizeColl = [];\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = '';\n            this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = '';\n            this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = '';\n            this.transform.defaultZoomFactor = this.transform.zoomFactor = 0;\n            this.transform.cropZoomFactor = null;\n            this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.tempFrameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false, isUndoZoom: false,\n                isUndoAction: false, isFiltered: false, isSave: false, isResize: false, isRedact: false };\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n            this.afterCropActions = [];\n            this.currentFilter = '';\n            this.tempFrameZoomLevel = null;\n            this.cxtTbarHeight = null;\n            this.straightenPoint = null;\n            this.transform.straighten = 0;\n            this.cancelCropSelection = null;\n            this.aspectWidth = this.aspectHeight = null;\n            this.isResize = this.isMaskImage = false;\n            this.drawingShape = null;\n            this.isShapeDrawing = this.noPushUndo = this.isUndoRedoStack = this.isKBDNavigation = false;\n            this.shapeColl = [];\n            this.tempObjColl = [];\n            this.tempPointColl = [];\n            this.tempShapeColl = [];\n            this.isImageUpdated = false;\n            this.tempToolbarHeight = 0;\n            this.tempToolbar = [];\n            this.tempRedactBlur = 50;\n            this.tempRedactPixel = 40;\n            var obj_1 = { initialZoomValue: false };\n            this.editCompleteArgs = null;\n            this.isFinetuneBtnClick = false;\n            this.notify('draw', { prop: 'getInitialZoomValue', onPropertyChange: false, value: { obj: obj_1 } });\n            if (obj_1['initialZoomValue']) {\n                this.setProperties({ zoomSettings: { zoomFactor: obj_1['initialZoomValue'] } }, true);\n            }\n            var qtArea = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                qtArea.style.display = 'none';\n            }\n            this.notifyResetForAllModules();\n            this.notify('filter', { prop: 'update-finetunes' });\n            if (this.toolbarTemplate) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbarArea').clientHeight;\n            }\n            else if (this.element.querySelector('#' + this.element.id + '_toolbar')) {\n                this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbar').clientHeight;\n            }\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this.isImageLoaded = isImageLoaded;\n            this.straightenBaseImageCanvas();\n            this.isImageLoaded = false;\n            this.notify('draw', { prop: 'update-canvas', onPropertyChange: false });\n            this.isImageLoaded = isImageLoaded;\n            this.prevStraightenedDegree = 0;\n            var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n            if (ctWrapper) {\n                ctWrapper.classList.add('e-hide');\n            }\n            this.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n            this.notify('toolbar', { prop: 'enable-disable-btns' });\n            var straightenObj = { bool: this.isStraightening };\n            if (Browser.isDevice && straightenObj['bool']) {\n                this.notify('crop', { prop: 'resizeWrapper' });\n            }\n            var actionArgs = { action: 'reset', actionEventArgs: null };\n            this.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * {% codeBlock src='image-editor/rotate/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * A positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @remarks\n     * It rotated the shapes including rectangle, circle, line, text, image, and freehand drawings.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var obj = { isRotate: false };\n        if (degree === 90 || degree === -90) {\n            this.updateImageTransformColl(degree === 90 ? 'rotateright' : 'rotateleft');\n        }\n        this.notify('transform', { prop: 'rotate', value: { degree: degree, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var actionArgs = { action: 'rotate', actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n        return obj['isRotate'];\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName  Specifies a file name to be saved\n     * @param {number} imageQuality  Specifies the quality of an image to be saved. The default value is 1 which represents the original size of the image if not specified.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName, imageQuality) {\n        this.applyShapes();\n        this.notify('export', { prop: 'export', onPropertyChange: false, value: { type: type, fileName: fileName, imgQuality: imageQuality } });\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * {% codeBlock src='image-editor/select/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX  Specifies the start x-coordinate point of the selection.\n     * @param {number} startY  Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        this.applyShapes();\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + type } });\n        this.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        if ((startX && startY) || (width && height)) {\n            this.notify('draw', { prop: 'select', onPropertyChange: false,\n                value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n        }\n        else {\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', straighten: 0, zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 }, frame: 'none',\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n                aspectWidth: null, aspectHeight: null, straightenZoom: 0,\n                adjustmentLevel: { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n                    exposure: 0, transparency: 100, sharpen: false, bw: false }, currentFilter: '' };\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing option in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @returns {void}.\n     * @private\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: value } });\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @remarks\n     * User can directly drawing on a canvas after enabling this option.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.freehandDraw = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            if (!value && this.isMaskImage) {\n                this.discard();\n                return;\n            }\n            this.applyShapes();\n            this.freeHandDraw(value);\n            var prevObj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n            var shapeSettings = prevObj['shapeSettingsObj'];\n            shapeSettings.type = ShapeType.FreehandDraw;\n            var shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.notify('freehand-draw', { prop: 'triggerShapeChanging', value: { shapeChangingArgs: shapeChangingArgs } });\n        }\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     * @param {number} x - Optional, Specifies a value to pan the image horizontally.\n     * @param {number} y - Optional, Specifies a value to pan the image vertically.\n     *\n     * @remarks\n     * This option will take into effect once the image's visibility is hidden when zooming an image or selection has been performed.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value, x, y) {\n        this.applyShapes();\n        this.notify('transform', { prop: 'pan', onPropertyChange: false, value: { value: value, x: x, y: y } });\n    };\n    /**\n     * Zoom in or out on a point in the image editor.\n     *\n     * @param {number} zoomFactor - The percentage-based zoom factor to use (e.g. 20 for 2x zoom).\n     * @param {Point} zoomPoint - The point in the image editor to zoom in/out on.\n     *\n     * @remarks\n     * Zooming directly enables the panning option when the image's visibility is hidden.\n     * User can disable it by using 'Pan' method.\n     * @returns {void}\n     *\n     */\n    ImageEditor.prototype.zoom = function (zoomFactor, zoomPoint) {\n        this.isZoomBtnClick = true;\n        this.notify('transform', { prop: 'zoom', onPropertyChange: false,\n            value: { zoomFactor: zoomFactor, zoomPoint: zoomPoint } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * {% codeBlock src='image-editor/ellipse/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - Specifies the radius x point for the ellipse.\n     * @param {number} radiusY - Specifies the radius y point for the ellipse.\n     * @param {number} strokeWidth - Specifies the stroke width of ellipse.\n     * @param {string} strokeColor - Specifies the stroke color of ellipse.\n     * @param {string} fillColor - Specifies the fill color of the ellipse.\n     * @param {number} degree - Specifies the degree to rotate the ellipse.\n     * @param {boolean} isSelected - Specifies to show the ellipse in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree, isSelected) {\n        var isEllipse = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isEllipse = true;\n            this.notify('shape', { prop: 'drawEllipse', onPropertyChange: false, value: { x: x, y: y, radiusX: radiusX, radiusY: radiusY,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of line.\n     * @param {number} startY  Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @param {boolean} isSelected - Specifies to show the line in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor, isSelected) {\n        var isLine = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isLine = true;\n            this.notify('shape', { prop: 'drawLine', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isLine;\n    };\n    /**\n     * Draw arrow on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of arrow.\n     * @param {number} startY  Specifies start point y-coordinate of arrow.\n     * @param {number} endX - Specifies end point x-coordinates of arrow.\n     * @param {number} endY - Specifies end point y-coordinates of the arrow.\n     * @param {number} strokeWidth - Specifies the stroke width of arrow.\n     * @param {string} strokeColor - Specifies the stroke color of arrow.\n     * @param {ArrowheadType} arrowStart  Specifies the type of arrowhead for start position. The default value is None.\n     * @param {ArrowheadType} arrowEnd  Specifies the type of arrowhead for end position. The default value is SolidArrow.\n     * @param {boolean} isSelected - Specifies to show the arrow in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd, isSelected) {\n        var isArrow = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isArrow = true;\n            this.notify('shape', { prop: 'drawArrow', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, arrowStart: arrowStart, arrowEnd: arrowEnd,\n                    isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isArrow;\n    };\n    /**\n     * Draw path on an image.\n     *\n     * @param {Point[]} pointColl  Specifies collection of start and end x, y-coordinates of path.\n     * @param {number} strokeWidth - Specifies the stroke width of path.\n     * @param {string} strokeColor - Specifies the stroke color of path.\n     * @param {boolean} isSelected - Specifies to show the path in the selected state.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawPath = function (pointColl, strokeWidth, strokeColor, isSelected) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        var isPath = false;\n        if (pointColl && pointColl.length > 0) {\n            for (var i = 0; i < pointColl.length; i++) {\n                if (obj['inRange']) {\n                    break;\n                }\n                this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n                    value: { x: pointColl[i].x, y: pointColl[i].y, obj: obj } });\n            }\n        }\n        if (!this.disabled && this.isImageLoaded && (obj['inRange'] || isNullOrUndefined(pointColl))) {\n            isPath = true;\n            this.applyShapes();\n            this.notify('shape', { prop: 'drawPath', onPropertyChange: false, value: { pointColl: pointColl,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, isSelected: isSelected } });\n            this.editCompleted();\n        }\n        return isPath;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - Specifies the fill color of the rectangle.\n     * @param {number} degree - Specifies the degree to rotate the rectangle.\n     * @param {boolean} isSelected - Specifies to show the rectangle in the selected state.\n     * @param {number} borderRadius - Specifies the radius to apply border radius to rectangle.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree, isSelected, borderRadius) {\n        var isRectangle = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRectangle = true;\n            this.notify('shape', { prop: 'drawRectangle', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor, degree: degree, isSelected: isSelected,\n                    radius: borderRadius } });\n            this.editCompleted();\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * {% codeBlock src='image-editor/text/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @param {boolean} isSelected - Specifies to show the text in the selected state.\n     * @param {number} degree - Specifies the degree to rotate the text.\n     * @param {fillColor} fillColor - Specifies the background Color of the text.\n     * @param {string} strokeColor - Specifies the outline color of the text annotation.\n     * @param {number} strokeWidth - Specifies the outline stroke width of the text annotation.\n     * @param {TransformationCollection[]} transformCollection - Specifies the transform collection of the text annotation.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color, isSelected, degree, fillColor, strokeColor, strokeWidth, transformCollection) {\n        var isText = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isText = true;\n            this.notify('shape', { prop: 'drawText', onPropertyChange: false, value: { x: x, y: y, text: text, fontFamily: fontFamily,\n                    fontSize: fontSize, bold: bold, italic: italic, color: color, isSelected: isSelected, degree: degree, fillColor: fillColor,\n                    outlineColor: strokeColor, outlineWidth: strokeWidth, transformCollection: transformCollection } });\n            this.editCompleted();\n        }\n        return isText;\n    };\n    /**\n     * Draw an image as annotation on an image.\n     *\n     *\n     * @param {string | ImageData} data - Specifies url of the image or image data.\n     * @param {number} x - Specifies x-coordinate of a starting point for an image.\n     * @param {number} y - Specifies y-coordinate of a starting point for an image.\n     * @param {number} width - Specifies the width of the image.\n     * @param {number} height - Specifies the height of the image.\n     * @param {boolean} isAspectRatio - Specifies whether to maintain aspect ratio or not.\n     * @param {number} degree - Specifies the degree to rotate the image.\n     * @param {number} opacity - Specifies the value for the image.\n     * @param {boolean} isSelected - Specifies to show the image in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawImage = function (data, x, y, width, height, isAspectRatio, degree, opacity, isSelected) {\n        var isImage = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            var length_1 = this.objColl.length;\n            this.notify('shape', { prop: 'drawImage', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    src: data, degree: degree, isAspectRatio: isAspectRatio, opacity: opacity, isSelected: isSelected } });\n            this.editCompleted();\n            if (this.objColl.length > length_1) {\n                isImage = true;\n            }\n        }\n        return isImage;\n    };\n    /**\n     * This method is used to update the existing shapes by changing its height, width, color, and font styles in the component.\n     * Use 'getShapeSettings' method to get the shape which is then passed to change the options of a shape.\n     * {% codeBlock src='image-editor/updateShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {ShapeSettings} setting - Specifies the shape settings to be updated for the shape on an image.\n     * @param {boolean} isSelected - Specifies to show the shape in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.updateShape = function (setting, isSelected) {\n        var obj = { isSelected: false };\n        var isTextArea = false;\n        var freehandObj = { bool: false };\n        if (isNullOrUndefined(setting.id)) {\n            if (setting.strokeColor) {\n                this.activeObj.strokeSettings.strokeColor = setting.strokeColor;\n            }\n            if (setting.fillColor) {\n                this.activeObj.strokeSettings.fillColor = setting.fillColor;\n            }\n            if (setting.strokeWidth) {\n                this.activeObj.strokeSettings.strokeWidth = setting.strokeWidth;\n            }\n            if (setting.index) {\n                this.activeObj.order = setting.index;\n            }\n            if (setting.type === 'FreehandDraw' && setting.strokeWidth) {\n                this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: setting.strokeWidth } });\n            }\n        }\n        else {\n            if (setting.type.toLowerCase() === 'text' && (this.textArea.style.display === 'block' ||\n                this.textArea.style.display === 'inline-block')) {\n                this.okBtn(null, true);\n                isTextArea = true;\n            }\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: setting.id, obj: obj } });\n            this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (obj['isSelected']) {\n                var tempFontSize = this.activeObj.textSettings.fontSize;\n                this.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: setting } });\n                if (this.activeObj.shape === 'text' && tempFontSize) {\n                    var diff = this.activeObj.textSettings.fontSize - tempFontSize;\n                    if (diff !== 0) {\n                        this.activeObj.activePoint.height += diff;\n                        this.activeObj.activePoint.startY -= (diff / 2);\n                        this.activeObj.activePoint.endY += (diff / 2);\n                        this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                                isMouseMove: null, x: null, y: null } });\n                    }\n                }\n                var activeObj = extend({}, this.activeObj, {}, true);\n                this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: null } });\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (activeObj.shape) {\n                    this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n                }\n                if (this.activeObj.shape === 'text') {\n                    this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n                }\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: true } });\n                }\n                this.okBtn(isSelected, true);\n                if (freehandObj['bool']) {\n                    this.notify('undo-redo', { prop: 'setPreventUR', value: { bool: false } });\n                }\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.editCompleteArgs = { action: 'shape-update', currentShapeSettings: setting };\n                this.editCompleted('shape-customize');\n                if (isTextArea) {\n                    this.enableTextEditing();\n                }\n                if (isSelected) {\n                    this.noRedact = true;\n                    this.selectShape(setting.id);\n                }\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Select a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/selectShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        this.editCompleted('shape-select');\n        this.noRedact = false;\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/deleteShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var shape = this.getShapeSetting(id);\n        if (shape.type === 'Redact') {\n            return;\n        }\n        this.applyShapes();\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n        this.editCompleted('shape-delete');\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * {% codeBlock src='image-editor/getShapeSetting/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     *\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        this.applyShapes();\n        var obj = { shapeDetails: null };\n        this.notify('shape', { prop: 'getShapeSetting', onPropertyChange: false,\n            value: { id: id, obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var shapeDetails = obj['shapeDetails'] ? obj['shapeDetails'] : {};\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        this.applyShapes();\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        return obj.shapeDetailsColl.filter(function (item) { return item.type !== 'redact'; });\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {RedactSettings[]}.\n     */\n    ImageEditor.prototype.getRedacts = function () {\n        this.applyShapes();\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getRedactSettings', onPropertyChange: false, value: { obj: obj } });\n        this.notify('draw', { prop: 'redrawDownScale' });\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        return obj.shapeDetailsColl.filter(function (item) { return item.type !== 'redact'; });\n    };\n    /**\n     * Select a redaction based on the given redaction id.\n     * Use 'getRedacts' method to get the shape id which is then passed to perform selection.\n     *\n     *\n     * @param {string} id - Specifies the shape id to select a redact on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectRedact = function (id) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        this.editCompleted('redact-select');\n        this.noRedact = false;\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a redaction based on the given shape id.\n     * Use 'getRedacts' method to get the redaaction id which is then passed to perform deletion.\n     *\n     *\n     * @param {string} id - Specifies the redaction id to delete the redaction on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteRedact = function (id) {\n        this.applyShapes();\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n        this.editCompleted('redact-delete');\n    };\n    /**\n     * This method is used to update the existing redacts by changing its height, width, blur, and pixel size in the component.\n     * Use 'getRedacts' method to get the redacts which is then passed to change the options of a redacts.\n     *\n     * @param {RedactSettings} setting - Specifies the redact settings to be updated for the shape on an image.\n     * @param {boolean} isSelected - Specifies to show the redacts in the selected state.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.updateRedact = function (setting, isSelected) {\n        this.applyShapes();\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: setting.id, obj: obj } });\n        if (obj['isSelected']) {\n            this.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                value: { shapeSettings: setting } });\n            if (setting.blurIntensity) {\n                this.activeObj.redactBlur = setting.blurIntensity;\n            }\n            if (setting.pixelSize) {\n                this.activeObj.redactPixelate = setting.pixelSize;\n            }\n            this.activeObj.redactType = setting.type.toLowerCase() === 'blur' ? 'blur' : 'pixelate';\n            var activeObj = extend({}, this.activeObj, {}, true);\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: null } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            if (activeObj.shape) {\n                this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n            }\n            this.okBtn(isSelected, true);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.editCompleteArgs = { action: 'redact-update', currentShapeSettings: setting };\n            this.editCompleted('redact-customize');\n            if (isSelected) {\n                this.selectRedact(setting.id);\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        this.notify('transform', { prop: 'update' });\n    };\n    /**\n     * Finetuning an image with the given type of finetune and its value in the image editor.\n     *\n     * @param {ImageFinetuneOption } finetuneOption - Specifies the finetune options to be performed in the image.\n     * @param {number } value - Specifies the value for finetuning the image.\n     *\n     * @remarks\n     * The finetuning will not affect the shapes background and border color.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.finetuneImage = function (finetuneOption, value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyShapes();\n            this.notify('filter', { prop: 'finetuneImage', value: { value: value, option: finetuneOption } });\n            this.editCompleteArgs = { finetune: finetuneOption, value: value };\n            this.editCompleted('fine-tune');\n        }\n    };\n    /**\n     * Filtering an image with the given type of filters.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @remarks\n     * The filtering will not affect the shape's background and border color.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.applyImageFilter = function (filterOption) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyShapes();\n            this.notify('filter', { prop: 'applyImageFilter', value: { option: filterOption.toString() } });\n            this.editCompleteArgs = { filter: filterOption };\n            this.editCompleted('filter');\n            this.canvasFilter = this.lowerContext.filter;\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    /**\n     * Reverse the last action which performed by the user in the Image Editor.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.undo = function () {\n        this.applyShapes();\n        this.notify('undo-redo', { prop: 'undo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Redo the last user action that was undone by the user or `undo` method.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.redo = function () {\n        this.applyShapes();\n        this.notify('undo-redo', { prop: 'redo', onPropertyChange: false });\n        this.notify('draw', { prop: 'redrawDownScale' });\n    };\n    /**\n     * Get the dimension of an image in the image editor such as x, y, width, and height.\n     * The method helps to get dimension after cropped an image.\n     *\n     * @returns {Dimension}.\n     * A Dimension object containing the x, y, width, and height of an image.\n     */\n    ImageEditor.prototype.getImageDimension = function () {\n        return { x: this.img.destLeft, y: this.img.destTop, width: this.img.destWidth, height: this.img.destHeight };\n    };\n    /**\n     * Resize an image by changing its width and height.\n     *\n     * @param {number} width - Specifies the width of an image.\n     * @param {number} height - Specifies the height of an image.\n     * @param {boolean} isAspectRatio - Specifies whether the scaling option is enabled or not.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the resizing operation.\n     */\n    ImageEditor.prototype.resize = function (width, height, isAspectRatio) {\n        var isResized = false;\n        if ((width.toString()).length <= 4 && (height.toString()).length <= 4) {\n            this.applyShapes();\n            var destPoints = { startX: this.img.destLeft, startY: this.img.destTop, width: this.img.destWidth,\n                height: this.img.destHeight };\n            if (isAspectRatio) {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'resize',\n                        isApplyBtn: false, isCropping: false } });\n            }\n            var aspectRatioWidth = this.element.querySelector('#' + this.element.id + '_resizeWidth');\n            var aspectRatioHeight = this.element.querySelector('#' + this.element.id + '_resizeHeight');\n            if (aspectRatioWidth && aspectRatioHeight) {\n                getComponent(aspectRatioWidth, 'numerictextbox').value = Math.floor(width);\n                aspectRatioWidth.value = Math.floor(width).toString() + ' px';\n                getComponent(aspectRatioHeight, 'numerictextbox').value = Math.floor(height);\n                aspectRatioHeight.value = Math.floor(height).toString() + ' px';\n            }\n            this.notify('transform', { prop: 'resize', value: { width: width, height: height, isAspectRatio: isAspectRatio } });\n            if (destPoints.startX !== this.img.destLeft || destPoints.startY !== this.img.destTop ||\n                destPoints.width !== this.img.destWidth || destPoints.height !== this.img.destHeight) {\n                isResized = true;\n                this.okBtn();\n            }\n            else {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isResized;\n    };\n    /**\n     * Draw a frame on an image.\n     *\n     * @param { FrameType} frameType - Specifies the frame option to be drawn on an image.\n     * @param {string} color - Specifies the color of a frame on an image. The default value is #fff.\n     * @param {string} gradientColor - Specifies the gradient color of a frame on an image. The default value is .\n     * @param {number} size - Specifies the size of the frame as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 20 if not specified.\n     * @param {number} inset - Specifies the inset value for line, hook, and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} offset - Specifies the offset value for line and inset type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {number} borderRadius - Specifies the border radius for line-type frames, as a percentage. It can be provided as an integer percentage (e.g., 10). Defaults to 0 if not specified.\n     * @param {FrameLineStyle} frameLineStyle - Specifies the type of line to be drawn for line-type frames. Default to Solid if not specified.\n     * @param {number} lineCount - Specifies the number of lines for line-type frames. Defaults to 0 if not specified.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawFrame = function (frameType, color, gradientColor, size, inset, offset, borderRadius, frameLineStyle, lineCount) {\n        this.applyShapes();\n        var isFrame = false;\n        var obj = { frameChangeEventArgs: null };\n        color = color ? color : '#fff';\n        gradientColor = gradientColor ? gradientColor : '';\n        size = size ? size : 20;\n        inset = inset ? inset : 0;\n        offset = offset ? offset : 0;\n        borderRadius = borderRadius ? borderRadius : 0;\n        frameLineStyle = frameLineStyle ? frameLineStyle : FrameLineStyle.Solid;\n        lineCount = lineCount ? lineCount : 0;\n        var prevFrameSettings = { type: this.toPascalCase(this.frameObj.type), color: this.frameObj.color,\n            gradientColor: this.frameObj.gradientColor, size: this.frameObj.size, inset: this.frameObj.inset,\n            offset: this.frameObj.offset, borderRadius: this.frameObj.radius,\n            frameLineStyle: this.toPascalCase(this.frameObj.border), lineCount: this.frameObj.amount };\n        extend(this.tempFrameObj, this.frameObj);\n        this.tempFrameZoomLevel = this.transform.zoomFactor;\n        this.frameDestPoints = extend({}, this.img, {}, true);\n        this.notify('toolbar', { prop: 'frameToolbarClick' });\n        this.frameObj.type = frameType.toLowerCase();\n        this.frameObj.color = color;\n        this.frameObj.gradientColor = gradientColor;\n        this.frameObj.size = size;\n        this.frameObj.inset = inset;\n        this.frameObj.offset = offset;\n        this.frameObj.radius = borderRadius;\n        this.frameObj.border = frameLineStyle.toLowerCase();\n        this.frameObj.amount = lineCount;\n        this.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n        if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                isFrame = true;\n                this.okBtn();\n            }\n            else {\n                this.tempFrameZoomLevel = null;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            extend(this.frameObj, this.tempFrameObj);\n            this.tempFrameZoomLevel = null;\n        }\n        this.notify('draw', { prop: 'redrawDownScale' });\n        return isFrame;\n    };\n    /**\n     * Straightens an image by rotating it clockwise or counterclockwise.\n     *\n     * @param {number} degree - The degree value specifying the amount of rotation for straightening the image.\n     * Positive values indicate clockwise rotation, while negative values indicate counterclockwise rotation.\n     *\n     * @remarks\n     * The degree value should be within the range of -45 to +45 degrees for accurate straightening.\n     *\n     * @returns {boolean} - A boolean value indicating the success of the straightening operation.\n     */\n    ImageEditor.prototype.straightenImage = function (degree) {\n        var isStraightened = false;\n        if (degree >= -45 && degree <= 45) {\n            this.applyShapes();\n            isStraightened = true;\n            this.notify('transform', { prop: 'straightenImage', value: { degree: degree } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isStraightened;\n    };\n    /**\n     * Duplicates a shape based on the given shape ID in the ImageEditor.\n     * Use 'getShapeSettings' method to get the shape and then pass a shapeId from the returned shape to clone a shape.\n     *\n     * @param {string} shapeId - Specifies the shape id to clone a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.cloneShape = function (shapeId) {\n        var obj = { isSelected: false };\n        if (shapeId.split('_')[0] === 'shape') {\n            this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: shapeId, obj: obj } });\n            if (obj['isSelected']) {\n                this.notify('toolbar', { prop: 'duplicateShape', onPropertyChange: false, value: { isPreventUndoRedo: false } });\n                this.okBtn(null, true);\n                this.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        return obj['isSelected'];\n    };\n    /**\n     * Update filter to the canvas in the ImageEditor.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @returns {string}.\n     *\n     */\n    ImageEditor.prototype.getImageFilter = function (filterOption) {\n        var canvas = this.createElement('canvas');\n        var ctx = canvas.getContext('2d');\n        this.notify('filter', { prop: 'updateAdj', value: { type: filterOption.toLowerCase(), value: null, isPreview: true, ctx: ctx } });\n        return ctx.filter;\n    };\n    /**\n     * Enable text area editing in the ImageEditor.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.enableTextEditing = function () {\n        var activeObj = extend({}, this.activeObj, {}, true);\n        if (!activeObj.order) {\n            this.noPushUndo = true;\n            this.okBtn();\n            this.noPushUndo = false;\n            this.noRedact = true;\n            this.selectShape(activeObj.currIndex);\n            activeObj.order = this.activeObj.order;\n        }\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: false } });\n        this.activeObj = activeObj;\n        this.notify('toolbar', { prop: 'editText', onPropertyChange: false });\n    };\n    /**\n     * Specifies if it's possible to undo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canUndo = function () {\n        var canUndo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoIndex = object['index'];\n        if (undoRedoIndex > 0) {\n            canUndo = true;\n        }\n        return canUndo;\n    };\n    /**\n     * Specifies if it's possible to redo the last recent action made in an Image Editor.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.canRedo = function () {\n        var canRedo = false;\n        var object = this.getUndoRedoColl();\n        var undoRedoColl = object['undoRedoColl'];\n        var undoRedoIndex = object['index'];\n        if (undoRedoColl && undoRedoColl.length > 0 && undoRedoIndex < undoRedoColl.length - 1) {\n            canRedo = true;\n        }\n        if (undoRedoIndex === undoRedoColl.length) {\n            canRedo = false;\n        }\n        else if (undoRedoIndex === 0 && undoRedoColl.length > 0) {\n            canRedo = true;\n        }\n        else if (undoRedoIndex > 0) {\n            canRedo = true;\n        }\n        return canRedo;\n    };\n    /**\n     * Applies the operations performed in the Image Editor, such as annotation drawings.\n     *\n     * @returns{void}\n     * @remarks\n     * This method applies the actions performed after enabling annotation drawings, ensuring that the drawn annotations are applied to the image.\n     */\n    ImageEditor.prototype.apply = function () {\n        if (this.isMaskImage) {\n            this.discard();\n        }\n        else {\n            this.updateColl('reset');\n            this.closeOverlayTbar();\n            this.okBtn(null, true);\n        }\n    };\n    /**\n     * Discards the operations performed in the Image Editor, such as annotation drawings.\n     *\n     * @returns{void}\n     * @remarks\n     * This method discards the actions performed after enabling annotation drawings, ensuring that the drawn annotations are not applied to the image.\n     */\n    ImageEditor.prototype.discard = function () {\n        this.updateColl('reset');\n        this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: this.closeOverlayTbar(), isFinalCancel: true } });\n    };\n    /**\n     * Enable or disable a shape drawing option in an Image Editor.\n     *\n     * @param {ShapeType} shapeType - Specifies the type of shape to be enabled or disabled for drawing.\n     * @param {boolean} isEnabled - Optional. Specifies a value to indicate whether to enable or disable shape drawing. The default value is true.\n     *\n     * @remarks This function allows the user to toggle the shape drawing feature in the Image Editor. When enabled, users can draw shapes on the image. When disabled, the shape drawing functionality is not available.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.enableShapeDrawing = function (shapeType, isEnabled) {\n        if (isEnabled) {\n            this.drawingShape = shapeType.toLowerCase();\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (shapeType && isEnabled) {\n            this.currObjType.shape = shapeType.toLowerCase();\n            this.activeObj.shape = this.currObjType.shape;\n            this.currObjType.isDragging = this.currObjType.isCustomCrop = false;\n            this.activeObj.shapeDegree = this.transform.degree;\n            this.activeObj.shapeFlip = this.transform.currFlipState;\n            this.activeObj.textFlip = this.transform.currFlipState;\n            this.activeObj.flipObjColl = [];\n            var orderObj = { order: null };\n            this.notify('shape', { prop: 'getNewOrder', onPropertyChange: false, value: { obj: orderObj } });\n            this.activeObj.order = orderObj['order'];\n            this.notify('selection', { prop: 'annotate', value: { shape: this.currObjType.shape } });\n            if (this.currObjType.shape === 'text') {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else if (this.currObjType.shape === 'redact') {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'redact',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            this.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else if (!isEnabled) {\n            this.okBtn(null, true);\n        }\n    };\n    /**\n     * Moves a shape to the front of all other shapes based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.bringToFront = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'bringToFront');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to ahead of one shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.bringForward = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'bringForward');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to behind all other shapes based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.sendToBack = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'sendToBack');\n            this.apply();\n        }\n    };\n    /**\n     * Moves a shape to behind one shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform moving.\n     *\n     * @param {string} shapeId - Specifies the shape id to move the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.sendBackward = function (shapeId) {\n        this.noRedact = true;\n        if (this.selectShape(shapeId)) {\n            this.updateShapeOrder(shapeId, 'sendBackward');\n            this.apply();\n        }\n    };\n    /**\n     * Clears the loaded image in the Image Editor.\n     *\n     * @returns{void}\n     * @remarks\n     * This method clears the loaded image and updates the component's user interface to its initial state (the initial user interface without a loaded image).\n     */\n    ImageEditor.prototype.clearImage = function () {\n        this.reset();\n        this.isImageLoaded = false;\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        var btoolbar = document.getElementById(this.element.id + '_bottomToolbar');\n        if (Browser.isDevice && btoolbar) {\n            document.getElementById(this.element.id + '_bottomToolbar').style.display = 'none';\n        }\n        this.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n        this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n        this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        var dropArea = document.getElementById(this.element.id + '_dropArea');\n        if (dropArea) {\n            dropArea.style.display = 'block';\n        }\n    };\n    // AI related codes\n    /**\n     * Enables overlay drawing to erase objects in an image editor. The eraser tool assists in selecting the mask image.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @param {number} strokeWidth - Specifies the stroke width of the drawing.\n     * @param {string} color - Specifies the color of the drawing.\n     * @hidden\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.selectMaskImage = function (strokeWidth, color) {\n        strokeWidth = strokeWidth ? strokeWidth : 10;\n        color = color ? color : '#512da880';\n        this.applyShapes();\n        this.isMaskImage = true;\n        this.updateColl('empty');\n        this.enableDisableToolbar(true);\n        this.update();\n        this.activeObj.strokeSettings.strokeWidth = strokeWidth;\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: strokeWidth } });\n        this.activeObj.strokeSettings.strokeColor = color;\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: true } });\n        this.maskCanvas.style.display = 'block';\n    };\n    ImageEditor.prototype.enableDisableToolbar = function (value) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var toolbar;\n        var elem = document.getElementById(this.element.id + '_toolbar');\n        if (elem) {\n            toolbar = getComponent(elem, 'toolbar');\n            if (toolbar) {\n                toolbar.disable(value);\n            }\n        }\n        elem = document.getElementById(this.element.id + '_bottomToolbar');\n        if (elem) {\n            toolbar = getComponent(elem, 'toolbar');\n            if (toolbar) {\n                toolbar.disable(value);\n            }\n        }\n    };\n    ImageEditor.prototype.updateImage = function (data, imageBackgroundColor) {\n        var _this = this;\n        if (data || imageBackgroundColor || imageBackgroundColor === '') {\n            var prevCropObj_1 = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj_1 = object['currObj'];\n            prevObj_1.objColl = extend([], this.objColl, [], true);\n            prevObj_1.pointColl = extend([], this.pointColl, [], true);\n            prevObj_1.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n            prevObj_1.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (data) {\n                this.isImageUpdated = true;\n                if (typeof (data) !== 'string') {\n                    var canvas = this.createElement('canvas');\n                    canvas.width = data.width;\n                    canvas.height = data.height;\n                    canvas.getContext('2d').putImageData(data, 0, 0);\n                    data = canvas.toDataURL();\n                }\n                this.baseImg.src = data;\n                setTimeout(function () {\n                    if (_this.cropObj.straighten !== 0) {\n                        _this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                        _this.noPushUndo = true;\n                        _this.crop();\n                        _this.noPushUndo = false;\n                    }\n                    else {\n                        _this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                    }\n                    _this.isImageUpdated = false;\n                    if (!imageBackgroundColor) {\n                        _this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'updateImage', previousObj: prevObj_1,\n                                previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl,\n                                previousSelPointColl: prevObj_1.selPointColl, previousCropObj: prevCropObj_1,\n                                previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                            } });\n                        _this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                    }\n                }, 100);\n            }\n            if (imageBackgroundColor || imageBackgroundColor === '') {\n                this.notify('draw', { prop: 'imageBackgroundColor', onPropertyChange: false, value: { color: imageBackgroundColor } });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n                if (!data) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'bgColor', previousObj: prevObj_1,\n                            previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl, previousSelPointColl: prevObj_1.selPointColl,\n                            previousCropObj: prevCropObj_1, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                        } });\n                    this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            if (data && imageBackgroundColor) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'updateImage', previousObj: prevObj_1,\n                        previousObjColl: prevObj_1.objColl, previousPointColl: prevObj_1.pointColl, previousSelPointColl: prevObj_1.selPointColl,\n                        previousCropObj: prevCropObj_1, previousText: null, currentText: null, previousFilter: null, isCircleCrop: null\n                    } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n    };\n    ImageEditor.prototype.editCompleted = function (type) {\n        this.notify('draw', { prop: 'redrawDownScale' });\n        var actionArgs = { action: type ? type : 'shape-insert',\n            actionEventArgs: this.editCompleteArgs };\n        this.triggerEditCompleteEvent(actionArgs);\n    };\n    ImageEditor.prototype.updateColl = function (type) {\n        if (!this.isMaskImage) {\n            return;\n        }\n        if (type === 'empty') {\n            this.tempToolbarHeight = this.toolbarHeight;\n            this.tempToolbar = this.toolbar ? extend([], this.toolbar, [], true) : null;\n            this.tempObjColl = extend([], this.objColl, [], true);\n            this.tempPointColl = extend([], this.pointColl, [], true);\n            this.tempShapeColl = extend([], this.shapeColl, [], true);\n            this.objColl = [];\n            this.pointColl = [];\n            this.shapeColl = [];\n            this.freehandCounter = 0;\n            this.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                value: { value: 0 } });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        }\n        else if (type === 'reset') {\n            this.objColl = this.tempObjColl;\n            this.pointColl = this.tempPointColl;\n            this.shapeColl = this.tempShapeColl;\n            this.freehandCounter = this.pointColl.length;\n            this.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex',\n                value: { value: this.freehandCounter } });\n            this.enableDisableToolbar(false);\n            if (this.cropObj.straighten !== 0) {\n                this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n                this.noPushUndo = true;\n                this.crop();\n                this.noPushUndo = false;\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.isMaskImage = false;\n            this.upperContext.globalCompositeOperation = 'source-over';\n            this.maskCanvas.style.display = 'none';\n            this.activeObj.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null,\n                radius: null, outlineColor: '', outlineWidth: null };\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: this.activeObj.strokeSettings,\n                    strokeColor: '#fff', fillColor: '', strokeWidth: null, outlineWidth: null } });\n            this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n            this.notify('freehand-draw', { prop: 'setMasking', onPropertyChange: false, value: { value: false } });\n        }\n    };\n    // Toolbar related codes\n    ImageEditor.prototype.resetToolbar = function () {\n        if (this.toolbarHeight !== this.tempToolbarHeight && !((isNullOrUndefined(this.toolbar) ||\n            (this.toolbar && this.toolbar.length > 0)\n            || !isNullOrUndefined(this.toolbarTemplate)))) {\n            this.toolbarHeight = this.tempToolbarHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this.toolbar = this.tempToolbar;\n            if (!this.toolbarTemplate) {\n                this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n                this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n            }\n            this.update();\n        }\n    };\n    ImageEditor.prototype.getData = function (isMaskImage) {\n        if (isMaskImage) {\n            this.resetToolbar();\n        }\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var shapeColl = extend([], this.shapeColl, null, true);\n        if (isMaskImage) {\n            this.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            for (var i = 0; i < this.freehandCounter; i++) {\n                this.pointColl[i].strokeColor = '#fff';\n            }\n        }\n        else {\n            this.objColl = [];\n            this.pointColl = [];\n            this.shapeColl = [];\n            this.freehandCounter = 0;\n        }\n        var frameType = this.frameObj.type;\n        this.frameObj.type = 'none';\n        var aspectWidth = this.aspectWidth;\n        var aspectHeight = this.aspectHeight;\n        this.aspectWidth = this.aspectHeight = null;\n        var straighten = this.cropObj.straighten;\n        this.togglePen = false;\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n        var tempDestPoints = extend({}, this.img, {}, true);\n        var tempCropObj = extend({}, this.cropObj, {}, true);\n        var tempSel = extend({}, this.activeObj, {}, true);\n        var tempTransform = extend({}, this.transform, {}, true);\n        var panPoint = extend({}, this.panPoint, {}, true);\n        if (straighten !== 0) {\n            this.setStraighten(0);\n        }\n        var point = this.activeObj.activePoint;\n        point.startX = this.img.destLeft;\n        point.startY = this.img.destTop;\n        point.width = this.img.destWidth;\n        point.height = this.img.destHeight;\n        point.endX = point.startX + point.width;\n        point.endY = point.startY + point.height;\n        this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: point, obj: this.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.noPushUndo = true;\n        this.crop();\n        this.noPushUndo = false;\n        this.isCropTab = false;\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.notify('crop', { prop: 'resetZoom', onPropertyChange: false });\n        this.isCropTab = true;\n        var afterCropActions = extend([], this.afterCropActions, [], true);\n        var coll = extend([], this.rotateFlipColl, [], true);\n        this.notify('crop', { prop: 'revertTransform', value: { type: 'initial', coll: coll } });\n        var imageData = this.getImageData();\n        if (isMaskImage) {\n            var canvas = this.createElement('canvas');\n            var ctx = canvas.getContext('2d');\n            canvas.width = imageData.width;\n            canvas.height = imageData.height;\n            ctx.fillRect(0, 0, canvas.width, canvas.height);\n            if (this.pointColl.length > 0) {\n                var obj = { width: 0, height: 0 };\n                this.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                    value: { obj: obj, dimension: { width: canvas.width, height: canvas.height } } });\n                var ratio = obj;\n                this.notify('export', { prop: 'drawAnnotation', value: { context: ctx, ratio: ratio } });\n            }\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n        }\n        this.notify('crop', { prop: 'revertTransform', value: { type: 'reverse', coll: coll } });\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.afterCropActions = afterCropActions;\n        if (!isMaskImage) {\n            this.objColl = objColl;\n            this.pointColl = pointColl;\n            this.shapeColl = shapeColl;\n            this.freehandCounter = this.pointColl.length;\n        }\n        this.frameObj.type = frameType;\n        this.aspectWidth = aspectWidth;\n        this.aspectHeight = aspectHeight;\n        this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: 'crop-' + 'custom' } });\n        if (straighten !== 0) {\n            this.setStraighten(straighten);\n        }\n        this.img = tempDestPoints;\n        this.cropObj = tempCropObj;\n        this.activeObj = tempSel;\n        this.transform = tempTransform;\n        this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: 0.1, zoomPoint: null, isResize: null } });\n        this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n            value: { zoomFactor: -0.1, zoomPoint: null, isResize: null } });\n        if (this.transform.degree !== 0) {\n            this.panPoint.currentPannedPoint = { x: panPoint.totalPannedClientPoint.x,\n                y: panPoint.totalPannedClientPoint.y };\n            this.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panPoint.totalPannedClientPoint.x,\n                    yDiff: panPoint.totalPannedClientPoint.y } });\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.notify('transform', { prop: 'setTempPanMove', value: { point: null } });\n        }\n        this.noPushUndo = true;\n        this.crop();\n        this.noPushUndo = false;\n        this.transform.straighten = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        return imageData;\n    };\n    ImageEditor.prototype.applyShapes = function () {\n        if (this.isUndoRedoStack) {\n            return;\n        }\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path', 'text', 'image'];\n        var dummyObj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: dummyObj } });\n        if (dummyObj['bool'] || this.togglePen || (this.activeObj.shape && shapes.indexOf(this.activeObj.shape) !== -1) ||\n            this.drawingShape) {\n            this.okBtn(null, true);\n        }\n    };\n    ImageEditor.prototype.closeOverlayTbar = function () {\n        var isContextualToolbar = false;\n        var frameObject = { bool: null };\n        this.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        if (!frameObject['bool'] && this.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!this.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = true;\n            }\n            var straightenObj = { bool: this.isStraightening };\n            if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n                this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        return isContextualToolbar;\n    };\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.toolbarHeight = toolbarArea.clientHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.quickAccessToolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_quickAccessToolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_quickAccessToolbarArea');\n        if (this.quickAccessToolbarTemplate) {\n            this.qatFn = this.templateParser(this.quickAccessToolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (typeof template !== 'function' && document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    // Common codes for EJ2 and Blazor\n    ImageEditor.prototype.getTextFromId = function (id) {\n        var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n            '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n        return idToValue[\"\" + id];\n    };\n    ImageEditor.prototype.getFinetuneOption = function (type) {\n        var typeToOption = { 'brightness': ImageFinetuneOption.Brightness, 'contrast': ImageFinetuneOption.Contrast,\n            'hue': ImageFinetuneOption.Hue, 'saturation': ImageFinetuneOption.Saturation, 'opacity': ImageFinetuneOption.Opacity,\n            'blur': ImageFinetuneOption.Blur, 'exposure': ImageFinetuneOption.Exposure };\n        return typeToOption[\"\" + type];\n    };\n    ImageEditor.prototype.setPenStroke = function (args) {\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: parseInt(args, 10) } });\n    };\n    ImageEditor.prototype.updateFreehandDrawColorChange = function () {\n        var obj = { tempFreeHandDrawEditingStyles: null };\n        this.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n        this.notify('freehand-draw', { prop: 'color-change', value: { color: obj['tempFreeHandDrawEditingStyles'].strokeColor } });\n    };\n    ImageEditor.prototype.getUndoRedoColl = function () {\n        var obj = { undoRedoColl: null, index: null };\n        var undoRedoObj = { undoRedoStep: null };\n        var object = { appliedUndoRedoColl: [] };\n        this.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        obj['undoRedoColl'] = object['appliedUndoRedoColl'];\n        obj['index'] = undoRedoObj['undoRedoStep'];\n        return obj;\n    };\n    ImageEditor.prototype.updateImageTransformColl = function (type) {\n        var value;\n        if (type === 'rotateleft') {\n            value = -90;\n        }\n        else if (type === 'rotateright') {\n            value = 90;\n        }\n        else if (type === 'horizontalflip') {\n            value = 'horizontal';\n        }\n        else if (type === 'verticalflip') {\n            value = 'vertical';\n        }\n        for (var i = 0; i < this.objColl.length; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape === 'image' || shape === 'text') {\n                if (isNullOrUndefined(this.objColl[i].rotateFlipColl)) {\n                    this.objColl[i].rotateFlipColl = [];\n                }\n                this.objColl[i].rotateFlipColl.push(value);\n                var obj = { collection: this.objColl[i].rotateFlipColl };\n                this.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: this.objColl[i].rotateFlipColl, isRotateFlipCollection: false, obj: obj } });\n                this.objColl[i].rotateFlipColl = obj['collection'];\n            }\n        }\n    };\n    ImageEditor.prototype.setInitialZoomState = function () {\n        this.objColl.push(this.activeObj);\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        var isUndoRedo = this.isUndoRedo;\n        this.isCropTab = false;\n        this.isUndoRedo = true;\n        if (this.transform.cropZoomFactor && this.transform.cropZoomFactor > 0) {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -this.transform.cropZoomFactor, zoomPoint: null, isResize: true } });\n        }\n        else {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: Math.abs(this.transform.cropZoomFactor), zoomPoint: null, isResize: true } });\n        }\n        this.isUndoRedo = isUndoRedo;\n        this.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.transform.cropZoomFactor = 0;\n        this.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.objColl.pop();\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n    };\n    /**\n     * Set the old item Transform item state.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateCropTransformItems = function () {\n        this.prevCurrSelectionPoint = extend({}, this.currSelectionPoint, {}, true);\n        this.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n    };\n    /**\n     * Get the pascal case.\n     *\n     * @param { string } str - Specifies the string to convert to pascal case.\n     * @param { Object } obj - Specifies the string to convert to pascal case.\n     * @hidden\n     * @returns {string}.\n     * A pascal case string.\n     */\n    ImageEditor.prototype.toPascalCase = function (str, obj) {\n        var strArr = [];\n        if (!isNullOrUndefined(str)) {\n            strArr = str.toLowerCase().split('-');\n        }\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        if (obj) {\n            obj['maxText'] = strArr.join('');\n        }\n        return strArr.join('');\n    };\n    /**\n     * Get the font sizes.\n     *\n     * @hidden\n     * @returns {DropDownButtonItemModel[]}.\n     * A font size collections.\n     */\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.transform.degree === 0 || this.transform.degree % 180 === 0) {\n            fontSize = this.img.destWidth / 25;\n        }\n        else {\n            fontSize = this.img.destHeight / 25;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    /**\n     * Updates drop area content dynamically.\n     *\n     * @param { HTMLElement } dropInfoElement - Specifies the drop area element.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateDropInfoContent = function (dropInfoElement) {\n        if (!dropInfoElement) {\n            return;\n        }\n        var supportObj = { key: 'SupportText' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: supportObj } });\n        var words = this.getExtensionString();\n        var fileSizeObj = { key: 'MinMaxSize' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n        var andObj = { key: 'And' };\n        this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: andObj } });\n        var size;\n        if (this.uploadSettings.minFileSize && this.uploadSettings.maxFileSize) {\n            size = ' ' + fileSizeObj['value'] + ' ' + this.formatSizeUnits(this.uploadSettings.minFileSize) + ' ' + andObj['value'] + ' ' + this.formatSizeUnits(this.uploadSettings.maxFileSize);\n        }\n        else if (this.uploadSettings.minFileSize) {\n            fileSizeObj['key'] = 'MinSize';\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n            size = ' ' + fileSizeObj['value'] + ' ' + this.formatSizeUnits(this.uploadSettings.minFileSize);\n        }\n        else if (this.uploadSettings.maxFileSize) {\n            fileSizeObj['key'] = 'MaxSize';\n            this.notify('toolbar', { prop: 'getLocaleText', onPropertyChange: false, value: { obj: fileSizeObj } });\n            size = ' ' + fileSizeObj['value'] + ' ' + this.formatSizeUnits(this.uploadSettings.maxFileSize);\n        }\n        if (size) {\n            dropInfoElement.textContent = supportObj['value'] + words + size;\n        }\n        else {\n            dropInfoElement.textContent = supportObj['value'] + words;\n        }\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { boolean } isMouseDown - Specifies whether it is a mouse down.\n     * @param { boolean } isFinalApply - Specifies whether it is a final apply.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.okBtn = function (isMouseDown, isFinalApply) {\n        if (isFinalApply) {\n            this.noPushUndo = false;\n            var tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [], order: null };\n            this.notify('selection', { prop: 'setTempActObj', onPropertyChange: false, value: { obj: tempActiveObj } });\n        }\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-frame-wrapper');\n        }\n        var isCropSelection = false;\n        var splitWords;\n        this.isResizeOkBtn = true;\n        var aspectIcon = this.element.querySelector('#' + this.element.id + '_aspectratio');\n        var nonAspectIcon = this.element.querySelector('#' + this.element.id + '_nonaspectratio');\n        var blrAspRatElem = this.element.querySelector('.e-ie-toolbar-aspect-ratio-btn');\n        var blrNAspRatElem = this.element.querySelector('.e-ie-toolbar-nonaspect-ratio-btn');\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        this.allowDownScale = true;\n        if ((this.activeObj.shape && this.activeObj.shape !== 'image' || this.togglePen) && !isCropSelection) {\n            var objt = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n            var shapeSettings = objt['shapeSettingsObj'];\n            if (this.togglePen) {\n                shapeSettings.type = ShapeType.FreehandDraw;\n            }\n            var shapeChangedArgs = { action: 'apply', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            if (!this.currObjType.isRedact && (isFinalApply || this.isShapeDrawing)) {\n                if (this.isShapeDrawing) {\n                    shapeChangedArgs.action = 'draw-end';\n                }\n                this.trigger('shapeChange', shapeChangedArgs);\n            }\n            this.editCompleteArgs = shapeChangedArgs;\n            if (this.currObjType.isRedact) {\n                this.currObjType.isRedact = false;\n            }\n        }\n        if (aspectIcon || nonAspectIcon) {\n            var obj_2 = { width: null, height: null };\n            this.notify('selection', { prop: 'getNumTextValue', onPropertyChange: false, value: { obj: obj_2 } });\n            var point = { x: obj_2['width'], y: obj_2['height'] };\n            var obj1 = { prevCropObj: this.prevCropObj };\n            var obj2 = { prevObj: this.prevObj };\n            if (point && point.x && point.y && obj1['prevCropObj'] && obj2['prevObj']) {\n                if (nonAspectIcon || (blrNAspRatElem && !blrNAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: point.y, isAspectRatio: false } });\n                }\n                else if (aspectIcon || (blrAspRatElem && !blrAspRatElem.classList.contains('e-hidden'))) {\n                    this.notify('transform', { prop: 'resize', value: { width: point.x, height: null, isAspectRatio: true } });\n                }\n                this.isResize = false;\n                this.aspectWidth = point.x;\n                this.aspectHeight = point.y;\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -this.transform.zoomFactor, zoomPoint: null, isResize: true } });\n                this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: obj2['prevObj']['defaultZoom'], zoomPoint: null, isResize: true } });\n                if (obj2['prevObj'].zoomFactor) {\n                    this.setProperties({ zoomSettings: { zoomFactor: obj2['prevObj'].zoomFactor } }, true);\n                }\n                this.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: this.zoomSettings.zoomFactor } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: { operation: 'resize',\n                        previousObj: obj2['prevObj'], previousObjColl: obj2['prevObj']['objColl'],\n                        previousPointColl: obj2['prevObj']['pointColl'], previousSelPointColl: obj2['prevObj']['selPointColl'],\n                        previousCropObj: obj1['prevCropObj'], previousText: null, currentText: null, previousFilter: null,\n                        isCircleCrop: null } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                var obj_3 = this.cancelCropSelection;\n                if ((obj_3 && (isNullOrUndefined(nonAspectIcon) || !nonAspectIcon))) {\n                    obj_3.previousObj.aspectWidth = obj_3.currentObj.aspectWidth = this.aspectWidth;\n                    obj_3.previousObj.aspectHeight = obj_3.currentObj.aspectHeight = this.aspectHeight;\n                    obj_3.previousCropObj = extend({}, this.cropObj, {}, true);\n                    obj_3.currentCropObj = extend({}, this.cropObj, {}, true);\n                    this.notify('draw', { prop: 'updateCropSelObj' });\n                }\n                this.cancelCropSelection = null;\n            }\n            else if (point && (point.x === 0 || point.y === 0)) {\n                this.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n            }\n            else {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n            }\n            this.isAspectRatio = false;\n        }\n        var selElem = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        var frameObject = { bool: null };\n        this.notify('toolbar', { prop: 'getFrameToolbar', onPropertyChange: false, value: { obj: frameObject } });\n        var sliderWrap = document.querySelector('#' + this.element.id + '_sliderWrapper');\n        if (selElem) {\n            this.currentFilter = selElem.children[0].children[0].id.replace('Canvas', '');\n        }\n        if (isCropSelection) {\n            if (this.transform.straighten !== 0 && (this.panPoint.totalPannedPoint.x !== 0 || this.panPoint.totalPannedPoint.y !== 0 ||\n                this.panPoint.totalPannedClientPoint.x !== 0 || this.panPoint.totalPannedClientPoint.y !== 0)) {\n                var temp = this.prevStraightenedDegree;\n                this.prevStraightenedDegree = this.transform.straighten;\n                this.setStraighten(this.transform.straighten - 3);\n                this.setStraighten(this.transform.straighten + 3);\n                this.prevStraightenedDegree = temp;\n            }\n            this.isCroppedEvent = this.crop();\n        }\n        else if (this.togglePen) {\n            this.freeHandDraw(false);\n            if (!this.isMaskImage) {\n                var widthObj = { penStrokeWidth: null };\n                this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n            }\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            if (isNullOrUndefined(isMouseDown)) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            this.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        }\n        else if ((sliderWrap || this.currObjType.isFiltered) && !this.drawingShape && this.activeObj.shape !== 'redact') {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n            var obj_4 = { value: null };\n            this.notify('draw', { prop: 'getTempAdjustmentValue', value: { obj: obj_4 } });\n            if (!sliderWrap || sliderWrap.parentElement.previousElementSibling.textContent !== 'Opacity') {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            if ((this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) ||\n                (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n                this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            }\n        }\n        else if (obj['bool']) {\n            this.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            this.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId', onPropertyChange: false });\n        }\n        else if ((this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) ||\n            (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n            if (this.activeObj.shape === 'image') {\n                this.notify('draw', { prop: 'setImageApply', onPropertyChange: false, value: { bool: true } });\n            }\n            this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        }\n        else {\n            if (JSON.stringify(this.frameObj) !== JSON.stringify(this.tempFrameObj)) {\n                var object = { currObj: {} };\n                this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                        operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                        previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                        previousCropObj: extend({}, this.cropObj, {}, true), previousText: null, currentText: null,\n                        previousFilter: null, isCircleCrop: null\n                    } });\n                this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                var currFrameSettings = { type: this.toPascalCase(this.frameObj.type),\n                    color: this.frameObj.color, gradientColor: this.frameObj.gradientColor, size: this.frameObj.size,\n                    inset: this.frameObj.inset, offset: this.frameObj.offset, borderRadius: this.frameObj.radius,\n                    frameLineStyle: this.toPascalCase(this.frameObj.border), lineCount: this.frameObj.amount };\n                var prevFrameSettings = { type: this.toPascalCase(this.tempFrameObj.type),\n                    color: this.tempFrameObj.color, gradientColor: this.tempFrameObj.gradientColor, size: this.tempFrameObj.size,\n                    inset: this.tempFrameObj.inset, offset: this.tempFrameObj.offset, borderRadius: this.tempFrameObj.radius,\n                    frameLineStyle: this.toPascalCase(this.tempFrameObj.border), lineCount: this.tempFrameObj.amount };\n                var frameChange = { cancel: false, previousFrameSetting: prevFrameSettings,\n                    currentFrameSetting: currFrameSettings };\n                this.editCompleteArgs = frameChange;\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                this.tempFrameObj = extend({}, this.frameObj, {}, true);\n            }\n            this.notify('draw', { prop: 'resetFrameZoom', onPropertyChange: false, value: { isOk: true } });\n        }\n        if (!obj['isCropToolbar']) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            this.currObjType.isRedact = false;\n        }\n        this.notify('draw', { prop: 'setNewPath', value: { bool: false } });\n        this.transform.zoomFactor = this.transform.defaultZoomFactor;\n        this.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        this.isResizeOkBtn = false;\n        this.notify('draw', { prop: 'redrawDownScale' });\n        this.isChangesSaved = this.isFinetuneBtnClick = false;\n        if (isFinalApply) {\n            this.drawingShape = null;\n            this.notify('draw', { prop: 'resetTempObjColl' });\n            this.notify('draw', { prop: 'resetTempPointColl' });\n        }\n    };\n    ImageEditor.prototype.triggerEditCompleteEvent = function (args) {\n        if (args.action === 'shape-insert' && args.actionEventArgs &&\n            args.actionEventArgs.currentShapeSettings &&\n            args.actionEventArgs.currentShapeSettings.type.toString() === 'Redact') {\n            args.action = 'redact';\n        }\n        this.trigger('editComplete', args);\n        this.editCompleteArgs = null;\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { string } id - Specifies shape id to return.\n     * @hidden\n     * @returns {SelectionPoint | Object}.\n     */\n    ImageEditor.prototype.getObjFromId = function (id) {\n        var obj;\n        if (this.activeObj.currIndex && this.activeObj.currIndex === id) {\n            obj = extend({}, this.activeObj, {}, true);\n        }\n        else {\n            for (var i = 0; i < this.shapeColl.length; i++) {\n                var shapeId = this.shapeColl[i].id ? this.shapeColl[i].id :\n                    this.shapeColl[i].currIndex;\n                if (shapeId === id) {\n                    obj = extend({}, this.shapeColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        return obj;\n    };\n    /**\n     * Set the temporary filter properties.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setTempFilterProperties = function () {\n        this.upperCanvas.style.display = 'block';\n        this.cropSelectedState();\n        var obj = { adjustmentLevel: null };\n        this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n            value: { obj: obj } });\n        this.lowerContext.filter = this.initialAdjustmentValue;\n        this.notify('draw', { prop: 'setTempAdjustmentValue', value: { tempAdjustmentValue: this.lowerContext.filter } });\n        this.notify('filter', { prop: 'setTempAdjustmentLevel', onPropertyChange: false,\n            value: { tempAdjustmentLevel: extend({}, obj['adjustmentLevel'], {}, true) } });\n        this.notify('draw', { prop: 'setTempFilter', value: { tempFilter: this.currentFilter } });\n        var undoRedoObj = { undoRedoStep: null };\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        this.notify('draw', { prop: 'setTempUndoRedoStep', value: { tempUndoRedoStep: undoRedoObj['undoRedoStep'] } });\n    };\n    /**\n     * To crop the selection.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.cropSelectedState = function () {\n        if (this.activeObj.shape && this.activeObj.shape.split('-')[0] === 'crop') {\n            this.okBtn();\n        }\n    };\n    /**\n     * Get the current canvas data.\n     *\n     * @hidden\n     * @returns {ImageData}.\n     * An ImageData returns the current canvas image data object.\n     */\n    ImageEditor.prototype.getCurrentCanvasData = function () {\n        var tempFrame = extend({}, this.frameObj, {}, true);\n        this.frameObj = { type: 'none', color: '#fff', size: 20, inset: 20, offset: 20, radius: 0, amount: 1, border: 'solid', gradientColor: '' };\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = this.canvasFilter = 'none';\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        var ctWrapper = this.element.querySelector('.e-contextual-toolbar-wrapper');\n        if (ctWrapper) {\n            ctWrapper.classList.add('e-hide');\n        }\n        var data = this.getImageData();\n        if (ctWrapper) {\n            ctWrapper.classList.remove('e-hide');\n        }\n        if (!Browser.isDevice) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: true, isCropping: false } });\n        }\n        this.element.querySelector('#' + this.element.id + '_contextualToolbarArea').classList.remove('e-hide');\n        this.objColl = objColl;\n        this.pointColl = pointColl;\n        this.freehandCounter = pointColl.length;\n        this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n            value: { ctx: this.lowerContext, shape: 'iterate', pen: 'iterate', isPreventApply: null } });\n        this.lowerContext.filter = this.canvasFilter = tempFilter;\n        this.frameObj = tempFrame;\n        return data;\n    };\n    /**\n     * To set current adjustment value\n     *\n     * @param { string } type - Specifies the type of adjustment.\n     * @param { number } value - Specifies the value to adjust.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setCurrAdjustmentValue = function (type, value) {\n        var finetuneValueChanging = { finetune: this.getFinetuneOption(type), value: value, cancel: false };\n        this.trigger('finetuneValueChanging', finetuneValueChanging);\n        this.editCompleteArgs = finetuneValueChanging;\n        if (finetuneValueChanging.cancel) {\n            return;\n        }\n        this.notify('filter', { prop: 'setCurrAdjValue', value: { type: type.toLowerCase(), value: value } });\n    };\n    /**\n     * Get the square point for path.\n     *\n     * @param { SelectionPoint } obj - Specifies the points of path.\n     * @hidden\n     * @returns {ActivePoint}.\n     * An ActivePoint object which returns the square point.\n     */\n    ImageEditor.prototype.getSquarePointForPath = function (obj) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        if (obj.pointColl.length > 0) {\n            point = { startX: obj.pointColl[0].x, startY: obj.pointColl[0].y, endX: obj.pointColl[0].x, endY: obj.pointColl[0].y };\n            for (var i = 1; i < obj.pointColl.length; i++) {\n                if (obj.pointColl[i].x < point.startX) {\n                    point.startX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y < point.startY) {\n                    point.startY = obj.pointColl[i].y;\n                }\n                if (obj.pointColl[i].x > point.endX) {\n                    point.endX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y > point.endY) {\n                    point.endY = obj.pointColl[i].y;\n                }\n            }\n            point.width = point.endX - point.startX;\n            point.height = point.endY - point.startY;\n        }\n        return point;\n    };\n    /**\n     * Get the SelectionType.\n     *\n     * @param { string } type - Specifies the SelectionType.\n     * @hidden\n     * @returns {string}.\n     * An string which returns the SelectionType.\n     */\n    ImageEditor.prototype.getSelectionType = function (type) {\n        type = type === 'crop-custom' ? 'CropCustom' : type;\n        var typeToSelectionType = { 'CropCustom': 'Custom', 'CropSquare': 'Square', 'CropCircle': 'Circle',\n            'Crop3:2': '3:2', 'Crop4:3': '4:3', 'Crop5:4': '5:4', 'Crop7:5': '7:5', 'Crop16:9': '16:9',\n            'Crop2:3': '2:3', 'Crop3:4': '3:4', 'Crop4:5': '4:5', 'Crop5:7': '5:7', 'Crop9:16': '9:16' };\n        return typeToSelectionType[\"\" + type] ? typeToSelectionType[\"\" + type] : type.split('Crop')[1];\n    };\n    /** Clears the context.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearContext = function (ctx) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.clearRect(0, 0, ctx.canvas.height, ctx.canvas.width);\n    };\n    /**\n     * Apply Arrow for start and end.\n     *\n     * @param { string } type - Specifies the start arrow or end arrow.\n     * @param { string } id - Specifies the start arrow or end arrow item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateArrow = function (type, id) {\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (type === 'startArrow') {\n            this.activeObj.start = this.getTextFromId(id);\n        }\n        else if (type === 'endArrow') {\n            this.activeObj.end = this.getTextFromId(id);\n        }\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        if (Browser.isDevice) {\n            if (document.getElementById(this.element.id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_1 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                toolbar_1.refreshOverflow();\n            }\n        }\n        else {\n            if (document.getElementById(this.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_2 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                toolbar_2.refreshOverflow();\n            }\n        }\n        var shapeChangedArgs = { action: type, currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font style for text.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontFamily = function (id) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var objColl = extend([], this.objColl, [], true);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            var width = this.activeObj.activePoint.width +\n                this.activeObj.textSettings.fontSize * 0.25;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.fontFamily = this.toPascalCase(id);\n            this.activeObj.textSettings.fontFamily = temp;\n            this.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                value: { isTextBox: null } });\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontFamily = this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: fontFamily, fontSize: null } });\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: objColl,\n                        previousPointColl: extend([], this.pointColl, [], true),\n                        previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-family', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontFamily = this.textArea.style.fontFamily;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font size for text.\n     *\n     * @param { string } text - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontSize = function (text) {\n        var itemText = text;\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.objColl.pop();\n            var textStyle = '';\n            if (this.textArea.style.fontWeight === 'bold') {\n                textStyle = 'bold ';\n            }\n            if (this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic ';\n            }\n            if (this.textArea.style.fontWeight === 'bold' && this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic bold ';\n            }\n            this.upperContext.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.textArea.style.fontFamily;\n            var rows = this.textArea.value.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: true, text: null, obj: obj } });\n            var text_1 = obj['maxText'];\n            var width = this.upperContext.measureText(text_1).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25) + 'px';\n            this.activeObj.textSettings.fontSize = temp;\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            this.textArea.style.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10) + 'px';\n            if (this.textArea.style.fontFamily === 'georgia') {\n                this.textArea.style.width = parseFloat(this.textArea.style.width) + parseFloat(this.textArea.style.fontSize) + 'px';\n            }\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontSize = this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: null, fontSize: fontSize } });\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            var rows = this.activeObj.keyHistory.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: null, text: null, obj: obj } });\n            var text_2 = obj['maxText'];\n            var width = this.upperContext.measureText(text_2).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = rows.length * (this.activeObj.textSettings.fontSize +\n                this.activeObj.textSettings.fontSize * 0.25);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n                    value: { width: width, height: height } });\n                this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                        isMouseMove: null, x: null, y: null } });\n                this.notify('shape', { prop: 'redraw-text' });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n        var shapeChangedArgs = { action: 'font-size', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fontSize = this.activeObj.textSettings.fontSize;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @param { string } color - Specifies the selected color type value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontColor = function (value, color) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'none') {\n            if (color === 'Text') {\n                this.activeObj.strokeSettings.strokeColor = value;\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                        strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            }\n            else {\n                this.activeObj.strokeSettings.fillColor = value;\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                        strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor, strokeWidth: null } });\n            }\n            if (!this.togglePen) {\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.objColl.push(this.activeObj);\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                }\n            }\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.textArea.style[color === 'Text' ? 'color' : 'backgroundColor'] = value;\n            var temp = color === 'Text' ? this.activeObj.strokeSettings.strokeColor : this.activeObj.strokeSettings.fillColor;\n            this.activeObj.strokeSettings[color === 'Text' ? 'strokeColor' : 'fillColor'] = value;\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings[color === 'Text' ? 'strokeColor' : 'fillColor'] = temp;\n        }\n        else if (!this.togglePen) {\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        var shapeChangedArgs = { action: 'font-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fillColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeTextColor = function (value) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        if (this.textArea.style.display === 'none') {\n            this.activeObj.strokeSettings.outlineColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                    strokeColor: null, fillColor: null, strokeWidth: null, outlineColor: this.activeObj.strokeSettings.outlineColor } });\n            if (!this.togglePen) {\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.objColl.push(this.activeObj);\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                }\n            }\n        }\n        else if (this.textArea.style.display === 'block' || this.textArea.style.display === 'inline-block') {\n            this.textArea.style.textShadow = \"-1px -1px 0 \" + value + \", 1px -1px 0 \" + value + \", -1px 1px 0 \" + value + \", 1px 1px 0 \" + value;\n            var temp = this.activeObj.strokeSettings.outlineColor;\n            this.activeObj.strokeSettings.outlineColor = value;\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings.outlineColor = temp;\n        }\n        else if (!this.togglePen) {\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        var shapeChangedArgs = { action: 'font-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.fillColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Pen stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeWidth = function (id) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.setPenStroke(id);\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var obj_5 = { penStrokeWidth: null };\n            this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_5 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            var indexObj = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            this.pointColl[indexObj['freehandSelectedIndex']].strokeWidth = obj_5['penStrokeWidth'];\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_5['penStrokeWidth'] } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Pen stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeColor = function (value) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.activeObj.strokeSettings.strokeColor = value;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n            this.notify('draw', { prop: 'redrawDownScale' });\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: null } });\n        }\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var indexObj_1 = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj_1 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.pointColl[indexObj_1['freehandSelectedIndex']].strokeColor = value;\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: value } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        else if (!this.togglePen) {\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.activeObj } });\n        }\n        shapeSettings.type = ShapeType.FreehandDraw;\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Shape stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @param { string } type - Specifies the type of selected item.\n     * @param { string } shapeType - Specifies the shape type of selected item.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeWidth = function (id, type, shapeType) {\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            var obj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var isObjPushed = false;\n            var collLength = this.objColl.length;\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            if (collLength !== this.objColl.length) {\n                isObjPushed = true;\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (isObjPushed) {\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = parseInt(id, 10);\n            if (this.activeObj.shape === 'rectangle' || this.activeObj.shape === 'ellipse') {\n                this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = parseInt(id, 10) - 1;\n            }\n            this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] *= 2;\n            if (type === 'width') {\n                if (shapeType === 'text') {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: null, radius: null, outlineWidth: this.activeObj.strokeSettings.outlineWidth } });\n                }\n                else {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: this.activeObj.strokeSettings.strokeWidth, radius: null, outlineWidth: null } });\n                }\n            }\n            else {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: null, radius: this.activeObj.strokeSettings.radius } });\n            }\n            this.objColl.push(this.activeObj);\n            if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n            }\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            var shapeChangedArgs = { action: 'stroke-width', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            shapeChangedArgs.currentShapeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'] = this.activeObj.strokeSettings[type === 'width' ? (shapeType === 'text' ? 'outlineWidth' : 'strokeWidth') : 'radius'];\n            this.trigger('shapeChange', shapeChangedArgs);\n            this.editCompleteArgs = shapeChangedArgs;\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10);\n            this.activeObj.strokeSettings.strokeWidth *= 2;\n            if (type === 'width') {\n                if (shapeType === 'text') {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: null, radius: null, outlineWidth: this.activeObj.strokeSettings.outlineWidth } });\n                }\n                else {\n                    this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                            strokeWidth: this.activeObj.strokeSettings.strokeWidth, radius: null, outlineWidth: null } });\n                }\n            }\n            else {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: null, radius: this.activeObj.strokeSettings.radius } });\n            }\n        }\n    };\n    /**\n     * Apply Shape stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeColor = function (value) {\n        var objt = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: objt } });\n        var shapeSettings = objt['shapeSettingsObj'];\n        if (this.activeObj.shape && (this.activeObj.shape !== 'path' || (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length > 0))) {\n            var isObjPushed = false;\n            var collLength = this.objColl.length;\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            if (collLength !== this.objColl.length) {\n                isObjPushed = true;\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (isObjPushed) {\n                this.objColl.pop();\n            }\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            if (!this.togglePen) {\n                this.objColl.push(this.activeObj);\n                if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n                    this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                }\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n        }\n        var shapeChangedArgs = { action: 'stroke-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        shapeChangedArgs.currentShapeSettings.strokeColor = value;\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply Shape fill color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFillColor = function (value) {\n        var obj = { shapeSettingsObj: {} };\n        this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var shapeSettings = obj['shapeSettingsObj'];\n        var isObjPushed = false;\n        var collLength = this.objColl.length;\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        if (collLength !== this.objColl.length) {\n            isObjPushed = true;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (isObjPushed) {\n            this.objColl.pop();\n        }\n        this.activeObj.strokeSettings.fillColor = value;\n        this.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: null, strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor,\n                strokeWidth: null } });\n        this.objColl.push(this.activeObj);\n        if (this.activeObj.activePoint.width !== 0 || this.activeObj.activePoint.height !== 0) {\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        var shapeChangedArgs = { action: 'fill-color', currentShapeSettings: extend({}, shapeSettings, {}, true) };\n        this.trigger('shapeChange', shapeChangedArgs);\n        this.editCompleteArgs = shapeChangedArgs;\n    };\n    /**\n     * Apply horizontal flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.horizontalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageHFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply vertical flip.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context 2D.\n     * @param { boolean } isPreventURC - Specifies to update undo redo collection.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.verticalFlip = function (ctx, isPreventURC) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(isPreventURC)) {\n            if (isNullOrUndefined(this.activeObj.imageRatio)) {\n                this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            }\n            this.notify('shape', { prop: 'pushActItemIntoObj' });\n            prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.objColl.pop();\n        }\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        ctx.clearRect(0, 0, this.activeObj.imageCanvas.width, this.activeObj.imageCanvas.height);\n        var activePoint = this.duplicateImage();\n        this.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n            value: { ctx: this.activeObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n        this.activeObj.activePoint = activePoint;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        if (isNullOrUndefined(isPreventURC)) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'imageVFlip', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply rotate image.\n     *\n     * @param { string } rotate - Specifies the direction of rotation.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.rotateImage = function (rotate) {\n        var prevCropObj;\n        var prevObj;\n        if (isNullOrUndefined(this.activeObj.imageRatio)) {\n            this.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        }\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        // eslint-disable-next-line prefer-const\n        prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        // eslint-disable-next-line prefer-const\n        prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.notify('toolbar', { prop: 'refreshSlider' });\n        if (rotate === 'rotleft') {\n            this.activeObj.rotatedAngle -= (90 * (Math.PI / 180));\n        }\n        else {\n            this.activeObj.rotatedAngle += (90 * (Math.PI / 180));\n        }\n        this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.activeObj } });\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'imageRotate', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n        this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n    };\n    /**\n     * Get pascalToSplitWords from string.\n     *\n     * @param { string } str - Specifies the word.\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.pascalToSplitWords = function (str) {\n        str = str.charAt(0).toUpperCase() + str.slice(1);\n        var splitStr = str.match(/[A-Z][a-z]+/g);\n        if (isNullOrUndefined(splitStr)) {\n            return str;\n        }\n        else {\n            return splitStr.map(function (word) { return word.charAt(0).toUpperCase() + word.slice(1); }).join(' ');\n        }\n    };\n    /**\n     * Get Slider Value.\n     *\n     * @param { string } type - Finetune type.\n     * @hidden\n     * @returns {number}.\n     */\n    ImageEditor.prototype.getCurrAdjustmentValue = function (type) {\n        var value = 100;\n        var indexObj = { freehandSelectedIndex: null };\n        this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (type === 'transparency' && this.togglePen) {\n            var obj = { penOpacity: 1 };\n            this.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n            value = obj['penOpacity'] * 100;\n        }\n        else if (type === 'transparency' && indexObj['freehandSelectedIndex'] !== null && indexObj['freehandSelectedIndex'] !== undefined) {\n            value = this.pointColl[indexObj['freehandSelectedIndex']].opacity * 100;\n        }\n        else {\n            var obj = { adjustmentLevel: null };\n            this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n                value: { obj: obj } });\n            var typeToAdjustmentLevel = { 'brightness': obj['adjustmentLevel'].brightness,\n                'contrast': obj['adjustmentLevel'].contrast, 'hue': obj['adjustmentLevel'].hue,\n                'saturation': obj['adjustmentLevel'].saturation, 'opacity': obj['adjustmentLevel'].opacity,\n                'blur': obj['adjustmentLevel'].blur, 'exposure': obj['adjustmentLevel'].exposure,\n                'transparency': obj['adjustmentLevel'].transparency, 'straighten': this.transform.straighten };\n            value = typeToAdjustmentLevel[\"\" + type];\n        }\n        return value;\n    };\n    /**\n     * Apply transformSelect.\n     *\n     * @param { string } type - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.transformSelect = function (type) {\n        if (this.transform.straighten === 0 && (type === 'rotateleft' || type === 'rotateright') &&\n            this.activeObj.shape && (['crop-2:3', 'crop-3:2', 'crop-3:4', 'crop-4:3', 'crop-4:5', 'crop-5:4', 'crop-5:7', 'crop-7:5',\n            'crop-9:16', 'crop-16:9'].indexOf(this.activeObj.shape) !== -1 || (this.activeObj.shape.indexOf('crop-') !== -1 &&\n            this.activeObj.shape !== 'crop-custom' && this.activeObj.shape !== 'crop-square' && this.activeObj.shape !== 'crop-circle'))) {\n            this.activeObj.shape = 'crop-' + this.activeObj.shape.split('-')[1].split(':')[1] + ':' + this.activeObj.shape.split('-')[1].split(':')[0];\n            this.notify('toolbar', { prop: 'performCropTransformClick', value: { shape: this.activeObj.shape, isTransform: true } });\n        }\n        this.isCropToolbar = true;\n        this.allowDownScale = false;\n        var straighten = this.transform.straighten;\n        var straightenObj = extend({}, this.activeObj, {}, true);\n        var zoomFactor = this.transform.zoomFactor;\n        this.prevEventSelectionPoint = extend({}, this.activeObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevEventObjPoint = object['currObj'];\n        this.prevEventObjPoint.objColl = extend([], this.objColl, [], true);\n        this.prevEventObjPoint.pointColl = extend([], this.pointColl, [], true);\n        this.prevEventObjPoint.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevEventObjPoint.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (this.transform.straighten !== 0) {\n            this.transform.straighten = 0;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle -= (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n        }\n        this.setInitialZoomState();\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: true } });\n        this.cropSelectedState();\n        this.notify('crop', { prop: 'setTransformCrop', onPropertyChange: false, value: { bool: false } });\n        this.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n        this.updateImageTransformColl(type);\n        this.notify('transform', { prop: 'performTransformation', value: { text: type } });\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'moveToSelectionRange', value: { type: type, activeObj: activeObj } });\n        if (this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) {\n            this.notify('draw', { prop: 'resetStraightenDestPoints' });\n            this.notify('draw', { prop: 'setDestForStraighten' });\n        }\n        if (straighten !== 0) {\n            this.transform.straighten = straighten;\n            this.straightenBaseImageCanvas();\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                var shape = this.objColl[i].shape;\n                if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                    this.objColl[i].rotatedAngle += (straighten * (Math.PI / 180));\n                    this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n                }\n            }\n            this.notify('shape', { prop: 'drawAnnotations', onPropertyChange: false,\n                value: { ctx: this.lowerContext, shape: 'zoom', pen: 'zoom', isPreventApply: null } });\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: straightenObj } });\n            this.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n            this.notify('draw', { prop: 'setStraightenInitZoom', value: { zoomFactor: zoomFactor } });\n            if ((this.isStraightening && (type === 'horizontalflip' || type === 'verticalflip')) &&\n                isNullOrUndefined(this.transform.zoomFactor) || this.transform.zoomFactor === 0) {\n                if (this.transform.degree === 0) {\n                    this.transform.zoomFactor += 0.025;\n                }\n                else if (this.transform.zoomFactor === 0) {\n                    this.transform.zoomFactor = null;\n                }\n            }\n            this.notify('draw', { prop: 'zoomToSel', value: { activeObj: straightenObj, isToolbar: false } });\n        }\n        this.isCropToolbar = false;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = this.transform.straighten.toString() + '&#176';\n        }\n    };\n    /**\n     * Returns default filter.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.getDefaultFilter = function () {\n        return 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' +\n            'grayscale(0%) ' + 'invert(0%)';\n    };\n    /**\n     * Performs Straightening action.\n     *\n     * @param { number } value - Specifies the degree of straightening.\n     * @hidden\n     * @returns {void} .\n     */\n    ImageEditor.prototype.setStraighten = function (value) {\n        var straightenEventArgs = { cancel: false, previousDegree: this.transform.straighten, currentDegree: value };\n        this.trigger('rotating', straightenEventArgs);\n        this.editCompleteArgs = straightenEventArgs;\n        if (!straightenEventArgs.cancel) {\n            this.performStraighten(straightenEventArgs);\n            var actionArgs = { action: 'straighten', actionEventArgs: this.editCompleteArgs };\n            this.triggerEditCompleteEvent(actionArgs);\n        }\n    };\n    ImageEditor.prototype.duplicateImage = function () {\n        var activePoint = extend({}, this.activeObj.activePoint, {}, true);\n        var dimObj = { width: 0, height: 0 };\n        this.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: this.activeObj.imageElement.width, height: this.activeObj.imageElement.height, obj: dimObj, isImgShape: null } });\n        this.activeObj.activePoint.width = dimObj['width'];\n        this.activeObj.activePoint.height = dimObj['height'];\n        return activePoint;\n    };\n    ImageEditor.prototype.performStraighten = function (straightenEventArgs) {\n        var value = straightenEventArgs.currentDegree;\n        var stValPan = this.element.querySelector('.e-ie-straighten-value-span');\n        if (stValPan) {\n            stValPan.innerHTML = value.toString() + '&#176';\n        }\n        var obj = extend({}, this.activeObj, null, true);\n        this.notify('freehand-draw', { prop: 'setCenterSelPoints' });\n        this.transform.straighten = value;\n        this.straightenPoint = { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n            y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2) };\n        this.straightenBaseImageCanvas();\n        for (var i = 0, len = this.objColl.length; i < len; i++) {\n            var shape = this.objColl[i].shape;\n            if (shape !== 'line' && shape !== 'arrow' && shape !== 'path') {\n                this.objColl[i].rotatedAngle += ((this.transform.straighten - this.prevStraightenedDegree) * (Math.PI / 180));\n                this.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: this.objColl[i] } });\n            }\n        }\n        if (this.transform.degree % 90 === 0 && this.transform.degree % 180 !== 0) {\n            if (this.transform.straighten === 0) {\n                this.transform.straighten = 360;\n            }\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomIn', isResize: true } });\n            this.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                value: { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2), type: 'zoomOut', isResize: true } });\n            if (this.transform.straighten === 360) {\n                this.transform.straighten = 0;\n            }\n        }\n        else {\n            this.notify('draw', { prop: 'render-image', value: { isMouseWheel: true, isPreventClearRect: null, isFrame: null, isStraighten: true } });\n        }\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false,\n            value: { canvas: 'duplicate', obj: obj } });\n        this.notify('draw', { prop: 'zoomToSel', value: { activeObj: obj, isToolbar: true } });\n        this.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        this.prevStraightenedDegree = this.transform.straighten;\n    };\n    /**\n     * Straightens base image.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.straightenBaseImageCanvas = function () {\n        if (this.isImageLoaded) {\n            var flipState = this.getStraightenFlipState();\n            var straighten = flipState === 'horizontal' || flipState === 'vertical' ?\n                -this.transform.straighten : this.transform.straighten;\n            var ctx = this.baseImgCanvas.getContext('2d');\n            if (ctx.canvas.width !== this.lowerContext.canvas.width &&\n                ctx.canvas.height !== this.lowerContext.canvas.height) {\n                var obj_6 = { width: 0, height: 0 };\n                this.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                    value: { obj: obj_6, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n            }\n            var dimension = void 0;\n            // eslint-disable-next-line prefer-const\n            dimension = this.getRotatedCanvasDim(this.baseImg.width, this.baseImg.height, this.transform.straighten);\n            this.img.srcWidth = ctx.canvas.width = dimension.width;\n            this.img.srcHeight = ctx.canvas.height = dimension.height;\n            var x = ctx.canvas.width / 2;\n            var y = ctx.canvas.height / 2;\n            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n            ctx.translate(x, y);\n            ctx.rotate(straighten * Math.PI / 180);\n            ctx.drawImage(this.baseImg, -this.baseImg.width / 2, -this.baseImg.height / 2, this.baseImg.width, this.baseImg.height);\n            ctx.setTransform(1, 0, 0, 1, 0, 0);\n            var obj = { width: 0, height: 0 };\n            this.notify('crop', { prop: 'calcRatio', onPropertyChange: false, value: { obj: obj, dimension: { width: ctx.canvas.width, height: ctx.canvas.height } } });\n        }\n    };\n    /**\n     * Returns rotated canvas dimension.\n     *\n     * @param { number } width - Specifies the width of the canvas.\n     * @param { number } height - Specifies the height of the canvas.\n     * @param { number } angle - Specifies the angle of rotation in degrees.\n     * @hidden\n     * @returns {void} .\n     */\n    ImageEditor.prototype.getRotatedCanvasDim = function (width, height, angle) {\n        var angleRad = angle * Math.PI / 180;\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var minX = Math.min(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var maxX = Math.max(0, width * cosAngle, height * Math.cos(Math.PI / 2 - angleRad), width * cosAngle + height * Math.cos(Math.PI / 2 - angleRad));\n        var minY = Math.min(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        var maxY = Math.max(0, width * sinAngle, height * Math.sin(Math.PI / 2 - angleRad), width * sinAngle + height * Math.sin(Math.PI / 2 - angleRad));\n        return { width: Math.ceil(maxX - minX), height: Math.ceil(maxY - minY) };\n    };\n    /**\n     * Apply Shape order.\n     *\n     * @param { string } id - Specifies the id of the shape to change the order.\n     * @param { string } value - Specifies the order of the shapes.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateShapeOrder = function (id, value) {\n        var shapeObj = this.getObjFromId(id);\n        if ((shapeObj.shape && (shapeObj.shape !== 'path' ||\n            (shapeObj.shape === 'path' && shapeObj.pointColl.length > 0))) ||\n            (shapeObj && shapeObj['id'] && shapeObj['id'].indexOf('pen') > -1)) {\n            var obj = { shapeSettingsObj: {} };\n            this.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            if (shapeObj.shape) {\n                this.notify('shape', { prop: 'pushActItemIntoObj' });\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var object = { currObj: {} };\n            this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (shapeObj.shape) {\n                this.objColl.pop();\n            }\n            this.notify('shape', { prop: 'z-order', onPropertyChange: false, value: { obj: shapeObj, value: value } });\n            if (shapeObj.shape) {\n                this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                        strokeWidth: shapeObj.strokeSettings.strokeWidth } });\n                this.objColl.push(shapeObj);\n            }\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            if (shapeObj.shape) {\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n                this.activeObj.order = shapeObj.order;\n            }\n            var shapeChangedArgs = { action: 'stroke-width', previousShapeSettings: extend({}, shapeSettings, {}, true),\n                currentShapeSettings: extend({}, shapeSettings, {}, true) };\n            shapeChangedArgs.currentShapeSettings.strokeWidth = this.activeObj.strokeSettings.strokeWidth;\n        }\n        else if (this.activeObj.shape && (this.activeObj.shape === 'path' &&\n            this.activeObj.pointColl.length === 0)) {\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                    strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        }\n    };\n    ImageEditor.prototype.getStraightenFlipState = function () {\n        var flipState = '';\n        if (this.rotateFlipColl.length > 0) {\n            for (var i = 0, len = this.rotateFlipColl.length; i < len; i++) {\n                var curFlip = this.rotateFlipColl[i];\n                if (curFlip === 'horizontal') {\n                    flipState += 'horizontal';\n                }\n                else if (curFlip === 'vertical') {\n                    flipState += 'vertical';\n                }\n                if (flipState === 'horizontalvertical' || flipState === 'verticalhorizontal') {\n                    flipState = '';\n                }\n            }\n        }\n        return flipState;\n    };\n    ImageEditor.prototype.initializeZoomSettings = function () {\n        this.theme = isNullOrUndefined(this.theme) ? 'Bootstrap5' : this.theme;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (isNullOrUndefined(this.zoomSettings.zoomTrigger) || this.zoomSettings.zoomTrigger === 0) {\n            this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar | ZoomTrigger.Commands);\n        }\n        if (isNullOrUndefined(this.selectionSettings.strokeColor)) {\n            this.selectionSettings.strokeColor = this.themeColl[this.theme]['primaryColor'];\n        }\n        if (isNullOrUndefined(this.selectionSettings.fillColor)) {\n            this.selectionSettings.fillColor = this.themeColl[this.theme]['secondaryColor'];\n        }\n    };\n    ImageEditor.prototype.initializeThemeColl = function () {\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' },\n            Material3: { primaryColor: '#6750a4', secondaryColor: '#fff' },\n            Material3Dark: { primaryColor: '#d0bcff', secondaryColor: '#fff' },\n            Fluent2: { primaryColor: '#0f6cbd', secondaryColor: '#fff' },\n            Fluent2Dark: { primaryColor: '#115ea3', secondaryColor: '#fff' },\n            Fluent2Highcontrast: { primaryColor: '#1aebff', secondaryColor: '#fff' },\n            'Bootstrap5.3': { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            'Bootstrap5.3Dark': { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind3: { primaryColor: '#4f46e5', secondaryColor: '#ffffff' },\n            Tailwind3Dark: { primaryColor: '#6366f1', secondaryColor: '#ffffff03' }\n        };\n    };\n    /**\n     * Draw a redaction on an image.\n     *\n     * @param {RedactType} type  Optional. Specifies the type of redaction to be drawn on the image such as blur or pixelate. If not specified, the redaction drawing is initiated with the default blur value.\n     * @param {number} x  Optional. Specifies x-coordinate of redaction. If not specified, the redaction drawing is initiated with the first parameter.\n     * @param {number} y  Optional. Specifies y-coordinate of redaction. If not specified it draws redaction from the center point of the image.\n     * @param {number} width  Optional. Specifies the width of the redaction. The default value is 100.\n     * @param {number} height  Optional. Specifies the height of the redaction. The default value is 50.\n     * @param {number} value  Optional. Specifies the blur value for blur-type redaction or the pixel size for pixelate-type redaction. Defaults to 20 since the default redaction is blur.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRedact = function (type, x, y, width, height, value) {\n        var isRedact = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRedact = true;\n            this.notify('shape', {\n                prop: 'drawRedact', onPropertyChange: false, value: {\n                    x: x, y: y, width: width, height: height, type: type, value: value\n                }\n            });\n            this.notify('draw', { prop: 'redrawDownScale' });\n        }\n        return isRedact;\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"showQuickAccessToolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"quickAccessToolbarTemplate\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Complex({}, FinetuneSettings)\n    ], ImageEditor.prototype, \"finetuneSettings\", void 0);\n    __decorate([\n        Complex({}, ZoomSettings)\n    ], ImageEditor.prototype, \"zoomSettings\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], ImageEditor.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Complex({}, FontFamily)\n    ], ImageEditor.prototype, \"fontFamily\", void 0);\n    __decorate([\n        Complex({}, UploadSettings)\n    ], ImageEditor.prototype, \"uploadSettings\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"selectionChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"imageFiltering\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"finetuneValueChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"click\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChange\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarOpen\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"resizing\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarItemClick\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"frameChange\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"editComplete\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(Component));\nexport { ImageEditor };\n","/**\n * An enum representing the file types supported by the image editor.\n *\n * @enum {string}\n */\nexport var FileType;\n(function (FileType) {\n    /** The PNG file type. */\n    FileType[\"Png\"] = \"Png\";\n    /** The JPEG file type. */\n    FileType[\"Jpeg\"] = \"Jpeg\";\n    /** The SVG file type. */\n    FileType[\"Svg\"] = \"Svg\";\n    /** The WebP file type. */\n    FileType[\"WebP\"] = \"WebP\";\n})(FileType || (FileType = {}));\n/**\n * An enumeration representing the direction of an image editor operation.\n *\n * @enum {string}\n */\nexport var Direction;\n(function (Direction) {\n    /** The horizontal direction. */\n    Direction[\"Horizontal\"] = \"Horizontal\";\n    /** The vertical direction. */\n    Direction[\"Vertical\"] = \"Vertical\";\n})(Direction || (Direction = {}));\n/**\n * An enumeration representing the type of shape to be added in the image editor.\n *\n * @enum {string}\n */\nexport var ShapeType;\n(function (ShapeType) {\n    /** A rectangle shape. */\n    ShapeType[\"Rectangle\"] = \"Rectangle\";\n    /** An ellipse shape. */\n    ShapeType[\"Ellipse\"] = \"Ellipse\";\n    /** A line shape. */\n    ShapeType[\"Line\"] = \"Line\";\n    /** An arrow shape. */\n    ShapeType[\"Arrow\"] = \"Arrow\";\n    /** A path shape. */\n    ShapeType[\"Path\"] = \"Path\";\n    /** A text shape. */\n    ShapeType[\"Text\"] = \"Text\";\n    /** A freehand drawing shape. */\n    ShapeType[\"FreehandDraw\"] = \"FreehandDraw\";\n    /** An Image shape. */\n    ShapeType[\"Image\"] = \"Image\";\n})(ShapeType || (ShapeType = {}));\n/**\n * An enumeration representing the different ways to trigger zooming in the image editor.\n *\n * @aspNumberEnum\n */\nexport var ZoomTrigger;\n(function (ZoomTrigger) {\n    /** Zooming triggered by mouse wheel. */\n    ZoomTrigger[ZoomTrigger[\"MouseWheel\"] = 1] = \"MouseWheel\";\n    /** Zooming triggered by pinch gesture. */\n    ZoomTrigger[ZoomTrigger[\"Pinch\"] = 2] = \"Pinch\";\n    /** Zooming triggered by command keys. */\n    ZoomTrigger[ZoomTrigger[\"Commands\"] = 4] = \"Commands\";\n    /** Zooming triggered by toolbar button click. */\n    ZoomTrigger[ZoomTrigger[\"Toolbar\"] = 8] = \"Toolbar\";\n})(ZoomTrigger || (ZoomTrigger = {}));\n/**\n * * An enum representing the available themes in the image editor.\n */\nexport var Theme;\n(function (Theme) {\n    /** The Bootstrap 5 theme. */\n    Theme[\"Bootstrap5\"] = \"Bootstrap5\";\n    /** The dark variant of the Bootstrap 5 theme. */\n    Theme[\"Bootstrap5Dark\"] = \"Bootstrap5Dark\";\n    /** The Tailwind CSS theme. */\n    Theme[\"Tailwind\"] = \"Tailwind\";\n    /** The dark variant of the Tailwind CSS theme. */\n    Theme[\"TailwindDark\"] = \"TailwindDark\";\n    /** The Fluent UI theme. */\n    Theme[\"Fluent\"] = \"Fluent\";\n    /** The dark variant of the Fluent UI theme. */\n    Theme[\"FluentDark\"] = \"FluentDark\";\n    /** The Bootstrap 4 theme. */\n    Theme[\"Bootstrap4\"] = \"Bootstrap4\";\n    /** The Bootstrap theme. */\n    Theme[\"Bootstrap\"] = \"Bootstrap\";\n    /** The dark variant of the Bootstrap theme. */\n    Theme[\"BootstrapDark\"] = \"BootstrapDark\";\n    /** The Material Design theme. */\n    Theme[\"Material\"] = \"Material\";\n    /** The dark variant of the Material Design theme. */\n    Theme[\"MaterialDark\"] = \"MaterialDark\";\n    /** The Fabric theme. */\n    Theme[\"Fabric\"] = \"Fabric\";\n    /** The dark variant of the Fabric theme. */\n    Theme[\"FabricDark\"] = \"FabricDark\";\n    /** The high contrast theme. */\n    Theme[\"Highcontrast\"] = \"Highcontrast\";\n    /** The Fluent 2.0 UI theme. */\n    Theme[\"Fluent2\"] = \"Fluent2\";\n    /** The dark variant of the Fluent 2.0 UI theme. */\n    Theme[\"Fluent2Dark\"] = \"Fluent2Dark\";\n    /** The Tailwind 3 UI theme. */\n    Theme[\"Tailwind3\"] = \"Tailwind3\";\n    /** The dark variant of the Tailwind 3 UI theme. */\n    Theme[\"Tailwind3Dark\"] = \"Tailwind3Dark\";\n})(Theme || (Theme = {}));\n/**\n * An enum representing the available toolbar commands in the image editor.\n */\nexport var ImageEditorCommand;\n(function (ImageEditorCommand) {\n    ImageEditorCommand[\"Crop\"] = \"Crop\";\n    ImageEditorCommand[\"Transform\"] = \"Transform\";\n    ImageEditorCommand[\"Annotate\"] = \"Annotate\";\n    ImageEditorCommand[\"ZoomIn\"] = \"ZoomIn\";\n    ImageEditorCommand[\"ZoomOut\"] = \"ZoomOut\";\n    ImageEditorCommand[\"Open\"] = \"Open\";\n    ImageEditorCommand[\"Reset\"] = \"Reset\";\n    ImageEditorCommand[\"Save\"] = \"Save\";\n    ImageEditorCommand[\"Pan\"] = \"Pan\";\n    ImageEditorCommand[\"Move\"] = \"Move\";\n    ImageEditorCommand[\"Pen\"] = \"Pen\";\n    ImageEditorCommand[\"Line\"] = \"Line\";\n    ImageEditorCommand[\"Arrow\"] = \"Arrow\";\n    ImageEditorCommand[\"Path\"] = \"Path\";\n    ImageEditorCommand[\"Rectangle\"] = \"Rectangle\";\n    ImageEditorCommand[\"Image\"] = \"Image\";\n    ImageEditorCommand[\"Ellipse\"] = \"Ellipse\";\n    ImageEditorCommand[\"Text\"] = \"Text\";\n    ImageEditorCommand[\"CustomSelection\"] = \"CustomSelection\";\n    ImageEditorCommand[\"CircleSelection\"] = \"CircleSelection\";\n    ImageEditorCommand[\"SquareSelection\"] = \"SquareSelection\";\n    ImageEditorCommand[\"RatioSelection\"] = \"RatioSelection\";\n    ImageEditorCommand[\"RotateLeft\"] = \"RotateLeft\";\n    ImageEditorCommand[\"RotateRight\"] = \"RotateRight\";\n    ImageEditorCommand[\"FlipHorizontal\"] = \"FlipHorizontal\";\n    ImageEditorCommand[\"FlipVertical\"] = \"FlipVertical\";\n    ImageEditorCommand[\"Undo\"] = \"Undo\";\n    ImageEditorCommand[\"Redo\"] = \"Redo\";\n    ImageEditorCommand[\"None\"] = \"None\";\n    ImageEditorCommand[\"Mat\"] = \"Mat\";\n    ImageEditorCommand[\"Bevel\"] = \"Bevel\";\n    ImageEditorCommand[\"Inset\"] = \"Inset\";\n    ImageEditorCommand[\"Hook\"] = \"Hook\";\n    ImageEditorCommand[\"Finetune\"] = \"Finetune\";\n    ImageEditorCommand[\"Filter\"] = \"Filter\";\n    ImageEditorCommand[\"Frame\"] = \"Frame\";\n    ImageEditorCommand[\"Resize\"] = \"Resize\";\n    ImageEditorCommand[\"HorizontalFlip\"] = \"HorizontalFlip\";\n    ImageEditorCommand[\"VerticalFlip\"] = \"VerticalFlip\";\n    ImageEditorCommand[\"Brightness\"] = \"Brightness\";\n    ImageEditorCommand[\"Contrast\"] = \"Contrast\";\n    ImageEditorCommand[\"Hue\"] = \"Hue\";\n    ImageEditorCommand[\"Saturation\"] = \"Saturation\";\n    ImageEditorCommand[\"Opacity\"] = \"Opacity\";\n    ImageEditorCommand[\"Blur\"] = \"Blur\";\n    ImageEditorCommand[\"Exposure\"] = \"Exposure\";\n    ImageEditorCommand[\"Default\"] = \"Default\";\n    ImageEditorCommand[\"Chrome\"] = \"Chrome\";\n    ImageEditorCommand[\"Cold\"] = \"Cold\";\n    ImageEditorCommand[\"Warm\"] = \"Warm\";\n    ImageEditorCommand[\"Grayscale\"] = \"Grayscale\";\n    ImageEditorCommand[\"Sepia\"] = \"Sepia\";\n    ImageEditorCommand[\"Invert\"] = \"Invert\";\n    ImageEditorCommand[\"Straightening\"] = \"Straightening\";\n})(ImageEditorCommand || (ImageEditorCommand = {}));\n/**\n * An enumeration of available image filter options.\n *\n * @remarks\n * These options can be used with the `applyImageFilter` method of the image editor control to apply filters to an image.\n */\nexport var ImageFilterOption;\n(function (ImageFilterOption) {\n    /** Default filter */\n    ImageFilterOption[\"Default\"] = \"Default\";\n    /** Chrome filter */\n    ImageFilterOption[\"Chrome\"] = \"Chrome\";\n    /** Cold filter */\n    ImageFilterOption[\"Cold\"] = \"Cold\";\n    /** Warm filter */\n    ImageFilterOption[\"Warm\"] = \"Warm\";\n    /** Grayscale filter */\n    ImageFilterOption[\"Grayscale\"] = \"Grayscale\";\n    /** Sepia filter */\n    ImageFilterOption[\"Sepia\"] = \"Sepia\";\n    /** Invert filter */\n    ImageFilterOption[\"Invert\"] = \"Invert\";\n})(ImageFilterOption || (ImageFilterOption = {}));\n/**\n * An enumeration of available image finetune options.\n *\n * @remarks\n * These options can be used with the `finetuneImage` method of the image editor control to apply finetuning to an image.\n */\nexport var ImageFinetuneOption;\n(function (ImageFinetuneOption) {\n    /** Adjust the brightness of the image */\n    ImageFinetuneOption[\"Brightness\"] = \"Brightness\";\n    /** Adjust the contrast of the image */\n    ImageFinetuneOption[\"Contrast\"] = \"Contrast\";\n    /** Adjust the hue of the image */\n    ImageFinetuneOption[\"Hue\"] = \"Hue\";\n    /** Adjust the saturation of the image */\n    ImageFinetuneOption[\"Saturation\"] = \"Saturation\";\n    /** Adjust the exposure of the image */\n    ImageFinetuneOption[\"Exposure\"] = \"Exposure\";\n    /** Adjust the opacity of the image */\n    ImageFinetuneOption[\"Opacity\"] = \"Opacity\";\n    /** Adjust the blur of the image */\n    ImageFinetuneOption[\"Blur\"] = \"Blur\";\n})(ImageFinetuneOption || (ImageFinetuneOption = {}));\n/**\n * Specifies the type of arrowhead should be drawn.\n *\n */\nexport var ArrowheadType;\n(function (ArrowheadType) {\n    /** Indicates no arrowhead should be drawn. */\n    ArrowheadType[\"None\"] = \"None\";\n    /** Indicates a normal triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Arrow\"] = \"Arrow\";\n    /** Indicates a solid triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidArrow\"] = \"SolidArrow\";\n    /** Indicates a circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Circle\"] = \"Circle\";\n    /** Indicates a solid circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidCircle\"] = \"SolidCircle\";\n    /** Indicates a square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Square\"] = \"Square\";\n    /** Indicates a solid square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidSquare\"] = \"SolidSquare\";\n    /** Indicates a bar shaped arrowhead should be drawn. */\n    ArrowheadType[\"Bar\"] = \"Bar\";\n})(ArrowheadType || (ArrowheadType = {}));\n/**\n * An enumeration of available frame options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameType;\n(function (FrameType) {\n    /** Represents a no frame. */\n    FrameType[\"None\"] = \"None\";\n    /** Represents a mat frame. */\n    FrameType[\"Mat\"] = \"Mat\";\n    /** Represents a bevel frame. */\n    FrameType[\"Bevel\"] = \"Bevel\";\n    /** Represents a line frame. */\n    FrameType[\"Line\"] = \"Line\";\n    /** Represents an inset frame. */\n    FrameType[\"Inset\"] = \"Inset\";\n    /** Represents a hook frame. */\n    FrameType[\"Hook\"] = \"Hook\";\n})(FrameType || (FrameType = {}));\n/**\n * An enumeration of available line options.\n *\n * @remarks\n * These options can be used with the `drawFrame` method of the image editor control to draw frames on an image.\n */\nexport var FrameLineStyle;\n(function (FrameLineStyle) {\n    /** Represents a solid line. */\n    FrameLineStyle[\"Solid\"] = \"Solid\";\n    /** Represents a dashed line. */\n    FrameLineStyle[\"Dashed\"] = \"Dashed\";\n    /** Represents a dotted line. */\n    FrameLineStyle[\"Dotted\"] = \"Dotted\";\n})(FrameLineStyle || (FrameLineStyle = {}));\n/**\n * An enumeration representing the type of redaction to be added in the image editor.\n *\n * @enum {string}\n */\nexport var RedactType;\n(function (RedactType) {\n    /** Represents a blur redaction. */\n    RedactType[\"Blur\"] = \"Blur\";\n    /** Represents a pixelate redaction. */\n    RedactType[\"Pixelate\"] = \"Pixelate\";\n})(RedactType || (RedactType = {}));\n","import { extend, Browser, detach, select } from '@syncfusion/ej2-base';\nimport { EventHandler, getComponent, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader, Slider, TextBox } from '@syncfusion/ej2-inputs';\nimport { ZoomTrigger, ShapeType } from '../index';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nvar ToolbarModule = /** @class */ (function () {\n    function ToolbarModule(parent) {\n        this.defToolbarItems = [];\n        this.toolbarHeight = 46;\n        this.currToolbar = '';\n        this.preventZoomBtn = false;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        this.preventEnableDisableUr = false;\n        this.isAspectRatio = true;\n        this.isFrameToolbar = false;\n        this.presetColors = {\n            'custom': ['#000000', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                '#01579b', '#006064', '#004d40', '#f57f17']\n        };\n        this.isSlider = false;\n        this.currentQuality = 1;\n        this.imageQuality = 'highest';\n        this.parent = parent;\n        this.addEventListener();\n        this.initLocale();\n    }\n    ToolbarModule.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    ToolbarModule.prototype.addEventListener = function () {\n        this.parent.on('toolbar', this.toolbar, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    ToolbarModule.prototype.removeEventListener = function () {\n        this.parent.off('toolbar', this.toolbar);\n        this.parent.off('destroyed', this.destroy);\n    };\n    ToolbarModule.prototype.initLocale = function () {\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Undo: 'Undo',\n            Redo: 'Redo',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Finetune: 'Finetune',\n            Brightness: 'Brightness',\n            Contrast: 'Contrast',\n            Hue: 'Hue',\n            Saturation: 'Saturation',\n            Opacity: 'Opacity',\n            Blur: 'Blur',\n            Sharpen: 'Sharpen',\n            Exposure: 'Exposure',\n            Filter: 'Filter',\n            Default: 'Default',\n            Chrome: 'Chrome',\n            Cold: 'Cold',\n            Warm: 'Warm',\n            Grayscale: 'Grayscale',\n            BlackAndWhite: 'Black and White',\n            Sepia: 'Sepia',\n            Invert: 'Invert',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'Apply',\n            Cancel: 'Discard',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Arrow: 'Arrow',\n            Path: 'Path',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC',\n            Browse: 'Browse',\n            Duplicate: 'Duplicate',\n            Remove: 'Remove',\n            EditText: 'Edit Text',\n            Start: 'Start',\n            End: 'End',\n            Bar: 'Bar',\n            ArrowSolid: 'Arrow Solid',\n            CircleSolid: 'Circle Solid',\n            SquareSolid: 'Square Solid',\n            None: 'None',\n            CropAndTransform: 'Crop and Transform',\n            CropSelection: 'Crop Selection',\n            Image: 'Add Image',\n            Transparency: 'Transparency',\n            Height: 'Height',\n            Width: 'Width',\n            AspectRatio: 'Maintain aspect ratio',\n            W: 'W',\n            H: 'H',\n            DragText: 'Drag and drop your image here or',\n            DropText: 'Drop your image here or',\n            BrowseText: 'Browse here...',\n            SupportText: 'Supports:',\n            Frame: 'Frame',\n            Mat: 'Mat',\n            Bevel: 'Bevel',\n            Inset: 'Inset',\n            Hook: 'Hook',\n            Color: 'Color',\n            Size: 'Size',\n            Offset: 'Offset',\n            Radius: 'Radius',\n            Amount: 'Amount',\n            Resize: 'Resize',\n            0: '0%',\n            20: '20%',\n            40: '40%',\n            60: '60%',\n            80: '80%',\n            100: '100%',\n            1: '1',\n            2: '2',\n            3: '3',\n            4: '4',\n            5: '5',\n            Border: 'Border',\n            Solid: 'Solid',\n            Dashed: 'Dashed',\n            Dotted: 'Dotted',\n            GradientColor: 'Gradient Color',\n            ConfirmDialogHeader: 'Confirm Save Changes',\n            ConfirmDialogContent: 'Do you want to save the changes you made to the image?',\n            AlertDialogHeader: 'Unsupported file',\n            AlertDialogContent: 'The selected file is unsupported.',\n            MinMaxSize: 'with file size between',\n            MinMaxSizeAlert: 'File size between',\n            MinSize: 'with minimum file size of',\n            MinSizeAlert: 'A minimum file size of',\n            MaxSize: 'with maximum file size of',\n            MaxSizeAlert: 'A maximum file size of',\n            To: 'to',\n            Bytes: 'bytes',\n            Yes: 'Yes',\n            No: 'No',\n            ImageErrorDialogHeader: 'Image Selection Error',\n            ImageErrorDialogContent: 'Please select only one image to open.',\n            Straighten: 'Straighten',\n            NoOutline: 'No outline',\n            DlgOK: 'OK',\n            SaveAs: 'Save As',\n            ImageName: 'Image name',\n            Format: 'Format',\n            Quality: 'Quality',\n            Download: 'Download',\n            Close: 'Close',\n            ImageSize: 'Image Size',\n            QualityInfo: 'The image quality option is only available for JPEG format',\n            Good: 'Good',\n            Great: 'Great',\n            Highest: 'Highest',\n            BringForward: 'Bring Forward',\n            SendBackward: 'Send Backward',\n            SendToBack: 'Send to Back',\n            BringToFront: 'Bring to Front',\n            ZOrder: 'Z-Order',\n            Redact: 'Redact',\n            Pixelate: 'Pixelate',\n            BorderRadius: 'Border Radius',\n            TextOutlineColor: 'Outline Color',\n            TextOutlineWidth: 'Outline Width',\n            PixelSize: 'Pixel Size',\n            And: 'and'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.parent.locale);\n    };\n    ToolbarModule.prototype.toolbar = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'create-toolbar':\n                this.createToolbar();\n                break;\n            case 'create-contextual-toolbar':\n                this.createContextualToolbar();\n                break;\n            case 'update-toolbar-items':\n                this.updateToolbarItems();\n                break;\n            case 'refresh-toolbar':\n                this.refreshToolbar(args.value['type'], args.value['isApplyBtn'], args.value['isCropping'], args.value['isZooming'], args.value['cType']);\n                break;\n            case 'renderQAT':\n                this.renderQAT(args.value['isPenEdit']);\n                break;\n            case 'enable-disable-btns':\n                this.enableDisableTbrBtn();\n                break;\n            case 'init-main-toolbar':\n                this.initMainToolbar(args.value['isApplyBtn'], args.value['isDevice'], args.value['isOkBtn'], args.value['isResize'], args.value['isFrame'], args.value['isMainToolbar']);\n                break;\n            case 'create-bottom-toolbar':\n                this.createBottomToolbar();\n                break;\n            case 'refresh-main-toolbar':\n                this.refreshMainToolbar();\n                break;\n            case 'create-qa-toolbar':\n                this.createQuickAccessToolbar();\n                break;\n            case 'destroy-qa-toolbar':\n                this.destroyQuickAccessToolbar();\n                break;\n            case 'zoom-up-handler':\n                this.zoomBtnMouseUpHandler();\n                break;\n            case 'refresh-dropdown-btn':\n                this.refreshDropDownBtn(args.value['isDisabled']);\n                break;\n            case 'close-contextual-toolbar':\n                this.closeContextualToolbar();\n                break;\n            case 'destroy-bottom-toolbar':\n                this.destroyBottomToolbar();\n                break;\n            case 'destroy-top-toolbar':\n                this.destroyTopToolbar();\n                break;\n            case 'destroySubComponents':\n                this.destroySubComponents();\n                break;\n            case 'setLocale':\n                this.l10n.setLocale(args.value['locale']);\n                break;\n            case 'setPreventZoomBtn':\n                this.preventZoomBtn = args.value['isPrevent'];\n                break;\n            case 'getToolbarHeight':\n                args.value['obj']['toolbarHeight'] = this.toolbarHeight;\n                break;\n            case 'setToolbarHeight':\n                if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') > -1)) {\n                    this.toolbarHeight = args.value['height'];\n                }\n                break;\n            case 'setCurrentToolbar':\n                this.currentToolbar = args.value['type'];\n                break;\n            case 'setSelectedFreehandColor':\n                this.selFhdColor = args.value['color'];\n                break;\n            case 'setInitialAdjustmentValue':\n                parent.initialAdjustmentValue = args.value['value'];\n                break;\n            case 'getCanvasFilter':\n                args.value['obj']['canvasFilter'] = parent.canvasFilter;\n                break;\n            case 'getDefToolbarItems':\n                args.value['obj']['defToolbarItems'] = this.defToolbarItems;\n                break;\n            case 'getPenStroke':\n                this.getPenStroke(args.value['value']);\n                break;\n            case 'performDefToolbarClickAction':\n                this.performDefTbrClick(args.value['type'], args.value['isContextualToolbar'], args.value['isDisabledAdjustment'], args.value['isDisabledFilter'], args.value['isFilterFinetune']);\n                break;\n            case 'setTempFilterProperties':\n                parent.setTempFilterProperties();\n                break;\n            case 'refreshSlider':\n                this.refreshSlider();\n                break;\n            case 'getCurrAdjustmentValue':\n                parent.getCurrAdjustmentValue(args.value['type']);\n                break;\n            case 'setCurrAdjustmentValue':\n                parent.setCurrAdjustmentValue(args.value['type'], args.value['value']);\n                break;\n            case 'refreshShapeDrawing':\n                this.refreshShapeDrawing();\n                break;\n            case 'setEnableDisableUndoRedo':\n                this.preventEnableDisableUr = args.value['isPrevent'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'getLocaleText':\n                args.value['obj']['value'] = this.l10n.getConstant(args.value['obj']['key']);\n                break;\n            case 'initResizeToolbar':\n                this.initResizeToolbar();\n                break;\n            case 'getFrameToolbar':\n                args.value['obj']['bool'] = this.isFrameToolbar;\n                break;\n            case 'resizeClick':\n                this.resizeClick();\n                break;\n            case 'frameToolbarClick':\n                this.frameToolbarClick();\n                break;\n            case 'performCropTransformClick':\n                this.performCropTransformClick(args.value['shape'], args.value['isTransform']);\n                break;\n            case 'duplicateShape':\n                this.duplicateShape(args.value['isPreventUndoRedo'], true);\n                break;\n            case 'editText':\n                this.editText();\n                break;\n            case 'setInitialSize':\n                this.initialSize = Number(args.value['value']);\n                break;\n            case 'widthPress':\n                this.widthPress(args.value['e']);\n                break;\n            case 'heightPress':\n                this.heightPress(args.value['e']);\n                break;\n            case 'widthAspectRatio':\n                this.widthAspectRatio(args.value['e']);\n                break;\n            case 'heightAspectRatio':\n                this.heightAspectRatio(args.value['e']);\n                break;\n        }\n    };\n    ToolbarModule.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        this.inMemoryCanvas = parent.inMemoryCanvas;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (this.inMemoryCanvas) {\n            this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        }\n    };\n    ToolbarModule.prototype.reset = function () {\n        var parent = this.parent;\n        this.toolbarHeight = 46;\n        parent.prevCurrSelectionPoint = null;\n        this.zoomBtnHold = null;\n        this.currToolbar = '';\n        parent.cxtTbarHeight = null;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        parent.currentFilter = '';\n        this.preventZoomBtn = parent.isCropToolbar = this.preventEnableDisableUr = this.isFrameToolbar = false;\n        parent.initialAdjustmentValue = parent.canvasFilter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.tempStraighten = 0;\n        parent.isStraightening = false;\n    };\n    ToolbarModule.prototype.destroyTopToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_toolbar');\n        if (this.isToolbar() && toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.destroyBottomToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_bottomToolbar');\n        if (toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(toolbar, 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.isToolbar = function () {\n        var parent = this.parent;\n        return (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)\n            || !isNullOrUndefined(parent.toolbarTemplate));\n    };\n    ToolbarModule.prototype.createToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: parent.uploadSettings.allowedExtensions, multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_toolbarArea');\n            var toolbar_1 = parent.createElement('div', { id: id + '_toolbar' });\n            toolbarArea.appendChild(toolbar_1);\n            var uploadItems = [\n                {\n                    cssClass: 'e-image-upload',\n                    align: 'Left', type: 'Input',\n                    tooltipText: this.l10n.getConstant('Browse'),\n                    template: new Uploader({\n                        allowedExtensions: parent.uploadSettings.allowedExtensions,\n                        multiple: false,\n                        selected: function () {\n                            var toolbar = document.getElementById(id + '_toolbar');\n                            var bToolbar = document.getElementById(id + '_bottomToolbar');\n                            if (!parent.disabled) {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    if (bToolbar) {\n                                        getComponent(bToolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, Browser.isDevice, null);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 && toolbar) {\n                                        getComponent(toolbar, 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, false, null);\n                                }\n                            }\n                        }\n                    })\n                }\n            ];\n            var toolbarObj = new Toolbar({ items: uploadItems, width: '100%',\n                created: function () {\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_toolbar');\n            this.createLeftToolbarControls();\n            var mToolbar = document.getElementById(id + '_toolbar');\n            if (toolbar_1) {\n                this.toolbarHeight = mToolbar.clientHeight;\n                if (parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1) {\n                    var toolabr = getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar');\n                    if (toolabr) {\n                        toolabr.destroy();\n                        document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                    }\n                }\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ToolbarModule.prototype.createContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', { id: id + '_contextualToolbarArea',\n                className: 'e-contextual-toolbar-wrapper e-hide', attrs: { style: 'position: absolute;' }\n            }));\n            var toolbarArea = document.getElementById(id + '_contextualToolbarArea');\n            var toolbar_2 = parent.createElement('div', { id: id + '_contextualToolbar' });\n            toolbarArea.appendChild(toolbar_2);\n        }\n    };\n    ToolbarModule.prototype.createBottomToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.element.querySelector('#' + id + '_bottomToolbarArea')) {\n            parent.element.querySelector('#' + id + '_bottomToolbarArea').remove();\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!parent.toolbarTemplate) {\n                var toolbarArea = document.getElementById(id + '_bottomToolbarArea');\n                var toolbarElem = parent.createElement('div', {\n                    id: id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ToolbarModule.prototype.createQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.showQuickAccessToolbar) {\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: parent.uploadSettings.allowedExtensions, multiple: false }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(id + '_quickAccessToolbarArea');\n            var toolbar_3 = parent.createElement('div', {\n                id: id + '_quickAccessToolbar'\n            });\n            toolbarArea.appendChild(toolbar_3);\n            var toolbarObj = new Toolbar({ clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n        }\n    };\n    ToolbarModule.prototype.initMainToolbar = function (isApplyOption, isDevice, isOkBtn, isResize, isFrame, isMainToolbar, isRedact) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn, isResize);\n            var rightItem = this.getRightToolbarItem(isOkBtn, isMainToolbar, isRedact);\n            var mainItem = this.getMainToolbarItem(isApplyOption, isFrame, isRedact);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                if (isFrame || isRedact) {\n                    this.defToolbarItems = mainItem;\n                }\n                else {\n                    this.defToolbarItems = leftItem.concat(rightItem);\n                }\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(mainItem, rightItem, zoomItem);\n            }\n            var args = { toolbarType: 'main', toolbarItems: this.defToolbarItems };\n            parent.trigger('toolbarUpdating', args);\n            this.defToolbarItems = args.toolbarItems;\n            if (this.defToolbarItems.length > 0) {\n                var toolbarObj = new Toolbar({\n                    width: '100%',\n                    items: this.defToolbarItems,\n                    clicked: this.defToolbarClicked.bind(this),\n                    created: function () {\n                        if (!isDevice) {\n                            _this.renderAnnotationBtn();\n                        }\n                        _this.wireZoomBtnEvents();\n                        parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                    }\n                });\n                if ((isDevice && isFrame) || (isDevice && isRedact)) {\n                    toolbarObj.appendTo('#' + id + '_bottomToolbar');\n                }\n                else {\n                    toolbarObj.appendTo('#' + id + '_toolbar');\n                }\n                this.createLeftToolbarControls();\n                this.enableDisableTbrBtn();\n                if (this.isToolbar() && document.getElementById(id + '_toolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_4 = getComponent(id + '_toolbar', 'toolbar');\n                    toolbar_4.refreshOverflow();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.initBottomToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            var items = this.getMainToolbarItem();\n            var args = { toolbarType: 'bottom-toolbar', toolbarItems: items };\n            parent.trigger('toolbarUpdating', args);\n            items = args.toolbarItems;\n            var toolbarObj = new Toolbar({ items: items, width: '100%',\n                created: function () {\n                    _this.renderAnnotationBtn();\n                    _this.renderCropBtn();\n                    _this.renderTransformBtn();\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this)\n            });\n            toolbarObj.appendTo('#' + id + '_bottomToolbar');\n            if (this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_5 = getComponent(id + '_bottomToolbar', 'toolbar');\n                toolbar_5.refreshOverflow();\n            }\n        }\n    };\n    ToolbarModule.prototype.getLeftToolbarItem = function (isOkBtn, isResize) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (!isOkBtn || isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Open') > -1)) {\n                toolbarItems.push({ id: id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: parent.uploadSettings.allowedExtensions, multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n            else if (Browser.isDevice && (parent.toolbar && parent.toolbar.indexOf('Open') === -1)) {\n                toolbarItems.push({ visible: false, id: id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: parent.uploadSettings.allowedExtensions, multiple: false }) });\n                toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n            }\n        }\n        if (parent.allowUndoRedo && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Undo') > -1)) {\n                toolbarItems.push({ id: id + '_undo', prefixIcon: 'e-icons e-undo', cssClass: 'top-icon e-undo',\n                    tooltipText: this.l10n.getConstant('Undo'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Redo') > -1)) {\n                toolbarItems.push({ id: id + '_redo', prefixIcon: 'e-icons e-redo', cssClass: 'top-icon e-redo',\n                    tooltipText: this.l10n.getConstant('Redo'), align: 'Left' });\n            }\n        }\n        if (!this.preventZoomBtn && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar && !isResize) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomOut') > -1)) {\n                toolbarItems.push({ id: id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomIn') > -1)) {\n                toolbarItems.push({ id: id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getRightToolbarItem = function (isOkBtn, isMainToolbar, isRedact) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isOkBtn || isRedact) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if ((isMainToolbar || !Browser.isDevice) && (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Reset') > -1))) {\n            toolbarItems.push({ id: id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'e-caret-hide top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getMainToolbarItem = function (isApplyOption, isFrame, isRedact) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isFrame) {\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('None') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_none', prefixIcon: 'e-icons e-frame-none', cssClass: 'top-icon e-frame-none',\n                    tooltipText: this.l10n.getConstant('None'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Mat') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_mat', prefixIcon: 'e-icons e-frame-mat', cssClass: 'top-icon e-frame-mat',\n                    tooltipText: this.l10n.getConstant('Mat'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Bevel') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_bevel', prefixIcon: 'e-icons e-frame-bevel', cssClass: 'top-icon e-frame-bevel',\n                    tooltipText: this.l10n.getConstant('Bevel'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Line') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_line', prefixIcon: 'e-icons e-frame-line', cssClass: 'top-icon e-frame-line',\n                    tooltipText: this.l10n.getConstant('Line'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Inset') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_inset', prefixIcon: 'e-icons e-frame-inset', cssClass: 'top-icon e-frame-inset',\n                    tooltipText: this.l10n.getConstant('Inset'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Hook') > -1) || parent.toolbar.indexOf('Frame') > -1) {\n                toolbarItems.push({ id: id + '_hook', prefixIcon: 'e-icons e-frame-hook', cssClass: 'top-icon e-frame-hook',\n                    tooltipText: this.l10n.getConstant('Hook'), align: 'Center' });\n            }\n        }\n        else if (isRedact) {\n            toolbarItems.push({ id: id + '_redactBlur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n            toolbarItems.push({ id: id + '_pixelate', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Pixelate'), align: 'Center' });\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        else {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Crop') > -1)) {\n                toolbarItems.push({ id: id + '_cropTransform', prefixIcon: 'e-icons e-crop', cssClass: 'top-icon e-crop',\n                    tooltipText: this.l10n.getConstant('CropAndTransform'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Annotate') > -1)) {\n                toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                    template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Finetune') > -1)) {\n                toolbarItems.push({ id: id + '_adjustment', prefixIcon: 'e-icons e-adjustment', cssClass: 'top-icon e-adjustment',\n                    tooltipText: this.l10n.getConstant('Finetune'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Filter') > -1)) {\n                toolbarItems.push({ id: id + '_filter', prefixIcon: 'e-icons e-filters', cssClass: 'top-icon e-filters',\n                    tooltipText: this.l10n.getConstant('Filter'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Frame') > -1)) {\n                toolbarItems.push({ id: id + '_frame', prefixIcon: 'e-icons e-border-frame', cssClass: 'top-icon e-border-frame',\n                    tooltipText: this.l10n.getConstant('Frame'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Resize') > -1)) {\n                toolbarItems.push({ id: id + '_resize', prefixIcon: 'e-icons e-resize', cssClass: 'top-icon e-resize',\n                    tooltipText: this.l10n.getConstant('Resize'), align: 'Center' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (!isNullOrUndefined(parent.toolbar) && parent.toolbar.indexOf('Redact') > -1)) {\n                toolbarItems.push({ id: id + '_redact', prefixIcon: 'e-icons e-redact', cssClass: 'top-icon e-opacity',\n                    tooltipText: this.l10n.getConstant('Redact'), align: 'Center' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.updateContextualToolbar = function (type, cType, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarArea = parent.element.querySelector('#' + id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n        if (!contextualToolbarArea) {\n            return;\n        }\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        if (type === 'filter') {\n            var toolbar_6 = document.getElementById(id + '_toolbar');\n            if (toolbar_6 && this.defToolbarItems.length > 0) {\n                getComponent(toolbar_6, 'toolbar').destroy();\n            }\n            if (Browser.isDevice) {\n                this.initMainToolbar(false, true, true);\n            }\n            else {\n                this.initMainToolbar(true, null, null);\n            }\n            this.refreshSlider();\n            this.initFilterToolbarItem();\n        }\n        else {\n            var ctxToolbar = document.querySelector('#' + id + '_contextualToolbar');\n            if (ctxToolbar.classList.contains('e-control')) {\n                getComponent(ctxToolbar, 'toolbar').destroy();\n            }\n            this.refreshSlider();\n            if (type === 'frame') {\n                this.initFrameToolbarItem();\n            }\n            else {\n                this.renderSlider(cType, isSelect);\n            }\n        }\n        if (parent.toolbarTemplate) {\n            this.toolbarHeight = parent.element.querySelector('#' + id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + id + '_toolbar')) {\n            this.toolbarHeight = parent.element.querySelector('#' + id + '_toolbar').clientHeight;\n        }\n        parent.toolbarHeight = this.toolbarHeight;\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight + 1;\n            var cusWrapper = parent.element.querySelector('#' + id + '_customizeWrapper');\n            if (this.isFrameToolbar && cusWrapper) {\n                cHt = cusWrapper.offsetHeight + 2;\n            }\n            var ht = parent.element.querySelector('#' + id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + ht - cHt + 'px';\n            if (cType === 'straighten') {\n                parent.isStraightening = true;\n                var ctxToolbar = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n                if (ctxToolbar.style.position === 'absolute') {\n                    ctxToolbar.style.position = '';\n                    parent.element.insertBefore(ctxToolbar, parent.element.querySelector('#' + id + '_bottomToolbarArea'));\n                    parent.update();\n                    if (isSelect) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        }\n        else {\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + 'px';\n        }\n    };\n    ToolbarModule.prototype.processToolbar = function (position) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (parent.toolbar) {\n            for (var i = 0, len = parent.toolbar.length; i < len; i++) {\n                if (typeof (parent.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(parent.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(parent.toolbar[i]);\n                        }\n                    }\n                    else if (parent.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(parent.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.wireZoomBtnEvents = function () {\n        var zoomIn = document.querySelector('#' + this.parent.element.id + '_zoomIn');\n        var zoomOut = document.querySelector('#' + this.parent.element.id + '_zoomOut');\n        if (zoomIn) {\n            zoomIn.addEventListener('mousedown', this.zoomInBtnMouseDownHandler.bind(this));\n            zoomIn.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomIn.addEventListener('click', this.zoomInBtnClickHandler.bind(this));\n        }\n        if (zoomOut) {\n            zoomOut.addEventListener('mousedown', this.zoomOutBtnMouseDownHandler.bind(this));\n            zoomOut.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomOut.addEventListener('click', this.zoomOutBtnClickHandler.bind(this));\n        }\n    };\n    ToolbarModule.prototype.widthPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    ToolbarModule.prototype.heightPress = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109) {\n            e.preventDefault();\n            return;\n        }\n    };\n    ToolbarModule.prototype.widthAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109 || e.keyCode === 9) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioHeightValue = parseFloat(aspectRatioHeight.value);\n        var val = aspectRatioHeightValue / (originalHeight / originalWidth);\n        var width = val % 1 >= 0.5 || val % 1 <= -0.5 ? Math.round(val) : (val < 0) ? Math.ceil(val) : Math.floor(val);\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        var heightNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (width != null && !isNaN(width)) {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = width + ' px';\n                    aspectRatioWidth.placeholder = width.toString() + ' px';\n                }\n                else {\n                    (widthNumeric).value = width;\n                    aspectRatioWidth.value = width.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((widthNumeric).value)) {\n                    (widthNumeric).placeholder = '0 px';\n                    aspectRatioWidth.placeholder = '0 px';\n                    if (isNullOrUndefined(heightNumeric.value) && !isNullOrUndefined(heightNumeric.placeholder)) {\n                        (widthNumeric).placeholder = \"\" + parent.img.srcWidth;\n                        aspectRatioWidth.placeholder = \"\" + parent.img.srcWidth;\n                    }\n                }\n                else {\n                    (widthNumeric).value = 0;\n                    aspectRatioWidth.value = '0 px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.heightAspectRatio = function (e) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        if (e.keyCode === 109 || e.keyCode === 9) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var icon = parent.element.querySelector('#' + id + '_aspectratio');\n        var originalWidth = parent.img.destWidth;\n        var originalHeight = parent.img.destHeight;\n        var aspectRatioWidthValue = parseFloat(aspectRatioWidth.value);\n        var value = aspectRatioWidthValue / (originalWidth / originalHeight);\n        var ht = value % 1 >= 0.5 || value % 1 <= -0.5 ? Math.round(value) : (value < 0) ? Math.ceil(value) : Math.floor(value);\n        var heightNumeric = getComponent(aspectRatioHeight, 'numerictextbox');\n        var widthNumeric = getComponent(aspectRatioWidth, 'numerictextbox');\n        if (icon) {\n            if (!isNaN(ht)) {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = ht + ' px';\n                    aspectRatioHeight.placeholder = ht.toString() + ' px';\n                }\n                else {\n                    (heightNumeric).value = ht;\n                    aspectRatioHeight.value = ht.toString() + ' px';\n                }\n            }\n            else {\n                if (isNullOrUndefined((heightNumeric).value)) {\n                    (heightNumeric).placeholder = '0 px';\n                    aspectRatioHeight.placeholder = '0 px';\n                    if (isNullOrUndefined(widthNumeric.value) && !isNullOrUndefined(widthNumeric.placeholder)) {\n                        (heightNumeric).placeholder = \"\" + parent.img.srcHeight;\n                        aspectRatioHeight.placeholder = \"\" + parent.img.srcHeight;\n                    }\n                }\n                else {\n                    (heightNumeric).value = 0;\n                    aspectRatioHeight.value = '0 px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getResizeToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isResize = parent.aspectWidth && parent.aspectHeight ? true : false;\n        var width = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcHeight).toString() : Math.ceil(this.parent.img.srcWidth).toString();\n        var height = this.parent.transform.degree % 90 === 0 && this.parent.transform.degree % 180 !== 0 ?\n            Math.ceil(this.parent.img.srcWidth).toString() : Math.ceil(this.parent.img.srcHeight).toString();\n        var toolbarItems = [];\n        var spanWidth = document.createElement('span');\n        spanWidth.innerHTML = this.l10n.getConstant('W');\n        toolbarItems.push({ id: id + '_width', cssClass: 'e-ie-resize-width', template: spanWidth, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeWidth', prefixIcon: 'e-icons e-anti-clock-wise',\n            tooltipText: this.l10n.getConstant('Width'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: '4' },\n                showSpinButton: false, value: isResize ? parent.aspectWidth : null,\n                placeholder: isResize ? null : width, format: '###.## px' })\n        });\n        var spanHeight = document.createElement('span');\n        spanHeight.innerHTML = this.l10n.getConstant('H');\n        toolbarItems.push({ id: id + '_height', cssClass: 'e-ie-resize-height', template: spanHeight, align: 'Center' });\n        toolbarItems.push({ id: id + '_resizeHeight', prefixIcon: 'e-icons e-clock-wise',\n            tooltipText: this.l10n.getConstant('Height'), align: 'Center', type: 'Input', template: new NumericTextBox({ width: 75, htmlAttributes: { maxLength: '4' },\n                showSpinButton: false, value: isResize ? parent.aspectHeight : null,\n                placeholder: isResize ? null : height, format: '###.## px' })\n        });\n        if (!this.isAspectRatio) {\n            toolbarItems.push({ id: id + '_aspectratio', prefixIcon: 'e-icons e-lock', align: 'Center',\n                tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button', tabIndex: 0 });\n            this.isAspectRatio = true;\n        }\n        else {\n            toolbarItems.push({ id: id + '_nonaspectratio', prefixIcon: 'e-icons e-unlock', align: 'Center', tooltipText: this.l10n.getConstant('AspectRatio'), type: 'Button' });\n            this.isAspectRatio = false;\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initResizeToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(false, true);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getResizeToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'resize', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireResizeBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        parent.isResize = false;\n        this.enableDisableTbrBtn();\n        parent.isResize = true;\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.wireResizeBtnEvents = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        if (!isNullOrUndefined(aspectRatioHeight)) {\n            aspectRatioHeight.addEventListener('keydown', this.widthPress.bind(this));\n            aspectRatioWidth.addEventListener('keyup', this.heightAspectRatio.bind(this));\n        }\n        if (!isNullOrUndefined(aspectRatioWidth)) {\n            aspectRatioWidth.addEventListener('keydown', this.heightPress.bind(this));\n            aspectRatioHeight.addEventListener('keyup', this.widthAspectRatio.bind(this));\n        }\n    };\n    ToolbarModule.prototype.enableDisableTbrBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!this.preventEnableDisableUr) {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            var undo = parent.element.querySelector('#' + id + '_undo');\n            if (undo && undoRedoObj['undoRedoStep'] === 0) {\n                undo.classList.add('e-disabled');\n                undo.parentElement.classList.add('e-overlay');\n            }\n            else if (undo && undoRedoObj['undoRedoStep'] > 0) {\n                undo.classList.remove('e-disabled');\n                undo.parentElement.classList.remove('e-overlay');\n            }\n            var redo = parent.element.querySelector('#' + id + '_redo');\n            if (redo && (undoRedoObj['undoRedoStep'] === object['appliedUndoRedoColl'].length)) {\n                redo.classList.add('e-disabled');\n                redo.parentElement.classList.add('e-overlay');\n            }\n            else if (redo && (undoRedoObj['undoRedoStep'] === 0 && object['appliedUndoRedoColl'].length > 0)) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n            else if (redo && undoRedoObj['undoRedoStep'] > 0) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n        }\n        var zoomIn = document.querySelector('#' + id + '_zoomIn');\n        if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n            zoomIn.classList.add('e-disabled');\n            zoomIn.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomIn) {\n            zoomIn.classList.remove('e-disabled');\n            zoomIn.parentElement.classList.remove('e-overlay');\n        }\n        var zoomOut = document.querySelector('#' + id + '_zoomOut');\n        if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var frame = document.querySelector('#' + id + '_frame');\n        if (frame && ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop)) {\n            frame.classList.add('e-overlay');\n        }\n        else if (frame) {\n            frame.classList.remove('e-overlay');\n        }\n        var ratio = document.querySelector('#' + id + '_aspectratio');\n        if (ratio && ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop)) {\n            ratio.classList.add('e-overlay');\n        }\n        else if (ratio) {\n            ratio.classList.remove('e-overlay');\n        }\n    };\n    ToolbarModule.prototype.createLeftToolbarControls = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (document.getElementById(id + '_toolbar'))) {\n            var uploadDiv = document.getElementById(id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.title = this.l10n.getConstant('Browse');\n                uploadBtnElem.appendChild(parent.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ToolbarModule.prototype.fileSelect = function (inputElement, args) {\n        var parent = this.parent;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var type = inputElement.files[0].type.split('/')[1];\n        var filesTypes = this.parent.getExtensionArray();\n        var isJPG = ((type === 'jpg' || type === 'jpeg') &&\n            (parent.uploadSettings.allowedExtensions.indexOf('jpg') > -1 ||\n                parent.uploadSettings.allowedExtensions.indexOf('jpeg') > -1));\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.fileName = inputElement.files[0].name.split('.')[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var size = inputElement.files[0].size;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.parent.notify('toolbar', { prop: 'setInitialSize', value: { value: inputElement.files[0].size } });\n        if ((filesTypes.indexOf(type) > -1 || isJPG || (type.indexOf('svg') > -1 && filesTypes.indexOf('svg') > -1)) &&\n            (!this.parent.uploadSettings.minFileSize || size > this.parent.uploadSettings.minFileSize) &&\n            (!this.parent.uploadSettings.maxFileSize || size < this.parent.uploadSettings.maxFileSize)) {\n            this.parent.notify('draw', { prop: 'fileSelect', value: { inputElement: inputElement, args: args } });\n        }\n        else {\n            if (!this.parent.isImageLoaded) {\n                this.destroyTopToolbar();\n                this.createToolbar();\n                if (Browser.isDevice) {\n                    this.destroyBottomToolbar();\n                }\n            }\n            this.parent.showDialogPopup('unsupported', !((filesTypes.indexOf(type) > -1 || isJPG || (type.indexOf('svg') > -1 && filesTypes.indexOf('svg') > -1))));\n        }\n    };\n    ToolbarModule.prototype.triggerTbarClickEvent = function (args) {\n        var clickEvent = { item: args.item, originalEvent: args.event };\n        this.parent.trigger('toolbarItemClicked', clickEvent);\n    };\n    ToolbarModule.prototype.renderAnnotationBtn = function (isContextualToolbar) {\n        var _this = this;\n        var parent = this.parent;\n        var isCustomized = false;\n        var items = [];\n        var id = parent.element.id;\n        var defItems = ['Ellipse', 'Arrow', 'Line', 'Rectangle', 'Pen', 'Path', 'Text', 'Image'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Arrow') > -1)) {\n            items.push({ text: this.l10n.getConstant('Arrow'), id: 'arrow', iconCss: 'e-icons e-arrow-right-up' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Path') > -1)) {\n            items.push({ text: this.l10n.getConstant('Path'), id: 'path', iconCss: 'e-icons e-critical-path' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Image') > -1)) {\n            items.push({ text: this.l10n.getConstant('Image'), id: 'image', iconCss: 'e-icons e-image' });\n        }\n        var obj = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n        var toolbarId = Browser.isDevice ? '#' + id + '_bottomToolbar ' + '#' + id : '#' + id;\n        this.enableDisableCloneBtn(toolbarId, obj);\n        var iconCss = isContextualToolbar ? this.getCurrentShapeIcon(parent.activeObj.shape) : 'e-annotation';\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons ' + iconCss,\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                    parent.okBtn();\n                    parent.element.querySelector('#' + id + '_annotationBtn').click();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape) {\n                    document.getElementById(parent.activeObj.shape).classList.add('e-selected');\n                }\n                else if (parent.togglePen) {\n                    document.getElementById('pen').classList.add('e-selected');\n                }\n            },\n            select: function (args) {\n                parent.noPushUndo = false;\n                _this.triggerTbarClickEvent(args);\n                parent.okBtn();\n                var isCropSelection = false;\n                var splitWords;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                parent.currObjType.isCustomCrop = false;\n                if (isCropSelection || parent.togglePan) {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                var obj = { currentFreehandDrawIndex: null };\n                parent.notify('freehand-draw', { prop: 'getCurrentFreehandDrawIndex', value: { obj: obj } });\n                var prevObj = { shapeSettingsObj: {} };\n                var shapeSettings;\n                var shapeChangingArgs;\n                var shapes = ['ellipse', 'rectangle', 'text', 'image'];\n                var allowOutofBound;\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon(args.item.id);\n                parent.notify('draw', { prop: 'updateTempObjColl' });\n                parent.notify('draw', { prop: 'updateTempPointColl' });\n                var penStrokeWidthObj = { penStrokeWidth: 2 };\n                switch (args.item.id) {\n                    case 'pen':\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: penStrokeWidthObj } });\n                        parent.notify('draw', { prop: 'setTempStrokeWidth', value: { strokeWidth: penStrokeWidthObj['penStrokeWidth'] } });\n                        parent.drawingShape = null;\n                        parent.notify('draw', { prop: 'setTempFreehandCounter', value: { tempFreehandCounter: parent.freehandCounter } });\n                        parent.notify('draw', { prop: 'setTempCurrentFreehandDrawIndex', value: { tempCurrentFreehandDrawIndex: obj['currentFreehandDrawIndex'] } });\n                        _this.currentToolbar = 'pen';\n                        parent.freeHandDraw(true);\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: penStrokeWidthObj } });\n                        shapeSettings.strokeWidth = penStrokeWidthObj['penStrokeWidth'];\n                        shapeSettings.type = ShapeType.FreehandDraw;\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings };\n                        parent.notify('freehand-draw', { prop: 'triggerShapeChanging', value: { shapeChangingArgs: shapeChangingArgs } });\n                        break;\n                    case 'text':\n                        _this.currentToolbar = 'text';\n                        parent.drawingShape = args.item.id;\n                        _this.currentToolbar = 'text';\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        break;\n                    case 'image':\n                        parent.drawingShape = null;\n                        _this.currentToolbar = 'shapes';\n                        parent.element.querySelector('#' + id + '_fileUpload').click();\n                        break;\n                    case 'ellipse':\n                    case 'arrow':\n                    case 'line':\n                    case 'rectangle':\n                    case 'path':\n                        parent.drawingShape = args.item.id;\n                        _this.currentToolbar = 'shapes';\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: prevObj } });\n                        shapeSettings = prevObj['shapeSettingsObj'];\n                        allowOutofBound = shapes.indexOf(_this.parent.activeObj.shape) !== -1 ? false : true;\n                        shapeChangingArgs = { cancel: false, action: 'insert', previousShapeSettings: shapeSettings,\n                            currentShapeSettings: shapeSettings, allowShapeOverflow: allowOutofBound };\n                        parent.trigger('shapeChanging', shapeChangingArgs);\n                        parent.editCompleteArgs = shapeChangingArgs;\n                        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', value: { shapeSettings: shapeChangingArgs.currentShapeSettings } });\n                        break;\n                }\n                _this.updateToolbarItems();\n                var tempTogglePen = parent.togglePen;\n                if (args.item.id === 'pen') {\n                    parent.togglePen = false;\n                }\n                parent.notify('draw', { prop: 'redrawDownScale' });\n                parent.togglePen = tempTogglePen;\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_annotationBtn');\n    };\n    ToolbarModule.prototype.enableDisableCloneBtn = function (toolbarId, obj) {\n        var parent = this.parent;\n        var isDummyTextClick = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' &&\n            parent.activeObj.textSettings.fontSize === 11 && Math.floor(parent.activeObj.activePoint.width) === 55 &&\n            Math.floor(parent.activeObj.activePoint.height) === 11) {\n            isDummyTextClick = true;\n        }\n        var duplicateElement = document.querySelector(toolbarId + '_duplicate');\n        var removeElement = document.querySelector(toolbarId + '_remove');\n        var editTextElement = document.querySelector(toolbarId + '_editText');\n        var zOrderElement = document.querySelector(toolbarId + '_zOrderBtn');\n        if (isDummyTextClick || (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) &&\n            (isNullOrUndefined(parent.activeObj.pointColl) || (parent.activeObj.pointColl\n                && parent.activeObj.pointColl.length === 0)) &&\n            isNullOrUndefined(obj['freehandDrawSelectedId'])) {\n            if (duplicateElement) {\n                duplicateElement.classList.add('e-overlay');\n            }\n            if (removeElement) {\n                removeElement.classList.add('e-overlay');\n            }\n            if (editTextElement) {\n                editTextElement.classList.add('e-overlay');\n            }\n            if (zOrderElement) {\n                zOrderElement.classList.add('e-overlay');\n            }\n        }\n        else {\n            if (duplicateElement) {\n                duplicateElement.classList.remove('e-overlay');\n            }\n            if (removeElement) {\n                removeElement.classList.remove('e-overlay');\n            }\n            if (editTextElement) {\n                editTextElement.classList.remove('e-overlay');\n            }\n            if (zOrderElement) {\n                zOrderElement.classList.remove('e-overlay');\n            }\n        }\n        if (zOrderElement && (parent.shapeColl.length === 0 || (obj['freehandDrawSelectedId'] && parent.shapeColl.length === 1))) {\n            zOrderElement.classList.add('e-overlay');\n        }\n    };\n    ToolbarModule.prototype.renderStraightenSlider = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) &&\n            parent.element.querySelector('#' + id + '_straightenSlider')) {\n            var slider = this.createSlider(-45, 45, parent.cropObj.straighten, 'straighten');\n            slider.appendTo('#' + id + '_straightenSlider');\n            var sliderHandle = slider.element.querySelector('.e-handle');\n            if (sliderHandle && !Browser.isDevice) {\n                sliderHandle.addEventListener('mousedown', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n                sliderHandle.addEventListener('touchstart', function (e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                });\n            }\n        }\n    };\n    ToolbarModule.prototype.renderCropBtn = function (shapeString) {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        var isCustomized = false;\n        var defItems = ['CustomSelection', 'CircleSelection', 'SquareSelection', 'RatioSelection'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'circle', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '2:3', id: '2:3', iconCss: 'e-icons e-custom-f' });\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '3:4', id: '3:4', iconCss: 'e-icons e-custom-g' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '4:5', id: '4:5', iconCss: 'e-icons e-custom-h' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '5:7', id: '5:7', iconCss: 'e-icons e-custom-i' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '9:16', id: '9:16', iconCss: 'e-icons e-custom-j' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var iconCss;\n        var shape;\n        if (shapeString) {\n            iconCss = this.getCurrentShapeIcon(shapeString);\n            shape = shapeString;\n        }\n        else if (parent.activeObj.shape &&\n            (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) ||\n            (parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0)) {\n            iconCss = this.getCurrentShapeIcon(parent.activeObj.shape);\n            shape = parent.activeObj.shape;\n        }\n        else if (parent.currSelectionPoint) {\n            iconCss = this.getCurrentShapeIcon(parent.currSelectionPoint.shape);\n            shape = parent.currSelectionPoint.shape;\n        }\n        else {\n            iconCss = items[0].iconCss;\n            shape = items[0].id;\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (parent.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape.split('-').length > 1) {\n                    var elem = document.getElementById(parent.activeObj.shape.split('-')[1]);\n                    if (elem) {\n                        elem.classList.add('e-selected');\n                        elem.focus();\n                    }\n                }\n                parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                _this.cropSelect(args);\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon('crop-' + args.item.id);\n                drpDownBtn.content = Browser.isDevice ? null : parent.toPascalCase(args.item.id);\n            },\n            iconCss: 'e-icons ' + iconCss, cssClass: 'e-image-popup e-ie-crop-ddb-popup',\n            content: Browser.isDevice ? null : parent.toPascalCase(shape.replace('crop-', ''))\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_cropBtn');\n    };\n    ToolbarModule.prototype.renderTransformBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var elem = args.element.parentElement;\n                    var ht = elem.offsetHeight;\n                    elem.style.display = 'none';\n                    elem.style.top = drpDownBtn.element.getBoundingClientRect().top - ht + 'px';\n                    elem.style.display = 'block';\n                }\n            },\n            items: items,\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                parent.transformSelect.bind(_this);\n            },\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_transformBtn');\n    };\n    ToolbarModule.prototype.saveDialogPopup = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var quality = ['Good', 'Great', 'Highest'];\n        parent.element.appendChild(parent.createElement('div', { id: id + '_saveDialog' }));\n        var dialogContent = parent.createElement('div', {\n            id: id + '_dialogContent', attrs: { style: 'display: flex;' }\n        });\n        var dialogImgContent = dialogContent.appendChild(parent.createElement('div', {\n            id: id + '_dialogImgContent', className: 'e-ie-dlg-img-content'\n        }));\n        dialogImgContent.appendChild(parent.createElement('canvas', {\n            id: id + '_imgPic', className: 'e-ie-img-dlg-canvas'\n        }));\n        var imageNameContainer = dialogImgContent.appendChild(parent.createElement('div', {\n            id: id + '_imageNameContainer', className: 'e-ie-img-size'\n        }));\n        imageNameContainer.appendChild(parent.createElement('span', {\n            id: id + '_imageNameLabel', className: 'e-ie-quality-info'\n        }));\n        var dialogRightContent = dialogContent.appendChild(parent.createElement('div', {\n            id: id + '_dialogRightContent', className: 'e-ie-dlg-right-content'\n        }));\n        var imageNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_namediv', className: 'e-ie-img-save-name'\n        }));\n        imageNameDiv.appendChild(parent.createElement('span', {\n            id: id + '_labelImgname', className: 'e-ie-img-label-name', innerHTML: this.l10n.getConstant('ImageName')\n        }));\n        imageNameDiv.appendChild(parent.createElement('input', {\n            id: id + '_imgNametext', className: 'e-ie-img-input', attrs: { type: 'text' }\n        }));\n        var formatNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_imgNamediv', className: 'e-ie-img-save-dlg'\n        }));\n        formatNameDiv.appendChild(parent.createElement('span', {\n            id: id + '_labelname', className: 'e-ie-img-label-name', innerHTML: this.l10n.getConstant('Format')\n        }));\n        formatNameDiv.appendChild(parent.createElement('button', {\n            id: id + '_saveDropdownbtn', attrs: { tabindex: '1' }\n        }));\n        var qualityNameDiv = dialogRightContent.appendChild(parent.createElement('div', {\n            id: id + '_imgQualitydiv', className: 'e-ie-img-quality-name'\n        }));\n        var qualityDiv = parent.createElement('div', {\n            id: id + '_qualityContainer'\n        });\n        qualityDiv.appendChild(parent.createElement('span', {\n            id: id + '_qualityLabel', className: 'e-ie-img-quality-label',\n            innerHTML: this.l10n.getConstant('Quality')\n        }));\n        qualityDiv.appendChild(parent.createElement('span', {\n            id: id + '_qualityInfo', className: 'e-circle-info e-icons e-ie-quality-span',\n            attrs: { title: this.l10n.getConstant('QualityInfo') }\n        }));\n        var qualityValueElem = qualityDiv.appendChild(parent.createElement('div', {\n            id: id + '_imgsizeSpan',\n            className: 'e-ie-img-size-value-span'\n        }));\n        qualityValueElem.appendChild(parent.createElement('span', {\n            id: id + '_imgsizeValueSpan', className: ''\n        }));\n        qualityNameDiv.appendChild(qualityDiv);\n        var qualityOptionDiv = parent.createElement('div', {\n            id: id + '_qualityOptionContainer', className: 'e-ie-quality-option-container'\n        });\n        var buttonGroup = qualityNameDiv.appendChild(parent.createElement('div', {\n            id: id + '_qualityButtonGroup', className: 'e-btn-group'\n        }));\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        quality.forEach(function (option) {\n            var input = document.createElement('input');\n            input.type = 'radio';\n            input.id = id + '_' + option.toLowerCase();\n            input.name = 'quality';\n            input.value = option.toLowerCase();\n            var label = document.createElement('label');\n            label.className = 'e-btn';\n            label.htmlFor = option.toLowerCase();\n            label.textContent = _this.l10n.getConstant(option);\n            buttonGroup.appendChild(input);\n            buttonGroup.appendChild(label);\n        });\n        qualityOptionDiv.appendChild(buttonGroup);\n        qualityOptionDiv.appendChild(parent.createElement('div', {\n            id: id + '_qualitySlider', className: 'e-ie-img-quality-slider'\n        }));\n        qualityOptionDiv.appendChild(parent.createElement('button', { id: id + '_qualitybuttonIcon', className: 'e-ie-img-icon-button', attrs: { type: 'button' } }));\n        qualityNameDiv.appendChild(qualityOptionDiv);\n        if (Browser.isDevice) {\n            dialogRightContent.appendChild(parent.createElement('span', {\n                id: id + '_qualitySize', className: 'e-ie-img-quality-size'\n            }));\n        }\n        parent.element.querySelector('#' + id + '_saveDialog').style.display = 'block';\n        parent.element.appendChild(dialogContent);\n        var dialog = new Dialog({\n            target: parent.element,\n            header: this.l10n.getConstant('SaveAs'),\n            closeOnEscape: true, content: document.getElementById(id + '_dialogContent'),\n            width: Browser.isDevice ? '345px' : '570px', isModal: true, animationSettings: { effect: 'Zoom' }, beforeOpen: this.onBeforeopen(),\n            close: this.saveDialogClosed.bind(this, id),\n            cssClass: 'e-ie-save-dialog',\n            buttons: [\n                {\n                    'click': function () {\n                        dialog.hide();\n                    },\n                    buttonModel: {\n                        content: this.l10n.getConstant('Close'), cssClass: 'e-save-cancel-btn'\n                    }\n                },\n                {\n                    'click': function () {\n                        _this.download();\n                        dialog.hide();\n                        _this.isSlider = false;\n                    },\n                    buttonModel: {\n                        isPrimary: true, content: this.l10n.getConstant('Download'), cssClass: 'e-flat e-save-download-btn'\n                    }\n                }\n            ]\n        });\n        dialog.appendTo('#' + id + '_saveDialog');\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ToolbarModule.prototype.saveDialogClosed = function (id) {\n        if (getComponent(document.getElementById(id + '_saveDropdownbtn'), 'dropdownbutton')) {\n            getComponent(document.getElementById(id + '_saveDropdownbtn'), 'dropdownbutton').destroy();\n        }\n        this.isSlider = false;\n        if (document.querySelector('#' + id + '_qualityButtonGroup') &&\n            document.querySelector('#' + id + '_qualitySlider')) {\n            document.querySelector('#' + id + '_qualityButtonGroup').remove();\n            document.querySelector('#' + id + '_qualitySlider').remove();\n            document.querySelector('#' + id + '_imgsizeValueSpan').remove();\n            document.querySelector('#' + id + '_imageNameLabel').remove();\n            document.querySelector('#' + id + '_imgsizeSpan').remove();\n        }\n        document.getElementById(id + '_dialogContent').remove();\n        getComponent(document.getElementById(id + '_saveDialog'), 'dialog').destroy();\n        document.getElementById(id + '_saveDialog').remove();\n    };\n    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n    ToolbarModule.prototype.onBeforeopen = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var obj = { canvas: null };\n        var items = [\n            { id: 'jpeg', text: 'JPEG' },\n            { id: 'png', text: 'PNG' },\n            { id: 'svg', text: 'SVG' },\n            { id: 'webp', text: 'WebP' }\n        ];\n        var inputObj = new TextBox({\n            placeholder: this.l10n.getConstant('ImageName')\n        });\n        inputObj.appendTo('#' + id + '_imgNametext');\n        var qualityContainer = document.getElementById(id + '_imgQualitydiv');\n        var slider = document.getElementById(id + '_qualitySlider');\n        var qualityBtnGrp = document.querySelector('#' + id + '_qualityButtonGroup');\n        var qualityBtnIcon = document.querySelector('#' + id + '_qualitybuttonIcon');\n        var qualitySliderValue = document.querySelector('#' + id + '_imgsizeSpan');\n        var imageNameLabel;\n        if (Browser.isDevice) {\n            imageNameLabel = document.getElementById(id + '_qualitySize');\n        }\n        else {\n            imageNameLabel = document.getElementById(id + '_imageNameLabel');\n        }\n        var fileObj = { fileName: '', fileType: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: fileObj } });\n        this.fileType = fileObj['fileType'] ? fileObj['fileType'] : 'JPEG';\n        parent.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        var tempCanvas = obj['canvas'];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var canvas = document.getElementById(id + '_imgPic');\n        canvas.width = tempCanvas.width;\n        canvas.height = tempCanvas.height;\n        var buttonIcon = new Button({ iconCss: 'e-icons e-settings' });\n        buttonIcon.appendTo('#' + id + '_qualitybuttonIcon');\n        var ddbElem = document.getElementById(id + '_saveDropdownbtn');\n        if (ddbElem) {\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.fileType === 'Webp' ? 'Webp' : this.fileType.toUpperCase();\n            if (ddbElem) {\n                ddbElem.appendChild(spanElem_1);\n            }\n            var drpDownBtn_1 = new DropDownButton({\n                items: items,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    qualitySliderValue.style.display = 'none';\n                    _this.fileType = spanElem_1.innerHTML = args.item.text;\n                    if (args.item.id !== 'jpeg') {\n                        qualityContainer.style.display = 'none';\n                        imageNameLabel.style.display = 'block';\n                        _this.updateImageSize(1, obj['canvas'], _this.fileType);\n                        if (slider) {\n                            if (_this.isSlider) {\n                                getComponent(slider, 'slider').destroy();\n                            }\n                            slider.style.display = 'none';\n                        }\n                        _this.isSlider = false;\n                    }\n                    else {\n                        qualityContainer.style.display = 'block';\n                        removeClass([qualityBtnGrp], 'e-hide');\n                        slider.style.display = 'none';\n                        imageNameLabel.style.display = 'block';\n                        _this.updateImageSize(isNullOrUndefined(_this.currentQuality) ? 1 : _this.currentQuality, obj['canvas'], _this.fileType);\n                        document.getElementById(id + '_' + _this.imageQuality).checked = true;\n                    }\n                }\n            });\n            drpDownBtn_1.appendTo('#' + id + '_saveDropdownbtn');\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var imgName = document.getElementById(id + '_imgNametext');\n            imgName.value = this.fileName ? this.fileName : fileObj['fileName'];\n            if (fileObj['fileType'] && fileObj['fileType'].toUpperCase() !== 'JPEG') {\n                qualityContainer.style.display = 'none';\n                qualitySliderValue.style.display = 'none';\n            }\n            if (Browser.isDevice) {\n                document.getElementById(id + '_dialogImgContent').style.display = 'none';\n                document.getElementById(id + '_dialogRightContent').style.width = '100%';\n                this.updateImageSize(1, obj['canvas'], this.fileType);\n            }\n            else {\n                this.updateImageSize(1, obj['canvas'], this.fileType);\n            }\n        }\n        document.getElementById(id + '_' + this.imageQuality).checked = true;\n        qualityBtnGrp.addEventListener('click', this.qualityBtnClickHandler.bind(this));\n        qualityBtnIcon.addEventListener('click', this.qualityBtnClickHandler.bind(this));\n    };\n    ToolbarModule.prototype.qualityBtnClickHandler = function (event) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var target = event.target;\n        var fileObj = { fileName: '' };\n        var obj = { canvas: null };\n        var compressionValues = {\n            'Good': 0.8,\n            'Great': 0.9,\n            'Highest': 1\n        };\n        var qualityBtnGrp = document.querySelector('#' + id + '_qualityButtonGroup');\n        var qualitySlider = document.querySelector('#' + id + '_qualitySlider');\n        var qualityOption = document.querySelector('#' + id + '_qualityOptionContainer');\n        var qualitySliderValueDiv = document.querySelector('#' + id + '_imgsizeSpan');\n        var qualitySliderValueSpan = document.querySelector('#' + id + '_imgsizeValueSpan');\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: fileObj } });\n        parent.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        if (event.currentTarget.id === id + '_qualitybuttonIcon' && !this.isSlider) {\n            addClass([qualityBtnGrp], 'e-hide');\n            qualitySlider.style.display = 'block';\n            qualitySliderValueDiv.style.display = 'inline-block';\n            qualityOption.style.display = 'flex';\n            var sliderObj = new Slider({\n                tooltip: { placement: 'Before', isVisible: true, format: 'P0', showOn: 'Focus' },\n                min: 0.01, max: 1, step: 0.01, value: this.currentQuality,\n                type: 'MinRange',\n                width: Browser.isDevice ? '80%' : '190px',\n                created: function () {\n                    _this.updateImageSize(_this.currentQuality, obj['canvas'], 'jpeg');\n                    qualitySliderValueSpan.innerHTML = (Math.round(_this.currentQuality * 100)).toString();\n                },\n                changed: function (args) {\n                    _this.currentQuality = args.value;\n                    qualitySliderValueSpan.innerHTML = (Math.round(_this.currentQuality * 100)).toString();\n                    parent.notify('export', { prop: 'setImageQuality', value: { value: args.value } });\n                    _this.updateImageSize(args.value, obj['canvas'], 'jpeg');\n                }\n            });\n            sliderObj.appendTo('#' + id + '_qualitySlider');\n            sliderObj.element.parentElement.classList.add('e-ie-quality-slider');\n            this.isSlider = true;\n        }\n        else if (event.currentTarget.id === id + '_qualitybuttonIcon' && this.isSlider) {\n            getComponent(qualitySlider, 'slider').destroy();\n            qualitySlider.style.display = 'none';\n            qualitySliderValueDiv.style.display = 'none';\n            removeClass([qualityBtnGrp], 'e-hide');\n            qualityOption.style.display = 'block';\n            this.isSlider = false;\n            // eslint-disable-next-line no-prototype-builtins\n        }\n        else if (compressionValues.hasOwnProperty(target.textContent) && !this.isSlider) {\n            event.target.previousElementSibling.checked = true;\n            this.currentQuality = compressionValues[target.textContent];\n            this.imageQuality = target.textContent.toLowerCase();\n            this.updateImageSize(compressionValues[target.textContent], obj['canvas'], 'jpeg');\n        }\n    };\n    ToolbarModule.prototype.updateImageSize = function (quality, tempCanvas, fileType) {\n        var fileSize;\n        var parent = this.parent;\n        var id = parent.element.id;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var canvas = document.getElementById(id + '_imgPic');\n        var ctx = canvas.getContext('2d');\n        var imageNameLabel;\n        if (Browser.isDevice) {\n            imageNameLabel = document.getElementById(id + '_qualitySize');\n        }\n        else {\n            imageNameLabel = document.getElementById(id + '_imageNameLabel');\n        }\n        if (fileType.toLowerCase() === 'jpeg') {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            tempCanvas.toBlob((function (blob) {\n                fileSize = Math.floor(blob.size / 1024);\n                if (fileSize > 1000) {\n                    var megabytes = fileSize / 1024;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                    fileSize = +megabytes.toFixed(2);\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize.toFixed(2) + ' KB';\n                    fileSize = +fileSize.toFixed(2);\n                }\n                if (Browser.isDevice) {\n                    canvas.style.display = 'none';\n                }\n                else {\n                    var compressedImage_1 = new Image();\n                    compressedImage_1.src = URL.createObjectURL(blob);\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    compressedImage_1.onload = function () {\n                        ctx.drawImage(compressedImage_1, 0, 0);\n                        URL.revokeObjectURL(compressedImage_1.src);\n                    };\n                }\n                this.fileSize = fileSize;\n            }).bind(this), 'image/jpeg', quality);\n        }\n        else if (!isNullOrUndefined(fileType) && (fileType.toLowerCase() === 'png' || fileType.toLowerCase() === 'webp')) {\n            var type = 'image/' + fileType.toLowerCase();\n            ctx.drawImage(tempCanvas, 0, 0);\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            tempCanvas.toBlob((function (blob) {\n                fileSize = Math.floor(blob.size / 1024);\n                if (fileSize > 1000) {\n                    var megabytes = fileSize / 1024;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                    fileSize = +megabytes.toFixed(2);\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize.toFixed(2) + ' KB';\n                    fileSize = +fileSize.toFixed(2);\n                }\n                if (Browser.isDevice) {\n                    canvas.style.display = 'none';\n                }\n                this.fileSize = fileSize;\n            }).bind(this), type, 1);\n        }\n        else if (!isNullOrUndefined(fileType) && fileType.toLowerCase() === 'svg') {\n            ctx.drawImage(tempCanvas, 0, 0);\n            var svgDataUrl = tempCanvas.toDataURL('image/svg+xml');\n            var base64Data = svgDataUrl.split(',')[1];\n            var binaryStringLength = base64Data.length;\n            var rawByteSize = binaryStringLength;\n            var fileSize_1 = Math.floor(rawByteSize / 1024); // KB\n            if (fileSize_1 > 1000) {\n                var megabytes = fileSize_1 / 1024; // Convert to MB\n                imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                fileSize_1 = +megabytes.toFixed(2);\n            }\n            else {\n                imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + fileSize_1.toFixed(2) + ' KB';\n                fileSize_1 = +fileSize_1.toFixed(2);\n            }\n            if (Browser.isDevice) {\n                canvas.style.display = 'none';\n            }\n            this.fileSize = fileSize_1;\n        }\n        else {\n            if (Browser.isDevice) {\n                canvas.style.display = 'none';\n            }\n            else {\n                ctx.drawImage(tempCanvas, 0, 0);\n                if (this.initialSize > 1000) {\n                    var megabytes = this.initialSize / 1048576;\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + megabytes.toFixed(2) + ' MB';\n                }\n                else {\n                    imageNameLabel.innerHTML = this.l10n.getConstant('ImageSize') + ': ' + this.initialSize.toFixed(2) + ' KB';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.download = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (this.fileType === 'JPEG' && this.isSlider) {\n            var value = getComponent(document.getElementById(id + '_qualitySlider'), 'slider').value;\n            parent.notify('export', { prop: 'setImageQuality', value: { value: value } });\n        }\n        else {\n            parent.notify('export', { prop: 'setImageQuality', value: { value: this.currentQuality } });\n        }\n        var fileName = document.getElementById(id + '_imgNametext').value;\n        parent.export(this.fileType, fileName);\n    };\n    ToolbarModule.prototype.getCropTransformToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ id: id + '_crop', tooltipText: this.l10n.getConstant('CropSelection'), align: 'Center',\n            template: '<button id=\"' + id + '_cropBtn\"></button>'\n        });\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateLeft') > -1))) {\n            toolbarItems.push({ id: id + '_rotateLeft', prefixIcon: 'e-icons e-anti-clock-wise', tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('RotateRight') > -1))) {\n            toolbarItems.push({ id: id + '_rotateRight', prefixIcon: 'e-icons e-clock-wise', tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n        }\n        if (toolbarItems.length > 2) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('HorizontalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_horizontalFlip', prefixIcon: 'e-icons e-horizontal-flip', tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Transform') > -1 || parent.toolbar.indexOf('VerticalFlip') > -1))) {\n            toolbarItems.push({ id: id + '_verticalFlip', prefixIcon: 'e-icons e-vertical-flip', tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1)) && !Browser.isDevice) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && (parent.toolbar.indexOf('Straighten') > -1 || parent.toolbar.indexOf('Straighten') > -1))) {\n                var spanWidth = document.createElement('span');\n                spanWidth.innerHTML = this.l10n.getConstant('Straighten');\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-span', template: spanWidth, align: 'Center' });\n                toolbarItems.push({ id: id + '_straighten',\n                    cssClass: 'top-icon e-straighten', tooltipText: this.l10n.getConstant('Straighten'), align: 'Center', type: 'Input',\n                    template: '<div id=\"' + id + '_straightenSlider\"></div>' });\n                var straightenSpan = document.createElement('span');\n                straightenSpan.innerHTML = parent.transform.straighten.toString() + '&#176';\n                toolbarItems.push({ id: id + '_straightenSpan', cssClass: 'e-ie-straighten-value-span',\n                    template: straightenSpan, align: 'Center' });\n            }\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getShapesToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('StrokeWidth'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('start') > -1) {\n            toolbarItems.push({ id: id + '_start', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Start'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_startBtn\"></button>' });\n        }\n        if (items.indexOf('borderRadius') > -1) {\n            toolbarItems.push({ id: id + '_rectangleRadius', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('BorderRadius'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_rectangleRadiusBtn\"></button>' });\n        }\n        if (items.indexOf('end') > -1) {\n            toolbarItems.push({ id: id + '_end', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('End'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_endBtn\"></button>' });\n        }\n        if (items.indexOf('flip') > -1) {\n            toolbarItems.push({ id: id + '_rotLeft', prefixIcon: 'e-anti-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n            toolbarItems.push({ id: id + '_rotRight', prefixIcon: 'e-clock-wise',\n                tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n            toolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-horizontal-flip',\n                tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n            toolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-vertical-flip',\n                tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ align: 'Center', type: 'Separator' });\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] !== 'path') {\n                toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                    tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n                toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initCropTransformToolbar = function (shape, isTransform) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getCropTransformToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'crop-transform', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderCropBtn(shape);\n                _this.renderStraightenSlider();\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                if (document.getElementById(id + '_cropBtn') && isNullOrUndefined(isTransform)) {\n                    if (!Browser.isDevice) {\n                        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n                            value: { type: _this.getCropTextContent(document.getElementById(id + '_cropBtn')).toLowerCase(),\n                                startX: null, startY: null, width: null, height: null } });\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        var slider = parent.element.querySelector('#' + id + '_straightenSlider');\n        if ((isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Straightening') > -1))\n            && slider && slider.parentElement.clientHeight > this.toolbarHeight) {\n            this.toolbarHeight = parent.toolbarHeight = slider.parentElement.clientHeight;\n        }\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.getCropTextContent = function (elem) {\n        if (elem) {\n            var classToContentMap = { 'e-custom': 'Custom', 'e-circle': 'Circle',\n                'e-square': 'Square', 'e-custom-a': '3:2', 'e-custom-b': '4:3', 'e-custom-c': '5:4', 'e-custom-d': '7:5',\n                'e-custom-e': '16:9', 'e-custom-f': '2:3', 'e-custom-g': '3:4', 'e-custom-h': '4:5', 'e-custom-i': '5:7',\n                'e-custom-j': '9:16'\n            };\n            var classList = elem.children[0].classList;\n            for (var className in classToContentMap) {\n                if (classList.contains(className)) {\n                    return classToContentMap[className];\n                }\n            }\n        }\n        return '';\n    };\n    ToolbarModule.prototype.getCurrentShapeIcon = function (shape) {\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        var shapeIcons = {\n            rectangle: 'e-rectangle',\n            ellipse: 'e-circle',\n            line: 'e-line',\n            arrow: 'e-arrow-right-up',\n            path: 'e-critical-path',\n            text: 'e-add-text',\n            image: 'e-image',\n            pen: 'e-free-pen',\n            'crop-custom': 'e-custom',\n            'crop-circle': 'e-circle',\n            'crop-square': 'e-square',\n            'crop-3:2': 'e-custom-a',\n            'crop-4:3': 'e-custom-b',\n            'crop-5:4': 'e-custom-c',\n            'crop-7:5': 'e-custom-d',\n            'crop-16:9': 'e-custom-e',\n            'crop-2:3': 'e-custom-f',\n            'crop-3:4': 'e-custom-g',\n            'crop-4:5': 'e-custom-h',\n            'crop-5:7': 'e-custom-i',\n            'crop-9:16': 'e-custom-j'\n        };\n        return shapeIcons[shape] ? shapeIcons[shape] : (shape && shape.indexOf('crop-') !== -1) ? 'e-custom' : 'e-free-pen';\n    };\n    ToolbarModule.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: parent.activeObj.shape ? parent.activeObj.shape : 'shapes',\n            toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createRectangleRadius(items);\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                _this.createZOrderBtn(items);\n                if (parent.activeObj.shape === 'arrow') {\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('start') > -1; })) {\n                        _this.createStartBtn();\n                    }\n                    // eslint-disable-next-line @typescript-eslint/tslint/config\n                    if (items.some(function (item) { return item.toLowerCase().indexOf('end') > -1; })) {\n                        _this.createEndBtn();\n                    }\n                }\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createRectangleRadius = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('borderRadius') > -1) {\n            var strokeWidthItems = [\n                { id: '1', text: this.l10n.getConstant('0') },\n                { id: '2', text: this.l10n.getConstant('20') },\n                { id: '3', text: this.l10n.getConstant('40') },\n                { id: '4', text: this.l10n.getConstant('60') },\n                { id: '5', text: this.l10n.getConstant('80') },\n                { id: '6', text: this.l10n.getConstant('100') }\n            ];\n            var strokeWidthBtn = document.getElementById(id + '_rectangleRadiusBtn');\n            var spanElem_2 = document.createElement('span');\n            spanElem_2.innerHTML = this.l10n.getConstant(parent.frameObj.radius.toString());\n            spanElem_2.className = 'e-shape-rectangle-radius';\n            strokeWidthBtn.appendChild(spanElem_2);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        var parentElem = args.element.parentElement;\n                        parentElem.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            parentElem.offsetHeight + 'px';\n                    }\n                    var activeBtn = drpDownBtn_2.element.childNodes[0].textContent;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_2.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id, 'radius');\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_7 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_7.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + id + '_rectangleRadiusBtn');\n        }\n    };\n    ToolbarModule.prototype.beforeModeSwitch = function (args, inst) {\n        this.popupLeft = args.element.offsetParent.style.left;\n        if (args.mode === 'Picker') {\n            inst.showButtons = true;\n            inst.dataBind();\n            args.element.querySelector('.e-apply').title = this.l10n.getConstant('Apply');\n            args.element.querySelector('.e-cancel').title = this.l10n.getConstant('Cancel');\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('StandardColors');\n        }\n        else {\n            inst.showButtons = false;\n            inst.dataBind();\n            args.element.querySelector('.e-mode-switch-btn').title = this.l10n.getConstant('MoreColors');\n        }\n    };\n    ToolbarModule.prototype.createShapeColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fillColor') > -1) {\n            parent.element.querySelector('.e-template.e-fill').appendChild(parent.createElement('input', {\n                id: id + '_shape_fill'\n            }));\n            var fillColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                beforeModeSwitch: function (args) { return _this.beforeModeSwitch(args, fillColor_1); },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateFillColor(args.value);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (fillDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    fillDDB_1.toggle();\n                }\n            }, '#' + id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fillColorBtn');\n            fillColor_1.inline = true;\n            fillColor_1.value = fillColor_1.getValue(fillColor_1.value, 'rgba');\n            parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n                id: id + '_shape_stroke'\n            }));\n            var strokeColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    strokeColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, strokeColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateStrokeColor(args.value);\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_1.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_borderColorBtn');\n            strokeColor_1.inline = true;\n            strokeColor_1.value = strokeColor_1.getValue(strokeColor_1.value, 'rgba');\n            parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createShapeBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthItems = [\n                { id: '1', text: this.l10n.getConstant('XSmall') },\n                { id: '2', text: this.l10n.getConstant('Small') },\n                { id: '3', text: this.l10n.getConstant('Medium') },\n                { id: '4', text: this.l10n.getConstant('Large') },\n                { id: '5', text: this.l10n.getConstant('XLarge') }\n            ];\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse')) {\n                strokeWidthItems = [\n                    { id: '1', text: this.l10n.getConstant('NoOutline') },\n                    { id: '2', text: this.l10n.getConstant('XSmall') },\n                    { id: '3', text: this.l10n.getConstant('Small') },\n                    { id: '4', text: this.l10n.getConstant('Medium') },\n                    { id: '5', text: this.l10n.getConstant('Large') },\n                    { id: '6', text: this.l10n.getConstant('XLarge') }\n                ];\n            }\n            var strokeWidthBtn = document.getElementById(id + '_borderWidthBtn');\n            var spanElem_3 = document.createElement('span');\n            spanElem_3.innerHTML = this.l10n.getConstant('XSmall');\n            spanElem_3.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_3 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_3.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_3.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id, 'width', parent.activeObj.shape);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_9 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_9.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_10 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_10.refreshOverflow();\n                        }\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_3.appendTo('#' + id + '_borderWidthBtn');\n        }\n    };\n    ToolbarModule.prototype.createZOrderBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('z-order') > -1) {\n            var zOrderItems = [\n                { text: this.l10n.getConstant('BringForward'), id: 'bringForward', iconCss: 'e-icons e-bring-forward' },\n                { text: this.l10n.getConstant('SendBackward'), id: 'sendBackward', iconCss: 'e-icons e-send-backward' },\n                { text: this.l10n.getConstant('BringToFront'), id: 'bringToFront', iconCss: 'e-icons e-bring-to-front' },\n                { text: this.l10n.getConstant('SendToBack'), id: 'sendToBack', iconCss: 'e-icons e-send-to-back' }\n            ];\n            // Initialize the DropDownButton component.\n            var drpDownBtn_4 = new DropDownButton({ items: zOrderItems, iconCss: 'e-icons e-layers',\n                beforeOpen: function (args) {\n                    if (document.getElementById(parent.element.id + '_zOrderBtn').classList.contains('e-disabled')) {\n                        args.cancel = true;\n                    }\n                    var indexObj = { freehandSelectedIndex: -1 };\n                    parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                    var orderObj = { order: null };\n                    parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    var order = parent.activeObj.order ? parent.activeObj.order : parent.getObjFromId(parent.pointColl[indexObj['freehandSelectedIndex']].id).order;\n                    if (order && order >= orderObj['order']) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[0].disabled = true;\n                        args.items[2].disabled = true;\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[0].disabled = false;\n                        args.items[2].disabled = false;\n                    }\n                    parent.notify('shape', { prop: 'getLowestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                    if (order && order <= orderObj['order']) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[1].disabled = true;\n                        args.items[3].disabled = true;\n                    }\n                    else {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        args.items[1].disabled = false;\n                        args.items[3].disabled = false;\n                    }\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_4.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    var obj = { freehandDrawSelectedId: null };\n                    parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n                    var shapeId = obj['freehandDrawSelectedId'] ? obj['freehandDrawSelectedId'] : parent.activeObj.currIndex;\n                    parent.updateShapeOrder(shapeId, args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_11 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_11.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_12 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_12.refreshOverflow();\n                        }\n                    }\n                    if (shapeId.indexOf('shape') > -1) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    else if (shapeId.indexOf('pen') > -1) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_4.appendTo('#' + id + '_zOrderBtn');\n        }\n    };\n    ToolbarModule.prototype.createStartBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_startBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.start)) {\n            parent.activeObj.start = 'none';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.start);\n        spanElem.className = 'e-shape-start';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n                    '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n                parent.notify('selection', { prop: 'setArrowShape', value: { type: 'initial', shape: idToValue[\"\" + args.item.id] } });\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('startArrow', args.item.id);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_startBtn');\n    };\n    ToolbarModule.prototype.createEndBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeEndBtn = document.getElementById(id + '_endBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.end)) {\n            parent.activeObj.end = 'arrowSolid';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.end);\n        spanElem.className = 'e-shape-end';\n        strokeEndBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n                    '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n                parent.notify('selection', { prop: 'setArrowShape', value: { type: 'final', shape: idToValue[\"\" + args.item.id] } });\n                _this.triggerTbarClickEvent(args);\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('endArrow', args.item.id);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_endBtn');\n    };\n    ToolbarModule.prototype.getTextToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_fontColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-stroke-text-font-color', id: id + '_stroke_text_color',\n                tooltipText: this.l10n.getConstant('TextOutlineColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_strokeTextColorBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-background-color', id: id + '_text_backgroundcolor',\n                tooltipText: this.l10n.getConstant('FillColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_bgColorBtn\"></button>'\n            });\n        }\n        if (items.indexOf('bold') > -1) {\n            toolbarItems.push({ id: id + '_bold', prefixIcon: 'e-icons e-bold', cssClass: 'top-icon e-bold',\n                tooltipText: this.l10n.getConstant('Bold'), align: 'Center' });\n        }\n        if (items.indexOf('italic') > -1) {\n            toolbarItems.push({ id: id + '_italic', prefixIcon: 'e-icons e-italic', cssClass: 'top-icon e-italic',\n                tooltipText: this.l10n.getConstant('Italic'), align: 'Center' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('TextOutlineWidth'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('transparency') > -1) {\n            toolbarItems.push({ id: id + '_transparency', prefixIcon: 'e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center', disabled: (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') ? true : false });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFontFamilyItems = function () {\n        var parent = this.parent;\n        var items = [];\n        if (parent.fontFamily && parent.fontFamily.items && parent.fontFamily.items.length > 0) {\n            items = parent.fontFamily.items;\n        }\n        else {\n            if (Browser.isDevice) {\n                items = [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                    { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n            }\n            else {\n                items = [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n                    { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n            }\n        }\n        return items;\n    };\n    ToolbarModule.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'text', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createTextColor(items);\n                _this.createStrokeTextColor(items);\n                _this.createShapeBtn(items);\n                _this.createBackgroundColor(items);\n                _this.createTextBtn(items);\n                _this.createZOrderBtn(items);\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createTextColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontColor') > -1 && parent.element.querySelector('.e-template.e-text-font-color')) {\n            parent.element.querySelector('.e-template.e-text-font-color').appendChild(parent.createElement('input', {\n                id: id + '_text_font'\n            }));\n            var fontColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: false, value: '#fff', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    fontColor_1.value = parent.activeObj.strokeSettings.strokeColor !== '#fff' ? parent.activeObj.strokeSettings.strokeColor : '#008000ff';\n                    _this.beforeModeSwitch(args, fontColor_1);\n                },\n                presetColors: this.presetColors,\n                change: function (args) {\n                    parent.updateFontColor(args.value, 'Text');\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_2.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_fontColorBtn');\n            fontColor_1.inline = true;\n            fontColor_1.value = fontColor_1.getValue(fontColor_1.value, 'rgba');\n            parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createBackgroundColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fillColor') > -1 && parent.element.querySelector('.e-template.e-text-background-color')) {\n            parent.element.querySelector('.e-template.e-text-background-color').appendChild(parent.createElement('input', {\n                id: id + '_text_bgColor'\n            }));\n            var backgroundColor_1 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    _this.beforeModeSwitch(args, backgroundColor_1);\n                },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateFontColor(args.value, 'Background');\n                    if (args.currentValue.rgba === '') {\n                        strokeDDB_3.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        strokeDDB_3.element.children[0].classList.remove('e-nocolor-item');\n                        strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    strokeDDB_3.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_3.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + id + '_text_bgColor');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_bgColorBtn');\n            backgroundColor_1.inline = true;\n            backgroundColor_1.value = backgroundColor_1.getValue(backgroundColor_1.value, 'rgba');\n            parent.element.querySelector('.e-text-background-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createStrokeTextColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeColor') > -1 && parent.element.querySelector('.e-template.e-stroke-text-font-color')) {\n            parent.element.querySelector('.e-template.e-stroke-text-font-color').appendChild(parent.createElement('input', {\n                id: id + '_stroke_text'\n            }));\n            var fontColor_2 = new ColorPicker({\n                modeSwitcher: true, noColor: true, value: '', inline: true,\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                beforeModeSwitch: function (args) {\n                    _this.popupLeft = args.element.offsetParent.style.left;\n                    _this.beforeModeSwitch(args, fontColor_2);\n                },\n                presetColors: {\n                    'custom': ['', '#f44336', '#e91e63', '#9c27b0', '#673ab7', '#2196f3',\n                        '#03a9f4', '#00bcd4', '#009688', '#ffeb3b', '#ffffff', '#ffebee', '#fce4ec', '#f3e5f5', '#ede7f6', '#e3f2fd',\n                        '#e1f5fe', '#e0f7fa', '#e0f2f1', '#fffde7', '#f2f2f2', '#ffcdd2', '#f8bbd0', '#e1bee7', '#d1c4e9', '#bbdefb',\n                        '#b3e5fc', '#b2ebf2', '#b2dfdb', '#fff9c4', '#e6e6e6', '#ef9a9a', '#f48fb1', '#ce93d8', '#b39ddb', '#90caf9',\n                        '#81d4fa', '#80deea', '#80cbc4', '#fff59d', '#cccccc', '#e57373', '#f06292', '#ba68c8', '#9575cd', '#64b5f6',\n                        '#4fc3f7', '#4dd0e1', '#4db6ac', '#fff176', '#b3b3b3', '#ef5350', '#ec407a', '#ab47bc', '#7e57c2', '#42a5f5',\n                        '#29b6f6', '#26c6da', '#26a69a', '#ffee58', '#999999', '#e53935', '#d81b60', '#8e24aa', '#5e35b1', '#1e88e5',\n                        '#039be5', '#00acc1', '#00897b', '#fdd835', '#808080', '#d32f2f', '#c2185b', '#7b1fa2', '#512da8', '#1976d2',\n                        '#0288d1', '#0097a7', '#00796b', '#fbc02d', '#666666', '#c62828', '#ad1457', '#6a1b9a', '#4527a0', '#1565c0',\n                        '#0277bd', '#00838f', '#00695c', '#f9a825', '#4d4d4d', '#b71c1c', '#880e4f', '#4a148c', '#311b92', '#0d47a1',\n                        '#01579b', '#006064', '#004d40', '#f57f17']\n                },\n                beforeTileRender: function (args) {\n                    if (args.value === '') {\n                        args.element.classList.add('e-nocolor-item');\n                    }\n                },\n                change: function (args) {\n                    parent.updateStrokeTextColor(args.value);\n                    if (args.currentValue.rgba === '') {\n                        strokeDDB_4.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        strokeDDB_4.element.children[0].classList.remove('e-nocolor-item');\n                        strokeDDB_4.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    strokeDDB_4.toggle();\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                },\n                onModeSwitch: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.parentElement.style.left = _this.popupLeft;\n                        args.element.parentElement.parentElement.style.top = (strokeDDB_4.element.getBoundingClientRect().top - args.element.parentElement.parentElement.offsetHeight) + 'px';\n                    }\n                },\n                beforeClose: function () {\n                    strokeDDB_4.toggle();\n                }\n            }, '#' + id + '_stroke_text');\n            var strokeDDB_4 = new DropDownButton({\n                open: function (args) {\n                    var parenElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parenElem.style.top = strokeDDB_4.element.getBoundingClientRect().top -\n                            parenElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parenElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_strokeTextColorBtn');\n            fontColor_2.inline = true;\n            fontColor_2.value = fontColor_2.getValue(fontColor_2.value, 'rgba');\n            parent.element.querySelector('.e-stroke-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createTextBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(id + '_fontFamilyBtn');\n            var spanElem_4 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_4.innerHTML = 'ABC';\n                spanElem_4.setAttribute('style', 'font-family: ' + parent.fontFamily.default.toLowerCase() + '\\'');\n            }\n            else {\n                spanElem_4.innerHTML = parent.fontFamily.default;\n            }\n            spanElem_4.className = 'e-text-font-family';\n            if (fontNameBtn) {\n                fontNameBtn.appendChild(spanElem_4);\n            }\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (parent.textArea.style.display === 'block' || parent.textArea.style.display === 'inline-block') {\n                        fontFamily = parent.textArea.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = parent.activeObj.textSettings.fontFamily;\n                    }\n                    var elem = args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase() + '\"' + ']');\n                    if (elem) {\n                        elem.classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_4.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_4.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    parent.updateFontFamily(args.item.id);\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    var toolbar = document.getElementById(parent.element.id + '_toolbar');\n                    if (toolbar && toolbar.classList.contains('e-control')) {\n                        getComponent(toolbar, 'toolbar').refreshOverflow();\n                    }\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = parent.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    parent.updateFontSize(args.item.text);\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + id + '_fontSizeBtn');\n        }\n    };\n    ToolbarModule.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming, cType, shape, isTransform) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded || parent.isCropToolbar) {\n            return;\n        }\n        var args = {};\n        var aspectIcon;\n        var nonAspectIcon;\n        if (type !== 'filter' && type !== 'color') {\n            var toolbarElement = document.getElementById(id + '_toolbar');\n            var cusWrapper = document.getElementById(id + '_customizeWrapper');\n            var bottomToolbar = document.getElementById(id + '_bottomToolbar');\n            if (cusWrapper && (getComponent(cusWrapper, 'toolbar')) && this.defToolbarItems.length > 0) {\n                getComponent(cusWrapper, 'toolbar').destroy();\n                cusWrapper.innerHTML = '';\n            }\n            if (toolbarElement && toolbarElement.classList.contains('e-control') && this.defToolbarItems.length > 0) {\n                getComponent(toolbarElement, 'toolbar').destroy();\n                toolbarElement.innerHTML = '';\n            }\n            if (toolbarElement && (this.defToolbarItems.length > 0 || parent.toolbar && parent.toolbar.length > 0 && parent.toolbar.indexOf('Open') === -1)) {\n                var toolbar_13 = getComponent(toolbarElement, 'toolbar');\n                if (!isNullOrUndefined(toolbar_13)) {\n                    toolbar_13.destroy();\n                    document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n                }\n            }\n            if (bottomToolbar && this.defToolbarItems.length > 0) {\n                if (bottomToolbar.className.indexOf('e-control') > -1) {\n                    getComponent(bottomToolbar, 'toolbar').destroy();\n                    bottomToolbar.innerHTML = '';\n                }\n            }\n        }\n        this.refreshSlider();\n        if (document.querySelector('.e-slider-tooltip')) {\n            document.querySelector('.e-slider-tooltip').remove();\n        }\n        this.isFrameToolbar = parent.isCropTab = false;\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initMainToolbar(false, true, true, false, false, true);\n                    }\n                    else {\n                        this.initMainToolbar(false, true, null, false, false, true);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    if (isZooming) {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                    else {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                parent.noPushUndo = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'path') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'z-order', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'arrow') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'start', 'end', 'z-order', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'image') {\n                    args.toolbarItems = ['flip', 'z-order', 'duplicate', 'remove', 'transparency'];\n                }\n                else if (parent.activeObj.shape === 'rectangle') {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'borderRadius', 'z-order', 'duplicate', 'remove'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'z-order', 'duplicate', 'remove'];\n                }\n                this.initShapesToolbarItem(args.toolbarItems);\n                if (parent.activeObj.shape === 'image') {\n                    var actObj = extend({}, parent.activeObj, {}, true);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.activeObj = actObj;\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj,\n                            isCropRatio: null, points: null, isPreventDrag: true } });\n                    this.renderQAT(false);\n                }\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontSize', 'fontColor', 'fillColor', 'strokeColor', 'strokeWidth', 'bold', 'italic', 'z-order', 'duplicate', 'remove', 'text'];\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth', 'z-order', 'remove', 'transparency'];\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'adjustment':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                this.initAdjustmentToolbarItem();\n                break;\n            case 'filter':\n                this.updateContextualToolbar(type);\n                break;\n            case 'resize':\n                if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.aspectHeight = parent.aspectWidth;\n                    this.isAspectRatio = false;\n                }\n                this.initResizeToolbar();\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true, true);\n                }\n                aspectIcon = parent.element.querySelector('#' + id + '_aspectratio');\n                nonAspectIcon = parent.element.querySelector('#' + id + '_nonaspectratio');\n                if (parent.aspectWidth && parent.aspectHeight) {\n                    if (nonAspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    else if (aspectIcon) {\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                    }\n                }\n                break;\n            case 'color':\n                this.updateContextualToolbar(type, cType);\n                break;\n            case 'croptransform':\n                if (isNullOrUndefined(isTransform)) {\n                    parent.allowDownScale = false;\n                    parent.isCropTab = true;\n                }\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (isNullOrUndefined(isTransform)) {\n                    parent.updateCropTransformItems();\n                }\n                this.initCropTransformToolbar(shape, isTransform);\n                if (Browser.isDevice && this.isToolbar()) {\n                    this.updateContextualToolbar('color', 'straighten', true);\n                }\n                if (parent.isMaskImage) {\n                    this.refreshToolbar('main');\n                }\n                break;\n            case 'frame':\n                this.isFrameToolbar = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                    this.initMainToolbar(false, true, true, false, true);\n                }\n                else {\n                    this.initMainToolbar(true, null, null, false, true);\n                }\n                // eslint-disable-next-line no-case-declarations\n                var frameElem = parent.element.querySelector('#' + id + '_' + parent.frameObj.type);\n                if (frameElem) {\n                    frameElem.classList.add('e-selected-btn');\n                }\n                if (parent.frameObj.type !== 'none') {\n                    this.updateContextualToolbar(type, cType);\n                }\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                break;\n            case 'redact':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                    this.initMainToolbar(false, true, true, null, null, null, true);\n                }\n                else {\n                    this.initMainToolbar(isApplyBtn, Browser.isDevice, null, null, null, null, true);\n                }\n                this.enableDisableTbrBtn();\n                if (parent.activeObj.redactType === 'blur') {\n                    var redactBlurElement = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                    if (redactBlurElement) {\n                        redactBlurElement.classList.add('e-selected-btn');\n                    }\n                }\n                else {\n                    var pixelateElement = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                    if (pixelateElement) {\n                        pixelateElement.classList.add('e-selected-btn');\n                    }\n                }\n                this.redactSlider(parent.activeObj.redactType);\n                break;\n        }\n        this.refreshDropDownBtn(isCropping);\n        this.updateKBDNavigation(type);\n        this.currToolbar = type;\n    };\n    ToolbarModule.prototype.updateRedactObj = function () {\n        var parent = this.parent;\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl = [];\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n        parent.objColl = objColl;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            var obj = parent.objColl[i];\n            if (obj.shape === 'redact') {\n                obj.redactImage = parent.createElement('canvas');\n                obj.redactImage.width = obj.activePoint.width;\n                obj.redactImage.height = obj.activePoint.height;\n                obj.redactImage.getContext('2d').drawImage(parent.lowerCanvas, obj.activePoint.startX, obj.activePoint.startY, obj.activePoint.width, obj.activePoint.height, 0, 0, obj.redactImage.width, obj.redactImage.height);\n            }\n        }\n        parent.isCropTab = false;\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n        parent.isCropTab = true;\n        if (activeObj) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj,\n                    isCropRatio: null, points: null, isPreventDrag: true } });\n        }\n        var panMoveObj = { panMove: null };\n        parent.notify('transform', { prop: 'getPanMove', onPropertyChange: false,\n            value: { obj: panMoveObj } });\n        if (panMoveObj['panMove']) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: null, yDiff: null } });\n        }\n    };\n    ToolbarModule.prototype.updateKBDNavigation = function (type) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isKBDNavigation || this.currToolbar === type) {\n            return;\n        }\n        if (this.isToolbar()) {\n            var tbar = parent.element.querySelectorAll('#' + id + '_toolbar')[0];\n            var tbarInitialChild = void 0;\n            var tbarInitialBtn_1;\n            if (tbar) {\n                tbarInitialChild = tbar.querySelector('.e-toolbar-center');\n                if (!tbarInitialChild || !tbarInitialChild.children[0]) {\n                    return;\n                }\n                tbarInitialBtn_1 = tbarInitialChild.children[0].querySelector('.e-btn');\n                var tempElem = tbarInitialChild.children[1];\n                if (tempElem) {\n                    tempElem = tempElem.children[0];\n                }\n                if (tempElem) {\n                    tempElem = tempElem.children[0];\n                }\n                if (type === 'resize' && tempElem) {\n                    tbarInitialBtn_1 = tempElem;\n                }\n                if (type === 'filter') {\n                    var defaultFilter_1 = document.querySelector('#' + id + '_defaultCanvas');\n                    if (defaultFilter_1) {\n                        setTimeout(function () { return defaultFilter_1.focus(); }, 50);\n                    }\n                }\n                if (tbarInitialBtn_1) {\n                    if (type === 'main') {\n                        setTimeout(function () { return tbarInitialBtn_1.focus(); }, 50);\n                    }\n                    else {\n                        tbarInitialBtn_1.focus();\n                    }\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.performCropTransformClick = function (shape, isTransform) {\n        var parent = this.parent;\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setTempStraightenZoomDeg' });\n            parent.tempStraighten = parent.transform.straighten;\n            if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                parent.okBtn();\n            }\n            parent.isStraightening = true;\n        }\n        this.refreshToolbar('croptransform', null, null, null, null, shape, isTransform);\n        if (isNullOrUndefined(isTransform)) {\n            parent.notify('draw', { prop: 'setDestForStraighten' });\n            parent.notify('draw', { prop: 'setTempDestForStraighten' });\n        }\n    };\n    ToolbarModule.prototype.getAdjustmentToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Brightness', 'Contrast', 'Hue', 'Saturation', 'Exposure', 'Opacity', 'Blur'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Brightness') > -1)) {\n            toolbarItems.push({ id: id + '_brightness', prefixIcon: 'e-icons e-brightness', cssClass: 'top-icon e-brightness',\n                tooltipText: this.l10n.getConstant('Brightness'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Contrast') > -1)) {\n            toolbarItems.push({ id: id + '_contrast', prefixIcon: 'e-icons e-contrast', cssClass: 'top-icon e-contrast',\n                tooltipText: this.l10n.getConstant('Contrast'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Hue') > -1)) {\n            toolbarItems.push({ id: id + '_hue', prefixIcon: 'e-icons e-fade', cssClass: 'top-icon e-fade',\n                tooltipText: this.l10n.getConstant('Hue'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Saturation') > -1)) {\n            toolbarItems.push({ id: id + '_saturation', prefixIcon: 'e-icons e-saturation', cssClass: 'top-icon e-saturation',\n                tooltipText: this.l10n.getConstant('Saturation'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Exposure') > -1)) {\n            toolbarItems.push({ id: id + '_exposure', prefixIcon: 'e-icons e-grain', cssClass: 'top-icon e-grain',\n                tooltipText: this.l10n.getConstant('Exposure'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Opacity') > -1)) {\n            toolbarItems.push({ id: id + '_opacity', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Blur') > -1)) {\n            toolbarItems.push({ id: id + '_blur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-tint',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFrameToolbarItem = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameColor',\n            cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('Color'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('Color') + '</span><button id=\"' + id + '_frameColorBtn\"></button>' });\n        toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_frameGradient',\n            cssClass: 'top-icon e-frame-stroke', tooltipText: this.l10n.getConstant('GradientColor'), align: 'Center', type: 'Input',\n            template: '<span>' + this.l10n.getConstant('GradientColor') + '</span><button id=\"' + id + '_frameGradientColorBtn\"></button>' });\n        toolbarItems.push({ id: id + '_frameSize', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Size'), align: 'Center',\n            type: 'Input', template: '<span>' + this.l10n.getConstant('Size') + '</span><button id=\"' + id + '_frameSizeBtn\"></button>' });\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset' || parent.frameObj.type === 'hook') {\n            toolbarItems.push({ id: id + '_frameInset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Inset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Inset') + '</span><button id=\"' + id + '_frameInsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line' || parent.frameObj.type === 'inset') {\n            toolbarItems.push({ id: id + '_frameOffset', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Offset'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Offset') + '</span><button id=\"' + id + '_frameOffsetBtn\"></button>' });\n        }\n        if (parent.frameObj.type === 'line') {\n            toolbarItems.push({ id: id + '_frameRadius', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Radius'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Radius') + '</span><button id=\"' + id + '_frameRadiusBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameAmount', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Amount'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Amount') + '</span><button id=\"' + id + '_frameAmountBtn\"></button>' });\n            toolbarItems.push({ id: id + '_frameBorder', cssClass: 'top-icon e-size', tooltipText: this.l10n.getConstant('Border'), align: 'Center',\n                type: 'Input', template: '<span>' + this.l10n.getConstant('Border') + '</span><button id=\"' + id + '_frameBorderBtn\"></button>' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFilterToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        var isCustomized = false;\n        var id = parent.element.id;\n        var defItems = ['Default', 'Chrome', 'Cold', 'Warm', 'Grayscale', 'Sepia', 'Invert'];\n        if (parent.toolbar) {\n            for (var i = 0; i < defItems.length; i++) {\n                if (parent.toolbar.indexOf(defItems[i]) !== -1) {\n                    isCustomized = true;\n                    break;\n                }\n            }\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Default') > -1)) {\n            toolbarItems.push({ id: id + '_default', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Default'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_defaultCanvas' + ' tabindex=0></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Default') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Chrome') > -1)) {\n            toolbarItems.push({ id: id + '_chrome', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Chrome'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_chromeCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Chrome') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Cold') > -1)) {\n            toolbarItems.push({ id: id + '_cold', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Cold'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_coldCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Cold') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Warm') > -1)) {\n            toolbarItems.push({ id: id + '_warm', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Warm'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_warmCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Warm') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Grayscale') > -1)) {\n            toolbarItems.push({ id: id + '_grayscale', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Grayscale'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_grayscaleCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Grayscale') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Sepia') > -1)) {\n            toolbarItems.push({ id: id + '_sepia', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Sepia'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_sepiaCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Sepia') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || !isCustomized || (parent.toolbar && parent.toolbar.indexOf('Invert') > -1)) {\n            toolbarItems.push({ id: id + '_invert', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Invert'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + id + '_invertCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Invert') + '</span></div></div>' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getPenToolbarItem = function (items) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || parent.toolbar) {\n            toolbarItems.push({ id: id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: id + '_pen_strokewidth',\n                cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + id + '_penStrokeWidth\"></button>' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('z-order') > -1) {\n            toolbarItems.push({ id: id + '_zOrder', cssClass: 'top-icon e-list-unordered-3', tooltipText: this.l10n.getConstant('ZOrder'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + id + '_zOrderBtn\"></button>' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right', tabIndex: 0 });\n            toolbarItems.push({ id: id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'pen', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        if (this.isToolbarString(args.toolbarItems)) {\n            items = args.toolbarItems;\n            this.excludeItems(args.toolbarItems);\n        }\n        else {\n            this.defToolbarItems = args.toolbarItems;\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                _this.createZOrderBtn(items);\n                _this.wireZoomBtnEvents();\n                parent.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createPenColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-pen-stroke-color').appendChild(parent.createElement('input', {\n                id: id + '_pen_stroke'\n            }));\n            var presentVal = parent.activeObj.strokeSettings.strokeColor;\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    parent.updatePenStrokeColor(args.currentValue.hex);\n                    _this.selFhdColor = args.currentValue.hex;\n                    strokeDDB_5.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_5.toggle();\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                }\n            }, '#' + id + '_pen_stroke');\n            var strokeDDB_5 = new DropDownButton({\n                open: function (args) {\n                    var parentElem = args.element.parentElement;\n                    if (Browser.isDevice) {\n                        parentElem.style.top = strokeDDB_5.element.getBoundingClientRect().top -\n                            parentElem.offsetHeight + 'px';\n                        if (window.innerWidth <= 520) {\n                            parentElem.style.left = parent.element.offsetLeft + 'px';\n                        }\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview',\n                cssClass: 'e-ie-ddb-popup'\n            }, '#' + id + '_penColorBtn');\n            penColor.inline = true;\n            penColor.value = penColor.getValue(parent.activeObj.strokeSettings.strokeColor, 'rgba');\n            if (penColor.value === 'null') {\n                penColor.value = presentVal;\n            }\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = this.selFhdColor === '#42a5f5' ? obj['tempFreeHandDrawEditingStyles'].strokeColor :\n                        parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n            }\n            else {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = penColor.value;\n            }\n        }\n    };\n    ToolbarModule.prototype.createPenBtn = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(id + '_penStrokeWidth');\n            var spanElem_5 = document.createElement('span');\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                spanElem_5.innerHTML = this.getPenStroke(parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth);\n            }\n            else {\n                var obj = { penStrokeWidth: 2 };\n                parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj } });\n                if (obj['penStrokeWidth']) {\n                    spanElem_5.innerHTML = this.getPenStroke(obj['penStrokeWidth']);\n                }\n                else {\n                    spanElem_5.innerHTML = this.l10n.getConstant('Small');\n                }\n            }\n            spanElem_5.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_5);\n            var drpDownBtn_5 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_5.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_5.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.triggerTbarClickEvent(args);\n                    spanElem_5.textContent = args.item.text;\n                    parent.updatePenStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_14 = getComponent(id + '_bottomToolbar', 'toolbar');\n                            toolbar_14.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_15 = getComponent(id + '_toolbar', 'toolbar');\n                            toolbar_15.refreshOverflow();\n                        }\n                    }\n                    var widthObj = { penStrokeWidth: null };\n                    parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: widthObj } });\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', value: { isPenDraw: true } });\n                    parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: widthObj['penStrokeWidth'] } });\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_5.appendTo('#' + id + '_penStrokeWidth');\n        }\n    };\n    ToolbarModule.prototype.getPenStroke = function (value) {\n        var textContent = '';\n        var valueToTextContent = {\n            1: this.l10n.getConstant('XSmall'),\n            2: this.l10n.getConstant('Small'),\n            3: this.l10n.getConstant('Medium'),\n            4: this.l10n.getConstant('Large'),\n            5: this.l10n.getConstant('XLarge')\n        };\n        if (value >= 1 && value <= 5) {\n            textContent = valueToTextContent[value];\n        }\n        return textContent;\n    };\n    ToolbarModule.prototype.initAdjustmentToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var leftItem = this.getLeftToolbarItem(null);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getAdjustmentToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var args = { toolbarType: 'finetune', toolbarItems: this.defToolbarItems };\n        parent.trigger('toolbarUpdating', args);\n        this.defToolbarItems = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireZoomBtnEvents();\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.initFrameToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var frameWrapper = document.querySelector('#' + id + '_frameWrapper');\n        if (frameWrapper) {\n            frameWrapper.style.display = 'block';\n        }\n        else {\n            frameWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n                id: id + '_frameWrapper', className: 'e-frame-wrapper', styles: 'position: relative'\n            }));\n        }\n        frameWrapper.appendChild(parent.createElement('div', {\n            id: id + '_customizeWrapper',\n            styles: 'position: absolute'\n        }));\n        var mainItem = this.getFrameToolbarItem();\n        var args = { toolbarType: 'frame', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createFrameColor();\n                _this.createFrameSize();\n                var frameType = parent.frameObj.type;\n                if (frameType === 'line') {\n                    _this.createFrameRadius();\n                }\n                if (frameType === 'line' || frameType === 'inset' || frameType === 'hook') {\n                    _this.createFrameInset();\n                }\n                if (frameType === 'line' || frameType === 'inset') {\n                    _this.createFrameOffset();\n                }\n                if (frameType === 'line') {\n                    _this.createFrameAmount();\n                    _this.createFrameBorder();\n                }\n                _this.createFrameGradientColor();\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                parent.element.querySelector('#' + id + '_' + frameType).focus();\n            }\n        });\n        toolbar.appendTo('#' + id + '_customizeWrapper');\n    };\n    ToolbarModule.prototype.createFrameGradientColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-frame-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_gradient_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, noColor: true, value: parent.frameObj.gradientColor,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-gradient-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.gradientColor;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.gradientColor = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.gradientColor = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_gradient_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    if (window.innerWidth <= 520) {\n                        parentElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                }\n            },\n            target: '.e-frame-gradient-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameGradientColorBtn');\n        fillColor.inline = true;\n        if (parent.frameObj.gradientColor === '') {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        else {\n            parent.element.querySelector('.e-frame-stroke.e-template .e-dropdownbtn-preview').style.background\n                = parent.frameObj.gradientColor;\n        }\n    };\n    ToolbarModule.prototype.createFrameColor = function () {\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n            id: id + '_frame_fill'\n        }));\n        var fillColor = new ColorPicker({\n            modeSwitcher: false, value: parent.frameObj.color,\n            showButtons: false, mode: 'Palette', cssClass: 'e-frame-fill-color',\n            change: function (args) {\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.color;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.color = args.currentValue.hex;\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    if (args.currentValue.rgba === '') {\n                        fillDDB.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.color = temp;\n                }\n                fillDDB.toggle();\n            }\n        }, '#' + id + '_frame_fill');\n        var fillDDB = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = fillDDB.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                    if (window.innerWidth <= 520) {\n                        parentElem.style.left = parent.element.offsetLeft + 'px';\n                    }\n                }\n            },\n            target: '.e-frame-fill-color',\n            iconCss: 'e-dropdownbtn-preview',\n            cssClass: 'e-ie-ddb-popup'\n        }, '#' + id + '_frameColorBtn');\n        fillColor.inline = true;\n        parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = parent.frameObj.color;\n    };\n    ToolbarModule.prototype.createFrameSize = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameSizeBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.size.toString());\n        spanElem.className = 'e-frame-stroke-width';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.size;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.size = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.size = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_16 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_16.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_17 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_17.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameSizeBtn');\n    };\n    ToolbarModule.prototype.createFrameInset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameInsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.inset.toString());\n        spanElem.className = 'e-frame-inset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border), lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.inset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.inset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.inset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_18 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_18.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_19 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_19.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameInsetBtn');\n    };\n    ToolbarModule.prototype.createFrameOffset = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('20') },\n            { id: '2', text: this.l10n.getConstant('40') },\n            { id: '3', text: this.l10n.getConstant('60') },\n            { id: '4', text: this.l10n.getConstant('80') },\n            { id: '5', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameOffsetBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.offset.toString());\n        spanElem.className = 'e-frame-offset';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    lineCount: parent.frameObj.amount, frameLineStyle: parent.toPascalCase(parent.frameObj.border) };\n                var temp = parent.frameObj.offset;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.offset = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.offset = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_20 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_20.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_21 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_21.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameOffsetBtn');\n    };\n    ToolbarModule.prototype.createFrameRadius = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('0') },\n            { id: '2', text: this.l10n.getConstant('20') },\n            { id: '3', text: this.l10n.getConstant('40') },\n            { id: '4', text: this.l10n.getConstant('60') },\n            { id: '5', text: this.l10n.getConstant('80') },\n            { id: '6', text: this.l10n.getConstant('100') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameRadiusBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.radius.toString());\n        spanElem.className = 'e-frame-radius';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    lineCount: parent.frameObj.amount };\n                var temp = parent.frameObj.radius;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.radius = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting,\n                        currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.radius = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_22 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_22.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_23 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_23.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameRadiusBtn');\n    };\n    ToolbarModule.prototype.createFrameAmount = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('1') },\n            { id: '2', text: this.l10n.getConstant('2') },\n            { id: '3', text: this.l10n.getConstant('3') },\n            { id: '4', text: this.l10n.getConstant('4') },\n            { id: '5', text: this.l10n.getConstant('5') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameAmountBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.frameObj.amount.toString());\n        spanElem.className = 'e-frame-amount';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { type: parent.toPascalCase(parent.frameObj.type), color: parent.frameObj.color,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, borderRadius: parent.frameObj.radius,\n                    lineCount: parent.frameObj.amount, frameLineStyle: parent.toPascalCase(parent.frameObj.border) };\n                var temp = parent.frameObj.amount;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.amount = parseInt(args.item.text, 10);\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.amount = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_24 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_24.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_25 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_25.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameAmountBtn');\n    };\n    ToolbarModule.prototype.createFrameBorder = function () {\n        var _this = this;\n        var parent = this.parent;\n        var prevFrameSettings;\n        var obj = { frameChangeEventArgs: null };\n        var id = parent.element.id;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('Solid') },\n            { id: '2', text: this.l10n.getConstant('Dashed') },\n            { id: '3', text: this.l10n.getConstant('Dotted') }\n        ];\n        var strokeWidthBtn = document.getElementById(id + '_frameBorderBtn');\n        var spanElem = document.createElement('span');\n        spanElem.innerHTML = this.l10n.getConstant(parent.toPascalCase(parent.frameObj.border));\n        spanElem.className = 'e-frame-border';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var parentElem = args.element.parentElement;\n                    parentElem.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        parentElem.offsetHeight + 'px';\n                }\n                var activeBtn = drpDownBtn.element.childNodes[0].textContent;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                _this.triggerTbarClickEvent(args);\n                prevFrameSettings = { lineCount: parent.frameObj.amount, color: parent.frameObj.color, borderRadius: parent.frameObj.radius,\n                    gradientColor: parent.frameObj.gradientColor, size: parent.frameObj.size, inset: parent.frameObj.inset,\n                    offset: parent.frameObj.offset, frameLineStyle: parent.toPascalCase(parent.frameObj.border),\n                    type: parent.toPascalCase(parent.frameObj.type) };\n                var temp = parent.frameObj.border;\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                parent.frameObj.border = args.item.text.toLowerCase();\n                parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: prevFrameSettings, obj: obj } });\n                if (obj['frameChangeEventArgs'] && !obj['frameChangeEventArgs'].cancel) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                            operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                            previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                            previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                            previousFilter: null, isCircleCrop: null\n                        } });\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                    drpDownBtn.content = args.item.text;\n                    parent.curFrameObjEvent = { previousFrameSetting: obj['frameChangeEventArgs'].previousFrameSetting, currentFrameSetting: obj['frameChangeEventArgs'].currentFrameSetting };\n                    parent.isFrameBtnClick = true;\n                }\n                else {\n                    parent.frameObj.border = temp;\n                }\n                if (Browser.isDevice) {\n                    if (document.getElementById(id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_26 = getComponent(id + '_bottomToolbar', 'toolbar');\n                        toolbar_26.refreshOverflow();\n                    }\n                }\n                else {\n                    if (document.getElementById(id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        var toolbar_27 = getComponent(id + '_toolbar', 'toolbar');\n                        toolbar_27.refreshOverflow();\n                    }\n                }\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + id + '_frameBorderBtn');\n    };\n    ToolbarModule.prototype.initFilterToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var id = parent.element.id;\n        var mainItem = this.getFilterToolbarItem();\n        var args = { toolbarType: 'filter', toolbarItems: mainItem };\n        parent.trigger('toolbarUpdating', args);\n        mainItem = args.toolbarItems;\n        if (document.querySelector('#' + id + '_contextualToolbar').classList.contains('e-control')) {\n            getComponent(document.getElementById(id + '_contextualToolbar'), 'toolbar').destroy();\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.contextualToolbarClicked.bind(this),\n            created: function () {\n                _this.updatePrivateVariables();\n                _this.createCanvasFilter();\n                if (parent.currentFilter === '') {\n                    parent.currentFilter = id + '_default';\n                }\n                var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n                if (hdrWrapper) {\n                    hdrWrapper.style.display = 'none';\n                }\n                var filterElem = document.getElementById(parent.currentFilter + 'Canvas');\n                if (filterElem) {\n                    filterElem.parentElement.parentElement.classList.add('e-selected');\n                }\n                _this.enableDisableTbrBtn();\n                toolbar.refreshOverflow();\n            }\n        });\n        toolbar.appendTo('#' + id + '_contextualToolbar');\n    };\n    ToolbarModule.prototype.drawDashedLine = function (ctx) {\n        ctx.beginPath();\n        ctx.setLineDash([5]);\n        ctx.rect(10, 10, 280, 130);\n        ctx.stroke();\n        ctx.closePath();\n    };\n    ToolbarModule.prototype.createCanvasFilter = function () {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var imageData = parent.getCurrentCanvasData();\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n        this.updateFilterCanvas('_defaultCanvas', 'default');\n        this.updateFilterCanvas('_chromeCanvas', 'chrome');\n        this.updateFilterCanvas('_coldCanvas', 'cold');\n        this.updateFilterCanvas('_warmCanvas', 'warm');\n        this.updateFilterCanvas('_grayscaleCanvas', 'grayscale');\n        this.updateFilterCanvas('_sepiaCanvas', 'sepia');\n        this.updateFilterCanvas('_invertCanvas', 'invert');\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n    };\n    ToolbarModule.prototype.updateFilterCanvas = function (selector, type) {\n        var parent = this.parent;\n        var filter = parent.element.querySelector('#' + parent.element.id + selector);\n        if (filter) {\n            var ctx = filter.getContext('2d');\n            ctx = filter.getContext('2d');\n            filter.style.width = '100px';\n            filter.style.height = '100px';\n            parent.notify('filter', { prop: 'updateAdj', value: { type: type, value: null, isPreview: true, ctx: ctx } });\n            ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n            if (parent.isSafari) {\n                parent.notify('filter', { prop: 'apply-filter', onPropertyChange: false, value: { context: ctx } });\n            }\n        }\n    };\n    ToolbarModule.prototype.getQuickAccessToolbarItem = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var args = { cancel: false, toolbarItems: [] };\n        var toolbarItems = [];\n        if (isNullOrUndefined(isPenEdit)) {\n            if (parent.activeObj.shape === 'image') {\n                toolbarItems.push('Flip');\n            }\n            if (parent.activeObj.shape !== 'redact') {\n                toolbarItems.push('BringToFront');\n            }\n            toolbarItems.push('Clone');\n            toolbarItems.push('Delete');\n            if (parent.activeObj.shape === 'text') {\n                toolbarItems.push('EditText');\n            }\n            args.shape = parent.toPascalCase(parent.activeObj.shape);\n        }\n        else if (isPenEdit) {\n            toolbarItems.push('BringToFront');\n            toolbarItems.push('Delete');\n            args.shape = 'Freehand draw';\n        }\n        args.toolbarItems = extend([], toolbarItems, null, true);\n        parent.trigger('quickAccessToolbarOpen', args);\n        var orgToolbarItems = [];\n        if (args.cancel) {\n            orgToolbarItems = [];\n        }\n        else {\n            for (var i = 0; i < args.toolbarItems.length; i++) {\n                switch (args.toolbarItems[i]) {\n                    case 'BringToFront':\n                        orgToolbarItems.push({ id: id + '_bringToFront', prefixIcon: 'e-icons e-bring-to-front',\n                            tooltipText: this.l10n.getConstant('BringToFront'), align: 'Left' });\n                        break;\n                    case 'Clone':\n                        orgToolbarItems.push({ id: id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                            tooltipText: this.l10n.getConstant('Duplicate'), align: 'Left' });\n                        break;\n                    case 'Delete':\n                        orgToolbarItems.push({ id: id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                            tooltipText: this.l10n.getConstant('Remove'), align: 'Left' });\n                        break;\n                    case 'EditText':\n                        orgToolbarItems.push({ id: id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                            tooltipText: this.l10n.getConstant('EditText'), align: 'Left' });\n                        break;\n                    case 'Flip':\n                        orgToolbarItems.push({ id: id + '_hFlip', prefixIcon: 'e-icons e-horizontal-flip',\n                            tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Left' });\n                        orgToolbarItems.push({ id: id + '_vFlip', prefixIcon: 'e-icons e-vertical-flip',\n                            tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Left' });\n                        break;\n                    default:\n                        orgToolbarItems.push(args.toolbarItems[i]);\n                        break;\n                }\n            }\n        }\n        return orgToolbarItems;\n    };\n    ToolbarModule.prototype.renderQAT = function (isPenEdit) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (parent.activeObj && parent.showQuickAccessToolbar) {\n            var qtArea = document.getElementById(id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                this.destroyQuickAccessToolbar();\n                qtArea.style.display = 'block';\n            }\n            var items = this.getQuickAccessToolbarItem(isPenEdit);\n            if (items.length === 0) {\n                return;\n            }\n            if (isNullOrUndefined(parent.quickAccessToolbarTemplate)) {\n                var toolbarObj = new Toolbar({\n                    items: items,\n                    clicked: this.quickAccessToolbarClicked.bind(this)\n                });\n                toolbarObj.appendTo('#' + id + '_quickAccessToolbar');\n            }\n            var height = this.toolbarHeight && this.toolbarHeight !== 0 ? this.toolbarHeight : qtArea.clientHeight;\n            var wrapperElement = parent.element.querySelector('#' + id + '_headWrapper');\n            if (isNullOrUndefined(isPenEdit) && (parent.activeObj.activePoint.width !== 0 ||\n                parent.activeObj.activePoint.height !== 0 ||\n                (parent.activeObj.shape && parent.activeObj.shape === 'path' && parent.activeObj.pointColl.length > 0))) {\n                var orderObj = { order: null };\n                parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                if (parent.activeObj.order > orderObj['order'] && document.getElementById(parent.element.id + '_bringToFront')) {\n                    document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                }\n                else {\n                    if (document.getElementById(parent.element.id + '_bringToFront')) {\n                        document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                    }\n                }\n                qtArea.style.width = 'auto';\n                parent.activeObj.activePoint.width = Math.abs(parent.activeObj.activePoint.width);\n                parent.activeObj.activePoint.height = Math.abs(parent.activeObj.activePoint.height);\n                var x = parent.activeObj.activePoint.startX < parent.activeObj.activePoint.endX ?\n                    parent.activeObj.activePoint.startX : parent.activeObj.activePoint.endX;\n                var y = parent.activeObj.activePoint.startY < parent.activeObj.activePoint.endY ?\n                    parent.activeObj.activePoint.startY : parent.activeObj.activePoint.endY;\n                var width = parent.activeObj.activePoint.width;\n                if (parent.activeObj.rotatedAngle !== 0 && parent.activeObj.shape !== 'arrow') {\n                    var object = { activePoint: null };\n                    parent.notify('shape', { prop: 'getSquarePointForRotatedShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj, object: object } });\n                    var point = object['activePoint'];\n                    x = point.startX;\n                    y = point.startY;\n                    width = point.width;\n                }\n                else if (parent.activeObj.shape === 'path') {\n                    var path = parent.getSquarePointForPath(parent.activeObj);\n                    x = path.startX;\n                    y = path.startY;\n                    width = path.width;\n                }\n                qtArea.style.left = (x + (width / 2)) - (items.length * 25) + 'px';\n                if (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2) !== x + (width / 2)) {\n                    var diff = (x + (width / 2)) - (parseFloat(qtArea.style.left) + (qtArea.clientWidth / 2));\n                    qtArea.style.left = parseFloat(qtArea.style.left) + diff + 'px';\n                }\n                if (wrapperElement) {\n                    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                    height = wrapperElement.offsetHeight + height;\n                }\n                if (y - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                    if (wrapperElement) {\n                        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                        qtArea.style.top = (parent.img.destTop < 0 ? 0 : parent.img.destTop) + wrapperElement.offsetHeight + 'px';\n                    }\n                }\n                else {\n                    height = this.toolbarHeight;\n                    qtArea.style.top = y - (height + (height / 1.5)) + 'px';\n                }\n            }\n            else if (isPenEdit) {\n                var indexObj = { freehandSelectedIndex: -1 };\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                var orderObj = { order: null };\n                parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                if (parent.getObjFromId(parent.pointColl[indexObj['freehandSelectedIndex']].id).order >= orderObj['order'] && document.getElementById(parent.element.id + '_bringToFront')) {\n                    document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                }\n                else {\n                    if (document.getElementById(parent.element.id + '_bringToFront')) {\n                        document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                    }\n                }\n                var obj = { activePoint: null };\n                parent.notify('freehand-draw', { prop: 'getSqPtFD',\n                    value: { idx: indexObj['freehandSelectedIndex'], obj: obj } });\n                var point = obj['activePoint'];\n                qtArea.style.width = 'auto';\n                qtArea.style.left = (point.startX + (point.width / 2)) - (items.length * 24) + 'px';\n                if (point.startY - (height + (height / 1.5)) < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = point.startY - (height + (height / 1.5)) + 'px';\n                }\n            }\n            else {\n                qtArea.style.display = 'none';\n            }\n            if (parseFloat(qtArea.style.top) < 0) {\n                qtArea.style.top = '0px';\n            }\n        }\n    };\n    ToolbarModule.prototype.refreshDropDownBtn = function (isDisabled) {\n        if (isNullOrUndefined(isDisabled)) {\n            return;\n        }\n        var parent = this.parent;\n        var id = parent.element.id;\n        var annotation = document.querySelector('#' + id + '_annotationBtn');\n        if (annotation) {\n            if (isDisabled) {\n                annotation.classList.add('e-disabled');\n                annotation.parentElement.classList.add('e-overlay');\n            }\n            else {\n                annotation.classList.remove('e-disabled');\n                annotation.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(annotation, 'dropdown-btn').disabled = isDisabled;\n        }\n        var transform = document.querySelector('#' + id + '_transformBtn');\n        if (transform) {\n            if (isDisabled) {\n                transform.classList.add('e-disabled');\n                transform.parentElement.classList.add('e-overlay');\n            }\n            else {\n                transform.classList.remove('e-disabled');\n                transform.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(transform, 'dropdown-btn').disabled = isDisabled;\n        }\n        var adjustment = document.querySelector('#' + id + '_adjustment');\n        if (adjustment) {\n            if (isDisabled) {\n                adjustment.classList.add('e-disabled');\n                adjustment.parentElement.classList.add('e-overlay');\n            }\n            else {\n                adjustment.classList.remove('e-disabled');\n                adjustment.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(adjustment, 'btn').disabled = isDisabled;\n        }\n        var filter = document.querySelector('#' + id + '_filter');\n        if (filter) {\n            if (isDisabled) {\n                filter.classList.add('e-disabled');\n                filter.parentElement.classList.add('e-overlay');\n            }\n            else {\n                filter.classList.remove('e-disabled');\n                filter.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(filter, 'btn').disabled = isDisabled;\n        }\n    };\n    ToolbarModule.prototype.cropSelect = function (args) {\n        var parent = this.parent;\n        parent.isCropTab = true;\n        if (isNullOrUndefined(parent.transform.cropZoomFactor)) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n        }\n        parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n        var text = args.item.id;\n        this.currentToolbar = 'crop';\n        parent.currSelectionPoint = null;\n        parent.notify('draw', { prop: 'setIsCropSelect', value: { bool: true } });\n        var obj = { prevObj: null };\n        parent.notify('crop', { prop: 'getPreviousCropCurrentObj', value: { obj: obj } });\n        parent.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: text, startX: null, startY: null, width: null, height: null } });\n        parent.notify('crop', { prop: 'setPreviousCropCurrentObj', value: { obj: obj['prevObj'] } });\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.quickAccessToolbarClicked = function (args, isContextualToolbar) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (args.item) {\n            var isPreventUndoRedo = null;\n            var obj = { prevActObj: null };\n            var object = { tempObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('selection', { prop: 'getTempActObj', onPropertyChange: false, value: { obj: object } });\n            object['tempObj']['activePoint']['height'] = Math.abs(object['tempObj']['activePoint']['height']);\n            var pathObject = { isNewPath: null };\n            var ctx = void 0;\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            var left = void 0;\n            var right = void 0;\n            var indexObj = { freehandSelectedIndex: null };\n            var shapeId = void 0;\n            var isDisabled = void 0;\n            var orderObj = { order: null };\n            switch (type) {\n                case 'duplicate':\n                    if (!parent.element.querySelector('#' + id + '_duplicate').classList.contains('e-overlay')) {\n                        this.refreshSlider();\n                        if (!pathObject['isNewPath'] && JSON.stringify(object['tempObj']) === JSON.stringify(parent.activeObj)) {\n                            isPreventUndoRedo = true;\n                        }\n                        this.duplicateShape(isPreventUndoRedo);\n                    }\n                    break;\n                case 'remove':\n                    if (!parent.element.querySelector('#' + id + '_remove').classList.contains('e-overlay')) {\n                        parent.noPushUndo = false;\n                        this.refreshSlider();\n                        parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n                    }\n                    break;\n                case 'edittext':\n                    if (!parent.element.querySelector('#' + id + '_editText').classList.contains('e-overlay')) {\n                        this.editText();\n                    }\n                    break;\n                case 'rotleft':\n                case 'rotright':\n                    left = parent.element.querySelector('#' + id + '_rotLeft');\n                    right = parent.element.querySelector('#' + id + '_rotRight');\n                    if ((left && !left.classList.contains('e-disabled')) ||\n                        (right && !right.classList.contains('e-disabled'))) {\n                        parent.rotateImage(args.item.id.replace(id + '_', '').toLowerCase());\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'hflip':\n                    if (!parent.element.querySelector('#' + id + '_hFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.horizontalFlip(ctx);\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'vflip':\n                    if (!parent.element.querySelector('#' + id + '_vFlip').classList.contains('e-disabled')) {\n                        ctx = parent.activeObj.imageCanvas.getContext('2d');\n                        parent.verticalFlip(ctx);\n                    }\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    break;\n                case 'bringtofront':\n                    if (!parent.element.querySelector('#' + id + '_bringToFront').classList.contains('e-overlay')) {\n                        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                        shapeId = indexObj['freehandSelectedIndex'] !== null ? parent.pointColl[indexObj['freehandSelectedIndex']].id :\n                            parent.activeObj.currIndex;\n                        parent.updateShapeOrder(shapeId, type);\n                        isDisabled = false;\n                        parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n                        if (shapeId.indexOf('pen') > -1) {\n                            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var order = parent.getObjFromId(shapeId).order;\n                            isDisabled = order >= orderObj['order'] ? true : false;\n                        }\n                        else {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var order = parent.getObjFromId(shapeId).order;\n                            isDisabled = order > orderObj['order'] ? true : false;\n                        }\n                        if (isDisabled) {\n                            document.getElementById(parent.element.id + '_bringToFront').classList.add('e-overlay');\n                        }\n                        else {\n                            document.getElementById(parent.element.id + '_bringToFront').classList.remove('e-overlay');\n                        }\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n            }\n            if (type === 'duplicate' || type === 'remove') {\n                parent.notify('draw', { prop: 'redrawDownScale' });\n            }\n        }\n        if (isNullOrUndefined(isContextualToolbar)) {\n            parent.trigger('quickAccessToolbarItemClick', args);\n        }\n    };\n    ToolbarModule.prototype.editText = function () {\n        var parent = this.parent;\n        var points = { x: parent.activeObj.activePoint.startX, y: parent.activeObj.activePoint.startY };\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: extend({}, parent.activeObj, {}, true) } });\n        parent.notify('selection', { prop: 'setInitialTextEdit', onPropertyChange: false,\n            value: { bool: true } });\n        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n            value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n        if (parent.activeObj.rotatedAngle !== 0) {\n            var object = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'getTextBoxPosition', onPropertyChange: false,\n                value: { obj: parent.activeObj, object: object } });\n            points.x = object['x'];\n            points.y = object['y'];\n            var object1 = { x: points.x, y: points.y };\n            parent.notify('shape', { prop: 'setFlipState', onPropertyChange: false,\n                value: { x: points.x, y: points.y, obj: parent.activeObj, object: object1 } });\n            points.x = object1['x'];\n            points.y = object1['y'];\n        }\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'redrawDownScale' });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        parent.activeObj = tempActiveObj;\n        parent.notify('shape', { prop: 'renderTextArea', onPropertyChange: false,\n            value: { x: points.x, y: points.y, actObj: parent.activeObj } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.duplicateShape = function (isPreventUndoRedo, isPublicMethod) {\n        var parent = this.parent;\n        var tempObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] };\n        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n            value: { obj: tempObj } });\n        var obj = { prevActObj: null };\n        parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n        var pathObject = { isNewPath: null };\n        parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n        var objColl;\n        var duplicateObj = extend({}, parent.activeObj, {}, true);\n        var orderObj = { order: null };\n        parent.notify('shape', { prop: 'getHighestOrder', onPropertyChange: false, value: { obj: orderObj } });\n        if (duplicateObj.order) {\n            parent.notify('shape', { prop: 'updateShapeColl', onPropertyChange: false });\n            duplicateObj.order = orderObj['order'] > duplicateObj.order ? orderObj['order'] + 1 : duplicateObj.order + 1;\n        }\n        else {\n            parent.noPushUndo = true;\n            parent.okBtn();\n            parent.noPushUndo = false;\n            parent.selectShape(duplicateObj.currIndex);\n            duplicateObj.order = orderObj['order'] > duplicateObj.order ? orderObj['order'] + 1 : duplicateObj.order + 1;\n        }\n        if (duplicateObj.shape === 'image') {\n            objColl = extend([], parent.objColl, [], true);\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else if (obj['prevActObj'] || isPublicMethod) {\n            parent.activeObj.currIndex = null;\n            duplicateObj.currIndex = null;\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n        }\n        else {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        }\n        var noPushUndo = parent.noPushUndo;\n        parent.noPushUndo = false;\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        parent.noPushUndo = noPushUndo;\n        objColl = extend([], parent.objColl, [], true);\n        duplicateObj.activePoint.startX += 10;\n        duplicateObj.activePoint.startY -= 10;\n        duplicateObj.activePoint.endX += 10;\n        duplicateObj.activePoint.endY -= 10;\n        if (duplicateObj.shape === 'path') {\n            for (var i = 0; i < duplicateObj.pointColl.length; i++) {\n                duplicateObj.pointColl[i].x += 10;\n                duplicateObj.pointColl[i].y -= 10;\n            }\n        }\n        else if (duplicateObj.shape === 'image') {\n            duplicateObj.imageCanvas = parent.createElement('canvas');\n        }\n        var shapeIDObj = { id: 'shape_' + (parent.objColl.length + 1) };\n        parent.notify('shape', { prop: 'getNewShapeId', onPropertyChange: false, value: { obj: shapeIDObj } });\n        duplicateObj.currIndex = shapeIDObj['id'];\n        parent.activeObj = extend({}, duplicateObj, {}, true);\n        if (parent.activeObj.shape === 'image') {\n            var activePoint = extend({}, duplicateObj.activePoint, {}, true);\n            var dimObj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.activeObj.imageElement.width, height: parent.activeObj.imageElement.height,\n                    obj: dimObj, isImgShape: null } });\n            parent.activeObj.activePoint.width = dimObj['width'];\n            parent.activeObj.activePoint.height = dimObj['height'];\n            if (parent.activeObj.isHorImageFlip && parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: true } });\n                parent.activeObj.isHorImageFlip = parent.activeObj.isVerImageFlip = true;\n            }\n            else if (parent.activeObj.isHorImageFlip) {\n                parent.activeObj.isHorImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: true, isVFlip: null } });\n                parent.activeObj.isHorImageFlip = true;\n            }\n            else if (parent.activeObj.isVerImageFlip) {\n                parent.activeObj.isVerImageFlip = false;\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: true } });\n                parent.activeObj.isVerImageFlip = true;\n            }\n            else {\n                parent.notify('draw', { prop: 'downScaleImgCanvas', onPropertyChange: false,\n                    value: { ctx: duplicateObj.imageCanvas.getContext('2d'), isImgAnnotation: true, isHFlip: null, isVFlip: null } });\n            }\n            parent.activeObj.activePoint = activePoint;\n        }\n        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n            parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj,\n                isCropRatio: null, points: null, isPreventDrag: true } });\n        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        parent.noPushUndo = false;\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        parent.noPushUndo = true;\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        var id = parent.element.id;\n        var toolbarId = Browser.isDevice ? '#' + id + '_bottomToolbar ' + '#' + id : '#' + id;\n        var object = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: object } });\n        this.enableDisableCloneBtn(toolbarId, object);\n        this.renderQAT();\n        if (parent.activeObj.shape && parent.activeObj.shape === 'redact') {\n            this.redactSlider(parent.activeObj.redactType);\n        }\n    };\n    ToolbarModule.prototype.defToolbarClicked = function (args) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var isFilterFinetune = false;\n        if (!this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = isFilterFinetune = true;\n            }\n            var straightenObj = { bool: parent.isStraightening };\n            if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        if (args.item) {\n            var type = args.item.id.replace(id + '_', '').toLowerCase();\n            if (type === 'duplicate' || type === 'remove' || type === 'edittext' ||\n                type === 'hflip' || type === 'vflip' || type === 'rotleft' || type === 'rotright') {\n                this.quickAccessToolbarClicked(args, true);\n                parent.trigger('toolbarItemClicked', args);\n            }\n            else {\n                var isDisabledFilter = false;\n                var isDisabledAdjustment = false;\n                var adjustment = document.querySelector('#' + id + '_adjustment');\n                if (adjustment && adjustment.classList.contains('e-disabled')) {\n                    isDisabledAdjustment = true;\n                }\n                var filter = document.querySelector('#' + id + '_filter');\n                if (filter && filter.classList.contains('e-disabled')) {\n                    isDisabledFilter = true;\n                }\n                this.enableDisableTbrBtn();\n                this.performDefTbrClick(type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune);\n                parent.trigger('toolbarItemClicked', args);\n                if (parent.isStraightening) {\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                }\n                var validTypes = ['undo', 'redo', 'cancel', 'aspectratio', 'nonaspectratio',\n                    'save', 'duplicate', 'filter', 'frame', 'none', 'mat', 'bevel', 'line', 'inset', 'hook', 'resize',\n                    'remove'];\n                if (validTypes.indexOf(type) !== -1) {\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.performDefTbrClick = function (type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var zoomIn = parent.element.querySelector('#' + id + '_zoomIn');\n        var aspectRatioHeight = parent.element.querySelector('#' + id + '_resizeHeight');\n        var aspectRatioWidth = parent.element.querySelector('#' + id + '_resizeWidth');\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        var actionType;\n        var actionArgs;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (!parent.disabled) {\n            switch (type) {\n                case 'pan':\n                    parent.currObjType.isCustomCrop = parent.currObjType.isFiltered = false;\n                    parent.currObjType.isRedact = false;\n                    if (parent.currObjType.isUndoAction) {\n                        parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n                    }\n                    if (isCropSelection) {\n                        parent.currObjType.isCustomCrop = false;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (parent.togglePan) {\n                        this.cancelPan();\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: true } });\n                        if (this.currentToolbar === 'pen') {\n                            parent.freeHandDraw(true);\n                        }\n                    }\n                    else {\n                        panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n                        if (panBtn) {\n                            panBtn.classList.add('e-selected-btn');\n                        }\n                        parent.pan(true);\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: false } });\n                    }\n                    if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n                        zoomIn.classList.add('e-disabled');\n                        zoomIn.parentElement.classList.add('e-overlay');\n                    }\n                    else if (zoomIn) {\n                        zoomIn.classList.remove('e-disabled');\n                        zoomIn.parentElement.classList.remove('e-overlay');\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'cancel':\n                    if (parent.currObjType.isRedact) {\n                        parent.currObjType.isRedact = false;\n                    }\n                    if (this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper') && !parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar, isFinalCancel: true } });\n                    break;\n                case 'ok':\n                    if (Browser.isDevice && this.isFrameToolbar && parent.element.querySelector('.e-contextual-toolbar-wrapper') && !parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                    parent.okBtn(null, true);\n                    parent.drawingShape = null;\n                    this.refreshDropDownBtn(false);\n                    this.currentToolbar = 'main';\n                    parent.isStraightening = false;\n                    parent.notify('draw', { prop: 'resetTempObjColl' });\n                    parent.notify('draw', { prop: 'resetTempPointColl' });\n                    break;\n                case 'crop':\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    break;\n                case 'reset':\n                    parent.reset();\n                    this.imageHeight = null;\n                    this.imageWidth = null;\n                    parent.aspectHeight = null;\n                    parent.aspectWidth = null;\n                    this.isAspectRatio = true;\n                    this.currentToolbar = 'main';\n                    break;\n                case 'undo':\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                    break;\n                case 'redo':\n                    parent.noPushUndo = false;\n                    if (parent.togglePen || parent.drawingShape) {\n                        parent.okBtn();\n                        parent.drawingShape = null;\n                    }\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                    break;\n                case 'aspectratio':\n                    if (!parent.isCircleCrop && (isNullOrUndefined(parent.currSelectionPoint)) ||\n                        (parent.currSelectionPoint && parent.currSelectionPoint.shape !== 'crop-circle')) {\n                        if (getComponent(aspectRatioWidth, 'numerictextbox').value) {\n                            parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value;\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: null, isAspectRatio: true } });\n                        }\n                        else if (getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                            parent.aspectWidth = parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                            parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value;\n                            parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: true } });\n                        }\n                        parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                            height: parent.img.srcHeight };\n                        this.refreshToolbar('resize');\n                    }\n                    break;\n                case 'nonaspectratio':\n                    if (getComponent(aspectRatioWidth, 'numerictextbox').value ||\n                        getComponent(aspectRatioHeight, 'numerictextbox').value) {\n                        parent.aspectWidth = getComponent(aspectRatioWidth, 'numerictextbox').value ?\n                            getComponent(aspectRatioWidth, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioWidth, 'numerictextbox').placeholder);\n                        parent.aspectHeight = getComponent(aspectRatioHeight, 'numerictextbox').value ?\n                            getComponent(aspectRatioHeight, 'numerictextbox').value :\n                            parseFloat(getComponent(aspectRatioHeight, 'numerictextbox').placeholder);\n                        parent.notify('transform', { prop: 'resize', value: { width: parent.aspectWidth, height: parent.aspectHeight, isAspectRatio: false } });\n                    }\n                    parent.resizeSrc = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                        height: parent.img.srcHeight };\n                    this.refreshToolbar('resize');\n                    break;\n                case 'resize':\n                    if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                        parent.okBtn();\n                    }\n                    this.resizeClick();\n                    break;\n                case 'adjustment':\n                    if (!isDisabledAdjustment) {\n                        if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n                            parent.okBtn();\n                        }\n                        this.refreshToolbar('adjustment');\n                        parent.setTempFilterProperties();\n                        parent.notify('draw', { prop: 'updateFinetune' });\n                        parent.notify('filter', { prop: 'setTempAdjVal' });\n                        this.openSlider('brightness');\n                    }\n                    break;\n                case 'brightness':\n                case 'contrast':\n                case 'hue':\n                case 'saturation':\n                case 'opacity':\n                case 'blur':\n                case 'exposure':\n                    this.openSlider(type);\n                    break;\n                case 'filter':\n                    if (!isDisabledFilter) {\n                        showSpinner(parent.element);\n                        this.refreshToolbar('filter');\n                        parent.setTempFilterProperties();\n                        hideSpinner(parent.element);\n                    }\n                    break;\n                case 'default':\n                case 'chrome':\n                case 'cold':\n                case 'warm':\n                case 'grayscale':\n                case 'blackandwhite':\n                case 'sepia':\n                case 'invert':\n                case 'sharpen':\n                    parent.currObjType.isFiltered = true;\n                    parent.notify('filter', { prop: 'applyImageFilter', value: { option: type } });\n                    break;\n                case 'upload':\n                    if (isFilterFinetune) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.remove('e-hide');\n                    }\n                    break;\n                case 'bold':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_bold').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_bold').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_bold').classList.add('e-selected-btn');\n                    }\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n                case 'italic':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    if (parent.element.querySelector('#' + id + '_italic').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + id + '_italic').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + id + '_italic').classList.add('e-selected-btn');\n                    }\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                    }\n                    break;\n                case 'croptransform':\n                    this.performCropTransformClick();\n                    break;\n                case 'rotateleft':\n                case 'rotateright':\n                case 'horizontalflip':\n                case 'verticalflip':\n                    parent.transformSelect(type);\n                    this.updateRedactObj();\n                    if (type === 'rotateleft' || type === 'rotateright') {\n                        parent.notify('draw', { prop: 'resetStraightenDestPoints' });\n                        parent.notify('draw', { prop: 'setDestForStraighten' });\n                    }\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    if (Browser.isDevice) {\n                        this.updateContextualToolbar('color', 'straighten');\n                    }\n                    actionType = type === 'rotateleft' || type === 'rotateright' ?\n                        'rotate' : 'flip';\n                    actionArgs = { action: actionType, actionEventArgs: parent.editCompleteArgs };\n                    parent.triggerEditCompleteEvent(actionArgs);\n                    break;\n                case 'save':\n                    parent.noPushUndo = false;\n                    parent.okBtn();\n                    parent.drawingShape = null;\n                    this.saveDialogPopup();\n                    break;\n                case 'transparency':\n                    this.updateContextualToolbar('transparency', 'transparency');\n                    break;\n                case 'frame':\n                    this.frameToolbarClick();\n                    break;\n                case 'none':\n                case 'mat':\n                case 'bevel':\n                case 'line':\n                case 'inset':\n                case 'hook':\n                    this.unselectFrameBtn();\n                    if (parent.element.querySelector('#' + id + '_' + type)) {\n                        parent.element.querySelector('#' + id + '_' + type).classList.add('e-selected-btn');\n                    }\n                    parent.frameObj.type = type;\n                    parent.frameObj.size = 20;\n                    parent.frameObj.inset = 20;\n                    parent.frameObj.radius = 0;\n                    parent.frameObj.amount = 1;\n                    if (type === 'inset') {\n                        parent.frameObj.offset = 60;\n                    }\n                    else {\n                        parent.frameObj.offset = 20;\n                    }\n                    this.refreshToolbar('frame');\n                    parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null, isPreventClearRect: null, isFrame: true } });\n                    parent.isFrameBtnClick = true;\n                    parent.curFrameObjEvent = { previousFrameSetting: parent.tempFrameObj, currentFrameSetting: parent.frameObj };\n                    parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: parent.tempFrameObj, obj: { frameChangeEventArgs: null } } });\n                    break;\n                case 'redact':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    if (isNullOrUndefined(parent.activeObj.redactBlur)) {\n                        parent.activeObj.redactBlur = 20;\n                    }\n                    if (isNullOrUndefined(parent.activeObj.redactPixelate)) {\n                        parent.activeObj.redactPixelate = 20;\n                    }\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    this.refreshToolbar('redact');\n                    this.redactSlider(parent.activeObj.redactType);\n                    break;\n                case 'pixelate':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    if (parent.activeObj.redactType === 'blur') {\n                        this.updateRedactType('pixelate');\n                    }\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false,\n                        value: { redactType: 'pixelate' } });\n                    if (parent.activeObj.redactType === 'pixelate') {\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        if (pixelateBtn) {\n                            pixelateBtn.classList.add('e-selected-btn');\n                        }\n                        if (redactBlurBtn && redactBlurBtn.classList.contains('e-selected-btn')) {\n                            redactBlurBtn.classList.remove('e-selected-btn');\n                        }\n                    }\n                    else {\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        if (redactBlurBtn) {\n                            redactBlurBtn.classList.add('e-selected-btn');\n                        }\n                    }\n                    this.redactSlider(parent.activeObj.redactType);\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: null, previousObjColl: null,\n                                previousPointColl: null, previousSelPointColl: null,\n                                previousCropObj: null, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    break;\n                case 'redactblur':\n                    parent.currObjType.isRedact = true;\n                    parent.drawingShape = 'redact';\n                    parent.notify('selection', { prop: 'annotate', value: { shape: 'redact' } });\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false,\n                        value: { redactType: 'blur' } });\n                    if (parent.activeObj.redactType === 'pixelate') {\n                        this.updateRedactType('blur');\n                    }\n                    parent.notify('shape', { prop: 'setRedactType', onPropertyChange: false, value: { redactType: 'blur' } });\n                    if (parent.activeObj.redactType === 'blur') {\n                        var redactBlurBtn = parent.element.querySelector('#' + id + '_' + 'redactBlur');\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        if (redactBlurBtn) {\n                            redactBlurBtn.classList.add('e-selected-btn');\n                        }\n                        if (pixelateBtn && pixelateBtn.classList.contains('e-selected-btn')) {\n                            pixelateBtn.classList.remove('e-selected-btn');\n                        }\n                    }\n                    else {\n                        var pixelateBtn = parent.element.querySelector('#' + id + '_' + 'pixelate');\n                        if (pixelateBtn) {\n                            pixelateBtn.classList.add('e-selected-btn');\n                        }\n                    }\n                    this.redactSlider(parent.activeObj.redactType);\n                    if (parent.activeObj.activePoint.width !== 0 || parent.activeObj.activePoint.height !== 0) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: null, previousObjColl: null,\n                                previousPointColl: null, previousSelPointColl: null,\n                                previousCropObj: null, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    break;\n            }\n        }\n    };\n    ToolbarModule.prototype.updateRedactType = function (value) {\n        var parent = this.parent;\n        parent.activeObj.redactType = value;\n        parent.notify('shape', { prop: 'setRedactType', value: { type: value } });\n        this.parent.objColl.push(parent.activeObj);\n        parent.notify('selection', { prop: 'redrawShape', value: { obj: parent.objColl[parent.objColl.length - 1] } });\n    };\n    ToolbarModule.prototype.frameToolbarClick = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var frame = document.querySelector('#' + id + '_frame');\n        var zoom;\n        var frameObj;\n        var tempFrameObj;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        if (parent.currObjType.isFiltered || parent.currObjType.isRedact) {\n            parent.okBtn();\n        }\n        if (frame && !frame.classList.contains('e-overlay')) {\n            zoom = parent.transform.zoomFactor;\n            parent.frameDestPoints = extend({}, parent.img, {}, true);\n            if (isNullOrUndefined(parent.cxtTbarHeight)) {\n                frameObj = extend({}, parent.frameObj, {}, true);\n                tempFrameObj = extend({}, parent.tempFrameObj, {}, true);\n                this.callFrameToolbar();\n                parent.frameObj.type = 'mat';\n                this.callFrameToolbar();\n                parent.cxtTbarHeight = parent.element.querySelector('#' + id + '_customizeWrapper').scrollHeight;\n                parent.frameObj = frameObj;\n                parent.tempFrameObj = tempFrameObj;\n            }\n            this.zoomToFrameRange();\n            parent.tempFrameZoomLevel = zoom;\n            if (Browser.isDevice) {\n                parent.img.destTop -= (parent.cxtTbarHeight / 2);\n            }\n            else {\n                parent.img.destTop += (parent.cxtTbarHeight / 2);\n            }\n            this.callFrameToolbar();\n            parent.notify('draw', { prop: 'triggerFrameChange', value: { prevFrameSettings: parent.frameObj, obj: { frameChangeEventArgs: null } } });\n        }\n    };\n    ToolbarModule.prototype.zoomToFrameRange = function () {\n        var parent = this.parent;\n        this.isFrameToolbar = false;\n        parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n        var isSmaller = true;\n        while (isSmaller) {\n            if (this.toolbarHeight + parent.img.destTop >= (this.toolbarHeight + parent.cxtTbarHeight)) {\n                isSmaller = false;\n                break;\n            }\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -.1, zoomPoint: null, isResize: true } });\n        }\n        this.isFrameToolbar = true;\n    };\n    ToolbarModule.prototype.resizeClick = function () {\n        var parent = this.parent;\n        parent.notify('draw', { prop: 'updateCropSelection', onPropertyChange: false });\n        parent.upperCanvas.style.cursor = 'default';\n        parent.notify('transform', { prop: 'updateResize', value: { bool: false } });\n        if (this.isAspectRatio) {\n            this.isAspectRatio = false;\n        }\n        else {\n            this.isAspectRatio = true;\n        }\n        parent.isResize = true;\n        this.refreshToolbar('resize');\n    };\n    ToolbarModule.prototype.callFrameToolbar = function () {\n        var parent = this.parent;\n        extend(parent.tempFrameObj, parent.frameObj);\n        var undoRedoObj = { appliedUndoRedoColl: [] };\n        parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: undoRedoObj } });\n        if (undoRedoObj['appliedUndoRedoColl']['length'] === 0) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false, value: {\n                    operation: 'frame', previousObj: object['currObj'], previousObjColl: object['currObj']['objColl'],\n                    previousPointColl: object['currObj']['pointColl'], previousSelPointColl: object['currObj']['selPointColl'],\n                    previousCropObj: extend({}, parent.cropObj, {}, true), previousText: null, currentText: null,\n                    previousFilter: null, isCircleCrop: null\n                } });\n        }\n        this.refreshToolbar('frame');\n    };\n    ToolbarModule.prototype.contextualToolbarClicked = function (args) {\n        var parent = this.parent;\n        var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selEle) {\n            selEle.classList.remove('e-selected');\n        }\n        var type = args.item.id.replace(parent.element.id, '').split('_')[1];\n        var imageFiltering = { filter: parent.toPascalCase(type), cancel: false };\n        parent.trigger('imageFiltering', imageFiltering);\n        parent.editCompleteArgs = imageFiltering;\n        if (imageFiltering.cancel) {\n            return;\n        }\n        document.getElementById(args.item.id + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n        parent.currObjType.isFiltered = true;\n        parent.notify('filter', { prop: 'applyImageFilter', value: { option: type.toLowerCase() } });\n        parent.notify('draw', { prop: 'redrawDownScale' });\n        parent.currentFilter = args.item.id;\n        this.enableDisableTbrBtn();\n        parent.isFilterCanvasClick = true;\n        parent.curFilterObjEvent = imageFiltering;\n    };\n    ToolbarModule.prototype.refreshShapeDrawing = function () {\n        var parent = this.parent;\n        var object = { shape: '' };\n        parent.notify('selection', { prop: 'getCurrentDrawingShape', onPropertyChange: false, value: { obj: object } });\n        if (object['shape'] !== '') {\n            parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.refreshToolbar('main', false);\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnClickHandler = function (e) {\n        if (e) {\n            var parent_1 = this.parent;\n            if ((parent_1.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                parent_1.noPushUndo = false;\n                if (parent_1.currObjType.isFiltered) {\n                    parent_1.okBtn();\n                }\n                var drawingShape = parent_1.drawingShape;\n                if (parent_1.drawingShape) {\n                    var id = parent_1.activeObj.currIndex;\n                    parent_1.noPushUndo = true;\n                    parent_1.okBtn();\n                    parent_1.noPushUndo = false;\n                    parent_1.drawingShape = null;\n                    if (id) {\n                        parent_1.selectShape(id);\n                    }\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomIn = document.querySelector('#' + parent_1.element.id + '_zoomIn');\n                EventHandler.trigger(zoomIn, 'click');\n                var obj = { bool: false };\n                parent_1.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_1.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_1.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_1.currObjType.isFiltered = false;\n                parent_1.currObjType.isRedact = false;\n                if (parent_1.togglePen) {\n                    parent_1.currObjType.isZoomed = true;\n                    parent_1.freeHandDraw(false);\n                    parent_1.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_1.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_1.drawingShape = drawingShape;\n                parent_1.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: .1, zoomPoint: null, isResize: null } });\n                parent_1.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_1.isCropTab || parent_1.activeObj.shape) {\n                    parent_1.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_1.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_1.isStraightening) {\n                    parent_1.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_1.notify('draw', { prop: 'setDestForStraighten' });\n                }\n                var actionArgs = { action: 'zoom-in',\n                    actionEventArgs: parent_1.editCompleteArgs };\n                parent_1.triggerEditCompleteEvent(actionArgs);\n                if (Browser.isDevice) {\n                    zoomIn.focus();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomOutBtnClickHandler = function (e) {\n        if (e) {\n            var parent_2 = this.parent;\n            if ((parent_2.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                parent_2.noPushUndo = false;\n                if (parent_2.currObjType.isFiltered) {\n                    parent_2.okBtn();\n                }\n                var drawingShape = parent_2.drawingShape;\n                if (parent_2.drawingShape) {\n                    var id = parent_2.activeObj.currIndex;\n                    parent_2.noPushUndo = true;\n                    parent_2.okBtn();\n                    parent_2.noPushUndo = false;\n                    parent_2.drawingShape = null;\n                    if (id) {\n                        parent_2.selectShape(id);\n                    }\n                }\n                this.refreshShapeDrawing();\n                if (Browser.isDevice && e.type === 'touchstart') {\n                    if (!e.returnValue) {\n                        return;\n                    }\n                    e.preventDefault();\n                }\n                var zoomOut = document.querySelector('#' + parent_2.element.id + '_zoomOut');\n                EventHandler.trigger(zoomOut, 'click');\n                var obj = { bool: false };\n                parent_2.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n                if (obj['bool']) {\n                    parent_2.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                    this.destroyQuickAccessToolbar();\n                }\n                parent_2.isZoomBtnClick = true;\n                this.applyPreviewFilter();\n                parent_2.currObjType.isFiltered = false;\n                parent_2.currObjType.isRedact = false;\n                if (parent_2.togglePen) {\n                    parent_2.currObjType.isZoomed = true;\n                    parent_2.freeHandDraw(false);\n                    parent_2.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent_2.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n                parent_2.drawingShape = drawingShape;\n                parent_2.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -.1, zoomPoint: null, isResize: null } });\n                parent_2.notify('draw', { prop: 'redrawDownScale' });\n                if (parent_2.isCropTab || parent_2.activeObj.shape) {\n                    parent_2.notify('draw', { prop: 'setStraightenActObj', value: { activeObj: null } });\n                    parent_2.notify('freehand-draw', { prop: 'resetStraightenPoint' });\n                }\n                if (parent_2.isStraightening) {\n                    parent_2.notify('draw', { prop: 'resetStraightenDestPoints' });\n                    parent_2.notify('draw', { prop: 'setDestForStraighten' });\n                }\n                var actionArgs = { action: 'zoom-out',\n                    actionEventArgs: parent_2.editCompleteArgs };\n                parent_2.triggerEditCompleteEvent(actionArgs);\n                if (Browser.isDevice) {\n                    zoomOut.focus();\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomInBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomOutBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomOutBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomBtnMouseUpHandler = function () {\n        clearInterval(this.zoomBtnHold);\n        this.zoomBtnHold = 0;\n    };\n    ToolbarModule.prototype.closeContextualToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var isContextualToolbar = false;\n        var straightenObj = { bool: parent.isStraightening };\n        if (!Browser.isDevice || (Browser.isDevice && !straightenObj['bool'])) {\n            if ((parent.element.querySelector('#' + id + '_contextualToolbar') &&\n                !parent.element.querySelector('#' + id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n                (parent.element.querySelector('#' + id + '_headWrapper')\n                    && !parent.element.querySelector('#' + id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                parent.okBtn();\n                this.refreshMainToolbar();\n                isContextualToolbar = true;\n            }\n        }\n        return isContextualToolbar;\n    };\n    ToolbarModule.prototype.destroyQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var quickToolbar = document.getElementById(id + '_quickAccessToolbar');\n        if (quickToolbar && quickToolbar.classList.contains('e-control')) {\n            getComponent(quickToolbar, 'toolbar').destroy();\n        }\n        var qatArea = document.getElementById(id + '_quickAccessToolbarArea');\n        if (qatArea) {\n            qatArea.style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.renderSlider = function (type, isSelect) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + id + '_labelWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.remove();\n            labelWrapper.remove();\n        }\n        hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n            id: id + '_headWrapper',\n            styles: 'position: relative'\n        }));\n        if (type === 'transparency') {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? 'position: absolute; top: 31%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n                    : 'position: absolute; top: 31%; left: calc(50% - 220px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        else {\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_labelWrapper',\n                className: 'e-ie-finetune-slider-label',\n                styles: Browser.isDevice ? ('position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;')\n                    : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        labelWrapper.textContent = this.l10n.getConstant(parent.toPascalCase(type === 'transparency' ? 'opacity' : type));\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: id + '_sliderWrapper',\n            className: 'e-ie-finetune-slider-wrap',\n            styles: 'position: absolute'\n        }));\n        var value = parent.getCurrAdjustmentValue(type);\n        if (isSelect && type === 'straighten' && Browser.isDevice) {\n            value = parent.cropObj.straighten;\n        }\n        var min;\n        var max;\n        var slider;\n        if (type === 'brightness' || type === 'contrast' || type === 'saturation' || type === 'exposure') {\n            if (parent.finetuneSettings) {\n                if (type === 'brightness' && parent.finetuneSettings.brightness) {\n                    min = parent.finetuneSettings.brightness.min;\n                    max = parent.finetuneSettings.brightness.max;\n                }\n                else if (type === 'contrast' && parent.finetuneSettings.contrast) {\n                    min = parent.finetuneSettings.contrast.min;\n                    max = parent.finetuneSettings.contrast.max;\n                }\n                else if (type === 'saturation' && parent.finetuneSettings.saturation) {\n                    min = parent.finetuneSettings.saturation.min;\n                    max = parent.finetuneSettings.saturation.max;\n                }\n                else if (type === 'exposure' && parent.finetuneSettings.exposure) {\n                    min = parent.finetuneSettings.exposure.min;\n                    max = parent.finetuneSettings.exposure.max;\n                }\n                else {\n                    min = -100;\n                    max = 100;\n                }\n            }\n            else {\n                min = -100;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'hue' || type === 'blur' || type === 'opacity') {\n            if (parent.finetuneSettings) {\n                if (type === 'hue' && parent.finetuneSettings.hue) {\n                    min = parent.finetuneSettings.hue.min;\n                    max = parent.finetuneSettings.hue.max;\n                }\n                else if (type === 'blur' && parent.finetuneSettings.blur) {\n                    min = parent.finetuneSettings.blur.min;\n                    max = parent.finetuneSettings.blur.max;\n                }\n                else if (type === 'opacity' && parent.finetuneSettings.opacity) {\n                    min = parent.finetuneSettings.opacity.min;\n                    max = parent.finetuneSettings.opacity.max;\n                }\n                else {\n                    min = 0;\n                    max = 100;\n                }\n            }\n            else {\n                min = 0;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'transparency') {\n            min = 0;\n            max = 100;\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'straighten') {\n            min = -45;\n            max = 45;\n            slider = this.createSlider(min, max, value, type);\n        }\n        slider.appendTo('#' + id + '_sliderWrapper');\n        sliderWrapper.style.left = (parseFloat(canvasWrapper.style.width) - parseFloat(slider.width)) / 2 + 'px';\n        if (type === 'straighten' && Browser.isDevice) {\n            var sLabelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_sLabelWrapper',\n                className: 'e-ie-straighten-value-span e-ie-finetune-value-span',\n                styles: 'position: absolute; top: 31%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sLabelWrapper.innerHTML = parent.transform.straighten.toString() + '&#176';\n            sliderWrapper.parentElement.classList.add('e-straighten-slider');\n        }\n        if (type !== 'straighten') {\n            hdrWrapper.appendChild(parent.createElement('label', {\n                id: id + '_finetuneSpan',\n                className: 'e-ie-finetune-value-span',\n                styles: Browser.isDevice ? ('position: absolute; top: 25%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;') :\n                    'position: absolute; top: 25%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n            sliderWrapper.parentElement.classList.add('e-finetune-slider');\n            if (type === 'transparency' && Browser.isDevice) {\n                sliderWrapper.parentElement.classList.add('e-ie-device-transparency-slider');\n            }\n            this.updateFinetuneSpan(type);\n        }\n    };\n    ToolbarModule.prototype.createSlider = function (min, max, value, type) {\n        var _this = this;\n        var parent = this.parent;\n        var step = type === 'straighten' ? 3 : 1;\n        return new Slider({\n            value: value, type: 'MinRange', min: min, max: max,\n            step: step, width: Browser.isDevice ? '180px' : (type === 'straighten' ? '200px' : '300px'),\n            cssClass: 'e-slider',\n            change: function (args) {\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: true } });\n                if (type === 'transparency') {\n                    if (parent.activeObj.shape) {\n                        if (isNullOrUndefined(parent.activeObj.imageRatio)) {\n                            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                        }\n                        parent.notify('shape', { prop: 'pushActItemIntoObj' });\n                        var prevCropObj = extend({}, parent.cropObj, {}, true);\n                        var object = { currObj: {} };\n                        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                        var prevObj = object['currObj'];\n                        prevObj.objColl = extend([], parent.objColl, [], true);\n                        prevObj.pointColl = extend([], parent.pointColl, [], true);\n                        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                        var selPointCollObj = { selPointColl: null };\n                        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                            value: { obj: selPointCollObj } });\n                        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                        parent.objColl.pop();\n                        parent.activeObj.opacity = args.value / 100;\n                        _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        parent.objColl.push(parent.activeObj);\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                previousCropObj: prevCropObj, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                        parent.notify('selection', { prop: 'redrawShape', value: { obj: parent.objColl[parent.objColl.length - 1] } });\n                        _this.updateFinetuneSpan(type);\n                    }\n                }\n                else if (type === 'straighten') {\n                    parent.setStraighten(args.value);\n                }\n                else {\n                    if (parent.transform.zoomFactor && parent.transform.zoomFactor < 0) {\n                        parent.isFinetuning = true;\n                    }\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: true } });\n                    parent.setCurrAdjustmentValue(type, args.value);\n                    _this.updateFinetuneSpan(type);\n                    _this.enableDisableTbrBtn();\n                    parent.isFinetuning = false;\n                }\n            },\n            changed: function () {\n                if (type !== 'transparency' && type !== 'straighten') {\n                    parent.notify('selection', { prop: 'setSliding', value: { bool: false } });\n                    parent.notify('draw', { prop: 'redrawDownScale' });\n                }\n                parent.notify('selection', { prop: 'setSliderActive', onPropertyChange: false, value: { bool: false } });\n                if (type === 'transparency') {\n                    setTimeout(function () {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                        parent.element.querySelector('#' + parent.element.id + '_transparency').click();\n                    }, 50);\n                }\n            }\n        });\n    };\n    ToolbarModule.prototype.updateFinetuneSpan = function (type) {\n        var parent = this.parent;\n        var ftValPan = parent.element.querySelector('.e-ie-finetune-value-span');\n        if (ftValPan) {\n            var adjObj = { adjustmentLevel: null };\n            parent.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false, value: { obj: adjObj } });\n            ftValPan.innerHTML = Math.round(adjObj['adjustmentLevel'][type]).toString();\n        }\n    };\n    ToolbarModule.prototype.applyPreviewFilter = function () {\n        var parent = this.parent;\n        if (document.querySelector('#' + parent.element.id + '_sliderWrapper') ||\n            parent.currObjType.isFiltered) {\n            parent.initialAdjustmentValue = this.lowerContext.filter;\n            parent.canvasFilter = this.lowerContext.filter;\n            parent.currObjType.isFiltered = false;\n        }\n    };\n    ToolbarModule.prototype.unselectBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_brightness',\n            '#' + id + '_contrast',\n            '#' + id + '_hue',\n            '#' + id + '_saturation',\n            '#' + id + '_opacity',\n            '#' + id + '_blur',\n            '#' + id + '_exposure'\n        ];\n        for (var _i = 0, selectors_1 = selectors; _i < selectors_1.length; _i++) {\n            var selector = selectors_1[_i];\n            var element = document.querySelector(selector);\n            if (element && element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.openSlider = function (type) {\n        this.unselectBtn();\n        this.parent.currObjType.isFiltered = true;\n        this.refreshToolbar('color', null, null, null, type);\n        document.getElementById(this.parent.element.id + '_' + type).classList.add('e-selected-btn');\n    };\n    ToolbarModule.prototype.refreshSlider = function () {\n        var id = this.parent.element.id;\n        var sliderWrapper = document.querySelector('#' + id + '_sliderWrapper');\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var slider = document.querySelector('.e-slider');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.style.display = 'none';\n        }\n        if (sliderWrapper && slider) {\n            slider.ej2_instances[0].destroy();\n            sliderWrapper.remove();\n        }\n    };\n    ToolbarModule.prototype.unselectFrameBtn = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var selectors = [\n            '#' + id + '_none',\n            '#' + id + '_mat',\n            '#' + id + '_line',\n            '#' + id + '_inset',\n            '#' + id + '_bevel',\n            '#' + id + '_hook'\n        ];\n        for (var _i = 0, selectors_2 = selectors; _i < selectors_2.length; _i++) {\n            var selector = selectors_2[_i];\n            var element = document.querySelector(selector);\n            if (element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.updateToolbarItems = function () {\n        var parent = this.parent;\n        var id = parent.element.id;\n        if (!parent.isImageLoaded) {\n            return;\n        }\n        if (this.isToolbar()) {\n            var selFillElem = parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n            var selStrokeElem = parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n            var selTextStrokeElem = parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n            var selStrokeTextColorElem = parent.element.querySelector('.e-stroke-text-font-color.e-template .e-dropdownbtn-preview');\n            var selTextBGElem = parent.element.querySelector('.e-text-background-color.e-template .e-dropdownbtn-preview');\n            var selPenStrokeElem = parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n            var strokeWidthElem = parent.element.querySelector('.e-shape-stroke-width');\n            var rectangleRadiusElem = parent.element.querySelector('.e-shape-rectangle-radius');\n            var fontFamilyElem = parent.element.querySelector('.e-text-font-family');\n            var fontSizeElem = parent.element.querySelector('.e-text-font-size');\n            var boldBtn = parent.element.querySelector('#' + id + '_bold');\n            var italicBtn = parent.element.querySelector('#' + id + '_italic');\n            if (parent.activeObj.strokeSettings && parent.activeObj.textSettings) {\n                if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                    parent.activeObj.strokeSettings.strokeWidth = 2;\n                }\n                if (isNullOrUndefined(parent.activeObj.strokeSettings.outlineWidth)) {\n                    parent.activeObj.strokeSettings.outlineWidth = 2;\n                }\n                if (selFillElem) {\n                    var value = parent.activeObj.strokeSettings.fillColor;\n                    if (parent.activeObj.strokeSettings.fillColor === '') {\n                        selFillElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selFillElem.classList.remove('e-nocolor-item');\n                        selFillElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_shape_fill')) {\n                        getComponent(id + '_shape_fill', 'colorpicker').value = value;\n                    }\n                }\n                if (selStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_shape_stroke')) {\n                        getComponent(id + '_shape_stroke', 'colorpicker').value = value;\n                    }\n                }\n                if (selTextStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selTextStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_text_font')) {\n                        getComponent(id + '_text_font', 'colorpicker').value = value;\n                    }\n                }\n                if (selStrokeTextColorElem) {\n                    var value = parent.activeObj.strokeSettings.outlineColor;\n                    if (!/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6}|[0-9A-Fa-f]{8})$|^[a-zA-Z]+$/.test(parent.activeObj.strokeSettings.outlineColor)) {\n                        selStrokeTextColorElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selStrokeTextColorElem.classList.remove('e-nocolor-item');\n                        selStrokeTextColorElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_stroke_text')) {\n                        getComponent(id + '_stroke_text', 'colorpicker').value = value;\n                    }\n                }\n                if (selTextBGElem) {\n                    var value = parent.activeObj.strokeSettings.fillColor;\n                    if (parent.activeObj.strokeSettings.fillColor === '' || parent.activeObj.strokeSettings.fillColor === 'transparent') {\n                        selTextBGElem.classList.add('e-nocolor-item');\n                    }\n                    else {\n                        selTextBGElem.classList.remove('e-nocolor-item');\n                        selTextBGElem.style.background = value;\n                    }\n                    if (document.querySelector('#' + id + '_text_bgColor')) {\n                        getComponent(id + '_text_bgColor', 'colorpicker').value = value;\n                    }\n                }\n                if (selPenStrokeElem) {\n                    var value = parent.activeObj.strokeSettings.strokeColor;\n                    selPenStrokeElem.style.background = value;\n                    if (document.querySelector('#' + id + '_pen_stroke')) {\n                        getComponent(id + '_pen_stroke', 'colorpicker').value = value;\n                    }\n                    var obj = { penOpacity: 1 };\n                    parent.notify('freehand-draw', { prop: 'getPenOpacity', onPropertyChange: false, value: { obj: obj } });\n                }\n                if (fontFamilyElem) {\n                    if (Browser.isDevice) {\n                        fontFamilyElem.setAttribute('style', 'font-family:' + parent.activeObj.textSettings.fontFamily.toLowerCase());\n                    }\n                    else {\n                        fontFamilyElem.textContent = parent.activeObj.textSettings.fontFamily;\n                    }\n                }\n                if (fontSizeElem) {\n                    for (var i = 0; i < parent.fontSizeColl.length; i++) {\n                        if (parseInt(parent.fontSizeColl[i].text, 10) >= Math.round(parent.activeObj.textSettings.fontSize)) {\n                            fontSizeElem.textContent = (i + 1).toString();\n                            break;\n                        }\n                        else {\n                            if (Math.round(parent.activeObj.textSettings.fontSize) < parseInt(parent.fontSizeColl[0].text, 10)) {\n                                fontSizeElem.textContent = '1';\n                                break;\n                            }\n                            else if (Math.round(parent.activeObj.textSettings.fontSize) >\n                                parseInt(parent.fontSizeColl[parent.fontSizeColl.length - 1].text, 10)) {\n                                fontSizeElem.textContent = ((parent.fontSizeColl.length - 1) + 1).toString();\n                                break;\n                            }\n                        }\n                    }\n                }\n                if (boldBtn) {\n                    if (parent.activeObj.textSettings.bold) {\n                        boldBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        boldBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (italicBtn) {\n                    if (parent.activeObj.textSettings.italic) {\n                        italicBtn.classList.add('e-selected-btn');\n                    }\n                    else {\n                        italicBtn.classList.remove('e-selected-btn');\n                    }\n                }\n                if (strokeWidthElem) {\n                    var width = parent.activeObj.shape === 'text' ? parent.activeObj.strokeSettings.outlineWidth : parent.activeObj.strokeSettings.strokeWidth;\n                    var strokeWidth = Math.round(width).toString();\n                    strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n                }\n                if (rectangleRadiusElem) {\n                    var rectRadius = Math.round((parent.activeObj.strokeSettings.radius)).toString();\n                    rectangleRadiusElem.textContent = this.getRectRadius(rectRadius);\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 0:\n                strokeWidth = this.l10n.getConstant('NoOutline');\n                break;\n            case 1:\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case 2:\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case 3:\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case 4:\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case 5:\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ToolbarModule.prototype.getRectRadius = function (text) {\n        var rectRadius;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 0:\n                rectRadius = this.l10n.getConstant('0');\n                break;\n            case 1:\n                rectRadius = this.l10n.getConstant('20');\n                break;\n            case 2:\n                rectRadius = this.l10n.getConstant('40');\n                break;\n            case 3:\n                rectRadius = this.l10n.getConstant('60');\n                break;\n            case 4:\n                rectRadius = this.l10n.getConstant('80');\n                break;\n            case 5:\n                rectRadius = this.l10n.getConstant('100');\n                break;\n        }\n        return rectRadius;\n    };\n    ToolbarModule.prototype.cancelPan = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        parent.pan(false);\n    };\n    ToolbarModule.prototype.refreshMainToolbar = function () {\n        if (this.currToolbar !== 'main') {\n            this.refreshToolbar('main');\n        }\n    };\n    ToolbarModule.prototype.destroySubComponents = function () {\n        var parent = this.parent;\n        var inputElement = parent.element.querySelectorAll('input.e-control');\n        var btnElement = parent.element.querySelectorAll('button.e-control');\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-color-picker')) {\n                getComponent(inputElement[i], 'color-picker').destroy();\n                detach(select('input#' + inputElement[i].id, parent.element));\n            }\n        }\n        for (var i = 0, len = btnElement.length; i < len; i++) {\n            if (btnElement[i].classList.contains('e-dropdown-btn')) {\n                getComponent(btnElement[i], 'dropdown-btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n            else if (btnElement[i].classList.contains('e-btn')) {\n                getComponent(btnElement[i], 'btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n        }\n    };\n    ToolbarModule.prototype.setInitialShapeSettings = function (args) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.currObjType.shape = args.item.id;\n        parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n        parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n        var orderObj = { order: null };\n        parent.notify('shape', { prop: 'getNewOrder', onPropertyChange: false, value: { obj: orderObj } });\n        parent.activeObj.order = orderObj['order'];\n    };\n    ToolbarModule.prototype.isToolbarString = function (items) {\n        var isString = false;\n        for (var i = 0; i < items.length; i++) {\n            if (typeof (items[i]) === 'string') {\n                isString = true;\n                break;\n            }\n        }\n        return isString;\n    };\n    ToolbarModule.prototype.excludeItems = function (items) {\n        var indexArr = [];\n        for (var i = 0; i < items.length; i++) {\n            var index = this.getIndex(items[i]);\n            if (index !== -1) {\n                indexArr.push(index);\n            }\n        }\n        var negativeIndexArr = [];\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            if (this.defToolbarItems[i].align === 'Center' && !this.isSameIndex(indexArr, i) &&\n                this.defToolbarItems[i].id !== this.parent.element.id + '_' + 'annotation') {\n                negativeIndexArr.push(i);\n            }\n        }\n        for (var i = negativeIndexArr.length - 1; i >= 0; i--) {\n            this.defToolbarItems.splice(negativeIndexArr[i], 1);\n        }\n    };\n    ToolbarModule.prototype.isSameIndex = function (indexArr, index) {\n        for (var i = 0; i < indexArr.length; i++) {\n            if (indexArr[i] === index) {\n                return true;\n            }\n        }\n        return false;\n    };\n    ToolbarModule.prototype.getIndex = function (item) {\n        var index = -1;\n        var isFontColor = false;\n        if (item === 'rotateLeft') {\n            item = 'rotLeft';\n        }\n        if (item === 'rotateRight') {\n            item = 'rotRight';\n        }\n        if (item === 'horizontalFlip') {\n            item = 'hflip';\n        }\n        if (item === 'verticalFlip') {\n            item = 'vflip';\n        }\n        if (item === 'arrowStart') {\n            item = 'start';\n        }\n        if (item === 'arrowEnd') {\n            item = 'end';\n        }\n        if (item === 'fontColor') {\n            item = 'strokeColor';\n            isFontColor = true;\n        }\n        for (var i = 0; i < this.defToolbarItems.length; i++) {\n            var id = this.defToolbarItems[i].id;\n            if (id && id.toLowerCase().indexOf(item.toLowerCase()) !== -1) {\n                index = i;\n                break;\n            }\n        }\n        if (isFontColor) {\n            item = 'fontColor';\n        }\n        return index;\n    };\n    ToolbarModule.prototype.getModuleName = function () {\n        return 'toolbar-module';\n    };\n    ToolbarModule.prototype.redactSlider = function (type) {\n        var parent = this.parent;\n        var id = parent.element.id;\n        var toolbarArea = parent.element.querySelector('#' + id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + id + '_contextualToolbarArea');\n        if (!contextualToolbarArea) {\n            return;\n        }\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        var canvasWrapper = document.querySelector('#' + id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + id + '_labelWrapper');\n        var ctxTbar = document.querySelector('#' + id + '_contextualToolbar');\n        if (hdrWrapper) {\n            hdrWrapper.remove();\n            labelWrapper.remove();\n        }\n        if (ctxTbar) {\n            ctxTbar.remove();\n            this.createContextualToolbar();\n        }\n        hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n            id: id + '_headWrapper',\n            styles: 'position: relative'\n        }));\n        labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n            id: id + '_labelWrapper',\n            className: 'e-ie-finetune-slider-label',\n            styles: Browser.isDevice ? ('position: absolute; top: 31%; left: calc(50% - 160px); font-size: 15px; text-transform: capitalize; font-weight: 400;')\n                : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n        }));\n        var text = type === 'blur' ? this.l10n.getConstant('Blur') : this.l10n.getConstant('PixelSize');\n        labelWrapper.textContent = text;\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: id + '_sliderWrapper',\n            className: 'e-ie-finetune-slider-wrap',\n            styles: 'position: absolute'\n        }));\n        hdrWrapper.appendChild(parent.createElement('label', {\n            id: id + '_redactSpan',\n            className: 'e-ie-redact-value-span',\n            styles: Browser.isDevice ? ('position: absolute; top: 30%; margin-left: 20px; font-size: 15px; text-transform: capitalize; font-weight: 400;') :\n                'position: absolute; top: 30%; left: calc(50% + 190px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n        }));\n        sliderWrapper.parentElement.classList.add('e-finetune-slider');\n        var value = parent.activeObj.redactType === 'blur' ? parent.activeObj.redactBlur :\n            parent.activeObj.redactPixelate;\n        var redactSlider = new Slider({\n            tooltip: { placement: 'Before', isVisible: true, showOn: 'Focus' },\n            min: 10, max: 100, step: 1, value: value,\n            type: 'MinRange',\n            width: Browser.isDevice ? '130px' : '300px',\n            created: function () {\n                parent.element.querySelector('.e-ie-redact-value-span').innerText = value.toString();\n            },\n            change: function (args) {\n                parent.element.querySelector('.e-ie-redact-value-span').innerText = args.value.toString();\n                if (parent.activeObj.redactType === 'blur') {\n                    parent.activeObj.redactBlur = parent.tempRedactBlur = args.value;\n                }\n                else if (parent.activeObj.redactType === 'pixelate') {\n                    parent.activeObj.redactPixelate = parent.tempRedactPixel = args.value;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            },\n            changed: function () {\n                setTimeout(function () {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoStack', onPropertyChange: false });\n                }, 50);\n            }\n        });\n        redactSlider.appendTo('#' + id + '_sliderWrapper');\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight + 1;\n            var cusWrapper = parent.element.querySelector('#' + id + '_customizeWrapper');\n            if (this.isFrameToolbar && cusWrapper) {\n                cHt = cusWrapper.offsetHeight + 2;\n            }\n            var ht = parent.element.querySelector('#' + id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + 1 + ht - cHt + 'px';\n        }\n    };\n    return ToolbarModule;\n}());\nexport { ToolbarModule };\n"],"names":["Crop","parent","this","croppedDegree","cropDestPoints","startX","startY","width","height","tempFlipPanPoint","x","y","isPreventScaling","isInitCrop","isTransformCrop","addEventListener","prototype","destroy","isDestroyed","removeEventListener","on","cropping","off","args","updateCropPvtVar","prop","cropCircle","value","setCurrSelPoints","updateRotatePan","crop","calcRatio","getCurrFlipState","prevCropCurrObj","isNullOrUndefined","adjustStraightenForShapes","resizeWrapper","resetZoom","revertTransform","reset","getModuleName","lowerCanvas","lowerContext","getContext","upperCanvas","upperContext","cropImg","isRotateCrop","isNullCrop","resizeIcon","element","querySelector","id","actPoint","activeObj","activePoint","img","isRotated","i","len","rotateFlipColl","length","currentValue","notify","onPropertyChange","transform","degree","updateCropObj","point","destLeft","destTop","destWidth","destHeight","rotateCrop","currFlipState","flipCrop","tempZoomFactor","zoomFactor","ratio","currSelectionPoint","extend","obj","isImgShape","maxDimension","clearRect","srcLeft","srcTop","srcWidth","srcHeight","clientWidth","clientHeight","temp","filter","cropObjColl","straighten","cropFreehandDrawColl","shapeColl","ctx","shape","pen","isPreventApply","context","isCircleCrop","currObjType","isCustomCrop","pan","defaultZoomFactor","type","isInitialRotated","center","_i","_a","objColl","indexOf","rotatedAngle","_b","angle","diffX","diffY","cosAngle","Math","cos","sinAngle","sin","diffXUpdated","diffYUpdated","endX","endY","afterCropActions","object","currObj","cropObj","flipState","push","tempCurrSelObj","preventSelObj","bool","coll","panToSelRangle","canvas","pop","straightenBaseImageCanvas","isMouseWheel","isIntersect","count","zoomPoint","isResize","isRotate","direction","toPascalCase","toString","updateFlipState","shapeFlip","pointColl","freehandCounter","isUndoRedo","setProperties","zoomSettings","previousZoomValue","isReverseFlip","panPoint","totalPannedPoint","tempCurrFlipState","flipColl","tempFlipColl","panX","panY","setTransform","isPreventDestination","isPreventCircleCrop","isRotateZoom","imageRatio","size","shapeDegree","abs","textSettings","fontRatio","fontSize","cropPointCollection","n","ratioX","ratioY","points","l","resetAnnotations","isSetDimension","allowDownScale","destPoint","isCropTab","baseImgCanvas","currSelPoint","totalPannedInternalPoint","cropPointColl","straightenObj","straightenPoint","destPoints","selPointColl","cropSelPointColl","actObj","xDiff","yDiff","currentPannedPoint","cropZoom","isContextualToolbar","isApplyBtn","isCropping","isZooming","cType","document","innerHTML","isReverse","pannedPoint","totalPannedClientPoint","isSave","isFlip","globalCompositeOperation","beginPath","centerX","centerY","radius","arc","PI","closePath","fill","restore","isActiveObj","getCurrCropState","panRegion","disabled","isImageLoaded","isCropToolbar","isUndoAction","transitionArgs","cancel","startPoint","endPoint","preventScaling","trigger","editCompleteArgs","cropEvent","splitWords","split","horTopLine","isCrop","prevCropObj","prevObj","aspectWidth","aspectHeight","Browser","isDevice","updateUndoRedoColl","aspectIcon","nonAspectIcon","currSelPtObj","prevCurrSelectionPoint","operation","previousObj","previousObjColl","previousPointColl","previousSelPointColl","previousCropObj","previousText","currentText","previousFilter","elem","ctxToolbar","style","position","isStraightening","update","adjustmentValue","canvasFilter","dimension","widthRatio","heightRatio","panObj","collection","isRotateFlipCollection","region","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","verb","v","op","f","TypeError","_","t","call","label","ops","trys","g","sent","throw","return","Symbol","iterator","Draw","isInitialLoading","fileName","isErrorImage","isShapeTextInserted","tempStrokeSettings","strokeColor","fillColor","strokeWidth","outlineColor","outlineWidth","tempTextSettings","text","fontFamily","bold","italic","underline","tempAdjValue","tempFilter","tempUndoRedoStep","tempFreehandCounter","tempCurrFhdIndex","isCancelAction","rotatedFlipCropSel","zoomCrop","isImageEdited","isFileChanged","isNewPath","isResizeSelect","arrowDimension","bar","arrow","arrowSolid","circle","square","origDim","isImageApply","imgCanvasPoints","isCropSelect","isDownScale","preventStraightening","tempObjColl","tempPointColl","imageBackgroundColor","allowRedactStraighten","isNullExtension","draw","updatePrivateVariables","drawObject","updateActiveObject","clearOuterCanvas","setDestPoints","updateCurrTransState","currTransState","renderImage","drawImgToCanvas","updateCanvas","performCancel","updateFlipPan","select","callUpdateCurrTransState","resetPanPoints","setClientTransDim","redrawImgWithObj","setCurrentObj","performPointZoom","open","getInitialLoaded","fileSelect","fileType","initZoomValue","prevActObj","moveToSelectionRange","applyFrame","drawImage","downScaleImgCanvas","downScale","resetFrameZoom","triggerFrameChange","zoomToSel","straightenActObj","updateImgCanvasPoints","isLinesIntersect","setDestForStraighten","tempStraightenDestPoints","straightenDestPoints","straightenInitZoom","checkPointPosition","updateCropSelection","updateCropSelObj","redrawDownScale","updateFinetune","isSelOutsideImg","showDialogPopup","tempStrokeWidth","default","inMemoryContext","inMemoryCanvas","imageData","getImageData","putImageData","frameObj","isCropRatio","isPreventDrag","saveContext","isPreventSelection","canvasDraw","toLowerCase","setDragLimit","drawCropRatio","strokeSettings","obj_1","isText","obj_2","keyHistory","fillStyle","fillRect","rotateContext","drawOuterSelection","drawShapeObj","undefined","drawCornerCircles","_c","translateX","translateY","rotationAngle","translate","rotate","preventShapeDragOut","min","max","updateWidthHeight","drawCustomSelection","parseInt","imgWidth","imgHeight","updatePoints","diff","adjToCenter","enlargeToImg","adjToStraighten","arr","tempActPoint","isMouseMove","horCircleWidth","verCircleHeight","horBottomLine","verLeftLine","verRightLine","topLeftCircle","topCenterCircle","topRightCircle","centerLeftCircle","centerRightCircle","bottomLeftCircle","bottomCenterCircle","bottomRightCircle","rotationCirclePoint","isCropCircle","lineWidth","tempObj","strokeStyle","themeColl","theme","moveTo","lineTo","stroke","selectionSettings","showCircle","drawRotationArcLine","drawCenterCircles","rotationCircleLine","drawArrowHead","isStartHead","start","end","arrowCircleSolid","arrowCircle","arrowBar","arrowSquareStart","arrowSquareEnd","currentShape","shapeType","horLineWidth","verLineHeight","selectionWidth","selectionHeight","tempFillStyle","drawSquareLines","drawRedact","isRedact","ellipse","shapeCircle","shapeLine","triangleDirection","isShapeDrawing","nextPoint","shapeText","shapeImage","drawSelection","rect","isHorizontalflip","isVerticalflip","flipObjColl","flipStr","isTempCanvas","baseRadius","adjustedRadius","isSafari","drawRoundedRect","roundRect","rectRadius","arcTo","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","tempWidth","save","clip","x1","y1","x2","y2","tempLineWidth","manipulateSaveCtx","strWidth","dx","dy","atan2","isStartArrow","isEndArrow","isEndCircleOrSquare","isStartCircleOrSquare","isStartArrowSolid","isEndArrowSolid","isStartSquare","isEndCircle","isStartSquareSolid","isEndCircleSolid","strokeRect","squareStartIntersectX1","squareStartIntersectY1","endCircleIntersectX1","endCircleIntersectY1","squareEndIntersectX1","squareEndIntersectY1","startCircleIntersectX1","startCircleIntersectY1","circleRadius","a","intersect","b","c","t2","sqrt","intersectionX1","intersectionY1","isStartCircleSolid","imageCanvas","dimObj","imageElement","imgPoint","globalAlpha","opacity","rotateImage","rows","lineHeight","tempFill","yPoint","baseWidth","test","floor","textStyle","font","rotateText","strokeText","fillText","updateActPoint","tempActiveObj","tempDegree","scale","textFlipDegree","left","top","isRotatePan","isStraighten","isPreventDimension","setTransformColl","isPreventClearRect","isFrame","isMouseDown","imageOnLoad","src","_this","proxy","baseImg","onload","imgSrc","isCropped","isSameDimension","isImageUpdated","hideSpinner","updateBaseImgCanvas","fileOpened","isValidImage","isUndoZoom","display","eventargs","isOkBtn","isMainToolbar","action","actionEventArgs","triggerEditCompleteEvent","onerror","errorLoading","defaultZoom","srcPoints","isBrightAdjust","frame","straightenZoom","adjustmentLevel","brightness","contrast","hue","saturation","blur","exposure","transparency","sharpen","bw","currentFilter","setAttribute","zoom","isOk","tempFrameZoomLevel","cancelCropSelection","currentObj","isFinalCancel","noPushUndo","JSON","stringify","tempFrameObj","textArea","drawingShape","enableShapeDrawing","isFiltered","cancelItems","togglePan","isFinetuneBtnClick","initialAdjustmentValue","isBrightnessAdjusted","bevelFilter","obj_3","tempAdjustmentLevel","cursor","classList","add","isDisabled","isMaskImage","actionArgs","isCropSelection","ascpectIcon","shapes","currentToolbar","aspectRatioElement","blrAspRatElem","contains","obj1","obj2","togglePen","cancelPen","cancelText","cancelShape","cancelSelection","tempPointsColl","isFreehandDrawCustomized","isCancel","currIndex","appliedUndoRedoColl","appliedColl","currentObjColl","iLen","currObjColl","j","jLen","undoRedoObj","undoRedoStep","isDragging","tempStraighten","selPointCollObj","currentPointColl","currentSelPointColl","currentCropObj","tempSelectionObj","isPrevent","cropZoomFactor","drawNewSelection","cropShape","updateSelectionInsert","shapeSettingsObj","getSelectionType","selectionChangingArgs","previousSelectionSettings","currentSelectionSettings","destLeft_1","destTop_1","destWidth_1","destHeight_1","lowerCanvasWidth_1","lowerCanvasHeight_1","activePoint_1","destLeft_2","destTop_2","destWidth_2","destHeight_2","lowerCanvasWidth_2","lowerCanvasHeight_2","activePoint_2","_d","lowerCanvasWidth","lowerCanvasHeight","adjActObj","tempTogglePen","widthObj","penStrokeWidth","isCircleCropped","isObj","color","bgColor","drawCropSelectionImage","isDefaultZoom","isAfterCropAction","clearContext","okBtn","zoomValue","panToPoint","drawZoomPanImage","adjustPanning","isActObj","panToSel","destLeft_3","destTop_3","destWidth_3","destHeight_3","forEach","prevStraightenedDegree","setStraighten","openNewImage","showSpinner","toolbar","defToolbarItems","getElementById","openURL","getFileExtensionFromURL","getImageSizeFromURL","imageSizeMB","toDataURL","imageUrl","callback","response","contentLength","ex_1","fetch","method","headers","get","console","log","message","dlgBtnClick","export","applyDialogOption","dlgCloseBtnClick","checkToolbarTemplate","inputElem","getComponent","headerObj","key","contentObj","yesObj","noObj","Dialog","header","closeOnEscape","content","target","isModal","animationSettings","effect","close","bind","buttons","click","buttonModel","iconCss","isPrimary","appendTo","restoreOldImage","dropArea","extension","getExtensionArray","openImageData","isAllowedFileType","uploadSettings","allowedExtensions","minFileSize","maxFileSize","isInvalidSize","handleFileSize","isError","fileTypeError","isBase64","createElement","img_1","Image","getImageSize","toBlob","blob","data","url","lastDotIndex","lastIndexOf","slice","inputElement","filesData","fileData","files","rawFile","fileExtension","name","fileExtensionArray","isJPG","window","URL","createObjectURL","isChangesSaved","toolbarTemplate","maxZoomFactor","isSelectionBiggerThanCanvas","isSelectionOutsideCanvas","isBigger","isOutside","toolbarHeight","isImgAnnotation","isHFlip","isVFlip","tempCanvas","attrs","isHorImageFlip","isVerImageFlip","isFinetuning","widthSource","heightSource","round","halfWidthRatio","ceil","halfHeightRatio","img2","createImageData","data2","weight","weights","alphaWeights","r","stopY","w0","stopX","w","xPos","drawImgToCtx","preventImg","getFrameColor","gradientColor","gradient","createLinearGradient","addColorStop","inset","offset","amount","border","newWidth","newHeight","valueForty","valueFifty","bevelObj","quadraticCurveTo","arcY2","lineY","arcX2","lineX","arcX1","lineX2","arcY1","lineY2","setLineDash","prevFrameSettings","frameChange","previousFrameSetting","currentFrameSetting","borderRadius","frameLineStyle","lineCount","setFrameObj","currFrameSettings","isToolbar","pow","performDummyZoom","setZoomPan","calcStraightenedPoints","isDestPointSmall","isSmall","this_1","left_1","top_1","width_1","height_1","selectionObj","getImagePoints","p1","p2","p3","p4","imgPoints_1","isTopIntersect_1","doIntersect","isRightIntersect_1","isBottomIntersect_1","isLeftIntersect_1","imgPoints","isTopIntersect","isRightIntersect","isBottomIntersect","isLeftIntersect","isTopLeftInsideRect","isInsideRect","isTopRightInsideRect","isBottomRightInsideRect","isBottomLeftInsideRect","calcTriangleArea","x3","y3","x4","y4","area1","area2","area3","area4","areaRectangle","dim","getRotatedCanvasDim","baseImgCanvasWidth","baseImgCanvasHeight","baseImgWidth","baseImgHeight","radians","d","point1","initiation","point2","point3","point4","onSegment","isInside","isSaveCtx","redactImage","offscreenCanvas","offscreenCtx","imageWidth","imageHeight","tempRatio","tempCtx","straightenCanvas","straightenCtx","newP1","newP2","newP3","tempHeight","rotatedWidth","rotatedHeight","redactType","pixelSize","redactPixelate","blur_1","redactBlur","imageSmoothingEnabled","Export","updatePvtVar","exportImg","exportToCanvas","updateSaveContext","imageQuality","drawAnnotation","imgQuality","imageName","beforeSave","beforeSaveEvent","observableSaveArgs","lowerCaseType","toSVGImg","toBlobFn","saved","maxWidth","maxHeight","dataUrl","svg","createElementNS","setAttributeNS","appendChild","svgDataUrl","btoa","downloadImg","imagetype","blobUrl","tempCropObj","tempContextFilter","parseFloat","join","tempContext","exportTransformedImage","updateFrame","nonRedact","item","redact","concat","order","drawShape","drawPen","indexObj","index","found","splice","temp_1","indexBool","bgObj","isAnnotation","href","download","documentElement","parentNode","removeChild","flip","exportRotate","exportFlip","setMaxDim","flipHorizontal","flipVertical","Filter","tempAdjVal","tempFilVal","finetuneImage","setFilter","updateFinetunes","setAdjustment","initFilter","setCurrAdjValue","updateAdj","getCurrentObj","applyFilter","getDefaultFilter","fs","finetuneSettings","property","defaultValue","setFilterAdj","isPreview","values","getFilterValue","saturate","bright","saturatePercent","saturatePercentage","getSaturationFilterValue","getDefaultCurrentFilter","setTempFilterValue","tempSplitWords","prevFilter","valueArr","setFilterValue","setSaturationFilterValue","finetuneOption","curFinetuneObjEvent","finetune","dummyObj","tempFlipPanPointObj","zoomObj","imageSource","getValFromPercentage","percentage","val","getValFromLength","parseFilterString","filterString","filterArray","map","match","grayscale","hueRotate","invert","sepia","blurRadius","blurredData","Uint8ClampedArray","nx","ny","factor","length_1","length_2","length_3","gray","rotation","cosA","sinA","matrix","length_4","length_5","lumR","lumG","lumB","shiftW","pos","length_6","FreehandDrawing","fhdObj","lastWidth","lastVelocity","time","pointX","pointY","isFreehandDrawing","freehandDownPoint","isFreehandPointMoved","pointCounter","currFHDIdx","selPoints","dummyPoints","tempFHDStyles","straightenPointAngle","isMasking","updateFhdPvtVar","hoverFhd","freehandDownHandler","freehandUpHandler","isFHDIdx","deleteFhd","freehandRedraw","selectFhd","applyFhd","cancelFhd","updateFHDCurPts","rotateFhdColl","flipFHDColl","panFHDColl","updateFHDColl","zoomFHDColl","applyPenDraw","freeHandDraw","getSqPtFD","fhdHovIdx","updateCropPtsForSel","fhdSelID","fhdSelIdx","setCenterSelPoints","prevStraightenObj","triggerShapeChanging","idx","controlPoint1","controlPoint2","minStrokeWidth","maxStrokeWidth","startDraw","calcCurveCP","Date","getTime","clientX","clientY","touches","EventHandler","freehandMoveHandler","shapeSettings","ShapeType","FreehandDraw","shapeChangingArgs","previousShapeSettings","currentShapeSettings","getBoundingClientRect","remove","processPoint","changedTouches","fhCnt","mouseDown","lastPoint","isLastPointTooClose","distanceTo","unshift","p0","shift","dx1","dy1","dx2","dy2","m1","m2","l1","l2","dxm","dym","k","cm","tx","ty","tempVelocity","pointVelocity","drawCurve","startWidth","endWidth","t1","t3","u1","u2","u3","widthValue","bezierLength","drawSteps","drawArc","pointX1","pointY1","pointX2","pointY2","pointX3","pointY3","bezierPoint","cp1","cp2","sPoints","selectedPoint","isSelected","isUndoRedoStack","isId","tempSelPointColl","zoomX","zoomY","lowercaseValue","pointsHorizontalFlip","pointsVerticalFlip","isIndex","getAttribute","discard","selectMaskImage","Selection","diffPoint","oldPoint","isTouch","isObjSelected","isFhdPoint","dragPoint","isShapeInserted","triangle","triangleRatio","isFirstMove","startTouches","tempTouches","currMousePoint","cursorTargetId","isPreventDragging","dragElement","textRow","mouseDownPoint","previousPoint","zoomType","isInitialTextEdited","dragCanvas","isFhdCustomized","touchEndPoint","isFhdEditing","currentDrawingShape","initialPrevObj","touchTime","resizedElement","isImageClarity","isPinching","isSliding","isSliderActive","arrowShape","ArrowheadType","None","SolidArrow","isTouchDblClick","isMouseUp","mouseWheel","isTransformedShape","selection","setCursor","updateActivePoint","updateCursorStyles","setTextSelection","setActivePoint","clearSelection","calcShapeRatio","performTabAction","setDragDirection","setTimeout","redrawShape","setTextBoxStylesToActObj","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","keyDownEventHandler","handleScroll","textKeyDown","deleteItem","updatePrevShapeSettings","panDown","adjustActObjForLineArrow","findTarget","getCurrentFlipState","setDragWidth","setDragHeight","getTransRotationPoint","adjustNEPoints","adjustRotationPoints","getResizeDirection","unwireEvent","updPtCollForShpRot","findImageRatio","getNumTextValue","upgradeImageQuality","triggerShapeChange","applyTransformToImg","findTargetObj","getArrowType","updateNWPoints","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","drawMaskCircle","isValueUpdated","getDistance","updateTransColl","timer","pathAdjustedIndex","allowUndoRedoPush","applyCurrShape","isKBDNavigation","selMouseUpEvent","getMouseCursor","isApply","frameObject","setCursorForActObj","highestOrder","getHighestOrder","tempShapeColl","isShape","setCursorForFreehandDrawing","setCursorFromObj","isBreak","maskCanvas","setCursorForLineArrow","setCursorForPath","cursorColl","setCursorForRotatedObject","isMove","horTP","horTopLinePointColl","horTP1","verLP","verLeftLinePointColl","verRP","verRightLinePointColl","horBP","horBottomLinePointColl","horBP1","rotCP","rotationCirclePointColl","horTP0","horBP0","getRectanglePoints","horTP_1","horBP_1","verLP_1","verRP_1","adjustCursorStylesForRotatedState","cursorMap","nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize","getResizeElement","resizeMappings","positiveDegree","resizeMappings_1","startDegree","endDegree","resizeElement","isEntered","ptc","freehandSelectedIndex","pt","z1","z2","z3","z4","preventResizing","isShapeDragOut","shapeResizingArgs","allowShapeOverflow","allowOutofBound","shapeMovingArgs","isTextArea","isMouseOutsideImg","cropResize","rotatedDegree","tempEndX","tempEndY","getSquarePointForPath","allowPreventing","path","isObjOutsideImg","selectionResizingArgs","isPreventShaping","eventType","preventDragOut","limitDrag","isStart","isLimiting","wrapperWidth","wrapperHeight","preventDraggingInvertly","preventTextDraggingInvertly","preventInverseResize","getScaleRatio","newScale","gcd","divisor","revertResizing","performSEResize","resizeImg","revertCustomSelection","performNWResize","isCustomSelection","endY1","endX1","revertPoints","adjustNWPoints","top_2","top_3","adjustSWPoints","adjustSEPoints","isTextBox","width_2","measureText","rectangle","cx","cy","rotatedC","rotatePoints","newCenter","newBottomRight","newTopLeft","rotatedD","newBottomLeft","newTopRight","rotatedB","rotatedA","setResizedValue","getResizedElement","resizeMappings_2","isLine","updateCursorStylesForLineArrow","updateCursorStylesForPath","textWidth","textHeight","selectInfo","currentTarget","isPan","isGrabbing","imageEditorClickEventArgs","setXYPoints","clickEvent","tempCursor","performEnterAction","isShapeTouch","object_1","isFreehandDraw","isFreehandDrawTouch","isShapeClick","applyObj","isLineArrow","x_1","y_1","cursor_2","tempHoveredIndex","isPenEdit","qbArea","shapeChangedArgs","isPenDraw","cursor_1","canvasCursor","preventDefault","bbox","targetTouches","pageX","offsetLeft","pageY","offsetTop","firstFingerX","firstFingerY","secondFingerX","secondFingerY","zoomTrigger","ZoomTrigger","Pinch","calculateScale","isZoomBtnClick","isZoomOut","parentElement","closest","stopImmediatePropagation","activeObjShape","dummyClick","srcElement","elemId","id_1","prevCropObj_1","applyCurrActObj","splitWords_1","isCropSelection_1","freehandDrawSelectedId","isInitialLine","isAdjusted","setRatio","getCurrentIndex","setTimer","rgbToHex","offsetX","offsetY","tempPanMoveObj","tempPanMove","panMove","panMoveObj","ctrlKey","allowUndoRedo","Commands","isIcon","focusRatioBtn","isAspectRatio","aspectRatioHeight","aspectRatioWidth","placeholder","upload","isKeyBoardCrop","focus","isInsideCanvas","stopPropagation","MouseWheel","wheelDelta","String","fromCharCode","which","scrollHeight","resetCrop","presetRatio","originalWidth","originalHeight","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","prevIndex","cursor_3","cursor_4","shapeEvent","endTouches","startDistance","clearTimeout","smallPoint","largePoint","shapeIDObj","backgroundColor","textShadow","trim","fontWeight","fontStyle","hexR","padLeft","hexG","hexB","hexA","isNaN","Number","padChar","updateFreehandDrawColorChange","object_2","tempFreeHandDrawEditingStyles","radiusX","radiusY","arrowHead","arrowTail","transformCollection","tempColl","none","circleSolid","squareSolid","rectX","rectY","rectWidth","rectHeight","rectAngle","angleRad","localX","localY","rotatedX","rotatedY","halfWidth","halfHeight","widthElement","heightElement","heightString","replace","widthString","isValue","Shape","preventFrameAnnotation","initShapePvtProps","uploader","drawEllipse","drawLine","drawArrow","drawPath","drawRectangle","drawText","redrawActObj","updateShapeChangeEventArgs","updSelChangeEventArgs","iterateObjColl","updImgRatioForActObj","redrawObj","redrawText","renderTextArea","setTextBoxWidth","findTextTarget","updateFontStyles","applyFontStyle","updateFontRatio","updateFontSize","pushActItemIntoObj","clearActObj","refreshActiveObj","applyActObj","fileChanged","getShapeSetting","getShapeSettings","getRedactSettings","isPointsInRange","alignRotateFlipColl","selectShape","deleteShape","getMaxText","getLinePoints","setPointCollForShapeRotation","setTextBoxPos","setTextBoxPoints","alignTextAreaIntoCanvas","initializeTextShape","stopPathDrawing","updateArrowRatio","getSquarePointForRotatedShape","updateObj","straightenShapes","straightenShapePoints","straightenPath","straightenFHD","getTextBoxPosition","setFlipState","getNewShapeId","updateZOrder","getSmallestIndex","isIndexInObjColl","drawAnnotations","updateShapeColl","getNewOrder","getLowestOrder","shapeImg","crossorigin","initializeShape","arrowStart","arrowEnd","drawShapeText","setDimension","arrowType","Arrow","Circle","SolidCircle","Square","SolidSquare","Bar","lineDraw","RedactType","Blur","setCenterPoints","setPointCollForLineAndArrow","initShapeProps","isPublicMethod","textFlip","prevObjColl","isInitialText","getFontSizes","fontSizeColl","maxText","drawShapeTextEvent","fontSizeInd","findIndex","drawShapeImageEvent","isSelect","addLetter","onLoadImgShape","updateTextFromTextArea","renderWidth","renderHeight","shapeId","letter","widthColl","smallestIndex","updatePathRatio","zoomObjColl","preventApply","len_1","updateArrowSize","len_2","straightenPoints","fLen","updateCurrentActiveObjPoint","currActObjIndex","flipLineArrowObj","rotateObjColl","rotateLineArrowObj","prevPoint","lineArrowHorizontalFlip","lineArrowVerticalFlip","currPoint","getRotDegOfShape","transformObj","shapeObj","transformTextArea","zOrderElem","dupElem","removeElem","editTextElem","shadowColor","shadows","adjustedOutlineWidth","overflow","setTextBoxHeight","tempLeft","tempTop","center_1","width1","height1","width2","whiteSpace","textOverflow","textAreaWidth","letterWidth","textAreaLeft","textAreaTop","noRedact","selectedText","updateImgCanvas","resizeImage","aspectRatio","aspectRatioArray","selectionStart","finish","selectionEnd","substring","panObjColl","len_3","len_4","updateFontStyle","getTextAreaWidth","updateObjColl","dimensions_1","dimensions_2","tempBold","tempItalic","tempRedactBlur","tempRedactPixel","letters","transformOrigin","getRedactObjDetails","redactDetails","blurIntensity","getObjDetails","shapeDetails","arrowObj","getFreehandDrawDetails","obj_4","shapeDetailsColl","RedactDetailsColl","inRange","popForDefaultTransformedState","popForDefaultFlipState","popForDefaultRotateState","rotateRight","rotateleft","horizontal","vertical","isHorizontal","isVertical","isNextHorizontal","isNextVertical","isNextToNextHorizontal","isNextToNextVertical","isNextToNextToNextHorizontal","curr","obj_5","obj_6","maxi","maxStr","m","getSlope","getIntercept","lesserY","i_1","prev","lesserX","i_2","isSameAxis","slope","reverse","reArrangeObjColl","reUpdateShapeColl","reorderRedact","isOrdered","tempOrder","tempSelPointCollObj","isPrevented","isPenId","tempObjCollIndex","i_3","i_4","i_5","Transform","disablePan","isReverseRotate","prevZoomValue","cropDimension","isPreventSelect","preventDownScale","resizedImgAngle","initTransformPvtVar","flipImage","setDestPointsForFlipState","zoomAction","disableZoomOutBtn","rotatedFlip","drawPannedImage","drawPannImage","performTransformation","updateTransform","rotatePan","setCurrPanRegion","calcMaxDimension","currDestPoint","resizeCrop","updateResize","resize","straightenImage","zoomBtnHold","transCurrObj","previousDegree","currentDegree","rotateEvent","prevEventObjPoint","prevEventSelectionPoint","drawRotatedImage","rotateDegree","updateCurrSelectionPoint","previousDirection","flipEvent","lowercaseDirection","selObj","updateFlipColl","toLocaleLowerCase","dir","verticalFlip","horizontalFlip","lastFourItems","minZoomFactor","powerOften","zoomEventArgs","previousZoomFactor","currentZoomFactor","zoomEvent","zoomFact","drawZoomImgToCanvas","panObj_1","isAdd","rotateZoom","panObj_2","clearInterval","zoomOut","autoEnablePan","setZoomDimension","zmFactor","maxDestLeft","maxDestTop","panEventArgs","panEvent","isPanMethod","isObjCreated","updatePanPoints","tempFlipState","Direction","Horizontal","Vertical","rotatePanActiveObj","initialDestLeft","initialDestTop","intPan","limitPan","getCurrentZoomFactor","absValue","freehandObj","cxtTbarHeight","ctToolbar","ctWrapper","hdWrapper","updateDropInfoContent","canvasWrapper","offsetWidth","ctxTbarArea","offsetHeight","toolbar_1","refreshOverflow","canvasMaxWidth","canvasMaxHeight","cxtTbar","widthScale","heightScale","cssMaxWidth","cssMaxHeight","tempActObj","tempDestLeft","tempDestTop","temp1","minimum","resizeSrc","nearestNumber","smallestDifference","minimum_1","num","difference","prevResizeCurrObj","tempwidth","tempheight","tempZoom","sx","sy","currObject","resizeEventArgs","previousWidth","previousHeight","resizeEventHandler","aspectRatioWidthValue","UndoRedo","undoRedoColl","tempUndoRedoColl","isPreventing","undoRedo","initializeUrPvtProp","updateUrc","refreshUrc","updateCurrUrc","callUndo","callRedo","undo","redo","updateUrObj","updateUndoRedo","undoDefault","updateUndoRedoStack","tempCurrSelPoint","refreshToolbar","appliedURColl","prevTransform","getZeroZoomObjPointValue","adjObj","triggerActionCompletedEvent","lastObj","lastPrevObj","chrome","cold","warm","deleteObj","deleteFreehandDrawing","shapeInsert","shapeTransform","freehanddrawCustomized","getUndoRedoAction","imageRotate","freehanddraw","textAreaCustomization","imageHFlip","imageVFlip","updateImage","refreshToolbarActions","applyCurrentChanges","updateFreehandDraw","updateFreehandDrawCustomized","updateDelete","updateTextAreaCustomization","updateText","imageFlip","updateCropTransformItems","tempCircleCrop","endUndoRedo","updateTextBox","allowActiveObj","isUndo","isInitialLoaded","frameDestPoints","oper","cropDimensionObj","getZeroZoomObjColl","getZeroZoomPointColl","tempArrowObj","applyImgTranform","isUpdated","enableTextEditing","__extends","extendStatics","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","UploadSettings","_super","Property","ChildProperty","FinetuneSettings","ZoomSettings","SelectionSettings","FontFamily","ImageEditor","options","isZoomed","isFilterCanvasClick","isFrameBtnClick","tempToolbarHeight","tempToolbar","ImageEditor_1","Inject","ToolbarModule","requiredModules","modules","member","preRender","getUniqueID","navigator","userAgent","initializeThemeColl","render","isAngular","originalElement","clonedElement","cloneNode","replaceChild","setValue","initialize","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","keys","cssClass","removeClass","addClass","wireEvent","locale","showQuickAccessToolbar","Toolbar","className","toolbarTemplateFn","quickAccessToolbarTemplate","quickAccessToolbarTemplateFn","removeAttribute","saveDialog","createCanvas","createDropUploader","quickAccessToolbar","createSpinner","initializeZoomSettings","Uploader","getElementsByClassName","multiple","selected","event","errType","dataTransfer","okObj","supportObj","getExtensionString","fileSizeObj","andObj","formatSizeUnits","bytes","toFixed","validExtensions","split_1","trimmedExt","validExtensions_1","valid","words","keyUpEventHandler","windowResizeHandler","isIos","info","screen","orientation","screenOrientation","boxSizing","dragObj","dropObj","browseObj","dropAreaElement","dropIconElement","dropContentElement","textContent","minDropContentElem","dropAnchorElement","minDropAnchorElem","dropInfoElement","dropUploader","adjustToScreen","notifyResetForAllModules","module","allowShape","applyShapes","includeAnnotations","getData","updateColl","resetChanges","imageSettings","initialZoomValue","qtArea","updateImageTransformColl","freehandDraw","isEllipse","editCompleted","isArrow","isPath","isRectangle","isImage","updateShape","setting","tempFontSize","getRedacts","selectRedact","deleteRedact","updateRedact","option","applyImageFilter","filterOption","getImageDimension","isResized","drawFrame","frameType","frameChangeEventArgs","FrameLineStyle","Solid","isStraightened","cloneShape","isPreventUndoRedo","getImageFilter","canUndo","getUndoRedoColl","canRedo","undoRedoIndex","closeOverlayTbar","isEnabled","orderObj","bringToFront","updateShapeOrder","bringForward","sendToBack","sendBackward","clearImage","btoolbar","enableDisableToolbar","disable","prevObj_1","resetToolbar","tempDestPoints","tempSel","tempTransform","template","templateID","toolbarArea","toolbarFn","templateParser","isReact","templateColl","nodeType","qatFn","querySelectorAll","templateCompiler","compile","error","getTextFromId","1","2","3","4","5","6","7","8","getFinetuneOption","ImageFinetuneOption","Brightness","Contrast","Hue","Saturation","Opacity","Exposure","setPenStroke","setInitialZoomState","str","strArr","charAt","toUpperCase","items","isFinalApply","isResizeOkBtn","blrNAspRatElem","objt","selElem","sliderWrap","children","isCroppedEvent","previousElementSibling","getObjFromId","setTempFilterProperties","cropSelectedState","tempAdjustmentValue","getCurrentCanvasData","tempFrame","setCurrAdjustmentValue","finetuneValueChanging","typeToSelectionType","CropCustom","CropSquare","CropCircle","Crop3:2","Crop4:3","Crop5:4","Crop7:5","Crop16:9","Crop2:3","Crop3:4","Crop4:5","Crop5:7","Crop9:16","updateArrow","isObjPushed","collLength","updateFontFamily","itemText","text_1","text_2","updateFontColor","updateStrokeTextColor","updatePenStrokeWidth","updatePenStrokeColor","indexObj_1","updateStrokeWidth","updateStrokeColor","updateFillColor","isPreventURC","duplicateImage","pascalToSplitWords","splitStr","word","getCurrAdjustmentValue","penOpacity","transformSelect","isTransform","stValPan","straightenEventArgs","performStraighten","getStraightenFlipState","minX","maxX","minY","maxY","curFlip","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","Material3","Material3Dark","Fluent2","Fluent2Dark","Fluent2Highcontrast","Bootstrap5.3","Bootstrap5.3Dark","Tailwind3","Tailwind3Dark","Complex","Event","NotifyPropertyChanges","Component","FileType","Theme","ImageEditorCommand","ImageFilterOption","FrameType","currToolbar","preventZoomBtn","selFhdColor","preventEnableDisableUr","isFrameToolbar","presetColors","custom","isSlider","currentQuality","initLocale","defaultLocale","ZoomIn","ZoomOut","Undo","Redo","Annotation","Finetune","Sharpen","Default","Chrome","Cold","Warm","Grayscale","BlackAndWhite","Sepia","Invert","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Ellipse","Rectangle","Line","Path","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","Browse","Duplicate","Remove","EditText","Start","End","ArrowSolid","CircleSolid","SquareSolid","CropAndTransform","CropSelection","Transparency","Height","Width","AspectRatio","W","H","DragText","DropText","BrowseText","SupportText","Frame","Mat","Bevel","Inset","Hook","Color","Size","Offset","Radius","Amount","Resize","0","20","40","60","80","100","Border","Dashed","Dotted","GradientColor","ConfirmDialogHeader","ConfirmDialogContent","AlertDialogHeader","AlertDialogContent","MinMaxSize","MinMaxSizeAlert","MinSize","MinSizeAlert","MaxSize","MaxSizeAlert","To","Bytes","Yes","No","ImageErrorDialogHeader","ImageErrorDialogContent","Straighten","NoOutline","DlgOK","SaveAs","ImageName","Format","Quality","Download","Close","ImageSize","QualityInfo","Good","Great","Highest","BringForward","SendBackward","SendToBack","BringToFront","ZOrder","Redact","Pixelate","BorderRadius","TextOutlineColor","TextOutlineWidth","PixelSize","And","l10n","L10n","createToolbar","createContextualToolbar","updateToolbarItems","renderQAT","enableDisableTbrBtn","initMainToolbar","createBottomToolbar","refreshMainToolbar","createQuickAccessToolbar","destroyQuickAccessToolbar","zoomBtnMouseUpHandler","refreshDropDownBtn","closeContextualToolbar","destroyBottomToolbar","destroyTopToolbar","destroySubComponents","setLocale","getPenStroke","performDefTbrClick","refreshSlider","refreshShapeDrawing","getConstant","initResizeToolbar","resizeClick","frameToolbarClick","performCropTransformClick","duplicateShape","editText","initialSize","widthPress","heightPress","widthAspectRatio","heightAspectRatio","toolbarItems","align","tooltipText","uploadItems","bToolbar","created","toolbarType","clicked","defToolbarClicked","createLeftToolbarControls","mToolbar","toolabr","toolbar_2","toolbarElem","initBottomToolbar","toolbar_3","isApplyOption","leftItem","getLeftToolbarItem","rightItem","getRightToolbarItem","mainItem","getMainToolbarItem","zoomItem","getZoomToolbarItem","toolbarObj","renderAnnotationBtn","wireZoomBtnEvents","renderCropBtn","renderTransformBtn","visible","prefixIcon","tempToolbarItems","processToolbar","tabIndex","updateContextualToolbar","contextualToolbarArea","toolbar_6","initFilterToolbarItem","initFrameToolbarItem","renderSlider","cHt","cusWrapper","ht","insertBefore","getCropTextContent","processSubToolbar","zoomIn","zoomInBtnMouseDownHandler","zoomInBtnClickHandler","zoomOutBtnMouseDownHandler","zoomOutBtnClickHandler","keyCode","icon","widthNumeric","heightNumeric","getResizeToolbarItem","spanWidth","NumericTextBox","htmlAttributes","maxLength","showSpinButton","format","spanHeight","wireResizeBtnEvents","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","title","onchange","filesTypes","triggerTbarClickEvent","originalEvent","isCustomized","defItems","toolbarId","enableDisableCloneBtn","getCurrentShapeIcon","drpDownBtn","DropDownButton","currentFreehandDrawIndex","penStrokeWidthObj","tempCurrentFreehandDrawIndex","setInitialShapeSettings","isDummyTextClick","duplicateElement","removeElement","editTextElement","zOrderElement","renderStraightenSlider","slider","createSlider","sliderHandle","shapeString","cancelPan","cropSelect","saveDialogPopup","quality","dialogContent","dialogImgContent","dialogRightContent","imageNameDiv","formatNameDiv","tabindex","qualityNameDiv","qualityDiv","qualityOptionDiv","buttonGroup","input","htmlFor","dialog","beforeOpen","onBeforeopen","saveDialogClosed","hide","TextBox","imageNameLabel","qualityContainer","qualityBtnGrp","qualityBtnIcon","qualitySliderValue","fileObj","Button","ddbElem","spanElem_1","drpDownBtn_1","activeBtn","updateImageSize","checked","qualityBtnClickHandler","compressionValues","qualitySlider","qualityOption","qualitySliderValueDiv","qualitySliderValueSpan","sliderObj","Slider","tooltip","placement","isVisible","showOn","changed","fileSize","megabytes","compressedImage_1","revokeObjectURL","rawByteSize","fileSize_1","getCropTransformToolbarItem","straightenSpan","getShapesToolbarItem","initCropTransformToolbar","classToContentMap","e-custom","e-circle","e-square","e-custom-a","e-custom-b","e-custom-c","e-custom-d","e-custom-e","e-custom-f","e-custom-g","e-custom-h","e-custom-i","e-custom-j","shapeIcons","line","image","crop-custom","crop-circle","crop-square","crop-3:2","crop-4:3","crop-5:4","crop-7:5","crop-16:9","crop-2:3","crop-3:4","crop-4:5","crop-5:7","crop-9:16","initShapesToolbarItem","isToolbarString","excludeItems","createRectangleRadius","createShapeColor","createShapeBtn","createZOrderBtn","some","createStartBtn","createEndBtn","strokeWidthItems","strokeWidthBtn","spanElem_2","drpDownBtn_2","parentElem","childNodes","beforeModeSwitch","inst","popupLeft","offsetParent","mode","showButtons","dataBind","fillColor_1","ColorPicker","modeSwitcher","noColor","inline","beforeTileRender","change","rgba","fillDDB_1","toggle","onModeSwitch","beforeClose","parenElem","innerWidth","getValue","strokeColor_1","strokeDDB_1","background","spanElem_3","drpDownBtn_3","zOrderItems","drpDownBtn_4","spanElem","idToValue","strokeEndBtn","getTextToolbarItem","getFontFamilyItems","initTextToolbarItem","createTextColor","createStrokeTextColor","createBackgroundColor","createTextBtn","fontColor_1","strokeDDB_2","backgroundColor_1","strokeDDB_3","fontColor_2","strokeDDB_4","fontNameBtn","spanElem_4","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","fontSizeBtn_1","toolbarElement","bottomToolbar","toolbar_13","initPenToolbarItem","initAdjustmentToolbarItem","frameElem","redactBlurElement","pixelateElement","redactSlider","updateKBDNavigation","updateRedactObj","tbarInitialBtn_1","tbar","tbarInitialChild","tempElem","defaultFilter_1","getAdjustmentToolbarItem","getFrameToolbarItem","getFilterToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","presentVal","penColor","hex","strokeDDB_5","spanElem_5","drpDownBtn_5","valueToTextContent","frameWrapper","styles","createFrameColor","createFrameSize","createFrameRadius","createFrameInset","createFrameOffset","createFrameAmount","createFrameBorder","createFrameGradientColor","fillDDB","curFrameObjEvent","contextualToolbarClicked","createCanvasFilter","hdrWrapper","filterElem","drawDashedLine","updateFilterCanvas","selector","getQuickAccessToolbarItem","orgToolbarItems","quickAccessToolbarClicked","wrapperElement","annotation","adjustment","pathObject","right","object1","duplicateObj","isFilterFinetune","isDisabledFilter","isDisabledAdjustment","panBtn","openSlider","unselectFrameBtn","updateRedactType","pixelateBtn","redactBlurBtn","callFrameToolbar","zoomToFrameRange","isSmaller","selEle","imageFiltering","curFilterObjEvent","parent_1","returnValue","applyPreviewFilter","parent_2","setInterval","quickToolbar","qatArea","labelWrapper","sliderWrapper","updateFinetuneSpan","ftValPan","unselectBtn","selectors_1","ej2_instances","selectors_2","selFillElem","selStrokeElem","selTextStrokeElem","selStrokeTextColorElem","selTextBGElem","selPenStrokeElem","strokeWidthElem","rectangleRadiusElem","fontFamilyElem","fontSizeElem","boldBtn","italicBtn","getStrokeWidth","getRectRadius","btnElement","detach","isString","indexArr","getIndex","negativeIndexArr","isSameIndex","isFontColor","ctxTbar","innerText"],"mappings":"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"}